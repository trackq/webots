(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e=e||self,t(e.THREE={}))})(this,function(e){var Oe=Math.tan,Gn=Math.atan,kn=Math.acos,Hn=Math.round,Vn=Math.ceil,Wn=Number.isInteger,Xn=Math.sign,jn=Number.EPSILON,Yn=Math.sin,Qn=Math.atan2,qn=Math.pow,Zn=Math.PI,Jn=Math.sqrt,Kn=Math.LN2,$n=Math.log,ei=Math.max,ti=Math.cos,ai=Math.min,ri=Math.abs,oi=Math.floor;function t(){}function o(e,t){this.x=e||0,this.y=t||0}function i(e,t,a,r){this._x=e||0,this._y=t||0,this._z=a||0,this._w=void 0===r?1:r}function s(e,t,a){this.x=e||0,this.y=t||0,this.z=a||0}function y(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function r(t,a,n,i,s,e,d,p,c,l){Object.defineProperty(this,"id",{value:ii++}),this.uuid=ni.generateUUID(),this.name="",this.image=void 0===t?r.DEFAULT_IMAGE:t,this.mipmaps=[],this.mapping=void 0===a?r.DEFAULT_MAPPING:a,this.wrapS=void 0===n?1001:n,this.wrapT=void 0===i?1001:i,this.magFilter=void 0===s?1006:s,this.minFilter=void 0===e?1008:e,this.anisotropy=void 0===c?1:c,this.format=void 0===d?1023:d,this.type=void 0===p?1009:p,this.offset=new o(0,0),this.repeat=new o(1,1),this.center=new o(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new y,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0===l?3E3:l,this.version=0,this.onUpdate=null}function _(e,t,a,r){this.x=e||0,this.y=t||0,this.z=a||0,this.w=void 0===r?1:r}function l(e,t,a){this.width=e,this.height=t,this.scissor=new _(0,0,e,t),this.scissorTest=!1,this.viewport=new _(0,0,e,t),a=a||{},this.texture=new r(void 0,void 0,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),this.texture.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,this.texture.minFilter=void 0===a.minFilter?1006:a.minFilter,this.depthBuffer=!(void 0!==a.depthBuffer)||a.depthBuffer,this.stencilBuffer=!(void 0!==a.stencilBuffer)||a.stencilBuffer,this.depthTexture=void 0===a.depthTexture?null:a.depthTexture}function a(e,t,a){l.call(this,e,t,a),this.samples=4}function n(e,t,a){l.call(this,e,t,a)}function p(t,a,o,n,i,e,s,d,c,l,u,m){r.call(this,null,e,s,d,c,l,n,i,u,m),this.image={data:t,width:a,height:o},this.magFilter=void 0===c?1003:c,this.minFilter=void 0===l?1003:l,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1}function u(e,t){this.min=void 0===e?new s(1/0,1/0,1/0):e,this.max=void 0===t?new s(-Infinity,-Infinity,-Infinity):t}function S(e,t){this.center=void 0===e?new s:e,this.radius=void 0===t?0:t}function x(e,t){this.normal=void 0===e?new s(1,0,0):e,this.constant=void 0===t?0:t}function C(t,a,r,o,n,e){this.planes=[void 0===t?new x:t,void 0===a?new x:a,void 0===r?new x:r,void 0===o?new x:o,void 0===n?new x:n,void 0===e?new x:e]}function W(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function v(t){var a={},r;for(r in t)for(var o in a[r]={},t[r]){var n=t[r][o];a[r][o]=n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture)?n.clone():Array.isArray(n)?n.slice():n}return a}function d(t){for(var a={},r=0;r<t.length;r++){var o=v(t[r]),n;for(n in o)a[n]=o[n]}return a}function w(e,t,a){return void 0===t&&void 0===a?this.set(e):this.setRGB(e,t,a)}function P(){function t(n,e){!1!==a&&(o(n,e),r.requestAnimationFrame(t))}var r=null,a=!1,o=null;return{start:function(){!0!==a&&null!==o&&(r.requestAnimationFrame(t),a=!0)},stop:function(){a=!1},setAnimationLoop:function(e){o=e},setContext:function(e){r=e}}}function c(t){function a(a,r){var o=a.array,n=a.dynamic?35048:35044,e=t.createBuffer();return t.bindBuffer(r,e),t.bufferData(r,o,n),a.onUploadCallback(),r=5126,o instanceof Float32Array?r=5126:o instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):o instanceof Uint16Array?r=5123:o instanceof Int16Array?r=5122:o instanceof Uint32Array?r=5125:o instanceof Int32Array?r=5124:o instanceof Int8Array?r=5120:o instanceof Uint8Array&&(r=5121),{buffer:e,type:r,bytesPerElement:o.BYTES_PER_ELEMENT,version:a.version}}var r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var a=r.get(e);a&&(t.deleteBuffer(a.buffer),r.delete(e))},update:function(o,n){o.isInterleavedBufferAttribute&&(o=o.data);var e=r.get(o);if(void 0===e)r.set(o,a(o,n));else if(e.version<o.version){var i=o,s=i.array,p=i.updateRange;t.bindBuffer(n,e.buffer),!1===i.dynamic?t.bufferData(n,s,35044):-1===p.count?t.bufferSubData(n,0,s):0===p.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(n,p.offset*s.BYTES_PER_ELEMENT,s.subarray(p.offset,p.offset+p.count)),p.count=-1),e.version=o.version}}}}function L(t,a,r,o,n,e){this.a=t,this.b=a,this.c=r,this.normal=o&&o.isVector3?o:new s,this.vertexNormals=Array.isArray(o)?o:[],this.color=n&&n.isColor?n:new w,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=void 0===e?0:e}function m(e,t,a,r){this._x=e||0,this._y=t||0,this._z=a||0,this._order=r||m.DefaultOrder}function f(){this.mask=1}function A(){Object.defineProperty(this,"id",{value:Va++}),this.uuid=ni.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=A.DefaultUp.clone();var e=new s,t=new m,a=new i,r=new s(1,1,1);t.onChange(function(){a.setFromEuler(t,!1)}),a.onChange(function(){t.setFromQuaternion(a,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new W},normalMatrix:{value:new y}}),this.matrix=new W,this.matrixWorld=new W,this.matrixAutoUpdate=A.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new f,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function F(){Object.defineProperty(this,"id",{value:pi+=2}),this.uuid=ni.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function I(e,t,a){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0===e?0:e.length/t,this.normalized=!0===a,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function g(e,t,a){I.call(this,new Int8Array(e),t,a)}function h(e,t,a){I.call(this,new Uint8Array(e),t,a)}function N(e,t,a){I.call(this,new Uint8ClampedArray(e),t,a)}function D(e,t,a){I.call(this,new Int16Array(e),t,a)}function z(e,t,a){I.call(this,new Uint16Array(e),t,a)}function G(e,t,a){I.call(this,new Int32Array(e),t,a)}function H(e,t,a){I.call(this,new Uint32Array(e),t,a)}function j(e,t,a){I.call(this,new Float32Array(e),t,a)}function E(e,t,a){I.call(this,new Float64Array(e),t,a)}function b(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function Y(e){if(0===e.length)return-Infinity;for(var t=e[0],a=1,r=e.length;a<r;++a)e[a]>t&&(t=e[a]);return t}function Z(){Object.defineProperty(this,"id",{value:ci+=2}),this.uuid=ni.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0},this.userData={}}function B(t,a,r,o,n,e){F.call(this),this.type="BoxGeometry",this.parameters={width:t,height:a,depth:r,widthSegments:o,heightSegments:n,depthSegments:e},this.fromBufferGeometry(new K(t,a,r,o,n,e)),this.mergeVertices()}function K(r,o,n,i,u,y){function x(t,o,n,i,d,e,v,A,M,P,L){var R=e/M,r=v/P,u=e/2,w=v/2;v=M+1;var y=e=0,I=new s,F,N;for(N=0;N<P+1;N++){var D=N*r-w;for(F=0;F<v;F++)I[t]=(F*R-u)*i,I[o]=D*d,I[n]=A/2,l.push(I.x,I.y,I.z),I[t]=0,I[o]=0,I[n]=0<A?1:-1,m.push(I.x,I.y,I.z),T.push(F/M),T.push(1-N/P),e+=1}for(N=0;N<P;N++)for(F=0;F<M;F++)t=p+F+v*(N+1),o=p+(F+1)+v*(N+1),n=p+(F+1)+v*N,h.push(p+F+v*N,t,n),h.push(t,o,n),y+=6;_.addGroup(E,y,L),E+=y,p+=e}Z.call(this),this.type="BoxBufferGeometry",this.parameters={width:r,height:o,depth:n,widthSegments:i,heightSegments:u,depthSegments:y};var _=this;r=r||1,o=o||1,n=n||1,i=oi(i)||1,u=oi(u)||1,y=oi(y)||1;var h=[],l=[],m=[],T=[],p=0,E=0;x("z","y","x",-1,-1,n,o,r,y,u,0),x("z","y","x",1,-1,n,o,-r,y,u,1),x("x","z","y",1,1,r,n,o,i,y,2),x("x","z","y",1,-1,r,n,-o,i,y,3),x("x","y","z",1,-1,r,o,n,i,u,4),x("x","y","z",-1,-1,r,o,-n,i,u,5),this.setIndex(h),this.addAttribute("position",new j(l,3)),this.addAttribute("normal",new j(m,3)),this.addAttribute("uv",new j(T,2))}function k(e,t,a,r){F.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:a,heightSegments:r},this.fromBufferGeometry(new ee(e,t,a,r)),this.mergeVertices()}function ee(r,o,n,i){Z.call(this),this.type="PlaneBufferGeometry",this.parameters={width:r,height:o,widthSegments:n,heightSegments:i},r=r||1,o=o||1;var s=r/2,u=o/2;n=oi(n)||1,i=oi(i)||1;var y=n+1,g=i+1,x=r/n,l=o/i,m=[],_=[],p=[],v=[];for(r=0;r<g;r++){var t=r*l-u;for(o=0;o<y;o++)_.push(o*x-s,-t,0),p.push(0,0,1),v.push(o/n),v.push(1-r/i)}for(r=0;r<i;r++)for(o=0;o<n;o++)s=o+y*(r+1),u=o+1+y*(r+1),g=o+1+y*r,m.push(o+y*r,s,g),m.push(s,u,g);this.setIndex(m),this.addAttribute("position",new j(_,3)),this.addAttribute("normal",new j(p,3)),this.addAttribute("uv",new j(v,2))}function q(){Object.defineProperty(this,"id",{value:ui++}),this.uuid=ni.generateUUID(),this.name="",this.type="Material",this.lights=this.fog=!0,this.blending=1,this.side=0,this.vertexTangents=this.flatShading=!1,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}function Q(e){q.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function de(e,t){this.origin=void 0===e?new s:e,this.direction=void 0===t?new s:t}function ce(e,t,a){this.a=void 0===e?new s:e,this.b=void 0===t?new s:t,this.c=void 0===a?new s:a}function fe(e){q.call(this),this.type="MeshBasicMaterial",this.color=new w(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.lights=this.morphTargets=this.skinning=!1,this.setValues(e)}function ge(e,t){A.call(this),this.type="Mesh",this.geometry=void 0===e?new Z:e,this.material=void 0===t?new fe({color:16777215*Math.random()}):t,this.drawMode=0,this.updateMorphTargets()}function _e(r,t,a,o){function n(e,a){t.buffers.color.setClear(e.r,e.g,e.b,a,o)}var e=new w(0),i=0,s=null,p=0,c,u;return{getClearColor:function(){return e},setClearColor:function(t,a){e.set(t),i=void 0===a?1:a,n(e,i)},getClearAlpha:function(){return i},setClearAlpha:function(t){i=t,n(e,i)},render:function(o,l,m,f){l=l.background,m=r.vr,(m=m.getSession&&m.getSession())&&"additive"===m.environmentBlendMode&&(l=null),null===l?(n(e,i),s=null,p=0):l&&l.isColor&&(n(l,1),f=!0,s=null,p=0),(r.autoClear||f)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),l&&(l.isCubeTexture||l.isWebGLRenderTargetCube)?(void 0===u&&(u=new ge(new K(1,1,1),new Q({type:"BackgroundCubeMaterial",uniforms:v(J.cube.uniforms),vertexShader:J.cube.vertexShader,fragmentShader:J.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.removeAttribute("normal"),u.geometry.removeAttribute("uv"),u.onBeforeRender=function(e,t,a){this.matrixWorld.copyPosition(a.matrixWorld)},Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.tCube.value}}),a.update(u)),f=l.isWebGLRenderTargetCube?l.texture:l,u.material.uniforms.tCube.value=f,u.material.uniforms.tFlip.value=l.isWebGLRenderTargetCube?1:-1,(s!==l||p!==f.version)&&(u.material.needsUpdate=!0,s=l,p=f.version),o.unshift(u,u.geometry,u.material,0,0,null)):l&&l.isTexture&&(void 0===c&&(c=new ge(new ee(2,2),new Q({type:"BackgroundMaterial",uniforms:v(J.background.uniforms),vertexShader:J.background.vertexShader,fragmentShader:J.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.removeAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(c)),c.material.uniforms.t2D.value=l,!0===l.matrixAutoUpdate&&l.updateMatrix(),c.material.uniforms.uvTransform.value.copy(l.matrix),(s!==l||p!==l.version)&&(c.material.needsUpdate=!0,s=l,p=l.version),o.unshift(c,c.geometry,c.material,0,0,null))}}}function Ve(t,a,r,o){var n;this.setMode=function(e){n=e},this.render=function(e,a){t.drawArrays(n,e,a),r.update(a,n)},this.renderInstances=function(e,i,s){if(o.isWebGL2)var d=t;else if(d=a.get("ANGLE_instanced_arrays"),null===d)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[o.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](n,i,s,e.maxInstancedCount),r.update(s,n,e.maxInstancedCount)}}function We(r,a,o){function n(e){if("highp"===e){if(0<r.getShaderPrecisionFormat(35633,36338).precision&&0<r.getShaderPrecisionFormat(35632,36338).precision)return"highp";e="mediump"}return"mediump"===e&&0<r.getShaderPrecisionFormat(35633,36337).precision&&0<r.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var i="undefined"!=typeof WebGL2RenderingContext&&r instanceof WebGL2RenderingContext,s=void 0===o.precision?"highp":o.precision,d=n(s),f;d!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",d,"instead."),s=d),o=!0===o.logarithmicDepthBuffer,d=r.getParameter(34930);var y=r.getParameter(35660),l=r.getParameter(3379),m=r.getParameter(34076),b=r.getParameter(34921),p=r.getParameter(36347),v=r.getParameter(36348),t=r.getParameter(36349),_=0<y,u=i||!!a.get("OES_texture_float"),T=i?r.getParameter(36183):0;return{isWebGL2:i,getMaxAnisotropy:function(){if(void 0!==f)return f;var e=a.get("EXT_texture_filter_anisotropic");return f=null===e?0:r.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT)},getMaxPrecision:n,precision:s,logarithmicDepthBuffer:o,maxTextures:d,maxVertexTextures:y,maxTextureSize:l,maxCubemapSize:m,maxAttributes:b,maxVertexUniforms:p,maxVaryings:v,maxFragmentUniforms:t,vertexTextures:_,floatFragmentTextures:u,floatVertexTextures:_&&u,maxSamples:T}}function et(){function t(){l.value!==n&&(l.value=n,l.needsUpdate=0<i),r.numPlanes=i,r.numIntersection=0}function o(t,a,o,n){var i=null===t?0:t.length,s=null;if(0!==i){if(s=l.value,!0!==n||null===s)for(n=o+4*i,a=a.matrixWorldInverse,c.getNormalMatrix(a),(null===s||s.length<n)&&(s=new Float32Array(n)),n=0;n!==i;++n,o+=4)p.copy(t[n]).applyMatrix4(a,c),p.normal.toArray(s,o),s[o+3]=p.constant;l.value=s,l.needsUpdate=!0}return r.numPlanes=i,s}var r=this,n=null,i=0,s=!1,a=!1,p=new x,c=new y,l={value:null,needsUpdate:!1};this.uniform=l,this.numIntersection=this.numPlanes=0,this.init=function(e,t,a){var r=0!==e.length||t||0!==i||s;return s=t,n=o(e,a,0),i=e.length,r},this.beginShadows=function(){a=!0,o(null)},this.endShadows=function(){a=!1,t()},this.setState=function(e,d,m,f,g,r){if(!s||null===e||0===e.length||a&&!m)a?o(null):t();else{m=a?0:i;var u=4*m,h=g.clippingState||null;for(l.value=h,h=o(e,f,u,r),e=0;e!==u;++e)h[e]=n[e];g.clippingState=h,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=m}}}function tt(e){var t={};return{get:function(a){if(void 0!==t[a])return t[a];switch(a){case"WEBGL_depth_texture":var r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(a);}return null===r&&console.warn("THREE.WebGLRenderer: "+a+" extension not supported."),t[a]=r}}}function at(t,r,o){function n(e){var t=e.target;for(var d in e=i[t.id],null!==e.index&&r.remove(e.index),e.attributes)r.remove(e.attributes[d]);t.removeEventListener("dispose",n),delete i[t.id],(d=s[e.id])&&(r.remove(d),delete s[e.id]),o.memory.geometries--}var i={},s={};return{get:function(e,t){var a=i[t.id];return a?a:(t.addEventListener("dispose",n),t.isBufferGeometry?a=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=new Z().setFromObject(e)),a=t._bufferGeometry),i[t.id]=a,o.memory.geometries++,a)},update:function(t){var o=t.index,n=t.attributes;for(var i in null!==o&&r.update(o,34963),n)r.update(n[i],34962);for(i in t=t.morphAttributes,t){o=t[i],n=0;for(var s=o.length;n<s;n++)r.update(o[n],34962)}},getWireframeAttribute:function(t){var a=s[t.id];if(a)return a;a=[];var o=t.index,n=t.attributes;if(null!==o){o=o.array,n=0;for(var i=o.length;n<i;n+=3){var l=o[n+0],u=o[n+1],m=o[n+2];a.push(l,u,u,m,m,l)}}else for(o=n.position.array,n=0,i=o.length/3-1;n<i;n+=3)l=n+0,u=n+1,m=n+2,a.push(l,u,u,m,m,l);return a=new(65535<Y(a)?H:z)(a,1),r.update(a,34963),s[t.id]=a}}}function rt(t,a,r,o){var n,i,s;this.setMode=function(e){n=e},this.setIndex=function(e){i=e.type,s=e.bytesPerElement},this.render=function(e,a){t.drawElements(n,a,i,e*s),r.update(a,n)},this.renderInstances=function(e,d,l){if(o.isWebGL2)var p=t;else if(p=a.get("ANGLE_instanced_arrays"),null===p)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[o.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](n,l,i,d*s,e.maxInstancedCount),r.update(l,n,e.maxInstancedCount)}}function ot(){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(r,a,o){o=o||1,t.calls++;4===a?t.triangles+=r/3*o:5===a||6===a?t.triangles+=o*(r-2):1===a?t.lines+=r/2*o:3===a?t.lines+=o*(r-1):2===a?t.lines+=o*r:0===a?t.points+=o*r:console.error("THREE.WebGLInfo: Unknown draw mode:",a)}}}function nt(e,t){return ri(t[1])-ri(e[1])}function it(t){var a={},r=new Float32Array(8);return{update:function(o,n,e,i){var s=o.morphTargetInfluences,c=s.length;if(o=a[n.id],void 0===o){o=[];for(var u=0;u<c;u++)o[u]=[u,0];a[n.id]=o}var g=e.morphTargets&&n.morphAttributes.position;for(e=e.morphNormals&&n.morphAttributes.normal,u=0;u<c;u++){var y=o[u];0!==y[1]&&(g&&n.removeAttribute("morphTarget"+u),e&&n.removeAttribute("morphNormal"+u))}for(u=0;u<c;u++)y=o[u],y[0]=u,y[1]=s[u];for(o.sort(nt),u=0;8>u;u++){if((y=o[u])&&(s=y[0],c=y[1])){g&&n.addAttribute("morphTarget"+u,g[s]),e&&n.addAttribute("morphNormal"+u,e[s]),r[u]=c;continue}r[u]=0}i.getUniforms().setValue(t,"morphTargetInfluences",r)}}}function st(t,a){var r={};return{update:function(o){var n=a.render.frame,e=o.geometry,i=t.get(o,e);return r[i.id]!==n&&(e.isGeometry&&i.updateFromObject(o),t.update(i),r[i.id]=n),i},dispose:function(){r={}}}}function lt(t,o,n,i,s,e,d,p,c,l){t=void 0===t?[]:t,r.call(this,t,void 0===o?301:o,n,i,s,e,void 0===d?1022:d,p,c,l),this.flipY=!1}function dt(e,t,a,o){r.call(this,null),this.image={data:e,width:t,height:a,depth:o},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1}function pt(e,t,a,o){r.call(this,null),this.image={data:e,width:t,height:a,depth:o},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1}function ct(t,a,r){var o=t[0];if(0>=o||0<o)return t;var n=a*r,i=yi[n];if(void 0===i&&(i=new Float32Array(n),yi[n]=i),0!==a)for(o.toArray(i,0),o=1,n=0;o!==a;++o)n+=r,t[o].toArray(i,n);return i}function ut(e,t){if(e.length!==t.length)return!1;for(var a=0,r=e.length;a<r;a++)if(e[a]!==t[a])return!1;return!0}function X(e,t){for(var a=0,r=t.length;a<r;a++)e[a]=t[a]}function mt(e,t){var a=Xe[t];void 0===a&&(a=new Int32Array(t),Xe[t]=a);for(var r=0;r!==t;++r)a[r]=e.allocateTextureUnit();return a}function Ye(e,t){var a=this.cache;a[0]!==t&&(e.uniform1f(this.addr,t),a[0]=t)}function ft(e,t){var a=this.cache;a[0]!==t&&(e.uniform1i(this.addr,t),a[0]=t)}function gt(e,t){var a=this.cache;void 0===t.x?ut(a,t)||(e.uniform2fv(this.addr,t),X(a,t)):(a[0]!==t.x||a[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),a[0]=t.x,a[1]=t.y)}function ht(e,t){var a=this.cache;void 0===t.x?void 0===t.r?ut(a,t)||(e.uniform3fv(this.addr,t),X(a,t)):(a[0]!==t.r||a[1]!==t.g||a[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),a[0]=t.r,a[1]=t.g,a[2]=t.b):(a[0]!==t.x||a[1]!==t.y||a[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),a[0]=t.x,a[1]=t.y,a[2]=t.z)}function yt(e,t){var a=this.cache;void 0===t.x?ut(a,t)||(e.uniform4fv(this.addr,t),X(a,t)):(a[0]!==t.x||a[1]!==t.y||a[2]!==t.z||a[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),a[0]=t.x,a[1]=t.y,a[2]=t.z,a[3]=t.w)}function xt(e,t){var a=this.cache,r=t.elements;void 0===r?ut(a,t)||(e.uniformMatrix2fv(this.addr,!1,t),X(a,t)):ut(a,r)||(vi.set(r),e.uniformMatrix2fv(this.addr,!1,vi),X(a,r))}function vt(e,t){var a=this.cache,r=t.elements;void 0===r?ut(a,t)||(e.uniformMatrix3fv(this.addr,!1,t),X(a,t)):ut(a,r)||(xi.set(r),e.uniformMatrix3fv(this.addr,!1,xi),X(a,r))}function bt(e,t){var a=this.cache,r=t.elements;void 0===r?ut(a,t)||(e.uniformMatrix4fv(this.addr,!1,t),X(a,t)):ut(a,r)||(Ze.set(r),e.uniformMatrix4fv(this.addr,!1,Ze),X(a,r))}function _t(t,a,r){var o=this.cache,n=r.allocateTextureUnit();o[0]!==n&&(t.uniform1i(this.addr,n),o[0]=n),r.safeSetTexture2D(a||mi,n)}function Tt(t,a,r){var o=this.cache,n=r.allocateTextureUnit();o[0]!==n&&(t.uniform1i(this.addr,n),o[0]=n),r.setTexture2DArray(a||fi,n)}function St(t,a,r){var o=this.cache,n=r.allocateTextureUnit();o[0]!==n&&(t.uniform1i(this.addr,n),o[0]=n),r.setTexture3D(a||gi,n)}function Et(t,a,r){var o=this.cache,n=r.allocateTextureUnit();o[0]!==n&&(t.uniform1i(this.addr,n),o[0]=n),r.safeSetTextureCube(a||hi,n)}function wt(e,t){var a=this.cache;ut(a,t)||(e.uniform2iv(this.addr,t),X(a,t))}function At(e,t){var a=this.cache;ut(a,t)||(e.uniform3iv(this.addr,t),X(a,t))}function Mt(e,t){var a=this.cache;ut(a,t)||(e.uniform4iv(this.addr,t),X(a,t))}function Pt(e){return 5126===e?Ye:35664===e?gt:35665===e?ht:35666===e?yt:35674===e?xt:35675===e?vt:35676===e?bt:35678===e||36198===e?_t:35679===e?St:35680===e?Et:36289===e?Tt:5124===e||35670===e?ft:35667===e||35671===e?wt:35668===e||35672===e?At:35669===e||35673===e?Mt:void 0}function Lt(e,t){var a=this.cache;ut(a,t)||(e.uniform1fv(this.addr,t),X(a,t))}function Ct(e,t){var a=this.cache;ut(a,t)||(e.uniform1iv(this.addr,t),X(a,t))}function Rt(e,t){var a=this.cache;t=ct(t,this.size,2),ut(a,t)||(e.uniform2fv(this.addr,t),this.updateCache(t))}function Ft(e,t){var a=this.cache;t=ct(t,this.size,3),ut(a,t)||(e.uniform3fv(this.addr,t),this.updateCache(t))}function It(e,t){var a=this.cache;t=ct(t,this.size,4),ut(a,t)||(e.uniform4fv(this.addr,t),this.updateCache(t))}function Nt(e,t){var a=this.cache;t=ct(t,this.size,4),ut(a,t)||(e.uniformMatrix2fv(this.addr,!1,t),this.updateCache(t))}function Dt(e,t){var a=this.cache;t=ct(t,this.size,9),ut(a,t)||(e.uniformMatrix3fv(this.addr,!1,t),this.updateCache(t))}function Bt(e,t){var a=this.cache;t=ct(t,this.size,16),ut(a,t)||(e.uniformMatrix4fv(this.addr,!1,t),this.updateCache(t))}function Ut(t,r,o){var n=this.cache,i=r.length,e=mt(o,i);for(!1===ut(n,e)&&(t.uniform1iv(this.addr,e),X(n,e)),t=0;t!==i;++t)o.safeSetTexture2D(r[t]||mi,e[t])}function Ot(t,r,o){var n=this.cache,i=r.length,e=mt(o,i);for(!1===ut(n,e)&&(t.uniform1iv(this.addr,e),X(n,e)),t=0;t!==i;++t)o.safeSetTextureCube(r[t]||hi,e[t])}function zt(e){return 5126===e?Lt:35664===e?Rt:35665===e?Ft:35666===e?It:35674===e?Nt:35675===e?Dt:35676===e?Bt:35678===e?Ut:35680===e?Ot:5124===e||35670===e?Ct:35667===e||35671===e?wt:35668===e||35672===e?At:35669===e||35673===e?Mt:void 0}function Gt(e,t,a){this.id=e,this.addr=a,this.cache=[],this.setValue=Pt(t.type)}function kt(e,t,a){this.id=e,this.addr=a,this.cache=[],this.size=t.size,this.setValue=zt(t.type)}function Ht(e){this.id=e,this.seq=[],this.map={}}function Vt(t,a){this.seq=[],this.map={};for(var r=t.getProgramParameter(a,35718),o=0;o<r;++o){var n=t.getActiveUniform(a,o),i=t.getUniformLocation(a,n.name),s=this,c=n.name,u=c.length;for($e.lastIndex=0;;){var l=$e.exec(c),m=$e.lastIndex,f=l[1],y=l[3];if("]"===l[2]&&(f|=0),void 0===y||"["===y&&m+2===u){c=s,n=void 0===y?new Gt(f,n,i):new kt(f,n,i),c.seq.push(n),c.map[n.id]=n;break}else y=s.map[f],void 0===y&&(y=new Ht(f),f=s,s=y,f.seq.push(s),f.map[s.id]=s),s=y}}}function Wt(e){e=e.split("\n");for(var t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}function Xt(t,a,r,o){var n=t.createShader(a);return t.shaderSource(n,r),t.compileShader(n),!0===o&&(!1===t.getShaderParameter(n,35713)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",35633===a?"vertex":"fragment",t.getShaderInfoLog(n),Wt(r))),n}function jt(e){switch(e){case 3E3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+e);}}function Yt(e,t){return t=jt(t),"vec4 "+e+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function Qt(e,t){return t=jt(t),"vec4 "+e+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function qt(e,t){switch(t){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="Uncharted2";break;case 4:t="OptimizedCineon";break;case 5:t="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+t);}return"vec3 "+e+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Zt(e,t,r){return e=e||{},[e.derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap&&!t.objectSpaceNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Kt).join("\n")}function Jt(e){var t=[],a;for(a in e){var r=e[a];!1!==r&&t.push("#define "+a+" "+r)}return t.join("\n")}function Kt(e){return""!==e}function $t(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function ea(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function ta(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(e,t){if(e=li[t],void 0===e)throw Error("Can not resolve #include <"+t+">");return ta(e)})}function ie(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,r,o,n){for(t="",r=parseInt(r);r<parseInt(o);r++)t+=n.replace(/\[ i \]/g,"[ "+r+" ]");return t})}function aa(t,o,i,s,d,e,c,_){var h=t.context,l=s.defines,T=d.vertexShader,S=d.fragmentShader,E="SHADOWMAP_TYPE_BASIC";1===e.shadowMapType?E="SHADOWMAP_TYPE_PCF":2===e.shadowMapType&&(E="SHADOWMAP_TYPE_PCF_SOFT");var A="ENVMAP_TYPE_CUBE",M="ENVMAP_MODE_REFLECTION",P="ENVMAP_BLENDING_MULTIPLY";if(e.envMap){switch(s.envMap.mapping){case 301:case 302:A="ENVMAP_TYPE_CUBE";break;case 306:case 307:A="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:A="ENVMAP_TYPE_EQUIREC";break;case 305:A="ENVMAP_TYPE_SPHERE";}switch(s.envMap.mapping){case 302:case 304:M="ENVMAP_MODE_REFRACTION";}switch(s.combine){case 0:P="ENVMAP_BLENDING_MULTIPLY";break;case 1:P="ENVMAP_BLENDING_MIX";break;case 2:P="ENVMAP_BLENDING_ADD";}}var L=0<t.gammaFactor?t.gammaFactor:1,w=c.isWebGL2?"":Zt(s.extensions,e,o),n=Jt(l),x=h.createProgram();s.isRawShaderMaterial?(l=[n].filter(Kt).join("\n"),0<l.length&&(l+="\n"),o=[w,n].filter(Kt).join("\n"),0<o.length&&(o+="\n")):(l=["precision "+e.precision+" float;","precision "+e.precision+" int;","#define SHADER_NAME "+d.name,n,e.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+L,"#define MAX_BONES "+e.maxBones,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+M:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.displacementMap&&e.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.useVertexTexture?"#define BONE_TEXTURE":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&!1===e.flatShading?"#define USE_MORPHNORMALS":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+E:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&(c.isWebGL2||o.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Kt).join("\n"),o=[w,"precision "+e.precision+" float;","precision "+e.precision+" int;","#define SHADER_NAME "+d.name,n,e.alphaTest?"#define ALPHATEST "+e.alphaTest+(e.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+L,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+A:"",e.envMap?"#define "+M:"",e.envMap?"#define "+P:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMap&&e.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.vertexTangents?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+E:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",e.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",e.logarithmicDepthBuffer&&(c.isWebGL2||o.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",e.envMap&&(c.isWebGL2||o.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0===e.toneMapping?"":"#define TONE_MAPPING",0===e.toneMapping?"":li.tonemapping_pars_fragment,0===e.toneMapping?"":qt("toneMapping",e.toneMapping),e.dithering?"#define DITHERING":"",e.outputEncoding||e.mapEncoding||e.matcapEncoding||e.envMapEncoding||e.emissiveMapEncoding?li.encodings_pars_fragment:"",e.mapEncoding?Yt("mapTexelToLinear",e.mapEncoding):"",e.matcapEncoding?Yt("matcapTexelToLinear",e.matcapEncoding):"",e.envMapEncoding?Yt("envMapTexelToLinear",e.envMapEncoding):"",e.emissiveMapEncoding?Yt("emissiveMapTexelToLinear",e.emissiveMapEncoding):"",e.outputEncoding?Qt("linearToOutputTexel",e.outputEncoding):"",e.depthPacking?"#define DEPTH_PACKING "+s.depthPacking:"","\n"].filter(Kt).join("\n")),T=ta(T),T=$t(T,e),T=ea(T,e),S=ta(S),S=$t(S,e),S=ea(S,e),T=ie(T),S=ie(S),c.isWebGL2&&!s.isRawShaderMaterial&&(c=!1,E=/^\s*#version\s+300\s+es\s*\n/,s.isShaderMaterial&&null!==T.match(E)&&null!==S.match(E)&&(c=!0,T=T.replace(E,""),S=S.replace(E,"")),l="#version 300 es\n\n#define attribute in\n#define varying out\n#define texture2D texture\n"+l,o=["#version 300 es\n\n#define varying in",c?"":"out highp vec4 pc_fragColor;",c?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+o),S=o+S,T=Xt(h,35633,l+T,t.debug.checkShaderErrors),S=Xt(h,35632,S,t.debug.checkShaderErrors),h.attachShader(x,T),h.attachShader(x,S),void 0===s.index0AttributeName?!0===e.morphTargets&&h.bindAttribLocation(x,0,"position"):h.bindAttribLocation(x,0,s.index0AttributeName),h.linkProgram(x),t.debug.checkShaderErrors&&(t=h.getProgramInfoLog(x).trim(),e=h.getShaderInfoLog(T).trim(),c=h.getShaderInfoLog(S).trim(),A=E=!0,!1===h.getProgramParameter(x,35714)?(E=!1,console.error("THREE.WebGLProgram: shader error: ",h.getError(),"35715",h.getProgramParameter(x,35715),"gl.getProgramInfoLog",t,e,c)):""===t?(""===e||""===c)&&(A=!1):console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t),A&&(this.diagnostics={runnable:E,material:s,programLog:t,vertexShader:{log:e,prefix:l},fragmentShader:{log:c,prefix:o}})),h.deleteShader(T),h.deleteShader(S);var y;this.getUniforms=function(){return void 0===y&&(y=new Vt(h,x,_)),y};var C;return this.getAttributes=function(){if(void 0===C){for(var e={},t=h.getProgramParameter(x,35721),a=0,r;a<t;a++)r=h.getActiveAttrib(x,a).name,e[r]=h.getAttribLocation(x,r);C=e}return C},this.destroy=function(){h.deleteProgram(x),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=d.name,this.id=he++,this.code=i,this.usedTimes=1,this.program=x,this.vertexShader=T,this.fragmentShader=S,this}function na(t,a,o,r){function n(e,t){if(e)e.isTexture?a=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),a=e.texture.encoding);else var a=3E3;return 3E3===a&&t&&(a=3007),a}var i=[],e={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},s=["precision","supportsVertexTextures","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];this.getParameters=function(a,i,s,d,c,u,f){var r=e[a.type];if(f.isSkinnedMesh){var l=f.skeleton.bones;if(o.floatVertexTextures)l=1024;else{var g=ai(oi((o.maxVertexUniforms-20)/4),l.length);g<l.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+l.length+" bones. This GPU supports "+g+"."),l=0):l=g}}else l=0;g=o.precision,null!==a.precision&&(g=o.getMaxPrecision(a.precision),g!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",g,"instead."));var h=t.getRenderTarget();return{shaderID:r,precision:g,supportsVertexTextures:o.vertexTextures,outputEncoding:n(h?h.texture:null,t.gammaOutput),map:!!a.map,mapEncoding:n(a.map,t.gammaInput),matcap:!!a.matcap,matcapEncoding:n(a.matcap,t.gammaInput),envMap:!!a.envMap,envMapMode:a.envMap&&a.envMap.mapping,envMapEncoding:n(a.envMap,t.gammaInput),envMapCubeUV:!!a.envMap&&(306===a.envMap.mapping||307===a.envMap.mapping),lightMap:!!a.lightMap,aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,emissiveMapEncoding:n(a.emissiveMap,t.gammaInput),bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,objectSpaceNormalMap:1===a.normalMapType,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,alphaMap:!!a.alphaMap,gradientMap:!!a.gradientMap,combine:a.combine,vertexTangents:a.normalMap&&a.vertexTangents,vertexColors:a.vertexColors,fog:!!d,useFog:a.fog,fogExp:d&&d.isFogExp2,flatShading:a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:o.logarithmicDepthBuffer,skinning:a.skinning&&0<l,maxBones:l,useVertexTexture:o.floatVertexTextures,morphTargets:a.morphTargets,morphNormals:a.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:i.directional.length,numPointLights:i.point.length,numSpotLights:i.spot.length,numRectAreaLights:i.rectArea.length,numHemiLights:i.hemi.length,numClippingPlanes:c,numClipIntersection:u,dithering:a.dithering,shadowMapEnabled:t.shadowMap.enabled&&f.receiveShadow&&0<s.length,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,alphaTest:a.alphaTest,doubleSided:2===a.side,flipSided:1===a.side,depthPacking:void 0!==a.depthPacking&&a.depthPacking}},this.getProgramCode=function(a,r){var o=[];if(r.shaderID?o.push(r.shaderID):(o.push(a.fragmentShader),o.push(a.vertexShader)),void 0!==a.defines)for(var n in a.defines)o.push(n),o.push(a.defines[n]);for(n=0;n<s.length;n++)o.push(r[s[n]]);return o.push(a.onBeforeCompile.toString()),o.push(t.gammaOutput),o.push(t.gammaFactor),o.join()},this.acquireProgram=function(n,e,s,d){for(var p=0,c=i.length,u,f;p<c;p++)if(f=i[p],f.code===d){u=f,++u.usedTimes;break}return void 0===u&&(u=new aa(t,a,d,n,e,s,o,r),i.push(u)),u},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=i.indexOf(e);i[t]=i[i.length-1],i.pop(),e.destroy()}},this.programs=i}function pa(){var e=new WeakMap;return{get:function(t){var a=e.get(t);return void 0===a&&(a={},e.set(t,a)),a},remove:function(t){e.delete(t)},update:function(t,a,r){e.get(t)[a]=r},dispose:function(){e=new WeakMap}}}function ra(e,t){return e.groupOrder===t.groupOrder?e.renderOrder===t.renderOrder?e.program===t.program?e.material.id===t.material.id?e.z===t.z?e.id-t.id:e.z-t.z:e.material.id-t.material.id:e.program.id-t.program.id:e.renderOrder-t.renderOrder:e.groupOrder-t.groupOrder}function sa(e,t){return e.groupOrder===t.groupOrder?e.renderOrder===t.renderOrder?e.z===t.z?e.id-t.id:t.z-e.z:e.renderOrder-t.renderOrder:e.groupOrder-t.groupOrder}function ua(){function t(t,a,n,e,s,l){var d=r[o];return void 0===d?(d={id:t.id,object:t,geometry:a,material:n,program:n.program||i,groupOrder:e,renderOrder:t.renderOrder,z:s,group:l},r[o]=d):(d.id=t.id,d.object=t,d.geometry=a,d.material=n,d.program=n.program||i,d.groupOrder=e,d.renderOrder=t.renderOrder,d.z=s,d.group=l),o++,d}var r=[],o=0,a=[],n=[],i={id:-1};return{opaque:a,transparent:n,init:function(){o=0,a.length=0,n.length=0},push:function(e,r,o,i,s,l){e=t(e,r,o,i,s,l),(!0===o.transparent?n:a).push(e)},unshift:function(e,r,o,i,s,l){e=t(e,r,o,i,s,l),(!0===o.transparent?n:a).unshift(e)},sort:function(){1<a.length&&a.sort(ra),1<n.length&&n.sort(sa)}}}function ma(){function e(a){a=a.target,a.removeEventListener("dispose",e),delete t[a.id]}var t={};return{get:function(a,r){var o=t[a.id];if(void 0===o){var n=new ua;t[a.id]={},t[a.id][r.id]=n,a.addEventListener("dispose",e)}else n=o[r.id],void 0===n&&(n=new ua,o[r.id]=n);return n},dispose:function(){t={}}}}function fa(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];switch(t.type){case"DirectionalLight":var a={direction:new s,color:new w,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new o};break;case"SpotLight":a={position:new s,direction:new s,color:new w,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new o};break;case"PointLight":a={position:new s,color:new w,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new o,shadowCameraNear:1,shadowCameraFar:1E3};break;case"HemisphereLight":a={direction:new s,skyColor:new w,groundColor:new w};break;case"RectAreaLight":a={color:new w,position:new s,halfWidth:new s,halfHeight:new s};}return e[t.id]=a}}}function ga(){for(var t=new fa,a={id:bi++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=0;9>r;r++)a.probe.push(new s);var o=new s,i=new W,e=new W;return{setup:function(s,d,c){for(var m=0,f=0,h=0,b=0;9>b;b++)a.probe[b].set(0,0,0);var _=0,T=0,S=0,E=0,w=0;c=c.matrixWorldInverse,b=0;for(var A=s.length;b<A;b++){var x=s[b],y=x.color,M=x.intensity,P=x.distance,L=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)m+=y.r*M,f+=y.g*M,h+=y.b*M;else if(x.isLightProbe)for(L=0;9>L;L++)a.probe[L].addScaledVector(x.sh.coefficients[L],M);else if(x.isDirectionalLight){var C=t.get(x);C.color.copy(x.color).multiplyScalar(x.intensity),C.direction.setFromMatrixPosition(x.matrixWorld),o.setFromMatrixPosition(x.target.matrixWorld),C.direction.sub(o),C.direction.transformDirection(c),(C.shadow=x.castShadow)&&(M=x.shadow,C.shadowBias=M.bias,C.shadowRadius=M.radius,C.shadowMapSize=M.mapSize),a.directionalShadowMap[_]=L,a.directionalShadowMatrix[_]=x.shadow.matrix,a.directional[_]=C,_++}else x.isSpotLight?(C=t.get(x),C.position.setFromMatrixPosition(x.matrixWorld),C.position.applyMatrix4(c),C.color.copy(y).multiplyScalar(M),C.distance=P,C.direction.setFromMatrixPosition(x.matrixWorld),o.setFromMatrixPosition(x.target.matrixWorld),C.direction.sub(o),C.direction.transformDirection(c),C.coneCos=ti(x.angle),C.penumbraCos=ti(x.angle*(1-x.penumbra)),C.decay=x.decay,(C.shadow=x.castShadow)&&(M=x.shadow,C.shadowBias=M.bias,C.shadowRadius=M.radius,C.shadowMapSize=M.mapSize),a.spotShadowMap[S]=L,a.spotShadowMatrix[S]=x.shadow.matrix,a.spot[S]=C,S++):x.isRectAreaLight?(C=t.get(x),C.color.copy(y).multiplyScalar(M),C.position.setFromMatrixPosition(x.matrixWorld),C.position.applyMatrix4(c),e.identity(),i.copy(x.matrixWorld),i.premultiply(c),e.extractRotation(i),C.halfWidth.set(.5*x.width,0,0),C.halfHeight.set(0,.5*x.height,0),C.halfWidth.applyMatrix4(e),C.halfHeight.applyMatrix4(e),a.rectArea[E]=C,E++):x.isPointLight?(C=t.get(x),C.position.setFromMatrixPosition(x.matrixWorld),C.position.applyMatrix4(c),C.color.copy(x.color).multiplyScalar(x.intensity),C.distance=x.distance,C.decay=x.decay,(C.shadow=x.castShadow)&&(M=x.shadow,C.shadowBias=M.bias,C.shadowRadius=M.radius,C.shadowMapSize=M.mapSize,C.shadowCameraNear=M.camera.near,C.shadowCameraFar=M.camera.far),a.pointShadowMap[T]=L,a.pointShadowMatrix[T]=x.shadow.matrix,a.point[T]=C,T++):x.isHemisphereLight&&(C=t.get(x),C.direction.setFromMatrixPosition(x.matrixWorld),C.direction.transformDirection(c),C.direction.normalize(),C.skyColor.copy(x.color).multiplyScalar(M),C.groundColor.copy(x.groundColor).multiplyScalar(M),a.hemi[w]=C,w++)}a.ambient[0]=m,a.ambient[1]=f,a.ambient[2]=h,a.directional.length=_,a.spot.length=S,a.rectArea.length=E,a.point.length=T,a.hemi.length=w,a.hash.stateID=a.id,a.hash.directionalLength=_,a.hash.pointLength=T,a.hash.spotLength=S,a.hash.rectAreaLength=E,a.hash.hemiLength=w,a.hash.shadowsLength=d.length},state:a}}function ha(){var e=new ga,t=[],r=[];return{init:function(){t.length=0,r.length=0},state:{lightsArray:t,shadowsArray:r,lights:e},setupLights:function(a){e.setup(t,r,a)},pushLight:function(e){t.push(e)},pushShadow:function(e){r.push(e)}}}function ya(){function t(e){e=e.target,e.removeEventListener("dispose",t),delete a[e.id]}var a={};return{get:function(r,o){if(void 0===a[r.id]){var n=new ha;a[r.id]={},a[r.id][o.id]=n,r.addEventListener("dispose",t)}else void 0===a[r.id][o.id]?(n=new ha,a[r.id][o.id]=n):n=a[r.id][o.id];return n},dispose:function(){a={}}}}function _a(e){q.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.setValues(e)}function Ta(e){q.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new s,this.nearDistance=1,this.farDistance=1E3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.lights=this.fog=!1,this.setValues(e)}function Sa(i,a,t){function n(t,a,r,o,e,n){var s=t.geometry,d=S,c=t.customDepthMaterial;return r&&(d=p,c=t.customDistanceMaterial),c?d=c:(c=!1,a.morphTargets&&(s&&s.isBufferGeometry?c=s.morphAttributes&&s.morphAttributes.position&&0<s.morphAttributes.position.length:s&&s.isGeometry&&(c=s.morphTargets&&0<s.morphTargets.length)),t.isSkinnedMesh&&!1===a.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t),t=t.isSkinnedMesh&&a.skinning,s=0,c&&(s|=1),t&&(s|=2),d=d[s]),i.localClippingEnabled&&!0===a.clipShadows&&0!==a.clippingPlanes.length&&(s=d.uuid,c=a.uuid,t=v[s],void 0===t&&(t={},v[s]=t),s=t[c],void 0===s&&(s=d.clone(),t[c]=s),d=s),d.visible=a.visible,d.wireframe=a.wireframe,d.side=null==a.shadowSide?A[a.side]:a.shadowSide,d.clipShadows=a.clipShadows,d.clippingPlanes=a.clippingPlanes,d.clipIntersection=a.clipIntersection,d.wireframeLinewidth=a.wireframeLinewidth,d.linewidth=a.linewidth,r&&d.isMeshDistanceMaterial&&(d.referencePosition.copy(o),d.nearDistance=e,d.farDistance=n),d}function b(o,s,d,f){if(!1!==o.visible){if(o.layers.test(s.layers)&&(o.isMesh||o.isLine||o.isPoints)&&o.castShadow&&(!o.frustumCulled||e.intersectsObject(o))){o.modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,o.matrixWorld);var l=a.update(o),g=o.material;if(Array.isArray(g))for(var h=l.groups,y=0,x=h.length;y<x;y++){var t=h[y],r=g[t.materialIndex];r&&r.visible&&(r=n(o,r,f,E,d.near,d.far),i.renderBufferDirect(d,null,l,r,o,t))}else g.visible&&(r=n(o,g,f,E,d.near,d.far),i.renderBufferDirect(d,null,l,r,o,null))}for(o=o.children,l=0,g=o.length;l<g;l++)b(o[l],s,d,f)}}var e=new C,f=new W,g=new o,h=new o(t,t),T=new s,E=new s,S=[,,,,],p=[,,,,],v={},A={0:1,1:0,2:2},r=[new s(1,0,0),new s(-1,0,0),new s(0,0,1),new s(0,0,-1),new s(0,1,0),new s(0,-1,0)],u=[new s(0,1,0),new s(0,1,0),new s(0,1,0),new s(0,1,0),new s(0,0,1),new s(0,0,-1)],m=[new _,new _,new _,new _,new _,new _];for(t=0;4!==t;++t){var d=0!=(1&t),w=0!=(2&t),y=new _a({depthPacking:3201,morphTargets:d,skinning:w});S[t]=y,d=new Ta({morphTargets:d,skinning:w}),p[t]=d}var M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(a,o,s){if(!1!==M.enabled&&(!1!==M.autoUpdate||!1!==M.needsUpdate)&&0!==a.length){var d=i.getRenderTarget(),p=i.state;p.setBlending(0),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(var c=0,v=a.length,_,w;c<v;c++){w=a[c],_=w.shadow;var A=w&&w.isPointLight;if(void 0===_)console.warn("THREE.WebGLShadowMap:",w,"has no shadow.");else{var P=_.camera;if(g.copy(_.mapSize),g.min(h),A){var S=g.x,L=g.y;m[0].set(2*S,L,S,L),m[1].set(0,L,S,L),m[2].set(3*S,L,S,L),m[3].set(S,L,S,L),m[4].set(3*S,0,S,L),m[5].set(S,0,S,L),g.x*=4,g.y*=2}for(null===_.map&&(_.map=new l(g.x,g.y,{minFilter:1003,magFilter:1003,format:1023}),_.map.texture.name=w.name+".shadowMap",P.updateProjectionMatrix()),_.isSpotLightShadow&&_.update(w),S=_.map,L=_.matrix,E.setFromMatrixPosition(w.matrixWorld),P.position.copy(E),A?(_=6,L.makeTranslation(-E.x,-E.y,-E.z)):(_=1,T.setFromMatrixPosition(w.target.matrixWorld),P.lookAt(T),P.updateMatrixWorld(),L.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),L.multiply(P.projectionMatrix),L.multiply(P.matrixWorldInverse)),i.setRenderTarget(S),i.clear(),w=0;w<_;w++)A&&(T.copy(P.position),T.add(r[w]),P.up.copy(u[w]),P.lookAt(T),P.updateMatrixWorld(),p.viewport(m[w])),f.multiplyMatrices(P.projectionMatrix,P.matrixWorldInverse),e.setFromMatrix(f),b(o,s,P,A)}}M.needsUpdate=!1,i.setRenderTarget(d)}}}function Ca(t,a,o,i){function s(a,r,o){var n=new Uint8Array(4),e=t.createTexture();for(t.bindTexture(a,e),t.texParameteri(a,10241,9728),t.texParameteri(a,10240,9728),a=0;a<o;a++)t.texImage2D(r+a,0,6408,1,1,0,6408,5121,n);return e}function e(r,o){v[r]=1,0===w[r]&&(t.enableVertexAttribArray(r),w[r]=1),x[r]!==o&&((i.isWebGL2?t:a.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,o),x[r]=o)}function T(e){!0!==y[e]&&(t.enable(e),y[e]=!0)}function g(e){!1!==y[e]&&(t.disable(e),y[e]=!1)}function d(a,r,n,e,i,s,d,c){0===a?U&&(g(3042),U=!1):(U||(T(3042),U=!0),5!==a)?(a!==z||c!==Y)&&((100!==k||100!==W)&&(t.blendEquation(32774),W=k=100),c?1===a?t.blendFuncSeparate(1,771,1,771):2===a?t.blendFunc(1,1):3===a?t.blendFuncSeparate(0,0,769,771):4===a?t.blendFuncSeparate(0,768,0,770):console.error("THREE.WebGLState: Invalid blending: ",a):1===a?t.blendFuncSeparate(770,771,1,771):2===a?t.blendFunc(770,1):3===a?t.blendFunc(0,769):4===a?t.blendFunc(0,768):console.error("THREE.WebGLState: Invalid blending: ",a),j=X=V=H=null,z=a,Y=c):(i=i||r,s=s||n,d=d||e,(r!==k||i!==W)&&(t.blendEquationSeparate(o.convert(r),o.convert(i)),k=r,W=i),(n!==H||e!==V||s!==X||d!==j)&&(t.blendFuncSeparate(o.convert(n),o.convert(e),o.convert(s),o.convert(d)),H=n,V=e,X=s,j=d),z=a,Y=null)}function l(e){q!==e&&(e?t.frontFace(2304):t.frontFace(2305),q=e)}function c(e){0===e?g(2884):(T(2884),e!==Z&&(1===e?t.cullFace(1029):2===e?t.cullFace(1028):t.cullFace(1032))),Z=e}function m(e,a,r){e?(T(32823),te!==a||ae!==r)&&(t.polygonOffset(a,r),te=a,ae=r):g(32823)}function p(e){void 0===e&&(e=33984+re-1),oe!==e&&(t.activeTexture(e),oe=e)}var f=new function(){var r=!1,a=new _,o=null,n=new _(0,0,0,0);return{setMask:function(e){o===e||r||(t.colorMask(e,e,e,e),o=e)},setLocked:function(e){r=e},setClear:function(e,r,o,i,s){!0===s&&(e*=i,r*=i,o*=i),a.set(e,r,o,i),!1===n.equals(a)&&(t.clearColor(e,r,o,i),n.copy(a))},reset:function(){r=!1,o=null,n.set(-1,0,0,0)}}},h=new function(){var r=!1,a=null,o=null,n=null;return{setTest:function(e){e?T(2929):g(2929)},setMask:function(e){a===e||r||(t.depthMask(e),a=e)},setFunc:function(e){o!==e&&(e?0===e?t.depthFunc(512):1===e?t.depthFunc(519):2===e?t.depthFunc(513):3===e?t.depthFunc(515):4===e?t.depthFunc(514):5===e?t.depthFunc(518):6===e?t.depthFunc(516):7===e?t.depthFunc(517):t.depthFunc(515):t.depthFunc(515),o=e)},setLocked:function(e){r=e},setClear:function(e){n!==e&&(t.clearDepth(e),n=e)},reset:function(){r=!1,n=o=a=null}}},r=new function(){var r=!1,a=null,o=null,n=null,i=null,s=null,u=null,h=null,y=null;return{setTest:function(e){e?T(2960):g(2960)},setMask:function(e){a===e||r||(t.stencilMask(e),a=e)},setFunc:function(e,a,r){(o!==e||n!==a||i!==r)&&(t.stencilFunc(e,a,r),o=e,n=a,i=r)},setOp:function(e,a,r){(s!==e||u!==a||h!==r)&&(t.stencilOp(e,a,r),s=e,u=a,h=r)},setLocked:function(e){r=e},setClear:function(e){y!==e&&(t.clearStencil(e),y=e)},reset:function(){r=!1,y=h=u=s=i=n=o=a=null}}},u=t.getParameter(34921),v=new Uint8Array(u),w=new Uint8Array(u),x=new Uint8Array(u),y={},R=null,N=null,U=null,z=null,k=null,H=null,V=null,W=null,X=null,j=null,Y=!1,q=null,Z=null,ee=null,te=null,ae=null,re=t.getParameter(35661),A=!1;u=0,u=t.getParameter(7938),-1===u.indexOf("WebGL")?-1!==u.indexOf("OpenGL ES")&&(u=parseFloat(/^OpenGL ES ([0-9])/.exec(u)[1]),A=2<=u):(u=parseFloat(/^WebGL ([0-9])/.exec(u)[1]),A=1<=u);var oe=null,ne={},ie=new _,O=new _,Q={};return Q[3553]=s(3553,3553,1),Q[34067]=s(34067,34069,6),f.setClear(0,0,0,1),h.setClear(1),r.setClear(0),T(2929),h.setFunc(3),l(!1),c(1),T(2884),d(0),{buffers:{color:f,depth:h,stencil:r},initAttributes:function(){for(var e=0,t=v.length;e<t;e++)v[e]=0},enableAttribute:function(t){e(t,0)},enableAttributeAndDivisor:e,disableUnusedAttributes:function(){for(var e=0,a=w.length;e!==a;++e)w[e]!==v[e]&&(t.disableVertexAttribArray(e),w[e]=0)},enable:T,disable:g,getCompressedTextureFormats:function(){if(null===R&&(R=[],a.get("WEBGL_compressed_texture_pvrtc")||a.get("WEBGL_compressed_texture_s3tc")||a.get("WEBGL_compressed_texture_etc1")||a.get("WEBGL_compressed_texture_astc")))for(var e=t.getParameter(34467),r=0;r<e.length;r++)R.push(e[r]);return R},useProgram:function(e){return N!==e&&(t.useProgram(e),N=e,!0)},setBlending:d,setMaterial:function(e,t){2===e.side?g(2884):T(2884);var a=1===e.side;t&&(a=!a),l(a),1===e.blending&&!1===e.transparent?d(0):d(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),h.setFunc(e.depthFunc),h.setTest(e.depthTest),h.setMask(e.depthWrite),f.setMask(e.colorWrite),m(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:l,setCullFace:c,setLineWidth:function(e){e!==ee&&(A&&t.lineWidth(e),ee=e)},setPolygonOffset:m,setScissorTest:function(e){e?T(3089):g(3089)},activeTexture:p,bindTexture:function(e,a){null===oe&&p();var r=ne[oe];void 0===r&&(r={type:void 0,texture:void 0},ne[oe]=r),(r.type!==e||r.texture!==a)&&(t.bindTexture(e,a||Q[e]),r.type=e,r.texture=a)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===ie.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),ie.copy(e))},viewport:function(e){!1===O.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),O.copy(e))},reset:function(){for(var e=0;e<w.length;e++)1===w[e]&&(t.disableVertexAttribArray(e),w[e]=0);y={},oe=R=null,ne={},Z=q=z=N=null,f.reset(),h.reset(),r.reset()}}}function Ua(o,t,i,s,_,a,d){function f(e,t){return h?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function e(t,a,r,o){var n=1;if((t.width>o||t.height>o)&&(n=o/ei(t.width,t.height)),1>n||!0===a){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap)return o=a?ni.floorPowerOfTwo:oi,a=o(n*t.width),n=o(n*t.height),void 0===F&&(F=f(a,n)),r=r?f(a,n):F,r.width=a,r.height=n,r.getContext("2d").drawImage(t,0,0,a,n),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+a+"x"+n+")."),r;"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+").")}return t}function c(e){return ni.isPowerOfTwo(e.width)&&ni.isPowerOfTwo(e.height)}function m(e,t){return e.generateMipmaps&&t&&1003!==e.minFilter&&1006!==e.minFilter}function T(t,a,r,e){o.generateMipmap(t),s.get(a).__maxMipLevel=$n(ei(r,e))*Math.LOG2E}function p(e,a){if(!_.isWebGL2)return e;var r=e;return 6403===e&&(5126===a&&(r=33326),5131===a&&(r=33325),5121===a&&(r=33321)),6407===e&&(5126===a&&(r=34837),5131===a&&(r=34843),5121===a&&(r=32849)),6408===e&&(5126===a&&(r=34836),5131===a&&(r=34842),5121===a&&(r=32856)),33325===r||33326===r||34842===r||34836===r?t.get("EXT_color_buffer_float"):(34843===r||34837===r)&&console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),r}function l(e){return 1003===e||1004===e||1005===e?9728:9729}function g(e){e=e.target,e.removeEventListener("dispose",g);var t=s.get(e);void 0!==t.__webglInit&&(o.deleteTexture(t.__webglTexture),s.remove(e)),e.isVideoTexture&&delete w[e.id],d.memory.textures--}function v(t){t=t.target,t.removeEventListener("dispose",v);var a=s.get(t),r=s.get(t.texture);if(t){if(void 0!==r.__webglTexture&&o.deleteTexture(r.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLRenderTargetCube)for(r=0;6>r;r++)o.deleteFramebuffer(a.__webglFramebuffer[r]),a.__webglDepthbuffer&&o.deleteRenderbuffer(a.__webglDepthbuffer[r]);else o.deleteFramebuffer(a.__webglFramebuffer),a.__webglDepthbuffer&&o.deleteRenderbuffer(a.__webglDepthbuffer);s.remove(t.texture),s.remove(t)}d.memory.textures--}function r(t,a){var r=s.get(t);if(t.isVideoTexture){var e=t.id,o=d.render.frame;w[e]!==o&&(w[e]=o,t.update())}if(0<t.version&&r.__version!==t.version)if(e=t.image,void 0===e)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(!1===e.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else return void x(r,t,a);i.activeTexture(33984+a),i.bindTexture(3553,r.__webglTexture)}function n(l,d){var f=s.get(l);if(6===l.image.length)if(0<l.version&&f.__version!==l.version){y(f,l),i.activeTexture(33984+d),i.bindTexture(34067,f.__webglTexture),o.pixelStorei(37440,l.flipY),d=l&&l.isCompressedTexture;for(var h=l.image[0]&&l.image[0].isDataTexture,v=[],t=0;6>t;t++)v[t]=d||h?h?l.image[t].image:l.image[t]:e(l.image[t],!1,!0,_.maxCubemapSize);var b=v[0],u=c(b)||_.isWebGL2,n=a.convert(l.format),E=a.convert(l.type),x=p(n,E);for(M(34067,l,u),t=0;6>t;t++)if(d)for(var w=v[t].mipmaps,A=0,P=w.length,L;A<P;A++)L=w[A],1023!==l.format&&1022!==l.format?-1<i.getCompressedTextureFormats().indexOf(n)?i.compressedTexImage2D(34069+t,A,x,L.width,L.height,0,L.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+t,A,x,L.width,L.height,0,n,E,L.data);else h?i.texImage2D(34069+t,0,x,v[t].width,v[t].height,0,n,E,v[t].data):i.texImage2D(34069+t,0,x,n,E,v[t]);f.__maxMipLevel=d?w.length-1:0,m(l,u)&&T(34067,l,b.width,b.height),f.__version=l.version,l.onUpdate&&l.onUpdate(l)}else i.activeTexture(33984+d),i.bindTexture(34067,f.__webglTexture)}function u(e,t){i.activeTexture(33984+t),i.bindTexture(34067,s.get(e).__webglTexture)}function M(e,r,n){n?(o.texParameteri(e,10242,a.convert(r.wrapS)),o.texParameteri(e,10243,a.convert(r.wrapT)),32879!==e&&35866!==e||o.texParameteri(e,32882,a.convert(r.wrapR)),o.texParameteri(e,10240,a.convert(r.magFilter)),o.texParameteri(e,10241,a.convert(r.minFilter))):(o.texParameteri(e,10242,33071),o.texParameteri(e,10243,33071),32879!==e&&35866!==e||o.texParameteri(e,32882,33071),1001===r.wrapS&&1001===r.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),o.texParameteri(e,10240,l(r.magFilter)),o.texParameteri(e,10241,l(r.minFilter)),1003!==r.minFilter&&1006!==r.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),(n=t.get("EXT_texture_filter_anisotropic"))&&(1015!==r.type||null!==t.get("OES_texture_float_linear"))&&(1016!==r.type||null!==(_.isWebGL2||t.get("OES_texture_half_float_linear")))&&(1<r.anisotropy||s.get(r).__currentAnisotropy)&&(o.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,ai(r.anisotropy,_.getMaxAnisotropy())),s.get(r).__currentAnisotropy=r.anisotropy)}function y(e,t){void 0===e.__webglInit&&(e.__webglInit=!0,t.addEventListener("dispose",g),e.__webglTexture=o.createTexture(),d.memory.textures++)}function x(s,l,d){var f=3553;l.isDataTexture2DArray&&(f=35866),l.isDataTexture3D&&(f=32879),y(s,l),i.activeTexture(33984+d),i.bindTexture(f,s.__webglTexture),o.pixelStorei(37440,l.flipY),o.pixelStorei(37441,l.premultiplyAlpha),o.pixelStorei(3317,l.unpackAlignment),d=!_.isWebGL2&&(1001!==l.wrapS||1001!==l.wrapT||1003!==l.minFilter&&1006!==l.minFilter),d=d&&!1===c(l.image),d=e(l.image,d,!1,_.maxTextureSize);var v=c(d)||_.isWebGL2,b=a.convert(l.format),r=a.convert(l.type),S=p(b,r);M(f,l,v);var E=l.mipmaps;if(l.isDepthTexture){if(S=6402,1015===l.type){if(!_.isWebGL2)throw Error("Float Depth Texture only supported in WebGL2.0");S=36012}else _.isWebGL2&&(S=33189);1026===l.format&&6402===S&&1012!==l.type&&1014!==l.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),l.type=1012,r=a.convert(l.type)),1027===l.format&&(S=34041,1020!==l.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),l.type=1020,r=a.convert(l.type))),i.texImage2D(3553,0,S,d.width,d.height,0,b,r,null)}else if(l.isDataTexture){if(0<E.length&&v){for(var n=0,A=E.length;n<A;n++)f=E[n],i.texImage2D(3553,n,S,f.width,f.height,0,b,r,f.data);l.generateMipmaps=!1,s.__maxMipLevel=E.length-1}else i.texImage2D(3553,0,S,d.width,d.height,0,b,r,d.data),s.__maxMipLevel=0;}else if(l.isCompressedTexture){for(n=0,A=E.length;n<A;n++)f=E[n],1023!==l.format&&1022!==l.format?-1<i.getCompressedTextureFormats().indexOf(b)?i.compressedTexImage2D(3553,n,S,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,n,S,f.width,f.height,0,b,r,f.data);s.__maxMipLevel=E.length-1}else if(l.isDataTexture2DArray)i.texImage3D(35866,0,S,d.width,d.height,d.depth,0,b,r,d.data),s.__maxMipLevel=0;else if(l.isDataTexture3D)i.texImage3D(32879,0,S,d.width,d.height,d.depth,0,b,r,d.data),s.__maxMipLevel=0;else if(0<E.length&&v){for(n=0,A=E.length;n<A;n++)f=E[n],i.texImage2D(3553,n,S,b,r,f);l.generateMipmaps=!1,s.__maxMipLevel=E.length-1}else i.texImage2D(3553,0,S,b,r,d),s.__maxMipLevel=0;m(l,v)&&T(3553,l,d.width,d.height),s.__version=l.version,l.onUpdate&&l.onUpdate(l)}function S(t,r,e,n){var d=a.convert(r.texture.format),l=a.convert(r.texture.type),c=p(d,l);i.texImage2D(n,0,c,r.width,r.height,0,d,l,null),o.bindFramebuffer(36160,t),o.framebufferTexture2D(36160,e,n,s.get(r.texture).__webglTexture,0),o.bindFramebuffer(36160,null)}function P(t,r,n){if(o.bindRenderbuffer(36161,t),r.depthBuffer&&!r.stencilBuffer)n?(n=L(r),o.renderbufferStorageMultisample(36161,n,33189,r.width,r.height)):o.renderbufferStorage(36161,33189,r.width,r.height),o.framebufferRenderbuffer(36160,36096,36161,t);else if(r.depthBuffer&&r.stencilBuffer)n?(n=L(r),o.renderbufferStorageMultisample(36161,n,34041,r.width,r.height)):o.renderbufferStorage(36161,34041,r.width,r.height),o.framebufferRenderbuffer(36160,33306,36161,t);else{t=a.convert(r.texture.format);var i=a.convert(r.texture.type);t=p(t,i),n?(n=L(r),o.renderbufferStorageMultisample(36161,n,t,r.width,r.height)):o.renderbufferStorage(36161,t,r.width,r.height)}o.bindRenderbuffer(36161,null)}function L(e){return _.isWebGL2&&e.isWebGLMultisampleRenderTarget?ai(_.maxSamples,e.samples):0}var w={},h="undefined"!=typeof OffscreenCanvas,b=0,C=!1,R=!1,F;this.allocateTextureUnit=function(){var e=b;return e>=_.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+_.maxTextures),b+=1,e},this.resetTextureUnits=function(){b=0},this.setTexture2D=r,this.setTexture2DArray=function(t,a){var r=s.get(t);0<t.version&&r.__version!==t.version?x(r,t,a):(i.activeTexture(33984+a),i.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,a){var r=s.get(t);0<t.version&&r.__version!==t.version?x(r,t,a):(i.activeTexture(33984+a),i.bindTexture(32879,r.__webglTexture))},this.setTextureCube=n,this.setTextureCubeDynamic=u,this.setupRenderTarget=function(e){var n=s.get(e),u=s.get(e.texture);e.addEventListener("dispose",v),u.__webglTexture=o.createTexture(),d.memory.textures++;var f=!0===e.isWebGLRenderTargetCube,g=!0===e.isWebGLMultisampleRenderTarget,y=c(e)||_.isWebGL2;if(f)for(n.__webglFramebuffer=[],g=0;6>g;g++)n.__webglFramebuffer[g]=o.createFramebuffer();else if(n.__webglFramebuffer=o.createFramebuffer(),g)if(_.isWebGL2){n.__webglMultisampledFramebuffer=o.createFramebuffer(),n.__webglColorRenderbuffer=o.createRenderbuffer(),o.bindRenderbuffer(36161,n.__webglColorRenderbuffer),g=a.convert(e.texture.format);var t=a.convert(e.texture.type);g=p(g,t),t=L(e),o.renderbufferStorageMultisample(36161,t,g,e.width,e.height),o.bindFramebuffer(36160,n.__webglMultisampledFramebuffer),o.framebufferRenderbuffer(36160,36064,36161,n.__webglColorRenderbuffer),o.bindRenderbuffer(36161,null),e.depthBuffer&&(n.__webglDepthRenderbuffer=o.createRenderbuffer(),P(n.__webglDepthRenderbuffer,e,!0)),o.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(f){for(i.bindTexture(34067,u.__webglTexture),M(34067,e.texture,y),g=0;6>g;g++)S(n.__webglFramebuffer[g],e,36064,34069+g);m(e.texture,y)&&T(34067,e.texture,e.width,e.height),i.bindTexture(34067,null)}else i.bindTexture(3553,u.__webglTexture),M(3553,e.texture,y),S(n.__webglFramebuffer,e,36064,3553),m(e.texture,y)&&T(3553,e.texture,e.width,e.height),i.bindTexture(3553,null);if(e.depthBuffer){if(n=s.get(e),u=!0===e.isWebGLRenderTargetCube,e.depthTexture){if(u)throw Error("target.depthTexture not supported in Cube render targets");if(e&&e.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");if(o.bindFramebuffer(36160,n.__webglFramebuffer),!e.depthTexture||!e.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(s.get(e.depthTexture).__webglTexture&&e.depthTexture.image.width===e.width&&e.depthTexture.image.height===e.height||(e.depthTexture.image.width=e.width,e.depthTexture.image.height=e.height,e.depthTexture.needsUpdate=!0),r(e.depthTexture,0),n=s.get(e.depthTexture).__webglTexture,1026===e.depthTexture.format)o.framebufferTexture2D(36160,36096,3553,n,0);else if(1027===e.depthTexture.format)o.framebufferTexture2D(36160,33306,3553,n,0);else throw Error("Unknown depthTexture format")}else if(u)for(n.__webglDepthbuffer=[],u=0;6>u;u++)o.bindFramebuffer(36160,n.__webglFramebuffer[u]),n.__webglDepthbuffer[u]=o.createRenderbuffer(),P(n.__webglDepthbuffer[u],e);else o.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=o.createRenderbuffer(),P(n.__webglDepthbuffer,e);o.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(e){var t=e.texture,a=c(e)||_.isWebGL2;if(m(t,a)){a=e.isWebGLRenderTargetCube?34067:3553;var r=s.get(t).__webglTexture;i.bindTexture(a,r),T(a,t,e.width,e.height),i.bindTexture(a,null)}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(_.isWebGL2){var t=s.get(e);o.bindFramebuffer(36008,t.__webglMultisampledFramebuffer),o.bindFramebuffer(36009,t.__webglFramebuffer),t=e.width;var a=e.height,r=16384;e.depthBuffer&&(r|=256),e.stencilBuffer&&(r|=1024),o.blitFramebuffer(0,0,t,a,0,0,t,a,r,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===C&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),C=!0),e=e.texture),r(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLRenderTargetCube&&(!1===R&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),R=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?n(e,t):u(e,t)}}function Ga(e,t,r){return{convert:function(e){if(1E3===e)return 10497;if(1001===e)return 33071;if(1002===e)return 33648;if(1003===e)return 9728;if(1004===e)return 9984;if(1005===e)return 9986;if(1006===e)return 9729;if(1007===e)return 9985;if(1008===e)return 9987;if(1009===e)return 5121;if(1017===e)return 32819;if(1018===e)return 32820;if(1019===e)return 33635;if(1010===e)return 5120;if(1011===e)return 5122;if(1012===e)return 5123;if(1013===e)return 5124;if(1014===e)return 5125;if(1015===e)return 5126;if(1016===e){if(r.isWebGL2)return 5131;var a=t.get("OES_texture_half_float");if(null!==a)return a.HALF_FLOAT_OES}if(1021===e)return 6406;if(1022===e)return 6407;if(1023===e)return 6408;if(1024===e)return 6409;if(1025===e)return 6410;if(1026===e)return 6402;if(1027===e)return 34041;if(1028===e)return 6403;if(100===e)return 32774;if(101===e)return 32778;if(102===e)return 32779;if(200===e)return 0;if(201===e)return 1;if(202===e)return 768;if(203===e)return 769;if(204===e)return 770;if(205===e)return 771;if(206===e)return 772;if(207===e)return 773;if(208===e)return 774;if(209===e)return 775;if(210===e)return 776;if((33776===e||33777===e||33778===e||33779===e)&&(a=t.get("WEBGL_compressed_texture_s3tc"),null!==a)){if(33776===e)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===e)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===e)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===e)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((35840===e||35841===e||35842===e||35843===e)&&(a=t.get("WEBGL_compressed_texture_pvrtc"),null!==a)){if(35840===e)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===e)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e&&(a=t.get("WEBGL_compressed_texture_etc1"),null!==a))return a.COMPRESSED_RGB_ETC1_WEBGL;if((37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e)&&(a=t.get("WEBGL_compressed_texture_astc"),null!==a))return e;if(103===e||104===e){if(r.isWebGL2){if(103===e)return 32775;if(104===e)return 32776}if(a=t.get("EXT_blend_minmax"),null!==a){if(103===e)return a.MIN_EXT;if(104===e)return a.MAX_EXT}}if(1020===e){if(r.isWebGL2)return 34042;if(a=t.get("WEBGL_depth_texture"),null!==a)return a.UNSIGNED_INT_24_8_WEBGL}return 0}}}function Aa(){A.call(this),this.type="Group"}function Ba(){A.call(this),this.type="Camera",this.matrixWorldInverse=new W,this.projectionMatrix=new W,this.projectionMatrixInverse=new W}function Ha(e,t,a,r){Ba.call(this),this.type="PerspectiveCamera",this.fov=void 0===e?50:e,this.zoom=1,this.near=void 0===a?.1:a,this.far=void 0===r?2E3:r,this.focus=10,this.aspect=void 0===t?1:t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function ca(e){Ha.call(this),this.cameras=e||[]}function Wa(t,a,r){_i.setFromMatrixPosition(a.matrixWorld),Ti.setFromMatrixPosition(r.matrixWorld);var o=_i.distanceTo(Ti),n=a.projectionMatrix.elements,i=r.projectionMatrix.elements,s=n[14]/(n[10]-1);r=n[14]/(n[10]+1);var d=(n[9]+1)/n[5],p=(n[9]-1)/n[5],l=(n[8]-1)/n[0],u=(i[8]+1)/i[0];n=s*l,i=s*u,u=o/(-l+u),l=u*-l,a.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(l),t.translateZ(u),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld),a=s+u,s=r+u,t.projectionMatrix.makePerspective(n-l,i+(o-l),d*r/s*a,p*r/s*a,a,s)}function Xa(n){function T(){return null!==b&&!0===b.isPresenting}function a(){if(T()){var e=b.getEyeParameters("left"),t=e.renderWidth*d;e=e.renderHeight*d,R=n.getPixelRatio(),n.getSize(C),n.setDrawingBufferSize(2*t,e,1),F.start()}else v.enabled&&n.setDrawingBufferSize(C.width,C.height,R),F.stop()}var v=this,b=null,S=null,E=null,A=[],h=new W,l=new W,d=1,m="stage";"undefined"!=typeof window&&"VRFrameData"in window&&(S=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",a,!1));var M=new W,L=new i,t=new s,r=new Ha;r.bounds=new _(0,0,.5,1),r.layers.enable(1);var u=new Ha;u.bounds=new _(.5,0,.5,1),u.layers.enable(2);var w=new ca([r,u]);w.layers.enable(1),w.layers.enable(2);var C=new o,x=[],R;this.enabled=!1,this.getController=function(e){var t=A[e];return void 0===t&&(t=new Aa,t.matrixAutoUpdate=!1,t.visible=!1,A[e]=t),t},this.getDevice=function(){return b},this.setDevice=function(e){void 0!==e&&(b=e),F.setContext(e)},this.setFramebufferScaleFactor=function(e){d=e},this.setFrameOfReferenceType=function(e){m=e},this.setPoseTarget=function(e){void 0!==e&&(E=e)},this.getCamera=function(e){var o="stage"===m?1.6:0;if(!1===T())return e.position.set(0,o,0),e.rotation.set(0,0,0),e;if(b.depthNear=e.near,b.depthFar=e.far,b.getFrameData(S),"stage"===m){var i=b.stageParameters;i?h.fromArray(i.sittingToStandingTransform):h.makeTranslation(0,o,0)}o=S.pose,i=null===E?e:E,i.matrix.copy(h),i.matrix.decompose(i.position,i.quaternion,i.scale),null!==o.orientation&&(L.fromArray(o.orientation),i.quaternion.multiply(L)),null!==o.position&&(L.setFromRotationMatrix(h),t.fromArray(o.position),t.applyQuaternion(L),i.position.add(t)),i.updateMatrixWorld(),r.near=e.near,u.near=e.near,r.far=e.far,u.far=e.far,r.matrixWorldInverse.fromArray(S.leftViewMatrix),u.matrixWorldInverse.fromArray(S.rightViewMatrix),l.getInverse(h),"stage"===m&&(r.matrixWorldInverse.multiply(l),u.matrixWorldInverse.multiply(l)),e=i.parent,null!==e&&(M.getInverse(e.matrixWorld),r.matrixWorldInverse.multiply(M),u.matrixWorldInverse.multiply(M)),r.matrixWorld.getInverse(r.matrixWorldInverse),u.matrixWorld.getInverse(u.matrixWorldInverse),r.projectionMatrix.fromArray(S.leftProjectionMatrix),u.projectionMatrix.fromArray(S.rightProjectionMatrix),Wa(w,r,u),e=b.getLayers(),e.length&&(e=e[0],null!==e.leftBounds&&4===e.leftBounds.length&&r.bounds.fromArray(e.leftBounds),null!==e.rightBounds&&4===e.rightBounds.length&&u.bounds.fromArray(e.rightBounds));a:for(e=0;e<A.length;e++){o=A[e];b:{i=e;for(var s=navigator.getGamepads&&navigator.getGamepads(),p=0,f=0,g=s.length,y;p<g;p++)if(y=s[p],y&&("Daydream Controller"===y.id||"Gear VR Controller"===y.id||"Oculus Go Controller"===y.id||"OpenVR Gamepad"===y.id||y.id.startsWith("Oculus Touch")||y.id.startsWith("Spatial Controller"))){if(f===i){i=y;break b}f++}i=void 0}if(void 0!==i&&void 0!==i.pose){if(null===i.pose)break a;s=i.pose,!1===s.hasPosition&&o.position.set(.2,-.6,-.05),null!==s.position&&o.position.fromArray(s.position),null!==s.orientation&&o.quaternion.fromArray(s.orientation),o.matrix.compose(o.position,o.quaternion,o.scale),o.matrix.premultiply(h),o.matrix.decompose(o.position,o.quaternion,o.scale),o.matrixWorldNeedsUpdate=!0,o.visible=!0,s="Daydream Controller"===i.id?0:1,x[e]!==i.buttons[s].pressed&&(x[e]=i.buttons[s].pressed,!0===x[e]?o.dispatchEvent({type:"selectstart"}):(o.dispatchEvent({type:"selectend"}),o.dispatchEvent({type:"select"})))}else o.visible=!1}return w},this.getStandingMatrix=function(){return h},this.isPresenting=T;var F=new P;this.setAnimationLoop=function(e){F.setAnimationLoop(e),T()&&F.start()},this.submitFrame=function(){T()&&b.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",a)}}function er(o){function i(){return null!==v&&null!==T}function a(e){var t=E[w.indexOf(e.inputSource)];t&&t.dispatchEvent({type:e.type})}function s(){o.setFramebuffer(null),o.setRenderTarget(o.getRenderTarget()),A.stop()}function y(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}var e=o.context,d=null,v=null,c=1,T=null,f="stage",S=null,E=[],w=[],b=new Ha;b.layers.enable(1),b.viewport=new _;var r=new Ha;r.layers.enable(2),r.viewport=new _;var u=new ca([b,r]);u.layers.enable(1),u.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=E[e];return void 0===t&&(t=new Aa,t.matrixAutoUpdate=!1,t.visible=!1,E[e]=t),t},this.getDevice=function(){return d},this.setDevice=function(t){void 0!==t&&(d=t),t instanceof XRDevice&&e.setCompatibleXRDevice(t)},this.setFramebufferScaleFactor=function(e){c=e},this.setFrameOfReferenceType=function(e){f=e},this.setSession=function(t){v=t,null!==v&&(v.addEventListener("select",a),v.addEventListener("selectstart",a),v.addEventListener("selectend",a),v.addEventListener("end",s),v.baseLayer=new XRWebGLLayer(v,e,{framebufferScaleFactor:c}),v.requestFrameOfReference(f).then(function(e){T=e,o.setFramebuffer(v.baseLayer.framebuffer),A.setContext(v),A.start()}),w=v.getInputSources(),v.addEventListener("inputsourceschange",function(){w=v.getInputSources(),console.log(w);for(var e=0;e<E.length;e++)E[e].userData.inputSource=w[e]}))},this.getCamera=function(e){if(i()){var t=e.parent,o=u.cameras;y(u,t);for(var n=0;n<o.length;n++)y(o[n],t);for(e.matrixWorld.copy(u.matrixWorld),e=e.children,n=0,t=e.length;n<t;n++)e[n].updateMatrixWorld(!0);return Wa(u,b,r),u}return e},this.isPresenting=i;var n=null,A=new P;A.setAnimationLoop(function(t,a){if(S=a.getDevicePose(T),null!==S)for(var r=v.baseLayer,o=a.views,i=0;i<o.length;i++){var s=o[i],p=r.getViewport(s),m=S.getViewMatrix(s),l=u.cameras[i];l.matrix.fromArray(m).getInverse(l.matrix),l.projectionMatrix.fromArray(s.projectionMatrix),l.viewport.set(p.x,p.y,p.width,p.height),0==i&&u.matrix.copy(l.matrix)}for(i=0;i<E.length;i++){if(r=E[i],(o=w[i])&&(o=a.getInputPose(o,T),null!==o)){"targetRay"in o?r.matrix.elements=o.targetRay.transformMatrix:"pointerMatrix"in o&&(r.matrix.elements=o.pointerMatrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.visible=!0;continue}r.visible=!1}n&&n(t)}),this.setAnimationLoop=function(e){n=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new W},this.submitFrame=function(){}}function ja(n){function i(){N=new tt(we),Ae=new We(we,N,n),Ae.isWebGL2||(N.get("WEBGL_depth_texture"),N.get("OES_texture_float"),N.get("OES_texture_half_float"),N.get("OES_texture_half_float_linear"),N.get("OES_standard_derivatives"),N.get("OES_element_index_uint"),N.get("ANGLE_instanced_arrays")),N.get("OES_texture_float_linear"),ke=new Ga(we,N,Ae),Me=new Ca(we,N,ke,Ae),Me.scissor(U.copy(L).multiplyScalar(he)),Me.viewport(me.copy(ye).multiplyScalar(he)),Pe=new ot(we),Le=new pa,Ce=new Ua(we,N,Me,Le,Ae,ke,Pe),Re=new c(we),Fe=new at(we,Re,Pe),Ie=new st(Fe,Pe),Oe=new it(we),Ne=new na(ne,N,Ae,Ce),De=new ma,Be=new ya,Ue=new _e(ne,Me,Ie,F),ze=new Ve(we,N,Pe,Ae),Ge=new rt(we,N,Pe,Ae),Pe.programs=Ne.programs,ne.context=we,ne.capabilities=Ae,ne.extensions=N,ne.properties=Le,ne.renderLists=De,ne.state=Me,ne.info=Pe}function O(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),A=!0}function d(){console.log("THREE.WebGLRenderer: Context Restored."),A=!1,i()}function j(e){e=e.target,e.removeEventListener("dispose",j),f(e),Le.remove(e)}function f(e){var t=Le.get(e).program;e.program=void 0,void 0!==t&&Ne.releaseProgram(t)}function e(e,t){e.render(function(e){ne.renderBufferImmediate(e,t)})}function ee(t,r,o,n){if(!1!==t.visible){if(t.layers.test(r.layers))if(t.isGroup)o=t.renderOrder;else if(t.isLight)G.pushLight(t),t.castShadow&&G.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||xe.intersectsSprite(t)){n&&Ee.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Se);var i=Ie.update(t),s=t.material;s.visible&&I.push(t,i,s,o,Ee.z,null)}}else if(t.isImmediateRenderObject)n&&Ee.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Se),I.push(t,null,t.material,o,Ee.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||xe.intersectsObject(t)))if(n&&Ee.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Se),i=Ie.update(t),s=t.material,Array.isArray(s))for(var l=i.groups,d=0,u=l.length;d<u;d++){var g=l[d],y=s[g.materialIndex];y&&y.visible&&I.push(t,i,y,o,Ee.z,g)}else s.visible&&I.push(t,i,s,o,Ee.z,null);for(t=t.children,d=0,u=t.length;d<u;d++)ee(t[d],r,o,n)}}function l(o,a,n,i){for(var s=0,d=o.length;s<d;s++){var c=o[s],u=c.object,f=c.geometry,l=void 0===i?c.material:i;if(c=c.group,n.isArrayCamera){ue=n;for(var m=n.cameras,p=0,h=m.length,y;p<h;p++)if(y=m[p],u.layers.test(y.layers)){if("viewport"in y)Me.viewport(me.copy(y.viewport));else{var x=y.bounds;Me.viewport(me.set(x.x*fe,x.y*ge,x.z*fe,x.w*ge).multiplyScalar(he))}G.setupLights(y),te(u,a,y,f,l,c)}}else ue=null,te(u,a,n,f,l,c)}}function te(t,a,r,o,n,i){if(t.onBeforeRender(ne,a,r,o,n,i),G=Be.get(a,ue||r),t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){Me.setMaterial(n);var s=re(r,a.fog,n,t);de=k=null,pe=!1,e(t,s)}else ne.renderBufferDirect(r,a.fog,o,n,t,i);t.onAfterRender(ne,a,r,o,n,i),G=Be.get(a,ue||r)}function ae(t,r,o){var n=Le.get(t),i=G.state.lights,e=n.lightsHash,s=i.state.hash;o=Ne.getParameters(t,i.state,G.state.shadowsArray,r,ve.numPlanes,ve.numIntersection,o);var l=Ne.getProgramCode(t,o),d=n.program,u=!0;if(void 0===d)t.addEventListener("dispose",j);else if(d.code!==l)f(t);else{if(e.stateID!==s.stateID||e.directionalLength!==s.directionalLength||e.pointLength!==s.pointLength||e.spotLength!==s.spotLength||e.rectAreaLength!==s.rectAreaLength||e.hemiLength!==s.hemiLength||e.shadowsLength!==s.shadowsLength)e.stateID=s.stateID,e.directionalLength=s.directionalLength,e.pointLength=s.pointLength,e.spotLength=s.spotLength,e.rectAreaLength=s.rectAreaLength,e.hemiLength=s.hemiLength,e.shadowsLength=s.shadowsLength;else if(void 0!==o.shaderID)return;u=!1}if(u&&(o.shaderID?(l=J[o.shaderID],n.shader={name:t.type,uniforms:v(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}):n.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader},t.onBeforeCompile(n.shader,ne),l=Ne.getProgramCode(t,o),d=Ne.acquireProgram(t,n.shader,o,l),n.program=d,t.program=d),o=d.getAttributes(),t.morphTargets)for(l=t.numSupportedMorphTargets=0;l<ne.maxMorphTargets;l++)0<=o["morphTarget"+l]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(l=t.numSupportedMorphNormals=0;l<ne.maxMorphNormals;l++)0<=o["morphNormal"+l]&&t.numSupportedMorphNormals++;o=n.shader.uniforms,(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=ve.numPlanes,n.numIntersection=ve.numIntersection,o.clippingPlanes=ve.uniform),n.fog=r,void 0===e&&(n.lightsHash=e={}),e.stateID=s.stateID,e.directionalLength=s.directionalLength,e.pointLength=s.pointLength,e.spotLength=s.spotLength,e.rectAreaLength=s.rectAreaLength,e.hemiLength=s.hemiLength,e.shadowsLength=s.shadowsLength,t.lights&&(o.ambientLightColor.value=i.state.ambient,o.lightProbe.value=i.state.probe,o.directionalLights.value=i.state.directional,o.spotLights.value=i.state.spot,o.rectAreaLights.value=i.state.rectArea,o.pointLights.value=i.state.point,o.hemisphereLights.value=i.state.hemi,o.directionalShadowMap.value=i.state.directionalShadowMap,o.directionalShadowMatrix.value=i.state.directionalShadowMatrix,o.spotShadowMap.value=i.state.spotShadowMap,o.spotShadowMatrix.value=i.state.spotShadowMatrix,o.pointShadowMap.value=i.state.pointShadowMap,o.pointShadowMatrix.value=i.state.pointShadowMatrix),t=n.program.getUniforms(),t=Vt.seqWithValue(t.seq,o),n.uniformsList=t}function re(o,n,i,s){Ce.resetTextureUnits();var d=Le.get(i),e=d.lightsHash,c=G.state.lights.state.hash;be&&(Te||o!==ce)&&ve.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,o,d,o===ce&&i.id===le),!1===i.needsUpdate&&(void 0===d.program?i.needsUpdate=!0:i.fog&&d.fog!==n?i.needsUpdate=!0:i.lights&&(e.stateID!==c.stateID||e.directionalLength!==c.directionalLength||e.pointLength!==c.pointLength||e.spotLength!==c.spotLength||e.rectAreaLength!==c.rectAreaLength||e.hemiLength!==c.hemiLength||e.shadowsLength!==c.shadowsLength)?i.needsUpdate=!0:void 0===d.numClippingPlanes||d.numClippingPlanes===ve.numPlanes&&d.numIntersection===ve.numIntersection||(i.needsUpdate=!0)),i.needsUpdate&&(ae(i,n,s),i.needsUpdate=!1);var u=!1,y=!1,x=!1;e=d.program,c=e.getUniforms();var b=d.shader.uniforms;if(Me.useProgram(e.program)&&(x=y=u=!0),i.id!==le&&(le=i.id,y=!0),(u||ce!==o)&&(c.setValue(we,"projectionMatrix",o.projectionMatrix),Ae.logarithmicDepthBuffer&&c.setValue(we,"logDepthBufFC",2/($n(o.far+1)/Kn)),ce!==o&&(ce=o,x=y=!0),(i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap)&&(u=c.map.cameraPosition,void 0!==u&&u.setValue(we,Ee.setFromMatrixPosition(o.matrixWorld))),(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&c.setValue(we,"viewMatrix",o.matrixWorldInverse)),i.skinning&&(c.setOptional(we,s,"bindMatrix"),c.setOptional(we,s,"bindMatrixInverse"),o=s.skeleton))if(u=o.bones,Ae.floatVertexTextures){if(void 0===o.boneTexture){u=Jn(4*u.length),u=ni.ceilPowerOfTwo(u),u=ei(u,4);var _=new Float32Array(4*(u*u));_.set(o.boneMatrices);var T=new p(_,u,u,1023,1015);T.needsUpdate=!0,o.boneMatrices=_,o.boneTexture=T,o.boneTextureSize=u}c.setValue(we,"boneTexture",o.boneTexture,Ce),c.setValue(we,"boneTextureSize",o.boneTextureSize)}else c.setOptional(we,o,"boneMatrices");return y&&(c.setValue(we,"toneMappingExposure",ne.toneMappingExposure),c.setValue(we,"toneMappingWhitePoint",ne.toneMappingWhitePoint),i.lights&&(y=x,b.ambientLightColor.needsUpdate=y,b.lightProbe.needsUpdate=y,b.directionalLights.needsUpdate=y,b.pointLights.needsUpdate=y,b.spotLights.needsUpdate=y,b.rectAreaLights.needsUpdate=y,b.hemisphereLights.needsUpdate=y),n&&i.fog&&(b.fogColor.value.copy(n.color),n.isFog?(b.fogNear.value=n.near,b.fogFar.value=n.far):n.isFogExp2&&(b.fogDensity.value=n.density)),i.isMeshBasicMaterial?oe(b,i):i.isMeshLambertMaterial?(oe(b,i),i.emissiveMap&&(b.emissiveMap.value=i.emissiveMap)):i.isMeshPhongMaterial?(oe(b,i),i.isMeshToonMaterial?(t(b,i),i.gradientMap&&(b.gradientMap.value=i.gradientMap)):t(b,i)):i.isMeshStandardMaterial?(oe(b,i),i.isMeshPhysicalMaterial?(r(b,i),b.reflectivity.value=i.reflectivity,b.clearCoat.value=i.clearCoat,b.clearCoatRoughness.value=i.clearCoatRoughness):r(b,i)):i.isMeshMatcapMaterial?(oe(b,i),i.matcap&&(b.matcap.value=i.matcap),i.bumpMap&&(b.bumpMap.value=i.bumpMap,b.bumpScale.value=i.bumpScale,1===i.side&&(b.bumpScale.value*=-1)),i.normalMap&&(b.normalMap.value=i.normalMap,b.normalScale.value.copy(i.normalScale),1===i.side&&b.normalScale.value.negate()),i.displacementMap&&(b.displacementMap.value=i.displacementMap,b.displacementScale.value=i.displacementScale,b.displacementBias.value=i.displacementBias)):i.isMeshDepthMaterial?(oe(b,i),i.displacementMap&&(b.displacementMap.value=i.displacementMap,b.displacementScale.value=i.displacementScale,b.displacementBias.value=i.displacementBias)):i.isMeshDistanceMaterial?(oe(b,i),i.displacementMap&&(b.displacementMap.value=i.displacementMap,b.displacementScale.value=i.displacementScale,b.displacementBias.value=i.displacementBias),b.referencePosition.value.copy(i.referencePosition),b.nearDistance.value=i.nearDistance,b.farDistance.value=i.farDistance):i.isMeshNormalMaterial?(oe(b,i),i.bumpMap&&(b.bumpMap.value=i.bumpMap,b.bumpScale.value=i.bumpScale,1===i.side&&(b.bumpScale.value*=-1)),i.normalMap&&(b.normalMap.value=i.normalMap,b.normalScale.value.copy(i.normalScale),1===i.side&&b.normalScale.value.negate()),i.displacementMap&&(b.displacementMap.value=i.displacementMap,b.displacementScale.value=i.displacementScale,b.displacementBias.value=i.displacementBias)):i.isLineBasicMaterial?(b.diffuse.value.copy(i.color),b.opacity.value=i.opacity,i.isLineDashedMaterial&&(b.dashSize.value=i.dashSize,b.totalSize.value=i.dashSize+i.gapSize,b.scale.value=i.scale)):i.isPointsMaterial?(b.diffuse.value.copy(i.color),b.opacity.value=i.opacity,b.size.value=i.size*he,b.scale.value=.5*ge,b.map.value=i.map,null!==i.map&&(!0===i.map.matrixAutoUpdate&&i.map.updateMatrix(),b.uvTransform.value.copy(i.map.matrix))):i.isSpriteMaterial?(b.diffuse.value.copy(i.color),b.opacity.value=i.opacity,b.rotation.value=i.rotation,b.map.value=i.map,null!==i.map&&(!0===i.map.matrixAutoUpdate&&i.map.updateMatrix(),b.uvTransform.value.copy(i.map.matrix))):i.isShadowMaterial&&(b.color.value.copy(i.color),b.opacity.value=i.opacity),void 0!==b.ltc_1&&(b.ltc_1.value=di.LTC_1),void 0!==b.ltc_2&&(b.ltc_2.value=di.LTC_2),Vt.upload(we,d.uniformsList,b,Ce)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(Vt.upload(we,d.uniformsList,b,Ce),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&c.setValue(we,"center",s.center),c.setValue(we,"modelViewMatrix",s.modelViewMatrix),c.setValue(we,"normalMatrix",s.normalMatrix),c.setValue(we,"modelMatrix",s.matrixWorld),e}function oe(e,t){if(e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=Le.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map)var a=t.map;else t.specularMap?a=t.specularMap:t.displacementMap?a=t.displacementMap:t.normalMap?a=t.normalMap:t.bumpMap?a=t.bumpMap:t.roughnessMap?a=t.roughnessMap:t.metalnessMap?a=t.metalnessMap:t.alphaMap?a=t.alphaMap:t.emissiveMap&&(a=t.emissiveMap);void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),e.uvTransform.value.copy(a.matrix))}function t(e,t){e.specular.value.copy(t.specular),e.shininess.value=ei(t.shininess,1E-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function r(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}var k;console.log("THREE.WebGLRenderer","104"),n=n||{};var u=void 0===n.canvas?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):n.canvas,m=void 0===n.context?null:n.context,g=void 0!==n.alpha&&n.alpha,h=!(void 0!==n.depth)||n.depth,y=!(void 0!==n.stencil)||n.stencil,w=void 0!==n.antialias&&n.antialias,F=!(void 0!==n.premultipliedAlpha)||n.premultipliedAlpha,z=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,E=void 0===n.powerPreference?"default":n.powerPreference,I=null,G=null;this.domElement=u,this.context=null,this.debug={checkShaderErrors:!1},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var ne=this,A=!1,q=null,ie=null,se=null,le=-1,de=k=null,pe=!1,ce=null,ue=null,me=new _,U=new _,Y=null,fe=u.width,ge=u.height,he=1,ye=new _(0,0,fe,ge),L=new _(0,0,fe,ge),Z=!1,xe=new C,ve=new et,be=!1,Te=!1,Se=new W,Ee=new s;try{g={alpha:g,depth:h,stencil:y,antialias:w,premultipliedAlpha:F,preserveDrawingBuffer:z,powerPreference:E},u.addEventListener("webglcontextlost",O,!1),u.addEventListener("webglcontextrestored",d,!1);var we=m||u.getContext("webgl",g)||u.getContext("experimental-webgl",g);if(null===we){if(null!==u.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}void 0===we.getShaderPrecisionFormat&&(we.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}var N,Ae,Me,Pe,Le,Ce,Re,Fe,Ie,Ne,De,Be,Ue,Oe,ze,Ge,ke;i();var He="undefined"!=typeof navigator&&"xr"in navigator?new er(ne):new Xa(ne);this.vr=He;var Xe=new Sa(ne,Ie,Ae.maxTextureSize);this.shadowMap=Xe,this.getContext=function(){return we},this.getContextAttributes=function(){return we.getContextAttributes()},this.forceContextLoss=function(){var e=N.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=N.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return he},this.setPixelRatio=function(e){void 0!==e&&(he=e,this.setSize(fe,ge,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new o),e.set(fe,ge)},this.setSize=function(e,t,a){He.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(fe=e,ge=t,u.width=e*he,u.height=t*he,!1!==a&&(u.style.width=e+"px",u.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new o),e.set(fe*he,ge*he)},this.setDrawingBufferSize=function(e,t,a){fe=e,ge=t,he=a,u.width=e*a,u.height=t*a,this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new _),e.copy(me)},this.getViewport=function(e){return e.copy(ye)},this.setViewport=function(e,t,a,r){e.isVector4?ye.set(e.x,e.y,e.z,e.w):ye.set(e,t,a,r),Me.viewport(me.copy(ye).multiplyScalar(he))},this.getScissor=function(e){return e.copy(L)},this.setScissor=function(e,t,a,r){e.isVector4?L.set(e.x,e.y,e.z,e.w):L.set(e,t,a,r),Me.scissor(U.copy(L).multiplyScalar(he))},this.getScissorTest=function(){return Z},this.setScissorTest=function(e){Me.setScissorTest(Z=e)},this.getClearColor=function(){return Ue.getClearColor()},this.setClearColor=function(){Ue.setClearColor.apply(Ue,arguments)},this.getClearAlpha=function(){return Ue.getClearAlpha()},this.setClearAlpha=function(){Ue.setClearAlpha.apply(Ue,arguments)},this.clear=function(e,t,a){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===a||a)&&(r|=1024),we.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){u.removeEventListener("webglcontextlost",O,!1),u.removeEventListener("webglcontextrestored",d,!1),De.dispose(),Be.dispose(),Le.dispose(),Ie.dispose(),He.dispose(),Ye.stop()},this.renderBufferImmediate=function(e,t){Me.initAttributes();var a=Le.get(e);e.hasPositions&&!a.position&&(a.position=we.createBuffer()),e.hasNormals&&!a.normal&&(a.normal=we.createBuffer()),e.hasUvs&&!a.uv&&(a.uv=we.createBuffer()),e.hasColors&&!a.color&&(a.color=we.createBuffer()),t=t.getAttributes(),e.hasPositions&&(we.bindBuffer(34962,a.position),we.bufferData(34962,e.positionArray,35048),Me.enableAttribute(t.position),we.vertexAttribPointer(t.position,3,5126,!1,0,0)),e.hasNormals&&(we.bindBuffer(34962,a.normal),we.bufferData(34962,e.normalArray,35048),Me.enableAttribute(t.normal),we.vertexAttribPointer(t.normal,3,5126,!1,0,0)),e.hasUvs&&(we.bindBuffer(34962,a.uv),we.bufferData(34962,e.uvArray,35048),Me.enableAttribute(t.uv),we.vertexAttribPointer(t.uv,2,5126,!1,0,0)),e.hasColors&&(we.bindBuffer(34962,a.color),we.bufferData(34962,e.colorArray,35048),Me.enableAttribute(t.color),we.vertexAttribPointer(t.color,3,5126,!1,0,0)),Me.disableUnusedAttributes(),we.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(o,i,s,d,b,f){var _=b.isMesh&&0>b.matrixWorld.determinant();Me.setMaterial(d,_);var T=re(o,i,d,b),S=!1;(k!==s.id||de!==T.id||pe!==(!0===d.wireframe))&&(k=s.id,de=T.id,pe=!0===d.wireframe,S=!0),b.morphTargetInfluences&&(Oe.update(b,s,d,T),S=!0),_=s.index;var E=s.attributes.position;if(i=1,!0===d.wireframe&&(_=Fe.getWireframeAttribute(s),i=2),o=ze,null!==_){var A=Re.get(_);o=Ge,o.setIndex(A)}if(S){if(s&&s.isInstancedBufferGeometry&&!Ae.isWebGL2&&null===N.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{Me.initAttributes(),S=s.attributes,T=T.getAttributes();var M=d.defaultAttributeValues;for(I in T){var v=T[I];if(0<=v){var r=S[I];if(void 0!==r){var P=r.normalized,L=r.itemSize,u=Re.get(r);if(void 0!==u){var C=u.buffer,x=u.type;if(u=u.bytesPerElement,r.isInterleavedBufferAttribute){var y=r.data,R=y.stride;r=r.offset,y&&y.isInstancedInterleavedBuffer?(Me.enableAttributeAndDivisor(v,y.meshPerAttribute),void 0===s.maxInstancedCount&&(s.maxInstancedCount=y.meshPerAttribute*y.count)):Me.enableAttribute(v),we.bindBuffer(34962,C),we.vertexAttribPointer(v,L,x,P,R*u,r*u)}else r.isInstancedBufferAttribute?(Me.enableAttributeAndDivisor(v,r.meshPerAttribute),void 0===s.maxInstancedCount&&(s.maxInstancedCount=r.meshPerAttribute*r.count)):Me.enableAttribute(v),we.bindBuffer(34962,C),we.vertexAttribPointer(v,L,x,P,0,0)}}else if(void 0!==M&&(P=M[I],void 0!==P))switch(P.length){case 2:we.vertexAttrib2fv(v,P);break;case 3:we.vertexAttrib3fv(v,P);break;case 4:we.vertexAttrib4fv(v,P);break;default:we.vertexAttrib1fv(v,P);}}}Me.disableUnusedAttributes()}null!==_&&we.bindBuffer(34963,A.buffer)}A=1/0,null===_?void 0!==E&&(A=E.count):A=_.count,_=s.drawRange.start*i,E=null===f?0:f.start*i;var I=ei(_,E);if(f=ei(0,ai(A,_+s.drawRange.count*i,E+(null===f?1/0:f.count*i))-1-I+1),0!==f){if(!b.isMesh)b.isLine?(d=d.linewidth,void 0===d&&(d=1),Me.setLineWidth(d*(null===ie?he:1)),b.isLineSegments?o.setMode(1):b.isLineLoop?o.setMode(2):o.setMode(3)):b.isPoints?o.setMode(0):b.isSprite&&o.setMode(4);else if(!0===d.wireframe)Me.setLineWidth(d.wireframeLinewidth*(null===ie?he:1)),o.setMode(1);else switch(b.drawMode){case 0:o.setMode(4);break;case 1:o.setMode(5);break;case 2:o.setMode(6);}s&&s.isInstancedBufferGeometry?0<s.maxInstancedCount&&o.renderInstances(s,I,f):o.render(I,f)}},this.compile=function(e,t){G=Be.get(e,t),G.init(),e.traverse(function(e){e.isLight&&(G.pushLight(e),e.castShadow&&G.pushShadow(e))}),G.setupLights(t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var a=0;a<t.material.length;a++)ae(t.material[a],e.fog,t);else ae(t.material,e.fog,t)})};var je=null,Ye=new P;Ye.setAnimationLoop(function(e){He.isPresenting()||je&&je(e)}),"undefined"!=typeof window&&Ye.setContext(window),this.setAnimationLoop=function(e){je=e,He.setAnimationLoop(e),Ye.start()},this.render=function(t,a,r,o){if(void 0!==r){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");var n=r}if(void 0!==o){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");var i=o}a&&a.isCamera?A||(de=k=null,pe=!1,le=-1,ce=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===a.parent&&a.updateMatrixWorld(),He.enabled&&(a=He.getCamera(a)),G=Be.get(t,a),G.init(),t.onBeforeRender(ne,t,a,n||ie),Se.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),xe.setFromMatrix(Se),Te=this.localClippingEnabled,be=ve.init(this.clippingPlanes,Te,a),I=De.get(t,a),I.init(),ee(t,a,0,ne.sortObjects),!0===ne.sortObjects&&I.sort(),be&&ve.beginShadows(),Xe.render(G.state.shadowsArray,t,a),G.setupLights(a),be&&ve.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),Ue.render(I,t,a,i),r=I.opaque,o=I.transparent,t.overrideMaterial?(n=t.overrideMaterial,r.length&&l(r,t,a,n),o.length&&l(o,t,a,n)):(r.length&&l(r,t,a),o.length&&l(o,t,a)),t.onAfterRender(ne,t,a),null!==ie&&(Ce.updateRenderTargetMipmap(ie),Ce.updateMultisampleRenderTarget(ie)),Me.buffers.depth.setTest(!0),Me.buffers.depth.setMask(!0),Me.buffers.color.setMask(!0),Me.setPolygonOffset(!1),He.enabled&&He.submitFrame(),G=I=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){q=e},this.getRenderTarget=function(){return ie},this.setRenderTarget=function(t,r,o){(ie=t)&&void 0===Le.get(t).__webglFramebuffer&&Ce.setupRenderTarget(t);var n=q,i=!1;t?(n=Le.get(t).__webglFramebuffer,t.isWebGLRenderTargetCube?(n=n[r||0],i=!0):n=t.isWebGLMultisampleRenderTarget?Le.get(t).__webglMultisampledFramebuffer:n,me.copy(t.viewport),U.copy(t.scissor),Y=t.scissorTest):(me.copy(ye).multiplyScalar(he),U.copy(L).multiplyScalar(he),Y=Z),se!==n&&(we.bindFramebuffer(36160,n),se=n),Me.viewport(me),Me.scissor(U),Me.setScissorTest(Y),i&&(t=Le.get(t.texture),we.framebufferTexture2D(36160,36064,34069+(r||0),t.__webglTexture,o||0))},this.readRenderTargetPixels=function(t,a,r,o,n,e){if(t&&t.isWebGLRenderTarget){var i=Le.get(t).__webglFramebuffer;if(i){var s=!1;i!==se&&(we.bindFramebuffer(36160,i),s=!0);try{var d=t.texture,l=d.format,p=d.type;1023!==l&&ke.convert(l)!==we.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===p||ke.convert(p)===we.getParameter(35738)||1015===p&&(Ae.isWebGL2||N.get("OES_texture_float")||N.get("WEBGL_color_buffer_float"))||1016===p&&(Ae.isWebGL2?N.get("EXT_color_buffer_float"):N.get("EXT_color_buffer_half_float"))?36053===we.checkFramebufferStatus(36160)?0<=a&&a<=t.width-o&&0<=r&&r<=t.height-n&&we.readPixels(a,r,o,n,ke.convert(l),ke.convert(p),e):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{s&&we.bindFramebuffer(36160,se)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,a,r){var o=a.image.width,n=a.image.height,e=ke.convert(a.format);Ce.setTexture2D(a,0),we.copyTexImage2D(3553,r||0,e,t.x,t.y,o,n,0)},this.copyTextureToTexture=function(t,a,r,o){var n=a.image.width,e=a.image.height,i=ke.convert(r.format),s=ke.convert(r.type);Ce.setTexture2D(r,0),a.isDataTexture?we.texSubImage2D(3553,o||0,t.x,t.y,n,e,i,s,a.image.data):we.texSubImage2D(3553,o||0,t.x,t.y,i,s,a.image)}}function je(e,t){this.name="",this.color=new w(e),this.density=void 0===t?25e-5:t}function qa(e,t,a){this.name="",this.color=new w(e),this.near=void 0===t?1:t,this.far=void 0===a?1E3:a}function tr(){A.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.background=null,this.autoUpdate=!0}function ar(e,t){this.array=e,this.stride=t,this.count=void 0===e?0:e.length/t,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function rr(e,t,a,r){this.data=e,this.itemSize=t,this.offset=a,this.normalized=!0===r}function or(e){q.call(this),this.type="SpriteMaterial",this.color=new w(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(e)}function nr(e){if(A.call(this),this.type="Sprite",void 0===Si){Si=new Z;var t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);t=new ar(t,5),Si.setIndex([0,1,2,0,2,3]),Si.addAttribute("position",new rr(t,3,0,!1)),Si.addAttribute("uv",new rr(t,2,3,!1))}this.geometry=Si,this.material=void 0===e?new or:e,this.center=new o(.5,.5)}function ir(){A.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function sr(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),ge.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new W,this.bindMatrixInverse=new W}function lr(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new W)}function dr(){A.call(this),this.type="Bone"}function ke(e){q.call(this),this.type="LineBasicMaterial",this.color=new w(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.lights=!1,this.setValues(e)}function U(e,t,a){1===a&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),A.call(this),this.type="Line",this.geometry=void 0===e?new Z:e,this.material=void 0===t?new ke({color:16777215*Math.random()}):t}function ka(e,t){U.call(this,e,t),this.type="LineSegments"}function V(e,t){U.call(this,e,t),this.type="LineLoop"}function pr(e){q.call(this),this.type="PointsMaterial",this.color=new w(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=this.morphTargets=!1,this.setValues(e)}function Ia(e,t){A.call(this),this.type="Points",this.geometry=void 0===e?new Z:e,this.material=void 0===t?new pr({color:16777215*Math.random()}):t}function cr(t,a,o,n,i,e,s,d,p){r.call(this,t,a,o,n,i,e,s,d,p),this.format=void 0===s?1022:s,this.minFilter=void 0===e?1006:e,this.magFilter=void 0===i?1006:i,this.generateMipmaps=!1}function le(t,a,o,n,i,e,s,d,c,l,u,m){r.call(this,null,e,s,d,c,l,n,i,u,m),this.image={width:a,height:o},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function ur(t,a,o,n,i,e,s,d,p){r.call(this,t,a,o,n,i,e,s,d,p),this.needsUpdate=!0}function mr(t,a,o,n,i,e,s,d,p,l){if(l=void 0===l?1026:l,1026!==l&&1027!==l)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===o&&1026===l&&(o=1012),void 0===o&&1027===l&&(o=1020),r.call(this,null,n,i,e,s,d,l,o,p),this.image={width:t,height:a},this.magFilter=void 0===s?1003:s,this.minFilter=void 0===d?1003:d,this.generateMipmaps=this.flipY=!1}function fr(r){Z.call(this),this.type="WireframeGeometry";var o=[],n=[0,0],i={},u=["a","b","c"],f,y,x;if(r&&r.isGeometry){var v=r.faces,b=0;for(y=v.length;b<y;b++){var _=v[b];for(f=0;3>f;f++){var T=_[u[f]],S=_[u[(f+1)%3]];n[0]=ai(T,S),n[1]=ei(T,S),T=n[0]+","+n[1],void 0===i[T]&&(i[T]={index1:n[0],index2:n[1]})}}for(T in i)b=i[T],u=r.vertices[b.index1],o.push(u.x,u.y,u.z),u=r.vertices[b.index2],o.push(u.x,u.y,u.z)}else if(r&&r.isBufferGeometry)if(u=new s,null!==r.index){v=r.attributes.position,_=r.index;var E=r.groups;for(0===E.length&&(E=[{start:0,count:_.count,materialIndex:0}]),r=0,x=E.length;r<x;++r)for(b=E[r],f=b.start,y=b.count,b=f,y=f+y;b<y;b+=3)for(f=0;3>f;f++)T=_.getX(b+f),S=_.getX(b+(f+1)%3),n[0]=ai(T,S),n[1]=ei(T,S),T=n[0]+","+n[1],void 0===i[T]&&(i[T]={index1:n[0],index2:n[1]});for(T in i)b=i[T],u.fromBufferAttribute(v,b.index1),o.push(u.x,u.y,u.z),u.fromBufferAttribute(v,b.index2),o.push(u.x,u.y,u.z)}else for(v=r.attributes.position,b=0,y=v.count/3;b<y;b++)for(f=0;3>f;f++)i=3*b+f,u.fromBufferAttribute(v,i),o.push(u.x,u.y,u.z),i=3*b+(f+1)%3,u.fromBufferAttribute(v,i),o.push(u.x,u.y,u.z);this.addAttribute("position",new j(o,3))}function gr(e,t,a){F.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:a},this.fromBufferGeometry(new hr(e,t,a)),this.mergeVertices()}function hr(o,n,i){Z.call(this),this.type="ParametricBufferGeometry",this.parameters={func:o,slices:n,stacks:i};var c=[],d=[],e=[],f=[],g=new s,y=new s,x=new s,m=new s,v=new s,p,b;3>o.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var _=n+1;for(p=0;p<=i;p++){var r=p/i;for(b=0;b<=n;b++){var u=b/n;o(u,r,y),d.push(y.x,y.y,y.z),0<=u-1E-5?(o(u-1E-5,r,x),m.subVectors(y,x)):(o(u+1E-5,r,x),m.subVectors(x,y)),0<=r-1E-5?(o(u,r-1E-5,x),v.subVectors(y,x)):(o(u,r+1E-5,x),v.subVectors(x,y)),g.crossVectors(m,v).normalize(),e.push(g.x,g.y,g.z),f.push(u,r)}}for(p=0;p<i;p++)for(b=0;b<n;b++)o=p*_+b+1,g=(p+1)*_+b+1,y=(p+1)*_+b,c.push(p*_+b,o,y),c.push(o,g,y);this.setIndex(c),this.addAttribute("position",new j(d,3)),this.addAttribute("normal",new j(e,3)),this.addAttribute("uv",new j(f,2))}function yr(e,t,a,r){F.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:a,detail:r},this.fromBufferGeometry(new xr(e,t,a,r)),this.mergeVertices()}function xr(t,r,a,n){function i(e){u.push(e.x,e.y,e.z)}function e(e,a){e*=3,a.x=t[e+0],a.y=t[e+1],a.z=t[e+2]}function p(e,t,a,r){0>r&&1===e.x&&(m[t]=e.x-1),0===a.x&&0===a.z&&(m[t]=r/2/Zn+.5)}Z.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:r,radius:a,detail:n},a=a||1,n=n||0;var u=[],m=[];(function(t){for(var a=new s,o=new s,n=new s,d=0;d<r.length;d+=3){e(r[d+0],a),e(r[d+1],o),e(r[d+2],n);var p=a,c=n,u=qn(2,t),f=[],g,y;for(y=0;y<=u;y++){f[y]=[];var x=p.clone().lerp(c,y/u),v=o.clone().lerp(c,y/u),b=u-y;for(g=0;g<=b;g++)f[y][g]=0===g&&y===u?x:x.clone().lerp(v,g/b)}for(y=0;y<u;y++)for(g=0;g<2*(u-y)-1;g++)p=oi(g/2),0==g%2?(i(f[y][p+1]),i(f[y+1][p]),i(f[y][p])):(i(f[y][p+1]),i(f[y+1][p+1]),i(f[y+1][p]))}})(n),function(e){for(var t=new s,a=0;a<u.length;a+=3)t.x=u[a+0],t.y=u[a+1],t.z=u[a+2],t.normalize().multiplyScalar(e),u[a+0]=t.x,u[a+1]=t.y,u[a+2]=t.z}(a),function(){for(var t=new s,r=0;r<u.length;r+=3)t.x=u[r+0],t.y=u[r+1],t.z=u[r+2],m.push(Qn(t.z,-t.x)/2/Zn+.5,1-(Qn(-t.y,Jn(t.x*t.x+t.z*t.z))/Zn+.5));t=new s,r=new s;for(var n=new s,i=new s,l=new o,g=new o,f=new o,h=0,y=0;h<u.length;h+=9,y+=6){t.set(u[h+0],u[h+1],u[h+2]),r.set(u[h+3],u[h+4],u[h+5]),n.set(u[h+6],u[h+7],u[h+8]),l.set(m[y+0],m[y+1]),g.set(m[y+2],m[y+3]),f.set(m[y+4],m[y+5]),i.copy(t).add(r).add(n).divideScalar(3);var v=Qn(i.z,-i.x);p(l,y+0,t,v),p(g,y+2,r,v),p(f,y+4,n,v)}for(t=0;t<m.length;t+=6)r=m[t+0],n=m[t+2],i=m[t+4],l=ai(r,n,i),.9<ei(r,n,i)&&.1>l&&(.2>r&&(m[t+0]+=1),.2>n&&(m[t+2]+=1),.2>i&&(m[t+4]+=1))}(),this.addAttribute("position",new j(u,3)),this.addAttribute("normal",new j(u.slice(),3)),this.addAttribute("uv",new j(m,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function la(e,t){F.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new vr(e,t)),this.mergeVertices()}function vr(e,t){xr.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function br(e,t){F.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new _r(e,t)),this.mergeVertices()}function _r(e,t){xr.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Tr(e,t){F.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Sr(e,t)),this.mergeVertices()}function Sr(e,t){var a=(1+Jn(5))/2;xr.call(this,[-1,a,0,1,a,0,-1,-a,0,1,-a,0,0,-1,a,0,1,a,0,-1,-a,0,1,-a,a,0,-1,a,0,1,-a,0,-1,-a,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Er(e,t){F.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new wr(e,t)),this.mergeVertices()}function wr(e,t){var a=(1+Jn(5))/2,r=1/a;xr.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-a,0,-r,a,0,r,-a,0,r,a,-r,-a,0,-r,a,0,r,-a,0,r,a,0,-a,0,-r,a,0,-r,-a,0,r,a,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ar(t,r,o,n,i,e){F.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:r,radius:o,radialSegments:n,closed:i},void 0!==e&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new Mr(t,r,o,n,i),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function Mr(n,i,a,y,x){function v(r){T=n.getPointAt(r/i,T);var o=_.normals[r];for(r=_.binormals[r],E=0;E<=y;E++){var s=2*(E/y*Zn),l=Yn(s);s=-ti(s),h.x=s*o.x+l*r.x,h.y=s*o.y+l*r.y,h.z=s*o.z+l*r.z,h.normalize(),t.push(h.x,h.y,h.z),g.x=T.x+a*h.x,g.y=T.y+a*h.y,g.z=T.z+a*h.z,S.push(g.x,g.y,g.z)}}Z.call(this),this.type="TubeBufferGeometry",this.parameters={path:n,tubularSegments:i,radius:a,radialSegments:y,closed:x},i=i||64,a=a||1,y=y||8,x=x||!1;var _=n.computeFrenetFrames(i,x);this.tangents=_.tangents,this.normals=_.normals,this.binormals=_.binormals;var g=new s,h=new s,l=new o,T=new s,S=[],t=[],r=[],u=[],m,E;for(m=0;m<i;m++)v(m);for(v(!1===x?i:0),m=0;m<=i;m++)for(E=0;E<=y;E++)l.x=m/i,l.y=E/y,r.push(l.x,l.y);(function(){for(E=1;E<=i;E++)for(m=1;m<=y;m++){var t=(y+1)*E+(m-1),a=(y+1)*E+m,r=(y+1)*(E-1)+m;u.push((y+1)*(E-1)+(m-1),t,r),u.push(t,a,r)}})(),this.setIndex(u),this.addAttribute("position",new j(S,3)),this.addAttribute("normal",new j(t,3)),this.addAttribute("uv",new j(r,2))}function Pr(t,a,r,o,n,e,i){F.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:a,tubularSegments:r,radialSegments:o,p:n,q:e},void 0!==i&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Lr(t,a,r,o,n,e)),this.mergeVertices()}function Lr(o,n,i,v,_,T){function S(t,a,r,o,n){var e=Yn(t);a=r/a*t,r=ti(a),n.x=.5*(o*(2+r))*ti(t),n.y=.5*(o*(2+r)*e),n.z=.5*(o*Yn(a))}Z.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:o,tube:n,tubularSegments:i,radialSegments:v,p:_,q:T},o=o||1,n=n||.4,i=oi(i)||64,v=oi(v)||8,_=_||2,T=T||3;var g=[],h=[],l=[],m=[],E=new s,A=new s,t=new s,r=new s,u=new s,w=new s,M=new s,x;for(x=0;x<=i;++x){var P=2*(x/i*_*Zn);for(S(P,_,T,o,t),S(P+.01,_,T,o,r),w.subVectors(r,t),M.addVectors(r,t),u.crossVectors(w,M),M.crossVectors(u,w),u.normalize(),M.normalize(),P=0;P<=v;++P){var L=2*(P/v*Zn),C=-n*ti(L);L=n*Yn(L),E.x=t.x+(C*M.x+L*u.x),E.y=t.y+(C*M.y+L*u.y),E.z=t.z+(C*M.z+L*u.z),h.push(E.x,E.y,E.z),A.subVectors(E,t).normalize(),l.push(A.x,A.y,A.z),m.push(x/i),m.push(P/v)}}for(P=1;P<=i;P++)for(x=1;x<=v;x++)o=(v+1)*P+(x-1),n=(v+1)*P+x,_=(v+1)*(P-1)+x,g.push((v+1)*(P-1)+(x-1),o,_),g.push(o,n,_);this.setIndex(g),this.addAttribute("position",new j(h,3)),this.addAttribute("normal",new j(l,3)),this.addAttribute("uv",new j(m,2))}function Cr(t,a,r,o,n){F.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:a,radialSegments:r,tubularSegments:o,arc:n},this.fromBufferGeometry(new Rr(t,a,r,o,n)),this.mergeVertices()}function Rr(o,n,i,y,x){Z.call(this),this.type="TorusBufferGeometry",this.parameters={radius:o,tube:n,radialSegments:i,tubularSegments:y,arc:x},o=o||1,n=n||.4,i=oi(i)||8,y=oi(y)||6,x=x||2*Zn;var v=[],f=[],g=[],h=[],l=new s,m=new s,_=new s,p,T;for(p=0;p<=i;p++)for(T=0;T<=y;T++){var S=T/y*x,r=2*(p/i*Zn);m.x=(o+n*ti(r))*ti(S),m.y=(o+n*ti(r))*Yn(S),m.z=n*Yn(r),f.push(m.x,m.y,m.z),l.x=o*ti(S),l.y=o*Yn(S),_.subVectors(m,l).normalize(),g.push(_.x,_.y,_.z),h.push(T/y),h.push(p/i)}for(p=1;p<=i;p++)for(T=1;T<=y;T++)o=(y+1)*(p-1)+T-1,n=(y+1)*(p-1)+T,x=(y+1)*p+T,v.push((y+1)*p+T-1,o,x),v.push(o,n,x);this.setIndex(v),this.addAttribute("position",new j(f,3)),this.addAttribute("normal",new j(g,3)),this.addAttribute("uv",new j(h,2))}function Fr(t,a,r,o,n){for(var i=0,s=a,d=r-o,p;s<r;s+=o)i+=(t[d]-t[s])*(t[s+1]+t[d+1]),d=s;if(n===0<i)for(n=a;n<r;n+=o)p=Vr(n,t[n],t[n+1],p);else for(n=r-o;n>=a;n-=o)p=Vr(n,t[n],t[n+1],p);return p&&va(p,p.next)&&(Wr(p),p=p.next),p}function Ir(e,t){if(!e)return e;t||(t=e);do{var r=!1;if(e.steiner||!va(e,e.next)&&0!==zr(e.prev,e,e.next))e=e.next;else{if(Wr(e),e=t=e.prev,e===e.next)break;r=!0}}while(r||e!==t);return t}function Nr(o,i,s,c,d,e,u){if(o){if(!u&&e){var f=o,v=f;do null===v.z&&(v.z=Ur(v.x,v.y,c,d,e)),v.prevZ=v.prev,v=v.nextZ=v.next;while(v!==f);v.prevZ.nextZ=null,v.prevZ=null,f=v;var b=1,_,T,S,E;do{v=f;var A=f=null;for(T=0;v;){T++;var M=v;for(_=S=0;_<b&&(S++,M=M.nextZ,M);_++);for(E=b;0<S||0<E&&M;)0!==S&&(0===E||!M||v.z<=M.z)?(_=v,v=v.nextZ,S--):(_=M,M=M.nextZ,E--),A?A.nextZ=_:f=_,_.prevZ=A,A=_;v=M}A.nextZ=null,b*=2}while(1<T)}for(f=o;o.prev!==o.next;){if(v=o.prev,M=o.next,e)a:{A=o,E=c;var P=d,L=e;if(T=A.prev,S=A,b=A.next,0<=zr(T,S,b))A=!1;else{var C=T.x>S.x?T.x>b.x?T.x:b.x:S.x>b.x?S.x:b.x,x=T.y>S.y?T.y>b.y?T.y:b.y:S.y>b.y?S.y:b.y;for(_=Ur(T.x<S.x?T.x<b.x?T.x:b.x:S.x<b.x?S.x:b.x,T.y<S.y?T.y<b.y?T.y:b.y:S.y<b.y?S.y:b.y,E,P,L),E=Ur(C,x,E,P,L),P=A.nextZ;P&&P.z<=E;){if(P!==A.prev&&P!==A.next&&Or(T.x,T.y,S.x,S.y,b.x,b.y,P.x,P.y)&&0<=zr(P.prev,P,P.next)){A=!1;break a}P=P.nextZ}for(P=A.prevZ;P&&P.z>=_;){if(P!==A.prev&&P!==A.next&&Or(T.x,T.y,S.x,S.y,b.x,b.y,P.x,P.y)&&0<=zr(P.prev,P,P.next)){A=!1;break a}P=P.prevZ}A=!0}}else a:if(A=o,T=A.prev,S=A,b=A.next,0<=zr(T,S,b))A=!1;else{for(_=A.next.next;_!==A.prev;){if(Or(T.x,T.y,S.x,S.y,b.x,b.y,_.x,_.y)&&0<=zr(_.prev,_,_.next)){A=!1;break a}_=_.next}A=!0}if(A)i.push(v.i/s),i.push(o.i/s),i.push(M.i/s),Wr(o),f=o=M.next;else if(o=M,o===f){if(!u)Nr(Ir(o),i,s,c,d,e,1);else if(1===u){u=i,f=s,v=o;do M=v.prev,A=v.next.next,!va(M,A)&&Gr(M,v,v.next,A)&&kr(M,A)&&kr(A,M)&&(u.push(M.i/f),u.push(v.i/f),u.push(A.i/f),Wr(v),Wr(v.next),v=o=A),v=v.next;while(v!==o);o=v,Nr(o,i,s,c,d,e,2)}else if(2===u)a:{u=o;do{for(f=u.next.next;f!==u.prev;){if(v=u.i!==f.i){if(v=u,M=f,A=v.next.i!==M.i&&v.prev.i!==M.i){b:{A=v;do{if(A.i!==v.i&&A.next.i!==v.i&&A.i!==M.i&&A.next.i!==M.i&&Gr(A,A.next,v,M)){A=!0;break b}A=A.next}while(A!==v);A=!1}A=!A}if(A=A&&kr(v,M)&&kr(M,v)){A=v,T=!1,S=(v.x+M.x)/2,M=(v.y+M.y)/2;do A.y>M!=A.next.y>M&&A.next.y!==A.y&&S<(A.next.x-A.x)*(M-A.y)/(A.next.y-A.y)+A.x&&(T=!T),A=A.next;while(A!==v);A=T}v=A}if(v){o=Hr(u,f),u=Ir(u,u.next),o=Ir(o,o.next),Nr(u,i,s,c,d,e),Nr(o,i,s,c,d,e);break a}f=f.next}u=u.next}while(u!==o)}break}}}}function Dr(e,t){return e.x-t.x}function Br(t,a){var r=a,o=t.x,n=t.y,e=-Infinity;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var i=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(i<=o&&i>e){if(e=i,i===o){if(n===r.y)return r;if(n===r.next.y)return r.next}var s=r.x<r.next.x?r:r.next}}r=r.next}while(r!==a);if(!s)return null;if(o===e)return s.prev;a=s,i=s.x;var d=s.y,l=1/0;for(r=s.next;r!==a;){if(o>=r.x&&r.x>=i&&o!==r.x&&Or(n<d?o:e,n,i,d,n<d?e:o,n,r.x,r.y)){var p=ri(n-r.y)/(o-r.x);(p<l||p===l&&r.x>s.x)&&kr(r,t)&&(s=r,l=p)}r=r.next}return s}function Ur(t,r,o,n,i){return t=32767*(t-o)*i,r=32767*(r-n)*i,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),r=16711935&(r|r<<8),r=252645135&(r|r<<4),r=858993459&(r|r<<2),1431655765&(t|t<<1)|(1431655765&(r|r<<1))<<1}function me(e){var t=e,a=e;do t.x<a.x&&(a=t),t=t.next;while(t!==e);return a}function Or(t,a,r,o,n,e,i,s){return 0<=(n-i)*(a-s)-(t-i)*(e-s)&&0<=(t-i)*(o-s)-(r-i)*(a-s)&&0<=(r-i)*(e-s)-(n-i)*(o-s)}function zr(e,t,a){return(t.y-e.y)*(a.x-t.x)-(t.x-e.x)*(a.y-t.y)}function va(e,t){return e.x===t.x&&e.y===t.y}function Gr(e,t,a,r){return!!(va(e,t)&&va(a,r)||va(e,r)&&va(a,t))||0<zr(e,t,a)!=0<zr(e,t,r)&&0<zr(a,r,e)!=0<zr(a,r,t)}function kr(e,t){return 0>zr(e.prev,e,e.next)?0<=zr(e,t,e.next)&&0<=zr(e,e.prev,t):0>zr(e,t,e.prev)||0>zr(e,e.next,t)}function Hr(t,a){var r=new Xr(t.i,t.x,t.y),o=new Xr(a.i,a.x,a.y),n=t.next,e=a.prev;return t.next=a,a.prev=t,r.next=n,n.prev=r,o.next=r,r.prev=o,e.next=o,o.prev=e,o}function Vr(e,t,r,o){return e=new Xr(e,t,r),o?(e.next=o.next,e.prev=o,o.next.prev=e,o.next=e):(e.prev=e,e.next=e),e}function Wr(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Xr(e,t,a){this.i=e,this.x=t,this.y=a,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function ne(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function jr(e,t){for(var a=0;a<t.length;a++)e.push(t[a].x),e.push(t[a].y)}function Yr(e,t){F.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Qr(e,t)),this.mergeVertices()}function Qr(t,n){function r(t){function p(e,t,a){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(a).add(e)}function c(t,r,n){var i=t.x-r.x,s=t.y-r.y,p=n.x-t.x,c=n.y-t.y,u=i*i+s*s;if(ri(i*c-s*p)>jn){var y=Jn(u),l=Jn(p*p+c*c);if(u=r.x-s/y,r=r.y+i/y,c=((n.x-c/l-u)*c-(n.y+p/l-r)*p)/(i*c-s*p),p=u+i*c-t.x,i=r+s*c-t.y,s=p*p+i*i,2>=s)return new o(p,i);s=Jn(s/2)}else t=!1,i>jn?p>jn&&(t=!0):i<-jn?p<-jn&&(t=!0):Xn(s)===Xn(c)&&(t=!0),t?(p=-s,s=Jn(u)):(p=i,i=s,s=Jn(u/2));return new o(p/s,i/s)}function m(e,t){for(ie=e.length;0<=--ie;){var a=ie,o=ie-1;0>o&&(o=e.length-1);var n=v+2*N,s;for(s=0;s<n;s++){var c=U*s,u=U*(s+1),y=t+o+c,x=t+o+u;u=t+a+u,h(t+a+c),h(y),h(u),h(y),h(x),h(u),c=d.length/3,c=j.generateSideWallUV(i,d,c-6,c-3,c-2,c-1),r(c[0]),r(c[1]),r(c[3]),r(c[1]),r(c[2]),r(c[3])}}}function f(e,t,a){u.push(e),u.push(t),u.push(a)}function l(e,t,o){h(e),h(t),h(o),e=d.length/3,e=j.generateTopUV(i,d,e-3,e-2,e-1),r(e[0]),r(e[1]),r(e[2])}function h(e){d.push(u[3*e]),d.push(u[3*e+1]),d.push(u[3*e+2])}function r(t){e.push(t.x),e.push(t.y)}var u=[],g=void 0===n.curveSegments?12:n.curveSegments,v=void 0===n.steps?1:n.steps,x=void 0===n.depth?100:n.depth,_=!(void 0!==n.bevelEnabled)||n.bevelEnabled,b=void 0===n.bevelThickness?6:n.bevelThickness,w=void 0===n.bevelSize?b-2:n.bevelSize,C=void 0===n.bevelOffset?0:n.bevelOffset,N=void 0===n.bevelSegments?3:n.bevelSegments,k=n.extrudePath,j=void 0===n.UVGenerator?Ai:n.UVGenerator;void 0!==n.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),x=n.amount);var E=!1;if(k){var q=k.getSpacedPoints(v);E=!0,_=!1;var M=k.computeFrenetFrames(v,!1),P=new s,Q=new s,ee=new s}_||(C=w=b=N=0);var S;g=t.extractPoints(g),t=g.shape;var te=g.holes;if(!wi.isClockWise(t)){t=t.reverse();var O=0;for(S=te.length;O<S;O++){var ae=te[O];wi.isClockWise(ae)&&(te[O]=ae.reverse())}}var re=wi.triangulateShape(t,te),X=t;for(O=0,S=te.length;O<S;O++)ae=te[O],t=t.concat(ae);var U=t.length,Y=re.length,oe,ne;g=[];var ie=0,se=X.length,le=se-1;for(oe=ie+1;ie<se;ie++,le++,oe++)le===se&&(le=0),oe===se&&(oe=0),g[ie]=c(X[ie],X[le],X[oe]);k=[];var de=g.concat();for(O=0,S=te.length;O<S;O++){ae=te[O];var pe=[];for(ie=0,se=ae.length,le=se-1,oe=ie+1;ie<se;ie++,le++,oe++)le===se&&(le=0),oe===se&&(oe=0),pe[ie]=c(ae[ie],ae[le],ae[oe]);k.push(pe),de=de.concat(pe)}for(le=0;le<N;le++){se=le/N;var ce=b*ti(se*Zn/2);for(oe=w*Yn(se*Zn/2)+C,ie=0,se=X.length;ie<se;ie++){var ue=p(X[ie],g[ie],oe);f(ue.x,ue.y,-ce)}for(O=0,S=te.length;O<S;O++)for(ae=te[O],pe=k[O],ie=0,se=ae.length;ie<se;ie++)ue=p(ae[ie],pe[ie],oe),f(ue.x,ue.y,-ce)}for(oe=w+C,ie=0;ie<U;ie++)ue=_?p(t[ie],de[ie],oe):t[ie],E?(Q.copy(M.normals[0]).multiplyScalar(ue.x),P.copy(M.binormals[0]).multiplyScalar(ue.y),ee.copy(q[0]).add(Q).add(P),f(ee.x,ee.y,ee.z)):f(ue.x,ue.y,0);for(se=1;se<=v;se++)for(ie=0;ie<U;ie++)ue=_?p(t[ie],de[ie],oe):t[ie],E?(Q.copy(M.normals[se]).multiplyScalar(ue.x),P.copy(M.binormals[se]).multiplyScalar(ue.y),ee.copy(q[se]).add(Q).add(P),f(ee.x,ee.y,ee.z)):f(ue.x,ue.y,x/v*se);for(le=N-1;0<=le;le--){for(se=le/N,ce=b*ti(se*Zn/2),oe=w*Yn(se*Zn/2)+C,ie=0,se=X.length;ie<se;ie++)ue=p(X[ie],g[ie],oe),f(ue.x,ue.y,x+ce);for(O=0,S=te.length;O<S;O++)for(ae=te[O],pe=k[O],ie=0,se=ae.length;ie<se;ie++)ue=p(ae[ie],pe[ie],oe),E?f(ue.x,ue.y+q[v-1].y,q[v-1].x+ce):f(ue.x,ue.y,x+ce)}(function(){var e=d.length/3;if(_){var t=0*U;for(ie=0;ie<Y;ie++)ne=re[ie],l(ne[2]+t,ne[1]+t,ne[0]+t);for(t=U*(v+2*N),ie=0;ie<Y;ie++)ne=re[ie],l(ne[0]+t,ne[1]+t,ne[2]+t)}else{for(ie=0;ie<Y;ie++)ne=re[ie],l(ne[2],ne[1],ne[0]);for(ie=0;ie<Y;ie++)ne=re[ie],l(ne[0]+U*v,ne[1]+U*v,ne[2]+U*v)}i.addGroup(e,d.length/3-e,0)})(),function(){var e=d.length/3,t=0;for(m(X,t),t+=X.length,O=0,S=te.length;O<S;O++)ae=te[O],m(ae,t),t+=ae.length;i.addGroup(e,d.length/3-e,1)}()}Z.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:n},t=Array.isArray(t)?t:[t];for(var i=this,d=[],e=[],l=0,p=t.length;l<p;l++)r(t[l]);this.addAttribute("position",new j(d,3)),this.addAttribute("uv",new j(e,2)),this.computeVertexNormals()}function Ya(t,a,r){if(r.shapes=[],Array.isArray(t))for(var o=0,n=t.length;o<n;o++)r.shapes.push(t[o].uuid);else r.shapes.push(t.uuid);return void 0!==a.extrudePath&&(r.options.extrudePath=a.extrudePath.toJSON()),r}function qr(e,t){F.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Zr(e,t)),this.mergeVertices()}function Zr(e,t){t=t||{};var r=t.font;return r&&r.isFont?void(e=r.generateShapes(e,t.size),t.depth=void 0===t.height?50:t.height,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Qr.call(this,e,t),this.type="TextBufferGeometry"):(console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new F)}function Jr(t,a,r,o,n,e,i){F.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:a,heightSegments:r,phiStart:o,phiLength:n,thetaStart:e,thetaLength:i},this.fromBufferGeometry(new Kr(t,a,r,o,n,e,i)),this.mergeVertices()}function Kr(o,n,i,v,_,T,S){Z.call(this),this.type="SphereBufferGeometry",this.parameters={radius:o,widthSegments:n,heightSegments:i,phiStart:v,phiLength:_,thetaStart:T,thetaLength:S},o=o||1,n=ei(3,oi(n)||8),i=ei(2,oi(i)||6),v=void 0===v?0:v,_=void 0===_?2*Zn:_,T=void 0===T?0:T,S=void 0===S?Zn:S;var E=T+S,h=0,A=[],p=new s,M=new s,t=[],r=[],u=[],w=[],P,L;for(L=0;L<=i;L++){var C=[],x=L/i,y=0==L?.5/n:L==i?-.5/n:0;for(P=0;P<=n;P++){var R=P/n;p.x=-o*ti(v+R*_)*Yn(T+x*S),p.y=o*ti(T+x*S),p.z=o*Yn(v+R*_)*Yn(T+x*S),r.push(p.x,p.y,p.z),M.copy(p).normalize(),u.push(M.x,M.y,M.z),w.push(R+y,1-x),C.push(h++)}A.push(C)}for(L=0;L<i;L++)for(P=0;P<n;P++)o=A[L][P+1],v=A[L][P],_=A[L+1][P],S=A[L+1][P+1],(0!==L||0<T)&&t.push(o,v,S),(L!==i-1||E<Zn)&&t.push(v,_,S);this.setIndex(t),this.addAttribute("position",new j(r,3)),this.addAttribute("normal",new j(u,3)),this.addAttribute("uv",new j(w,2))}function $r(t,a,r,o,n,e){F.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:a,thetaSegments:r,phiSegments:o,thetaStart:n,thetaLength:e},this.fromBufferGeometry(new eo(t,a,r,o,n,e)),this.mergeVertices()}function eo(n,i,y,x,v,_){Z.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:n,outerRadius:i,thetaSegments:y,phiSegments:x,thetaStart:v,thetaLength:_},n=n||.5,i=i||1,v=void 0===v?0:v,_=void 0===_?2*Zn:_,y=void 0===y?8:ei(3,y),x=void 0===x?1:ei(1,x);var T=[],g=[],h=[],l=[],m=n,S=(i-n)/x,p=new s,E=new o,t,w;for(t=0;t<=x;t++){for(w=0;w<=y;w++)n=v+w/y*_,p.x=m*ti(n),p.y=m*Yn(n),g.push(p.x,p.y,p.z),h.push(0,0,1),E.x=(p.x/i+1)/2,E.y=(p.y/i+1)/2,l.push(E.x,E.y);m+=S}for(t=0;t<x;t++)for(i=t*(y+1),w=0;w<y;w++)n=w+i,v=n+y+1,_=n+y+2,m=n+1,T.push(n,v,m),T.push(v,_,m);this.setIndex(T),this.addAttribute("position",new j(g,3)),this.addAttribute("normal",new j(h,3)),this.addAttribute("uv",new j(l,2))}function to(e,t,a,r){F.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:a,phiLength:r},this.fromBufferGeometry(new ao(e,t,a,r)),this.mergeVertices()}function ao(r,a,n,i){Z.call(this),this.type="LatheBufferGeometry",this.parameters={points:r,segments:a,phiStart:n,phiLength:i},a=oi(a)||12,n=n||0,i=i||2*Zn,i=ni.clamp(i,0,2*Zn);var p=[],u=[],y=[],x=1/a,_=new s,T=new o,S;for(S=0;S<=a;S++){var E=n+S*x*i,w=Yn(E),v=ti(E);for(E=0;E<=r.length-1;E++)_.x=r[E].x*w,_.y=r[E].y,_.z=r[E].x*v,u.push(_.x,_.y,_.z),T.x=S/a,T.y=E/(r.length-1),y.push(T.x,T.y)}for(S=0;S<a;S++)for(E=0;E<r.length-1;E++)n=E+S*r.length,x=n+r.length,_=n+r.length+1,T=n+1,p.push(n,x,T),p.push(x,_,T);if(this.setIndex(p),this.addAttribute("position",new j(u,3)),this.addAttribute("uv",new j(y,2)),this.computeVertexNormals(),i===2*Zn)for(i=this.attributes.normal.array,p=new s,u=new s,y=new s,n=3*(a*r.length),E=S=0;S<r.length;S++,E+=3)p.x=i[E+0],p.y=i[E+1],p.z=i[E+2],u.x=i[n+E+0],u.y=i[n+E+1],u.z=i[n+E+2],y.addVectors(p,u).normalize(),i[E+0]=i[n+E+0]=y.x,i[E+1]=i[n+E+1]=y.y,i[E+2]=i[n+E+2]=y.z}function ro(e,t){F.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new oo(e,t)),this.mergeVertices()}function oo(t,r){function a(t){var s=i.length/3,l;t=t.extractPoints(r);var p=t.shape,u=t.holes;for(!1===wi.isClockWise(p)&&(p=p.reverse()),t=0,l=u.length;t<l;t++){var f=u[t];!0===wi.isClockWise(f)&&(u[t]=f.reverse())}var g=wi.triangulateShape(p,u);for(t=0,l=u.length;t<l;t++)f=u[t],p=p.concat(f);for(t=0,l=p.length;t<l;t++)f=p[t],i.push(f.x,f.y,0),e.push(0,0,1),n.push(f.x,f.y);for(t=0,l=g.length;t<l;t++)p=g[t],o.push(p[0]+s,p[1]+s,p[2]+s),d+=3}Z.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:r},r=r||12;var o=[],i=[],e=[],n=[],s=0,d=0;if(!1===Array.isArray(t))a(t);else for(var p=0;p<t.length;p++)a(t[p]),this.addGroup(s,d,p),s+=d,d=0;this.setIndex(o),this.addAttribute("position",new j(i,3)),this.addAttribute("normal",new j(e,3)),this.addAttribute("uv",new j(n,2))}function no(e,t){if(t.shapes=[],Array.isArray(e))for(var a=0,r=e.length;a<r;a++)t.shapes.push(e[a].uuid);else t.shapes.push(e.uuid);return t}function io(t,r){Z.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:r};var o=[];r=ti(ni.DEG2RAD*(void 0===r?1:r));var i=[0,0],s={},e=["a","b","c"];if(t.isBufferGeometry){var p=new F;p.fromBufferGeometry(t)}else p=t.clone();p.mergeVertices(),p.computeFaceNormals(),t=p.vertices,p=p.faces;for(var c=0,u=p.length;c<u;c++)for(var l=p[c],m=0;3>m;m++){var y=l[e[m]],x=l[e[(m+1)%3]];i[0]=ai(y,x),i[1]=ei(y,x),y=i[0]+","+i[1],void 0===s[y]?s[y]={index1:i[0],index2:i[1],face1:c,face2:void 0}:s[y].face2=c}for(y in s)(i=s[y],void 0===i.face2||p[i.face1].normal.dot(p[i.face2].normal)<=r)&&(e=t[i.index1],o.push(e.x,e.y,e.z),e=t[i.index2],o.push(e.x,e.y,e.z));this.addAttribute("position",new j(o,3))}function so(t,a,r,o,n,e,i,s){F.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:a,height:r,radialSegments:o,heightSegments:n,openEnded:e,thetaStart:i,thetaLength:s},this.fromBufferGeometry(new lo(t,a,r,o,n,e,i,s)),this.mergeVertices()}function lo(n,i,y,_,x,p,T,S){function E(a){var r=new o,d=new s,c=0,g=!0===a?n:i,u=!0===a?1:-1,h=t,y;for(y=1;y<=_;y++)P.push(0,R*u,0),L.push(0,u,0),v.push(.5,.5),t++;var x=t;for(y=0;y<=_;y++){var b=y/_*S+T,C=ti(b);b=Yn(b),d.x=g*b,d.y=R*u,d.z=g*C,P.push(d.x,d.y,d.z),L.push(0,u,0),r.x=.5*C+.5,r.y=.5*b*u+.5,v.push(r.x,r.y),t++}for(y=0;y<_;y++)r=h+y,d=x+y,!0===a?m.push(d,d+1,r):m.push(d+1,d,r),c+=3;M.addGroup(w,c,!0===a?1:2),w+=c}Z.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:n,radiusBottom:i,height:y,radialSegments:_,heightSegments:x,openEnded:p,thetaStart:T,thetaLength:S};var M=this;n=void 0===n?1:n,i=void 0===i?1:i,y=y||1,_=oi(_)||8,x=oi(x)||1,p=void 0!==p&&p,T=void 0===T?0:T,S=void 0===S?2*Zn:S;var m=[],P=[],L=[],v=[],t=0,C=[],R=y/2,w=0;(function(){var e=new s,a=new s,r=0,o=(i-n)/y,d,c;for(c=0;c<=x;c++){var u=[],g=c/x,h=g*(i-n)+n;for(d=0;d<=_;d++){var b=d/_,E=b*S+T,A=Yn(E);E=ti(E),a.x=h*A,a.y=-g*y+R,a.z=h*E,P.push(a.x,a.y,a.z),e.set(A,o,E).normalize(),L.push(e.x,e.y,e.z),v.push(b,1-g),u.push(t++)}C.push(u)}for(d=0;d<_;d++)for(c=0;c<x;c++)e=C[c+1][d],a=C[c+1][d+1],o=C[c][d+1],m.push(C[c][d],e,o),m.push(e,a,o),r+=6;M.addGroup(w,r,0),w+=r})(),!1===p&&(0<n&&E(!0),0<i&&E(!1)),this.setIndex(m),this.addAttribute("position",new j(P,3)),this.addAttribute("normal",new j(L,3)),this.addAttribute("uv",new j(v,2))}function po(t,a,r,o,n,e,i){so.call(this,0,t,a,r,o,n,e,i),this.type="ConeGeometry",this.parameters={radius:t,height:a,radialSegments:r,heightSegments:o,openEnded:n,thetaStart:e,thetaLength:i}}function co(t,a,r,o,n,e,i){lo.call(this,0,t,a,r,o,n,e,i),this.type="ConeBufferGeometry",this.parameters={radius:t,height:a,radialSegments:r,heightSegments:o,openEnded:n,thetaStart:e,thetaLength:i}}function uo(e,t,a,r){F.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:a,thetaLength:r},this.fromBufferGeometry(new mo(e,t,a,r)),this.mergeVertices()}function mo(t,r,n,i){Z.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:r,thetaStart:n,thetaLength:i},t=t||1,r=void 0===r?8:ei(3,r),n=void 0===n?0:n,i=void 0===i?2*Zn:i;var p=[],e=[],u=[],f=[],g=new s,m=new o,h;e.push(0,0,0),u.push(0,0,1),f.push(.5,.5);var y=0;for(h=3;y<=r;y++,h+=3){var x=n+y/r*i;g.x=t*ti(x),g.y=t*Yn(x),e.push(g.x,g.y,g.z),u.push(0,0,1),m.x=(e[h]/t+1)/2,m.y=(e[h+1]/t+1)/2,f.push(m.x,m.y)}for(h=1;h<=r;h++)p.push(h,h+1,0);this.setIndex(p),this.addAttribute("position",new j(e,3)),this.addAttribute("normal",new j(u,3)),this.addAttribute("uv",new j(f,2))}function fo(e){q.call(this),this.type="ShadowMaterial",this.color=new w(0),this.transparent=!0,this.setValues(e)}function go(e){Q.call(this,e),this.type="RawShaderMaterial"}function ho(e){q.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new w(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new w(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new o(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Za(e){ho.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoatRoughness=this.clearCoat=0,this.setValues(e)}function yo(e){q.call(this),this.type="MeshPhongMaterial",this.color=new w(16777215),this.specular=new w(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new w(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new o(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Ja(e){yo.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function xo(e){q.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new o(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1,this.setValues(e)}function vo(e){q.call(this),this.type="MeshLambertMaterial",this.color=new w(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new w(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function bo(e){q.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new w(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new o(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.lights=this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function _o(e){ke.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}function To(e,t,a,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0===r?new t.constructor(a):r,this.sampleValues=t,this.valueSize=a}function Da(e,t,a,r){To.call(this,e,t,a,r),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function So(e,t,a,r){To.call(this,e,t,a,r)}function Eo(e,t,a,r){To.call(this,e,t,a,r)}function wo(e,t,a,r){if(void 0===e)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Pi.convertArray(t,this.TimeBufferType),this.values=Pi.convertArray(a,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function da(e,t,a){wo.call(this,e,t,a)}function Ao(e,t,a,r){wo.call(this,e,t,a,r)}function Mo(e,t,a,r){wo.call(this,e,t,a,r)}function Po(e,t,a,r){To.call(this,e,t,a,r)}function Lo(e,t,a,r){wo.call(this,e,t,a,r)}function Co(e,t,a,r){wo.call(this,e,t,a,r)}function Ro(e,t,a,r){wo.call(this,e,t,a,r)}function Fo(e,t,a){this.name=e,this.tracks=a,this.duration=void 0===t?-1:t,this.uuid=ni.generateUUID(),0>this.duration&&this.resetDuration()}function Fa(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Mo;case"vector":case"vector2":case"vector3":case"vector4":return Ro;case"color":return Ao;case"quaternion":return Lo;case"bool":case"boolean":return da;case"string":return Co;}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function Io(e){if(void 0===e.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=Fa(e.type);if(void 0===e.times){var a=[],r=[];Pi.flattenJSON(e.keys,a,r,"value"),e.times=a,e.values=r}return void 0===t.parse?new t(e.name,e.times,e.values,e.interpolation):t.parse(e)}function No(t,a,r){var o=this,n=!1,i=0,s=0,l;this.onStart=void 0,this.onLoad=t,this.onProgress=a,this.onError=r,this.itemStart=function(e){s++,!1===n&&void 0!==o.onStart&&o.onStart(e,i,s),n=!0},this.itemEnd=function(e){i++,void 0!==o.onProgress&&o.onProgress(e,i,s),i===s&&(n=!1,void 0!==o.onLoad)&&o.onLoad()},this.itemError=function(e){void 0!==o.onError&&o.onError(e)},this.resolveURL=function(e){return l?l(e):e},this.setURLModifier=function(e){return l=e,this}}function oe(e){this.manager=void 0===e?Li:e}function Ka(e){this.manager=void 0===e?Li:e}function Do(e){this.manager=void 0===e?Li:e,this._parser=null}function Bo(e){this.manager=void 0===e?Li:e,this._parser=null}function pe(e){this.manager=void 0===e?Li:e}function Uo(e){this.manager=void 0===e?Li:e}function qe(e){this.manager=void 0===e?Li:e}function Oo(){this.type="Curve",this.arcLengthDivisions=200}function M(t,a,r,o,n,e,i,s){Oo.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=a||0,this.xRadius=r||1,this.yRadius=o||1,this.aStartAngle=n||0,this.aEndAngle=e||2*Zn,this.aClockwise=i||!1,this.aRotation=s||0}function Ea(t,a,r,o,n,e){M.call(this,t,a,r,r,o,n,e),this.type="ArcCurve"}function zo(){var t=0,r=0,o=0,n=0;return{initCatmullRom:function(a,i,s,d,p){a=p*(s-a),d=p*(d-i),t=i,r=a,o=-3*i+3*s-2*a-d,n=2*i-2*s+a+d},initNonuniformCatmullRom:function(a,i,s,d,p,l,c){a=((i-a)/p-(s-a)/(p+l)+(s-i)/l)*l,d=((s-i)/l-(d-i)/(l+c)+(d-s)/c)*l,t=i,r=a,o=-3*i+3*s-2*a-d,n=2*i-2*s+a+d},calc:function(a){var e=a*a;return t+r*a+o*e+n*e*a}}}function re(e,t,a,r){Oo.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=a||"centripetal",this.tension=r||.5}function oa(t,a,r,o,n){a=.5*(o-a),n=.5*(n-r);var i=t*t;return(2*r-2*o+a+n)*t*i+(-3*r+3*o-2*a-n)*i+a*t+r}function Go(t,a,r,o){var n=1-t;return n*n*a+2*(1-t)*t*r+t*t*o}function ko(t,a,r,o,n){var e=1-t,i=1-t;return e*e*e*a+3*i*i*t*r+3*(1-t)*t*t*o+t*t*t*n}function Ho(e,t,a,r){Oo.call(this),this.type="CubicBezierCurve",this.v0=e||new o,this.v1=t||new o,this.v2=a||new o,this.v3=r||new o}function La(e,t,a,r){Oo.call(this),this.type="CubicBezierCurve3",this.v0=e||new s,this.v1=t||new s,this.v2=a||new s,this.v3=r||new s}function $a(e,t){Oo.call(this),this.type="LineCurve",this.v1=e||new o,this.v2=t||new o}function wa(e,t){Oo.call(this),this.type="LineCurve3",this.v1=e||new s,this.v2=t||new s}function Ma(e,t,a){Oo.call(this),this.type="QuadraticBezierCurve",this.v0=e||new o,this.v1=t||new o,this.v2=a||new o}function Na(e,t,a){Oo.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new s,this.v1=t||new s,this.v2=a||new s}function Vo(e){Oo.call(this),this.type="SplineCurve",this.points=e||[]}function Oa(){Oo.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Wo(e){Oa.call(this),this.type="Path",this.currentPoint=new o,e&&this.setFromPoints(e)}function Pa(e){Wo.call(this,e),this.uuid=ni.generateUUID(),this.type="Shape",this.holes=[]}function Xo(e,t){A.call(this),this.type="Light",this.color=new w(e),this.intensity=void 0===t?1:t,this.receiveShadow=void 0}function T(e,t,a){Xo.call(this,e,a),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(A.DefaultUp),this.updateMatrix(),this.groundColor=new w(t)}function jo(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new o(512,512),this.map=null,this.matrix=new W}function Yo(){jo.call(this,new Ha(50,1,.5,500))}function Qo(t,a,r,o,n,e){Xo.call(this,t,a),this.type="SpotLight",this.position.copy(A.DefaultUp),this.updateMatrix(),this.target=new A,Object.defineProperty(this,"power",{get:function(){return this.intensity*Zn},set:function(e){this.intensity=e/Zn}}),this.distance=void 0===r?0:r,this.angle=void 0===o?Zn/3:o,this.penumbra=void 0===n?0:n,this.decay=void 0===e?1:e,this.shadow=new Yo}function qo(e,t,a,r){Xo.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Zn},set:function(e){this.intensity=e/(4*Zn)}}),this.distance=void 0===a?0:a,this.decay=void 0===r?1:r,this.shadow=new jo(new Ha(90,1,.5,500))}function Zo(t,a,r,o,n,e){Ba.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0===t?-1:t,this.right=void 0===a?1:a,this.top=void 0===r?1:r,this.bottom=void 0===o?-1:o,this.near=void 0===n?.1:n,this.far=void 0===e?2E3:e,this.updateProjectionMatrix()}function Jo(){jo.call(this,new Zo(-5,5,5,-5,.5,500))}function Ko(e,t){Xo.call(this,e,t),this.type="DirectionalLight",this.position.copy(A.DefaultUp),this.updateMatrix(),this.target=new A,this.shadow=new Jo}function $o(e,t){Xo.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function en(e,t,a,r){Xo.call(this,e,t),this.type="RectAreaLight",this.width=void 0===a?10:a,this.height=void 0===r?10:r}function tn(e){this.manager=void 0===e?Li:e,this.textures={}}function an(e){this.manager=void 0===e?Li:e}function se(e){this.manager=void 0===e?Li:e,this.resourcePath=""}function te(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0===e?Li:e,this.options=void 0}function ue(){this.type="ShapePath",this.color=new w,this.subPaths=[],this.currentPath=null}function ve(e){this.type="Font",this.data=e}function we(e){this.manager=void 0===e?Li:e}function rn(){}function on(e){this.manager=void 0===e?Li:e}function xe(){this.coefficients=[];for(var e=0;9>e;e++)this.coefficients.push(new s)}function nn(e,t){Xo.call(this,void 0,t),this.sh=void 0===e?new xe:e}function Qa(e,t,r){nn.call(this,void 0,r),e=new w().set(e),r=new w().set(t),t=new s(e.r,e.g,e.b),e=new s(r.r,r.g,r.b),r=Jn(Math.PI);var o=r*Jn(.75);this.sh.coefficients[0].copy(t).add(e).multiplyScalar(r),this.sh.coefficients[1].copy(t).sub(e).multiplyScalar(o)}function ye(e,t){nn.call(this,void 0,t),e=new w().set(e),this.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Jn(Math.PI))}function ze(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ha,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ha,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function sn(t,a,r,o){A.call(this),this.type="CubeCamera";var i=new Ha(90,1,t,a);i.up.set(0,-1,0),i.lookAt(new s(1,0,0)),this.add(i);var e=new Ha(90,1,t,a);e.up.set(0,-1,0),e.lookAt(new s(-1,0,0)),this.add(e);var p=new Ha(90,1,t,a);p.up.set(0,0,1),p.lookAt(new s(0,1,0)),this.add(p);var u=new Ha(90,1,t,a);u.up.set(0,0,-1),u.lookAt(new s(0,-1,0)),this.add(u);var f=new Ha(90,1,t,a);f.up.set(0,-1,0),f.lookAt(new s(0,0,1)),this.add(f);var l=new Ha(90,1,t,a);l.up.set(0,-1,0),l.lookAt(new s(0,0,-1)),this.add(l),o=o||{format:1022,magFilter:1006,minFilter:1006},this.renderTarget=new n(r,r,o),this.renderTarget.texture.name="CubeCamera",this.update=function(t,a){null===this.parent&&this.updateMatrixWorld();var r=t.getRenderTarget(),o=this.renderTarget,n=o.texture.generateMipmaps;o.texture.generateMipmaps=!1,t.setRenderTarget(o,0),t.render(a,i),t.setRenderTarget(o,1),t.render(a,e),t.setRenderTarget(o,2),t.render(a,p),t.setRenderTarget(o,3),t.render(a,u),t.setRenderTarget(o,4),t.render(a,f),o.texture.generateMipmaps=n,t.setRenderTarget(o,5),t.render(a,l),t.setRenderTarget(r)},this.clear=function(t,a,r,o){for(var n=t.getRenderTarget(),e=this.renderTarget,i=0;6>i;i++)t.setRenderTarget(e,i),t.clear(a,r,o);t.setRenderTarget(n)}}function ln(e){this.autoStart=!(void 0!==e)||e,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Ae(){A.call(this),this.type="AudioListener",this.context=Fi.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function Be(e){A.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function dn(e){Be.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function De(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0===t?2048:t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Ee(e,t,r){this.binding=e,this.valueSize=r,e=Float64Array;"quaternion"===t?t=this._slerp:"string"===t||"bool"===t?(e=Array,t=this._select):t=this._lerp;this.buffer=new e(4*r),this._mixBufferRegion=t,this.referenceCount=this.useCount=this.cumulativeWeight=0}function Fe(e,t,a){a=a||pn.parseTrackName(t),this._targetGroup=e,this._bindings=e.subscribe_(t,a)}function pn(e,t,a){this.path=t,this.parsedPath=a||pn.parseTrackName(t),this.node=pn.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function ia(){this.uuid=ni.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,a=arguments.length;t!==a;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function cn(t,r,o){this._mixer=t,this._clip=r,this._localRoot=o||null,t=r.tracks,r=t.length,o=Array(r);for(var n={endingStart:2400,endingEnd:2400},i=0,s;i!==r;++i)s=t[i].createInterpolant(null),o[i]=s,s.settings=n;this._interpolantSettings=n,this._interpolants=o,this._propertyBindings=Array(r),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function un(e){this._root=e,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function Ge(e,t){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=t),this.value=e}function mn(){Z.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function He(e,t,a){ar.call(this,e,t),this.meshPerAttribute=a||1}function Ie(e,t,a,r){"number"==typeof a&&(r=a,a=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),I.call(this,e,t,a),this.meshPerAttribute=r||1}function Je(e,t,a,r){this.ray=new de(e,t),this.near=a||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function fn(e,t){return e.distance-t.distance}function gn(t,r,o,n){if(!1!==t.visible&&(t.raycast(r,o),!0===n)){t=t.children,n=0;for(var i=t.length;n<i;n++)gn(t[n],r,o,!0)}}function Ke(e,t,a){return this.radius=void 0===e?1:e,this.phi=void 0===t?0:t,this.theta=void 0===a?0:a,this}function hn(e,t,a){return this.radius=void 0===e?1:e,this.theta=void 0===t?0:t,this.y=void 0===a?0:a,this}function yn(e,t){this.min=void 0===e?new o(1/0,1/0):e,this.max=void 0===t?new o(-Infinity,-Infinity):t}function Le(e,t){this.start=void 0===e?new s:e,this.end=void 0===t?new s:t}function Me(e){A.call(this),this.material=e,this.render=function(){}}function xn(e,t,r,o){this.object=e,this.size=void 0===t?1:t,e=void 0===r?16711680:r,o=void 0===o?1:o,t=0,(r=this.object.geometry)&&r.isGeometry?t=3*r.faces.length:r&&r.isBufferGeometry&&(t=r.attributes.normal.count),r=new Z,t=new j(6*t,3),r.addAttribute("position",t),ka.call(this,r,new ke({color:e,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function vn(t,r){A.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,t=new Z,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var o=0,n=1;32>o;o++,n++){var i=2*(o/32*Zn),e=2*(n/32*Zn);r.push(ti(i),Yn(i),1,ti(e),Yn(e),1)}t.addAttribute("position",new j(r,3)),r=new ke({fog:!1}),this.cone=new ka(t,r),this.add(this.cone),this.update()}function bn(e){var t=[];e&&e.isBone&&t.push(e);for(var a=0;a<e.children.length;a++)t.push.apply(t,bn(e.children[a]));return t}function _n(t){for(var a=bn(t),r=new Z,o=[],n=[],e=new w(0,0,1),i=new w(0,1,0),s=0,p;s<a.length;s++)p=a[s],p.parent&&p.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),n.push(e.r,e.g,e.b),n.push(i.r,i.g,i.b));r.addAttribute("position",new j(o,3)),r.addAttribute("color",new j(n,3)),o=new ke({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0}),ka.call(this,r,o),this.root=t,this.bones=a,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Tn(e,t,r){this.light=e,this.light.updateMatrixWorld(),this.color=r,e=new Kr(t,4,2),t=new fe({wireframe:!0,fog:!1}),ge.call(this,e,t),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Sn(e,t){this.type="RectAreaLightHelper",this.light=e,this.color=t,e=new Z,e.addAttribute("position",new j([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),e.computeBoundingSphere(),t=new ke({fog:!1}),U.call(this,e,t),e=new Z,e.addAttribute("position",new j([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),e.computeBoundingSphere(),this.add(new ge(e,new fe({side:1,fog:!1}))),this.update()}function En(e,t,r){A.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,e=new _r(t),e.rotateY(.5*Zn),this.material=new fe({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2),t=e.getAttribute("position"),t=new Float32Array(3*t.count),e.addAttribute("color",new I(t,3)),this.add(new ge(e,this.material)),this.update()}function wn(e,t){this.lightProbe=e,this.size=t,e=new Q({defines:{GAMMA_OUTPUT:""},uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:"varying vec3 vNormal;\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#define RECIPROCAL_PI 0.318309886\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\t// matrix is assumed to be orthogonal\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 linearToOutput( in vec3 a ) {\n\t#ifdef GAMMA_OUTPUT\n\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n\t#else\n\t\treturn a;\n\t#endif\n}\n// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\t// normal is assumed to have unit length\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\t// band 0\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\t// band 1\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\t// band 2\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nuniform vec3 sh[ 9 ]; // sh coefficients\nuniform float intensity; // light probe intensity\nvarying vec3 vNormal;\nvoid main() {\n\tvec3 normal = normalize( vNormal );\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );\n\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;\n\toutgoingLight = linearToOutput( outgoingLight );\n\tgl_FragColor = vec4( outgoingLight, 1.0 );\n}"}),t=new Kr(1,32,16),ge.call(this,t,e),this.onBeforeRender()}function An(t,r,o,n){t=t||10,r=r||10,o=new w(void 0===o?4473924:o),n=new w(void 0===n?8947848:n);var i=r/2,e=t/r,s=t/2;t=[];for(var p=[],u=0,f=0,g=-s;u<=r;u++,g+=e){t.push(-s,0,g,s,0,g),t.push(g,0,-s,g,0,s);var h=u===i?o:n;h.toArray(p,f),f+=3,h.toArray(p,f),f+=3,h.toArray(p,f),f+=3,h.toArray(p,f),f+=3}r=new Z,r.addAttribute("position",new j(t,3)),r.addAttribute("color",new j(p,3)),o=new ke({vertexColors:2}),ka.call(this,r,o)}function Mn(t,r,o,i,s,p){t=t||10,r=r||16,o=o||8,i=i||64,s=new w(void 0===s?4473924:s),p=new w(void 0===p?8947848:p);var u=[],y=[],h;for(h=0;h<=r;h++){var x=2*(h/r)*Zn,v=Yn(x)*t;x=ti(x)*t,u.push(0,0,0),u.push(v,0,x);var _=1&h?s:p;y.push(_.r,_.g,_.b),y.push(_.r,_.g,_.b)}for(h=0;h<=o;h++){_=1&h?s:p;var T=t-t/o*h;for(r=0;r<i;r++)x=2*(r/i)*Zn,v=Yn(x)*T,x=ti(x)*T,u.push(v,0,x),y.push(_.r,_.g,_.b),x=2*((r+1)/i)*Zn,v=Yn(x)*T,x=ti(x)*T,u.push(v,0,x),y.push(_.r,_.g,_.b)}t=new Z,t.addAttribute("position",new j(u,3)),t.addAttribute("color",new j(y,3)),u=new ke({vertexColors:2}),ka.call(this,t,u)}function Pn(e,t,r,o){this.audio=e,this.range=t||1,this.divisionsInnerAngle=r||16,this.divisionsOuterAngle=o||2,e=new Z,t=new Float32Array(3*(3*(this.divisionsInnerAngle+2*this.divisionsOuterAngle)+3)),e.addAttribute("position",new I(t,3)),t=new ke({color:65280}),r=new ke({color:16776960}),U.call(this,e,[r,t]),this.update()}function Ln(e,t,r,o){this.object=e,this.size=void 0===t?1:t,e=void 0===r?16776960:r,o=void 0===o?1:o,t=0,(r=this.object.geometry)&&r.isGeometry?t=r.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),r=new Z,t=new j(6*t,3),r.addAttribute("position",t),ka.call(this,r,new ke({color:e,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Cn(e,t,r){A.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===t&&(t=1),e=new Z,e.addAttribute("position",new j([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3)),t=new ke({fog:!1}),this.lightPlane=new U(e,t),this.add(this.lightPlane),e=new Z,e.addAttribute("position",new j([0,0,0,0,0,1],3)),this.targetLine=new U(e,t),this.add(this.targetLine),this.update()}function Rn(t){function a(e,t,a){r(e,a),r(t,a)}function r(t,a){e.push(0,0,0),s.push(a.r,a.g,a.b),void 0===d[t]&&(d[t]=[]),d[t].push(e.length/3-1)}var o=new Z,i=new ke({color:16777215,vertexColors:1}),e=[],s=[],d={},c=new w(16755200),l=new w(16711680),u=new w(43775),m=new w(16777215),p=new w(3355443);a("n1","n2",c),a("n2","n4",c),a("n4","n3",c),a("n3","n1",c),a("f1","f2",c),a("f2","f4",c),a("f4","f3",c),a("f3","f1",c),a("n1","f1",c),a("n2","f2",c),a("n3","f3",c),a("n4","f4",c),a("p","n1",l),a("p","n2",l),a("p","n3",l),a("p","n4",l),a("u1","u2",u),a("u2","u3",u),a("u3","u1",u),a("c","t",m),a("p","c",p),a("cn1","cn2",p),a("cn3","cn4",p),a("cf1","cf2",p),a("cf3","cf4",p),o.addAttribute("position",new j(e,3)),o.addAttribute("color",new j(s,3)),ka.call(this,o,i),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=d,this.update()}function Fn(e,t){this.object=e,void 0===t&&(t=16776960),e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var r=new Float32Array(24),o=new Z;o.setIndex(new I(e,1)),o.addAttribute("position",new I(r,3)),ka.call(this,o,new ke({color:t})),this.matrixAutoUpdate=!1,this.update()}function In(e,t){this.type="Box3Helper",this.box=e,e=void 0===t?16776960:t,t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var r=new Z;r.setIndex(new I(t,1)),r.addAttribute("position",new j([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),ka.call(this,r,new ke({color:e})),this.geometry.computeBoundingSphere()}function Nn(e,t,r){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t,e=void 0===r?16776960:r,t=new Z,t.addAttribute("position",new j([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),t.computeBoundingSphere(),U.call(this,t,new ke({color:e})),t=new Z,t.addAttribute("position",new j([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),t.computeBoundingSphere(),this.add(new ge(t,new fe({color:e,opacity:.2,transparent:!0,depthWrite:!1})))}function Dn(t,r,o,n,i,l){A.call(this),void 0===t&&(t=new s(0,0,1)),void 0===r&&(r=new s(0,0,0)),void 0===o&&(o=1),void 0===n&&(n=16776960),void 0===i&&(i=.2*o),void 0===l&&(l=.2*i),void 0===Ii&&(Ii=new Z,Ii.addAttribute("position",new j([0,0,0,0,1,0],3)),Ni=new lo(0,.5,1,5,1),Ni.translate(0,-.5,0)),this.position.copy(r),this.line=new U(Ii,new ke({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ge(Ni,new fe({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(o,i,l)}function Bn(e){e=e||1;var t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e];e=new Z,e.addAttribute("position",new j(t,3)),e.addAttribute("color",new j([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),t=new ke({vertexColors:2}),ka.call(this,e,t)}function Un(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),re.call(this,e),this.type="catmullrom",this.closed=!0}function On(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),re.call(this,e),this.type="catmullrom"}function zn(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),re.call(this,e),this.type="catmullrom"}void 0===jn&&(jn=qn(2,-52)),void 0===Wn&&(Wn=function(e){return"number"==typeof e&&isFinite(e)&&oi(e)===e}),void 0===Xn&&(Xn=function(e){return 0>e?-1:0<e?1:+e}),!1=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(t),r=1,o;r<arguments.length;r++)if(o=arguments[r],void 0!==o&&null!==o)for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(a[n]=o[n]);return a}}(),Object.assign(t.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var a=this._listeners;void 0===a[e]&&(a[e]=[]),-1===a[e].indexOf(t)&&a[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var a=this._listeners;return void 0!==a[e]&&-1!==a[e].indexOf(t)},removeEventListener:function(e,t){void 0!==this._listeners&&(e=this._listeners[e],void 0!==e&&(t=e.indexOf(t),-1!==t&&e.splice(t,1)))},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this,t=t.slice(0);for(var a=0,r=t.length;a<r;a++)t[a].call(this,e)}}}});var ni={DEG2RAD:Zn/180,RAD2DEG:180/Zn,generateUUID:function(){for(var t=[],e=0;256>e;e++)t[e]=(16>e?"0":"")+e.toString(16);return function(){var a=0|4294967295*Math.random(),r=0|4294967295*Math.random(),o=0|4294967295*Math.random(),e=0|4294967295*Math.random();return(t[255&a]+t[255&a>>8]+t[255&a>>16]+t[255&a>>24]+"-"+t[255&r]+t[255&r>>8]+"-"+t[64|15&r>>16]+t[255&r>>24]+"-"+t[128|63&o]+t[255&o>>8]+"-"+t[255&o>>16]+t[255&o>>24]+t[255&e]+t[255&e>>8]+t[255&e>>16]+t[255&e>>24]).toUpperCase()}}(),clamp:function(e,t,a){return ei(t,ai(a,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(t,a,r,o,n){return o+(t-a)*(n-o)/(r-a)},lerp:function(e,t,a){return(1-a)*e+a*t},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(6*e-15)+10))},randInt:function(e,t){return e+oi(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*ni.DEG2RAD},radToDeg:function(e){return e*ni.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return qn(2,Vn($n(e)/Kn))},floorPowerOfTwo:function(e){return qn(2,oi($n(e)/Kn))}};Object.defineProperties(o.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(o.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0===t?(this.x+=e.x,this.y+=e.y,this):(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t))},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0===t?(this.x-=e.x,this.y-=e.y,this):(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t))},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,r=this.y;return e=e.elements,this.x=e[0]*t+e[3]*r+e[6],this.y=e[1]*t+e[4]*r+e[7],this},min:function(e){return this.x=ai(this.x,e.x),this.y=ai(this.y,e.y),this},max:function(e){return this.x=ei(this.x,e.x),this.y=ei(this.y,e.y),this},clamp:function(e,t){return this.x=ei(e.x,ai(t.x,this.x)),this.y=ei(e.y,ai(t.y,this.y)),this},clampScalar:function(e,t){return this.x=ei(e,ai(t,this.x)),this.y=ei(e,ai(t,this.y)),this},clampLength:function(e,t){var a=this.length();return this.divideScalar(a||1).multiplyScalar(ei(e,ai(t,a)))},floor:function(){return this.x=oi(this.x),this.y=oi(this.y),this},ceil:function(){return this.x=Vn(this.x),this.y=Vn(this.y),this},round:function(){return this.x=Hn(this.x),this.y=Hn(this.y),this},roundToZero:function(){return this.x=0>this.x?Vn(this.x):oi(this.x),this.y=0>this.y?Vn(this.y):oi(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Jn(this.x*this.x+this.y*this.y)},manhattanLength:function(){return ri(this.x)+ri(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Qn(this.y,this.x);return 0>e&&(e+=2*Zn),e},distanceTo:function(e){return Jn(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x;return e=this.y-e.y,t*t+e*e},manhattanDistanceTo:function(e){return ri(this.x-e.x)+ri(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,a){return this.subVectors(t,e).multiplyScalar(a).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,a){return void 0!==a&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(t,a){var r=ti(a);a=Yn(a);var o=this.x-t.x,n=this.y-t.y;return this.x=o*r-n*a+t.x,this.y=o*a+n*r+t.y,this}}),Object.assign(i,{slerp:function(e,t,a,r){return a.copy(e).slerp(t,r)},slerpFlat:function(o,a,i,s,u,y,x){var v=i[s+0],b=i[s+1],_=i[s+2];i=i[s+3],s=u[y+0];var T=u[y+1],S=u[y+2];if(u=u[y+3],i!==u||v!==s||b!==T||_!==S){y=1-x;var p=v*s+b*T+_*S+i*u,E=0<=p?1:-1,w=1-p*p;w>jn&&(w=Jn(w),p=Qn(w,p*E),y=Yn(y*p)/w,x=Yn(x*p)/w),E*=x,v=v*y+s*E,b=b*y+T*E,_=_*y+S*E,i=i*y+u*E,y===1-x&&(x=1/Jn(v*v+b*b+_*_+i*i),v*=x,b*=x,_*=x,i*=x)}o[a]=v,o[a+1]=b,o[a+2]=_,o[a+3]=i}}),Object.defineProperties(i.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(i.prototype,{isQuaternion:!0,set:function(e,t,a,r){return this._x=e,this._y=t,this._z=a,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(t,r){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var o=t._x,n=t._y,i=t._z;t=t.order;var s=ti,p=Yn,u=s(o/2),m=s(n/2);return s=s(i/2),o=p(o/2),n=p(n/2),i=p(i/2),"XYZ"===t?(this._x=o*m*s+u*n*i,this._y=u*n*s-o*m*i,this._z=u*m*i+o*n*s,this._w=u*m*s-o*n*i):"YXZ"===t?(this._x=o*m*s+u*n*i,this._y=u*n*s-o*m*i,this._z=u*m*i-o*n*s,this._w=u*m*s+o*n*i):"ZXY"===t?(this._x=o*m*s-u*n*i,this._y=u*n*s+o*m*i,this._z=u*m*i+o*n*s,this._w=u*m*s-o*n*i):"ZYX"===t?(this._x=o*m*s-u*n*i,this._y=u*n*s+o*m*i,this._z=u*m*i-o*n*s,this._w=u*m*s+o*n*i):"YZX"===t?(this._x=o*m*s+u*n*i,this._y=u*n*s+o*m*i,this._z=u*m*i-o*n*s,this._w=u*m*s-o*n*i):"XZY"===t&&(this._x=o*m*s-u*n*i,this._y=u*n*s-o*m*i,this._z=u*m*i+o*n*s,this._w=u*m*s+o*n*i),!1!==r&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){t/=2;var a=Yn(t);return this._x=e.x*a,this._y=e.y*a,this._z=e.z*a,this._w=ti(t),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var r=t.elements,o=r[0];t=r[4];var n=r[8],i=r[1],e=r[5],s=r[9],d=r[2],p=r[6];r=r[10];var l=o+e+r;return 0<l?(o=.5/Jn(l+1),this._w=.25/o,this._x=(p-s)*o,this._y=(n-d)*o,this._z=(i-t)*o):o>e&&o>r?(o=2*Jn(1+o-e-r),this._w=(p-s)/o,this._x=.25*o,this._y=(t+i)/o,this._z=(n+d)/o):e>r?(o=2*Jn(1+e-o-r),this._w=(n-d)/o,this._x=(t+i)/o,this._y=.25*o,this._z=(s+p)/o):(o=2*Jn(1+r-o-e),this._w=(i-t)/o,this._x=(n+d)/o,this._y=(s+p)/o,this._z=.25*o),this.onChangeCallback(),this},setFromUnitVectors:function(e,t){var a=e.dot(t)+1;return 1E-6>a?(a=0,ri(e.x)>ri(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=a,this.normalize()},angleTo:function(e){return 2*kn(ri(ni.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var a=this.angleTo(e);return 0===a?this:(this.slerp(e,ai(1,t/a)),this)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Jn(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._z=this._y=this._x=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e),this.onChangeCallback(),this},multiply:function(e,t){return void 0===t?this.multiplyQuaternions(this,e):(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t))},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(t,r){var o=t._x,n=t._y,i=t._z;t=t._w;var e=r._x,s=r._y,l=r._z;return r=r._w,this._x=o*r+t*e+n*l-i*s,this._y=n*r+t*s+i*e-o*l,this._z=i*r+t*l+o*s-n*e,this._w=t*r-o*e-n*s-i*l,this.onChangeCallback(),this},slerp:function(t,r){if(0===r)return this;if(1===r)return this.copy(t);var o=this._x,n=this._y,i=this._z,e=this._w,s=e*t._w+o*t._x+n*t._y+i*t._z;if(0>s?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),1<=s)return this._w=e,this._x=o,this._y=n,this._z=i,this;if(t=1-s*s,t<=jn)return s=1-r,this._w=s*e+r*this._w,this._x=s*o+r*this._x,this._y=s*n+r*this._y,this._z=s*i+r*this._z,this.normalize();t=Jn(t);var l=Qn(t,s);return s=Yn((1-r)*l)/t,r=Yn(r*l)/t,this._w=e*s+this._w*r,this._x=o*s+this._x*r,this._y=n*s+this._y*r,this._z=i*s+this._z*r,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(s.prototype,{isVector3:!0,set:function(e,t,a){return this.x=e,this.y=t,this.z=a,this},setScalar:function(e){return this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0===t?(this.x+=e.x,this.y+=e.y,this.z+=e.z,this):(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t))},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0===t?(this.x-=e.x,this.y-=e.y,this.z-=e.z,this):(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t))},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0===t?(this.x*=e.x,this.y*=e.y,this.z*=e.z,this):(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t))},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(){var e=new i;return function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(e.setFromEuler(t))}}(),applyAxisAngle:function(){var e=new i;return function(t,a){return this.applyQuaternion(e.setFromAxisAngle(t,a))}}(),applyMatrix3:function(e){var t=this.x,r=this.y,o=this.z;return e=e.elements,this.x=e[0]*t+e[3]*r+e[6]*o,this.y=e[1]*t+e[4]*r+e[7]*o,this.z=e[2]*t+e[5]*r+e[8]*o,this},applyMatrix4:function(t){var r=this.x,o=this.y,n=this.z;t=t.elements;var i=1/(t[3]*r+t[7]*o+t[11]*n+t[15]);return this.x=(t[0]*r+t[4]*o+t[8]*n+t[12])*i,this.y=(t[1]*r+t[5]*o+t[9]*n+t[13])*i,this.z=(t[2]*r+t[6]*o+t[10]*n+t[14])*i,this},applyQuaternion:function(t){var r=this.x,o=this.y,n=this.z,i=t.x,e=t.y,s=t.z;t=t.w;var d=t*r+e*n-s*o,p=t*o+s*r-i*n,l=t*n+i*o-e*r;return r=-i*r-e*o-s*n,this.x=d*t+r*-i+p*-s-l*-e,this.y=p*t+r*-e+l*-i-d*-s,this.z=l*t+r*-s+d*-e-p*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,r=this.y,o=this.z;return e=e.elements,this.x=e[0]*t+e[4]*r+e[8]*o,this.y=e[1]*t+e[5]*r+e[9]*o,this.z=e[2]*t+e[6]*r+e[10]*o,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=ai(this.x,e.x),this.y=ai(this.y,e.y),this.z=ai(this.z,e.z),this},max:function(e){return this.x=ei(this.x,e.x),this.y=ei(this.y,e.y),this.z=ei(this.z,e.z),this},clamp:function(e,t){return this.x=ei(e.x,ai(t.x,this.x)),this.y=ei(e.y,ai(t.y,this.y)),this.z=ei(e.z,ai(t.z,this.z)),this},clampScalar:function(e,t){return this.x=ei(e,ai(t,this.x)),this.y=ei(e,ai(t,this.y)),this.z=ei(e,ai(t,this.z)),this},clampLength:function(e,t){var a=this.length();return this.divideScalar(a||1).multiplyScalar(ei(e,ai(t,a)))},floor:function(){return this.x=oi(this.x),this.y=oi(this.y),this.z=oi(this.z),this},ceil:function(){return this.x=Vn(this.x),this.y=Vn(this.y),this.z=Vn(this.z),this},round:function(){return this.x=Hn(this.x),this.y=Hn(this.y),this.z=Hn(this.z),this},roundToZero:function(){return this.x=0>this.x?Vn(this.x):oi(this.x),this.y=0>this.y?Vn(this.y):oi(this.y),this.z=0>this.z?Vn(this.z):oi(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Jn(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return ri(this.x)+ri(this.y)+ri(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,a){return this.subVectors(t,e).multiplyScalar(a).add(e)},cross:function(e,t){return void 0===t?this.crossVectors(this,e):(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t))},crossVectors:function(t,r){var o=t.x,n=t.y;t=t.z;var i=r.x,e=r.y;return r=r.z,this.x=n*r-t*e,this.y=t*i-o*r,this.z=o*e-n*i,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new s;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new s;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){return e=this.dot(e)/Jn(this.lengthSq()*e.lengthSq()),kn(ni.clamp(e,-1,1))},distanceTo:function(e){return Jn(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return e=this.z-e.z,t*t+r*r+e*e},manhattanDistanceTo:function(e){return ri(this.x-e.x)+ri(this.y-e.y)+ri(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,a){var r=Yn(t)*e;return this.x=r*Yn(a),this.y=ti(t)*e,this.z=r*ti(a),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,a){return this.x=e*Yn(t),this.y=a,this.z=e*ti(t),this},setFromMatrixPosition:function(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length();return e=this.setFromMatrixColumn(e,2).length(),this.x=t,this.y=r,this.z=e,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,a){return void 0!==a&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(y.prototype,{isMatrix3:!0,set:function(t,a,r,o,n,e,i,s,d){var l=this.elements;return l[0]=t,l[1]=o,l[2]=i,l[3]=a,l[4]=n,l[5]=s,l[6]=r,l[7]=e,l[8]=d,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this},setFromMatrix4:function(e){return e=e.elements,this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var e=new s;return function(t){for(var a=0,r=t.count;a<r;a++)e.x=t.getX(a),e.y=t.getY(a),e.z=t.getZ(a),e.applyMatrix3(this),t.setXYZ(a,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(o,i){var s=o.elements,y=i.elements;i=this.elements,o=s[0];var v=s[3],e=s[6],f=s[1],g=s[4],h=s[7],l=s[2],m=s[5];s=s[8];var _=y[0],p=y[3],n=y[6],t=y[1],r=y[4],u=y[7],T=y[2],S=y[5];return y=y[8],i[0]=o*_+v*t+e*T,i[3]=o*p+v*r+e*S,i[6]=o*n+v*u+e*y,i[1]=f*_+g*t+h*T,i[4]=f*p+g*r+h*S,i[7]=f*n+g*u+h*y,i[2]=l*_+m*t+s*T,i[5]=l*p+m*r+s*S,i[8]=l*n+m*u+s*y,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var t=this.elements,r=t[0],o=t[1],n=t[2],i=t[3],e=t[4],s=t[5],d=t[6],p=t[7];return t=t[8],r*e*t-r*s*p-o*i*t+o*s*d+n*i*p-n*e*d},getInverse:function(o,i){o&&o.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var s=o.elements;o=this.elements;var u=s[0],d=s[1],e=s[2],f=s[3],g=s[4],h=s[5],l=s[6],m=s[7];s=s[8];var y=s*g-h*m,p=h*l-s*f,n=m*f-g*l,t=u*y+d*p+e*n;if(0==t){if(!0===i)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0"),this.identity()}return i=1/t,o[0]=y*i,o[1]=(e*m-s*d)*i,o[2]=(h*d-e*g)*i,o[3]=p*i,o[4]=(s*u-e*l)*i,o[5]=(e*f-h*u)*i,o[6]=n*i,o[7]=(d*l-m*u)*i,o[8]=(g*u-d*f)*i,this},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(t,a,r,o,n,i,s){var l=ti(n);n=Yn(n),this.set(r*l,r*n,-r*(l*i+n*s)+i+t,-o*n,o*l,-o*(-n*i+l*s)+s+a,0,0,1)},scale:function(e,t){var a=this.elements;return a[0]*=e,a[3]*=e,a[6]*=e,a[1]*=t,a[4]*=t,a[7]*=t,this},rotate:function(t){var r=ti(t);t=Yn(t);var o=this.elements,n=o[0],i=o[3],e=o[6],s=o[1],d=o[4],p=o[7];return o[0]=r*n+t*s,o[3]=r*i+t*d,o[6]=r*e+t*p,o[1]=-t*n+r*s,o[4]=-t*i+r*d,o[7]=-t*e+r*p,this},translate:function(e,t){var a=this.elements;return a[0]+=e*a[2],a[3]+=e*a[5],a[6]+=e*a[8],a[1]+=t*a[2],a[4]+=t*a[5],a[7]+=t*a[8],this},equals:function(e){var t=this.elements;e=e.elements;for(var r=0;9>r;r++)if(t[r]!==e[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var a=0;9>a;a++)this.elements[a]=e[a+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}});var O={getDataURL:function(e){if("undefined"==typeof HTMLCanvasElement)return e.src;if(!(e instanceof HTMLCanvasElement)){void 0===si&&(si=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),si.width=e.width,si.height=e.height;var t=si.getContext("2d");e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),e=si}return 2048<e.width||2048<e.height?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},ii=0,si;r.DEFAULT_IMAGE=void 0,r.DEFAULT_MAPPING=300,r.prototype=Object.assign(Object.create(t.prototype),{constructor:r,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(t){var a=void 0===t||"string"==typeof t;if(!a&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var o=this.image;if(void 0===o.uuid&&(o.uuid=ni.generateUUID()),!a&&void 0===t.images[o.uuid]){if(Array.isArray(o))for(var n=[],i=0,s=o.length;i<s;i++)n.push(O.getDataURL(o[i]));else n=O.getDataURL(o);t.images[o.uuid]={uuid:o.uuid,url:n}}r.image=o.uuid}return a||(t.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),0>e.x||1<e.x)switch(this.wrapS){case 1E3:e.x-=oi(e.x);break;case 1001:e.x=0>e.x?0:1;break;case 1002:e.x=1===ri(oi(e.x)%2)?Vn(e.x)-e.x:e.x-oi(e.x);}if(0>e.y||1<e.y)switch(this.wrapT){case 1E3:e.y-=oi(e.y);break;case 1001:e.y=0>e.y?0:1;break;case 1002:e.y=1===ri(oi(e.y)%2)?Vn(e.y)-e.y:e.y-oi(e.y);}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(r.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(_.prototype,{isVector4:!0,set:function(e,t,a,r){return this.x=e,this.y=t,this.z=a,this.w=r,this},setScalar:function(e){return this.w=this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e);}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0===e.w?1:e.w,this},add:function(e,t){return void 0===t?(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this):(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t))},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0===t?(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this):(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t))},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(t){var r=this.x,o=this.y,n=this.z,i=this.w;return t=t.elements,this.x=t[0]*r+t[4]*o+t[8]*n+t[12]*i,this.y=t[1]*r+t[5]*o+t[9]*n+t[13]*i,this.z=t[2]*r+t[6]*o+t[10]*n+t[14]*i,this.w=t[3]*r+t[7]*o+t[11]*n+t[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*kn(e.w);var t=Jn(1-e.w*e.w);return 1E-4>t?(this.x=1,this.z=this.y=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(t){t=t.elements;var r=t[0],o=t[4],n=t[8],i=t[1],e=t[5],s=t[9],p=t[2],u=t[6],y=t[10];return .01>ri(o-i)&&.01>ri(n-p)&&.01>ri(s-u)?.1>ri(o+i)&&.1>ri(n+p)&&.1>ri(s+u)&&.1>ri(r+e+y-3)?(this.set(1,0,0,0),this):(t=Zn,r=(r+1)/2,e=(e+1)/2,y=(y+1)/2,o=(o+i)/4,n=(n+p)/4,s=(s+u)/4,r>e&&r>y?.01>r?(u=0,o=p=.707106781):(u=Jn(r),p=o/u,o=n/u):e>y?.01>e?(u=.707106781,p=0,o=.707106781):(p=Jn(e),u=o/p,o=s/p):.01>y?(p=u=.707106781,o=0):(o=Jn(y),u=n/o,p=s/o),this.set(u,p,o,t),this):(t=Jn((u-s)*(u-s)+(n-p)*(n-p)+(i-o)*(i-o)),.001>ri(t)&&(t=1),this.x=(u-s)/t,this.y=(n-p)/t,this.z=(i-o)/t,this.w=kn((r+e+y-1)/2),this)},min:function(e){return this.x=ai(this.x,e.x),this.y=ai(this.y,e.y),this.z=ai(this.z,e.z),this.w=ai(this.w,e.w),this},max:function(e){return this.x=ei(this.x,e.x),this.y=ei(this.y,e.y),this.z=ei(this.z,e.z),this.w=ei(this.w,e.w),this},clamp:function(e,t){return this.x=ei(e.x,ai(t.x,this.x)),this.y=ei(e.y,ai(t.y,this.y)),this.z=ei(e.z,ai(t.z,this.z)),this.w=ei(e.w,ai(t.w,this.w)),this},clampScalar:function(){var e,t;return function(a,r){return void 0===e&&(e=new _,t=new _),e.set(a,a,a,a),t.set(r,r,r,r),this.clamp(e,t)}}(),clampLength:function(e,t){var a=this.length();return this.divideScalar(a||1).multiplyScalar(ei(e,ai(t,a)))},floor:function(){return this.x=oi(this.x),this.y=oi(this.y),this.z=oi(this.z),this.w=oi(this.w),this},ceil:function(){return this.x=Vn(this.x),this.y=Vn(this.y),this.z=Vn(this.z),this.w=Vn(this.w),this},round:function(){return this.x=Hn(this.x),this.y=Hn(this.y),this.z=Hn(this.z),this.w=Hn(this.w),this},roundToZero:function(){return this.x=0>this.x?Vn(this.x):oi(this.x),this.y=0>this.y?Vn(this.y):oi(this.y),this.z=0>this.z?Vn(this.z):oi(this.z),this.w=0>this.w?Vn(this.w):oi(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Jn(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return ri(this.x)+ri(this.y)+ri(this.z)+ri(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,a){return this.subVectors(t,e).multiplyScalar(a).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,a){return void 0!==a&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),l.prototype=Object.assign(Object.create(t.prototype),{constructor:l,isWebGLRenderTarget:!0,setSize:function(e,t){(this.width!==e||this.height!==t)&&(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),a.prototype=Object.assign(Object.create(l.prototype),{constructor:a,isWebGLMultisampleRenderTarget:!0,copy:function(e){return l.prototype.copy.call(this,e),this.samples=e.samples,this}}),n.prototype=Object.create(l.prototype),n.prototype.constructor=n,n.prototype.isWebGLRenderTargetCube=!0,p.prototype=Object.create(r.prototype),p.prototype.constructor=p,p.prototype.isDataTexture=!0,Object.assign(u.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(t){for(var a=1/0,r=1/0,o=1/0,n=-Infinity,i=-Infinity,s=-Infinity,u=0,y=t.length;u<y;u+=3){var l=t[u],m=t[u+1],x=t[u+2];l<a&&(a=l),m<r&&(r=m),x<o&&(o=x),l>n&&(n=l),m>i&&(i=m),x>s&&(s=x)}return this.min.set(a,r,o),this.max.set(n,i,s),this},setFromBufferAttribute:function(t){for(var a=1/0,r=1/0,o=1/0,n=-Infinity,i=-Infinity,s=-Infinity,u=0,y=t.count;u<y;u++){var l=t.getX(u),m=t.getY(u),x=t.getZ(u);l<a&&(a=l),m<r&&(r=m),x<o&&(o=x),l>n&&(n=l),m>i&&(i=m),x>s&&(s=x)}return this.min.set(a,r,o),this.max.set(n,i,s),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,a=e.length;t<a;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new s;return function(t,a){return a=e.copy(a).multiplyScalar(.5),this.min.copy(t).sub(a),this.max.copy(t).add(a),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new s),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new s),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){function t(t){var a=t.geometry;if(void 0!==a)if(a.isGeometry)for(a=a.vertices,o=0,n=a.length;o<n;o++)r.copy(a[o]),r.applyMatrix4(t.matrixWorld),e.expandByPoint(r);else if(a.isBufferGeometry&&(a=a.attributes.position,void 0!==a))for(o=0,n=a.count;o<n;o++)r.fromBufferAttribute(a,o).applyMatrix4(t.matrixWorld),e.expandByPoint(r)}var r=new s,e,o,n;return function(a){return e=this,a.updateMatrixWorld(!0),a.traverse(t),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new s),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(){var e=new s;return function(t){return this.clampPoint(t.center,e),e.distanceToSquared(t.center)<=t.radius*t.radius}}(),intersectsPlane:function(e){if(0<e.normal.x)var t=e.normal.x*this.min.x,a=e.normal.x*this.max.x;else t=e.normal.x*this.max.x,a=e.normal.x*this.min.x;return 0<e.normal.y?(t+=e.normal.y*this.min.y,a+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,a+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,a+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,a+=e.normal.z*this.min.z),t<=-e.constant&&a>=-e.constant},intersectsTriangle:function(){function t(t){var a=0,i;for(i=t.length-3;a<=i;a+=3){d.fromArray(t,a);var s=c.x*ri(d.x)+c.y*ri(d.y)+c.z*ri(d.z),p=r.dot(d),l=o.dot(d),u=n.dot(d);if(ei(-ei(p,l,u),ai(p,l,u))>s)return!1}return!0}var r=new s,o=new s,n=new s,a=new s,e=new s,i=new s,d=new s,p=new s,c=new s,l=new s;return function(s){return!this.isEmpty()&&(this.getCenter(p),c.subVectors(this.max,p),r.subVectors(s.a,p),o.subVectors(s.b,p),n.subVectors(s.c,p),a.subVectors(o,r),e.subVectors(n,o),i.subVectors(r,n),s=[0,-a.z,a.y,0,-e.z,e.y,0,-i.z,i.y,a.z,0,-a.x,e.z,0,-e.x,i.z,0,-i.x,-a.y,a.x,0,-e.y,e.x,0,-i.y,i.x,0],!!t(s))&&(s=[1,0,0,0,1,0,0,0,1],!!t(s))&&(l.crossVectors(a,e),s=[l.x,l.y,l.z],t(s))}}(),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new s),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new s;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new s;return function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new s,new s,new s,new s,new s,new s,new s,new s];return function(t){return this.isEmpty()?this:(e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(e),this)}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(S.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var t=new u;return function(a,r){var o=this.center;void 0===r?t.setFromPoints(a).getCenter(o):o.copy(r);for(var n=r=0,i=a.length;n<i;n++)r=ei(r,o.distanceToSquared(a[n]));return this.radius=Jn(r),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return ri(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var a=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new s),t.copy(e),a>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new u),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius*=e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(x.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,a,r){return this.normal.set(e,t,a),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new s,a=new s;return function(r,o,n){return o=t.subVectors(n,o).cross(a.subVectors(r,o)).normalize(),this.setFromNormalAndCoplanarPoint(o,r),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new s),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var t=new s;return function(a,r){void 0===r&&(console.warn("THREE.Plane: .intersectLine() target is now required"),r=new s);var o=a.delta(t),n=this.normal.dot(o);if(0===n){if(0===this.distanceToPoint(a.start))return r.copy(a.start);}else if(n=-(a.start.dot(this.normal)+this.constant)/n,!(0>n||1<n))return r.copy(o).multiplyScalar(n).add(a.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start);return e=this.distanceToPoint(e.end),0>t&&0<e||0>e&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new s),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new s,t=new y;return function(a,r){return r=r||t.getNormalMatrix(a),a=this.coplanarPoint(e).applyMatrix4(a),r=this.normal.applyMatrix3(r).normalize(),this.constant=-a.dot(r),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(C.prototype,{set:function(t,a,r,o,n,e){var i=this.planes;return i[0].copy(t),i[1].copy(a),i[2].copy(r),i[3].copy(o),i[4].copy(n),i[5].copy(e),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){for(var t=this.planes,a=0;6>a;a++)t[a].copy(e.planes[a]);return this},setFromMatrix:function(o){var i=this.planes,s=o.elements;o=s[0];var y=s[1],d=s[2],e=s[3],f=s[4],g=s[5],h=s[6],l=s[7],m=s[8],x=s[9],p=s[10],n=s[11],t=s[12],r=s[13],u=s[14];return s=s[15],i[0].setComponents(e-o,l-f,n-m,s-t).normalize(),i[1].setComponents(e+o,l+f,n+m,s+t).normalize(),i[2].setComponents(e+y,l+g,n+x,s+r).normalize(),i[3].setComponents(e-y,l-g,n-x,s-r).normalize(),i[4].setComponents(e-d,l-h,n-p,s-u).normalize(),i[5].setComponents(e+d,l+h,n+p,s+u).normalize(),this},intersectsObject:function(){var e=new S;return function(t){var a=t.geometry;return null===a.boundingSphere&&a.computeBoundingSphere(),e.copy(a.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSprite:function(){var e=new S;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){var t=this.planes,r=e.center;e=-e.radius;for(var o=0;6>o;o++)if(t[o].distanceToPoint(r)<e)return!1;return!0},intersectsBox:function(){var t=new s;return function(a){for(var r=this.planes,o=0,n;6>o;o++)if(n=r[o],t.x=0<n.normal.x?a.max.x:a.min.x,t.y=0<n.normal.y?a.max.y:a.min.y,t.z=0<n.normal.z?a.max.z:a.min.z,0>n.distanceToPoint(t))return!1;return!0}}(),containsPoint:function(e){for(var t=this.planes,a=0;6>a;a++)if(0>t[a].distanceToPoint(e))return!1;return!0}}),Object.assign(W.prototype,{isMatrix4:!0,set:function(o,a,i,s,d,e,c,f,g,l,m,h,p,n,t,r){var u=this.elements;return u[0]=o,u[4]=a,u[8]=i,u[12]=s,u[1]=d,u[5]=e,u[9]=c,u[13]=f,u[2]=g,u[6]=l,u[10]=m,u[14]=h,u[3]=p,u[7]=n,u[11]=t,u[15]=r,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new W().fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this},copyPosition:function(e){var t=this.elements;return e=e.elements,t[12]=e[12],t[13]=e[13],t[14]=e[14],this},extractBasis:function(e,t,a){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),a.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,a){return this.set(e.x,t.x,a.x,0,e.y,t.y,a.y,0,e.z,t.z,a.z,0,0,0,0,1),this},extractRotation:function(){var t=new s;return function(a){var r=this.elements,o=a.elements,n=1/t.setFromMatrixColumn(a,0).length(),e=1/t.setFromMatrixColumn(a,1).length();return a=1/t.setFromMatrixColumn(a,2).length(),r[0]=o[0]*n,r[1]=o[1]*n,r[2]=o[2]*n,r[3]=0,r[4]=o[4]*e,r[5]=o[5]*e,r[6]=o[6]*e,r[7]=0,r[8]=o[8]*a,r[9]=o[9]*a,r[10]=o[10]*a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var r=this.elements,o=t.x,n=t.y,i=t.z,s=ti(o);o=Yn(o);var p=ti(n);n=Yn(n);var u=ti(i);if(i=Yn(i),"XYZ"===t.order){t=s*u;var f=s*i,g=o*u,h=o*i;r[0]=p*u,r[4]=-p*i,r[8]=n,r[1]=f+g*n,r[5]=t-h*n,r[9]=-o*p,r[2]=h-t*n,r[6]=g+f*n,r[10]=s*p}else"YXZ"===t.order?(t=p*u,f=p*i,g=n*u,h=n*i,r[0]=t+h*o,r[4]=g*o-f,r[8]=s*n,r[1]=s*i,r[5]=s*u,r[9]=-o,r[2]=f*o-g,r[6]=h+t*o,r[10]=s*p):"ZXY"===t.order?(t=p*u,f=p*i,g=n*u,h=n*i,r[0]=t-h*o,r[4]=-s*i,r[8]=g+f*o,r[1]=f+g*o,r[5]=s*u,r[9]=h-t*o,r[2]=-s*n,r[6]=o,r[10]=s*p):"ZYX"===t.order?(t=s*u,f=s*i,g=o*u,h=o*i,r[0]=p*u,r[4]=g*n-f,r[8]=t*n+h,r[1]=p*i,r[5]=h*n+t,r[9]=f*n-g,r[2]=-n,r[6]=o*p,r[10]=s*p):"YZX"===t.order?(t=s*p,f=s*n,g=o*p,h=o*n,r[0]=p*u,r[4]=h-t*i,r[8]=g*i+f,r[1]=i,r[5]=s*u,r[9]=-o*u,r[2]=-n*u,r[6]=f*i+g,r[10]=t-h*i):"XZY"===t.order&&(t=s*p,f=s*n,g=o*p,h=o*n,r[0]=p*u,r[4]=-i,r[8]=n*u,r[1]=t*i+h,r[5]=s*u,r[9]=f*i-g,r[2]=g*i-f,r[6]=o*u,r[10]=h*i+t);return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},makeRotationFromQuaternion:function(){var e=new s(0,0,0),t=new s(1,1,1);return function(a){return this.compose(e,a,t)}}(),lookAt:function(){var t=new s,a=new s,r=new s;return function(o,n,e){var i=this.elements;return r.subVectors(o,n),0===r.lengthSq()&&(r.z=1),r.normalize(),t.crossVectors(e,r),0===t.lengthSq()&&(1===ri(e.z)?r.x+=1E-4:r.z+=1E-4,r.normalize(),t.crossVectors(e,r)),t.normalize(),a.crossVectors(r,t),i[0]=t.x,i[4]=a.x,i[8]=r.x,i[1]=t.y,i[5]=a.y,i[9]=r.y,i[2]=t.z,i[6]=a.z,i[10]=r.z,this}}(),multiply:function(e,t){return void 0===t?this.multiplyMatrices(this,e):(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t))},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(o,i){var s=o.elements,v=i.elements;i=this.elements,o=s[0];var _=s[4],e=s[8],f=s[12],g=s[1],h=s[5],l=s[9],m=s[13],T=s[2],p=s[6],n=s[10],t=s[14],r=s[3],u=s[7],w=s[11];s=s[15];var P=v[0],x=v[4],y=v[8],L=v[12],R=v[1],C=v[5],F=v[9],I=v[13],A=v[2],N=v[6],E=v[10],D=v[14],B=v[3],U=v[7],M=v[11];return v=v[15],i[0]=o*P+_*R+e*A+f*B,i[4]=o*x+_*C+e*N+f*U,i[8]=o*y+_*F+e*E+f*M,i[12]=o*L+_*I+e*D+f*v,i[1]=g*P+h*R+l*A+m*B,i[5]=g*x+h*C+l*N+m*U,i[9]=g*y+h*F+l*E+m*M,i[13]=g*L+h*I+l*D+m*v,i[2]=T*P+p*R+n*A+t*B,i[6]=T*x+p*C+n*N+t*U,i[10]=T*y+p*F+n*E+t*M,i[14]=T*L+p*I+n*D+t*v,i[3]=r*P+u*R+w*A+s*B,i[7]=r*x+u*C+w*N+s*U,i[11]=r*y+u*F+w*E+s*M,i[15]=r*L+u*I+w*D+s*v,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new s;return function(t){for(var a=0,r=t.count;a<r;a++)e.x=t.getX(a),e.y=t.getY(a),e.z=t.getZ(a),e.applyMatrix4(this),t.setXYZ(a,e.x,e.y,e.z);return t}}(),determinant:function(){var t=this.elements,a=t[0],r=t[4],o=t[8],i=t[12],e=t[1],s=t[5],d=t[9],c=t[13],l=t[2],u=t[6],m=t[10],p=t[14];return t[3]*(+i*d*u-o*c*u-i*s*m+r*c*m+o*s*p-r*d*p)+t[7]*(+a*d*p-a*c*m+i*e*m-o*e*p+o*c*l-i*d*l)+t[11]*(+a*c*u-a*s*p-i*e*u+r*e*p+i*s*l-r*c*l)+t[15]*(-o*s*l-a*d*u+a*s*m+o*e*u-r*e*m+r*d*l)},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(o,i){var s=this.elements,c=o.elements;o=c[0];var v=c[1],e=c[2],f=c[3],g=c[4],h=c[5],l=c[6],m=c[7],_=c[8],p=c[9],n=c[10],t=c[11],r=c[12],u=c[13],T=c[14];c=c[15];var S=p*T*m-u*n*m+u*l*t-h*T*t-p*l*c+h*n*c,x=r*n*m-_*T*m-r*l*t+g*T*t+_*l*c-g*n*c,y=_*u*m-r*p*m+r*h*t-g*u*t-_*h*c+g*p*c,E=r*p*l-_*u*l-r*h*n+g*u*n+_*h*T-g*p*T,w=o*S+v*x+e*y+f*E;if(0==w){if(!0===i)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0"),this.identity()}return i=1/w,s[0]=S*i,s[1]=(u*n*f-p*T*f-u*e*t+v*T*t+p*e*c-v*n*c)*i,s[2]=(h*T*f-u*l*f+u*e*m-v*T*m-h*e*c+v*l*c)*i,s[3]=(p*l*f-h*n*f-p*e*m+v*n*m+h*e*t-v*l*t)*i,s[4]=x*i,s[5]=(_*T*f-r*n*f+r*e*t-o*T*t-_*e*c+o*n*c)*i,s[6]=(r*l*f-g*T*f-r*e*m+o*T*m+g*e*c-o*l*c)*i,s[7]=(g*n*f-_*l*f+_*e*m-o*n*m-g*e*t+o*l*t)*i,s[8]=y*i,s[9]=(r*p*f-_*u*f-r*v*t+o*u*t+_*v*c-o*p*c)*i,s[10]=(g*u*f-r*h*f+r*v*m-o*u*m-g*v*c+o*h*c)*i,s[11]=(_*h*f-g*p*f-_*v*m+o*p*m+g*v*t-o*h*t)*i,s[12]=E*i,s[13]=(_*u*e-r*p*e+r*v*n-o*u*n-_*v*T+o*p*T)*i,s[14]=(r*h*e-g*u*e-r*v*l+o*u*l+g*v*T-o*h*T)*i,s[15]=(g*p*e-_*h*e+_*v*l-o*p*l-g*v*n+o*h*n)*i,this},scale:function(e){var t=this.elements,r=e.x,o=e.y;return e=e.z,t[0]*=r,t[4]*=o,t[8]*=e,t[1]*=r,t[5]*=o,t[9]*=e,t[2]*=r,t[6]*=o,t[10]*=e,t[3]*=r,t[7]*=o,t[11]*=e,this},getMaxScaleOnAxis:function(){var e=this.elements;return Jn(ei(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))},makeTranslation:function(e,t,a){return this.set(1,0,0,e,0,1,0,t,0,0,1,a,0,0,0,1),this},makeRotationX:function(e){var t=ti(e);return e=Yn(e),this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this},makeRotationY:function(e){var t=ti(e);return e=Yn(e),this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=ti(e);return e=Yn(e),this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,r){var o=ti(r);r=Yn(r);var n=1-o,i=t.x,e=t.y;t=t.z;var s=n*i,l=n*e;return this.set(s*i+o,s*e-r*t,s*t+r*e,0,s*e+r*t,l*e+o,l*t-r*i,0,s*t-r*e,l*t+r*i,n*t*t+o,0,0,0,0,1),this},makeScale:function(e,t,a){return this.set(e,0,0,0,0,t,0,0,0,0,a,0,0,0,0,1),this},makeShear:function(e,t,a){return this.set(1,t,a,0,e,1,a,0,e,t,1,0,0,0,0,1),this},compose:function(r,a,o){var i=this.elements,s=a._x,d=a._y,u=a._z,y=a._w,x=s+s,v=d+d,_=u+u;a=s*x;var T=s*v;s*=_;var p=d*v;d*=_,u*=_,x*=y,v*=y,y*=_,_=o.x;var n=o.y;return o=o.z,i[0]=(1-(p+u))*_,i[1]=(T+y)*_,i[2]=(s-v)*_,i[3]=0,i[4]=(T-y)*n,i[5]=(1-(a+u))*n,i[6]=(d+x)*n,i[7]=0,i[8]=(s+v)*o,i[9]=(d-x)*o,i[10]=(1-(a+p))*o,i[11]=0,i[12]=r.x,i[13]=r.y,i[14]=r.z,i[15]=1,this},decompose:function(){var t=new s,a=new W;return function(r,o,n){var e=this.elements,i=t.set(e[0],e[1],e[2]).length(),s=t.set(e[4],e[5],e[6]).length(),d=t.set(e[8],e[9],e[10]).length();0>this.determinant()&&(i=-i),r.x=e[12],r.y=e[13],r.z=e[14],a.copy(this),r=1/i,e=1/s;var l=1/d;return a.elements[0]*=r,a.elements[1]*=r,a.elements[2]*=r,a.elements[4]*=e,a.elements[5]*=e,a.elements[6]*=e,a.elements[8]*=l,a.elements[9]*=l,a.elements[10]*=l,o.setFromRotationMatrix(a),n.x=i,n.y=s,n.z=d,this}}(),makePerspective:function(t,a,r,o,n,e){void 0===e&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var i=this.elements;return i[0]=2*n/(a-t),i[4]=0,i[8]=(a+t)/(a-t),i[12]=0,i[1]=0,i[5]=2*n/(r-o),i[9]=(r+o)/(r-o),i[13]=0,i[2]=0,i[6]=0,i[10]=-(e+n)/(e-n),i[14]=-2*e*n/(e-n),i[3]=0,i[7]=0,i[11]=-1,i[15]=0,this},makeOrthographic:function(t,a,r,o,n,e){var i=this.elements,s=1/(a-t),d=1/(r-o),l=1/(e-n);return i[0]=2*s,i[4]=0,i[8]=0,i[12]=-((a+t)*s),i[1]=0,i[5]=2*d,i[9]=0,i[13]=-((r+o)*d),i[2]=0,i[6]=0,i[10]=-2*l,i[14]=-((e+n)*l),i[3]=0,i[7]=0,i[11]=0,i[15]=1,this},equals:function(e){var t=this.elements;e=e.elements;for(var r=0;16>r;r++)if(t[r]!==e[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var a=0;16>a;a++)this.elements[a]=e[a+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}});var li={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick( specularColor, dotNV );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#endif\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\t\tvec3 diffuse = material.diffuseColor;\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\t#else\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#endif\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\t#ifdef USE_TANGENT\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy = normalScale * mapN.xy;\n\t\t\tnormal = normalize( vTBN * mapN );\n\t\t#else\n\t\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t\t#endif\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#if defined( DITHERING )\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},R={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(w.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.b=this.g=this.r=e,this},setHex:function(e){return e=oi(e),this.r=(255&e>>16)/255,this.g=(255&e>>8)/255,this.b=(255&e)/255,this},setRGB:function(e,t,a){return this.r=e,this.g=t,this.b=a,this},setHSL:function(){function e(e,t,a){return 0>a&&(a+=1),1<a&&--a,a<1/6?e+6*(t-e)*a:.5>a?t:a<2/3?e+6*(t-e)*(2/3-a):e}return function(t,a,r){return t=ni.euclideanModulo(t,1),a=ni.clamp(a,0,1),r=ni.clamp(r,0,1),0===a?this.r=this.g=this.b=r:(a=.5>=r?r*(1+a):r+a-r*a,r=2*r-a,this.r=e(r,a,t+1/3),this.g=e(r,a,t),this.b=e(r,a,t-1/3)),this}}(),setStyle:function(t){function a(e){void 0!==e&&1>parseFloat(e)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var o=r[2];switch(r[1]){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=ai(255,parseInt(r[1],10))/255,this.g=ai(255,parseInt(r[2],10))/255,this.b=ai(255,parseInt(r[3],10))/255,a(r[5]),this;if(r=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=ai(100,parseInt(r[1],10))/100,this.g=ai(100,parseInt(r[2],10))/100,this.b=ai(100,parseInt(r[3],10))/100,a(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){o=parseFloat(r[1])/360;var n=parseInt(r[2],10)/100,e=parseInt(r[3],10)/100;return a(r[5]),this.setHSL(o,n,e)}}}else if(r=/^#([A-Fa-f0-9]+)$/.exec(t)){if(r=r[1],o=r.length,3===o)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,this;if(6===o)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,this}return t&&0<t.length&&(r=R[t],void 0===r?console.warn("THREE.Color: Unknown color "+t):this.setHex(r)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=qn(e.r,t),this.g=qn(e.g,t),this.b=qn(e.b,t),this},copyLinearToGamma:function(e,t){return void 0===t&&(t=2),t=0<t?1/t:1,this.r=qn(e.r,t),this.g=qn(e.g,t),this.b=qn(e.b,t),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(){function e(e){return .04045>e?.0773993808*e:qn(.9478672986*e+.0521327014,2.4)}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),copyLinearToSRGB:function(){function e(e){return .0031308>e?12.92*e:1.055*qn(e,.41666)-.055}return function(t){return this.r=e(t.r),this.g=e(t.g),this.b=e(t.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var r=this.r,o=this.g,n=this.b,i=ei(r,o,n),e=ai(r,o,n),s=(e+i)/2,d;if(e===i)e=d=0;else{var p=i-e;e=.5>=s?p/(i+e):p/(2-i-e),i===r?d=(o-n)/p+(o<n?6:0):i===o?d=(n-r)/p+2:i===n?d=(r-o)/p+4:void 0,d/=6}return t.h=d,t.s=e,t.l=s,t},getStyle:function(){return"rgb("+(0|255*this.r)+","+(0|255*this.g)+","+(0|255*this.b)+")"},offsetHSL:function(){var e={};return function(t,a,r){return this.getHSL(e),e.h+=t,e.s+=a,e.l+=r,this.setHSL(e.h,e.s,e.l),this}}(),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=ei(0,this.r-e.r),this.g=ei(0,this.g-e.g),this.b=ei(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(){var t={h:0,s:0,l:0},a={h:0,s:0,l:0};return function(r,o){this.getHSL(t),r.getHSL(a),r=ni.lerp(t.h,a.h,o);var n=ni.lerp(t.s,a.s,o);return o=ni.lerp(t.l,a.l,o),this.setHSL(r,n,o),this}}(),equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var di={common:{diffuse:{value:new w(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new y},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new o(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new w(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new w(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new y}},sprite:{diffuse:{value:new w(15658734)},opacity:{value:1},center:{value:new o(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new y}}},J={basic:{uniforms:d([di.common,di.specularmap,di.envmap,di.aomap,di.lightmap,di.fog]),vertexShader:li.meshbasic_vert,fragmentShader:li.meshbasic_frag},lambert:{uniforms:d([di.common,di.specularmap,di.envmap,di.aomap,di.lightmap,di.emissivemap,di.fog,di.lights,{emissive:{value:new w(0)}}]),vertexShader:li.meshlambert_vert,fragmentShader:li.meshlambert_frag},phong:{uniforms:d([di.common,di.specularmap,di.envmap,di.aomap,di.lightmap,di.emissivemap,di.bumpmap,di.normalmap,di.displacementmap,di.gradientmap,di.fog,di.lights,{emissive:{value:new w(0)},specular:{value:new w(1118481)},shininess:{value:30}}]),vertexShader:li.meshphong_vert,fragmentShader:li.meshphong_frag},standard:{uniforms:d([di.common,di.envmap,di.aomap,di.lightmap,di.emissivemap,di.bumpmap,di.normalmap,di.displacementmap,di.roughnessmap,di.metalnessmap,di.fog,di.lights,{emissive:{value:new w(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:li.meshphysical_vert,fragmentShader:li.meshphysical_frag},matcap:{uniforms:d([di.common,di.bumpmap,di.normalmap,di.displacementmap,di.fog,{matcap:{value:null}}]),vertexShader:li.meshmatcap_vert,fragmentShader:li.meshmatcap_frag},points:{uniforms:d([di.points,di.fog]),vertexShader:li.points_vert,fragmentShader:li.points_frag},dashed:{uniforms:d([di.common,di.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:li.linedashed_vert,fragmentShader:li.linedashed_frag},depth:{uniforms:d([di.common,di.displacementmap]),vertexShader:li.depth_vert,fragmentShader:li.depth_frag},normal:{uniforms:d([di.common,di.bumpmap,di.normalmap,di.displacementmap,{opacity:{value:1}}]),vertexShader:li.normal_vert,fragmentShader:li.normal_frag},sprite:{uniforms:d([di.sprite,di.fog]),vertexShader:li.sprite_vert,fragmentShader:li.sprite_frag},background:{uniforms:{uvTransform:{value:new y},t2D:{value:null}},vertexShader:li.background_vert,fragmentShader:li.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:li.cube_vert,fragmentShader:li.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:li.equirect_vert,fragmentShader:li.equirect_frag},distanceRGBA:{uniforms:d([di.common,di.displacementmap,{referencePosition:{value:new s},nearDistance:{value:1},farDistance:{value:1E3}}]),vertexShader:li.distanceRGBA_vert,fragmentShader:li.distanceRGBA_frag},shadow:{uniforms:d([di.lights,di.fog,{color:{value:new w(0)},opacity:{value:1}}]),vertexShader:li.shadow_vert,fragmentShader:li.shadow_frag}};J.physical={uniforms:d([J.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:li.meshphysical_vert,fragmentShader:li.meshphysical_frag},Object.assign(L.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,a=e.vertexNormals.length;t<a;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,a=e.vertexColors.length;t<a;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}),m.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],m.DefaultOrder="XYZ",Object.defineProperties(m.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(m.prototype,{isEuler:!0,set:function(e,t,a,r){return this._x=e,this._y=t,this._z=a,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,r,o){var n=Math.asin,i=ni.clamp,s=t.elements;t=s[0];var d=s[4],c=s[8],u=s[1],f=s[5],l=s[9],m=s[2],g=s[6];return s=s[10],r=r||this._order,"XYZ"===r?(this._y=n(i(c,-1,1)),.99999>ri(c)?(this._x=Qn(-l,s),this._z=Qn(-d,t)):(this._x=Qn(g,f),this._z=0)):"YXZ"===r?(this._x=n(-i(l,-1,1)),.99999>ri(l)?(this._y=Qn(c,s),this._z=Qn(u,f)):(this._y=Qn(-m,t),this._z=0)):"ZXY"===r?(this._x=n(i(g,-1,1)),.99999>ri(g)?(this._y=Qn(-m,s),this._z=Qn(-d,f)):(this._y=0,this._z=Qn(u,t))):"ZYX"===r?(this._y=n(-i(m,-1,1)),.99999>ri(m)?(this._x=Qn(g,s),this._z=Qn(u,t)):(this._x=0,this._z=Qn(-d,f))):"YZX"===r?(this._z=n(i(u,-1,1)),.99999>ri(u)?(this._x=Qn(-l,f),this._y=Qn(-m,t)):(this._x=0,this._y=Qn(c,s))):"XZY"===r?(this._z=n(-i(d,-1,1)),.99999>ri(d)?(this._x=Qn(g,f),this._y=Qn(c,t)):(this._x=Qn(-l,s),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+r),this._order=r,!1!==o&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new W;return function(t,a,r){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,a,r)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(){var e=new i;return function(t){return e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new s(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(f.prototype,{set:function(e){this.mask=0|1<<e},enable:function(e){this.mask=0|(this.mask|1<<e)},toggle:function(e){this.mask^=0|1<<e},disable:function(e){this.mask&=~(0|1<<e)},test:function(e){return 0!=(this.mask&e.mask)}});var Va=0;A.DefaultUp=new s(0,1,0),A.DefaultMatrixAutoUpdate=!0,A.prototype=Object.assign(Object.create(t.prototype),{constructor:A,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new i;return function(t,a){return e.setFromAxisAngle(t,a),this.quaternion.multiply(e),this}}(),rotateOnWorldAxis:function(){var e=new i;return function(t,a){return e.setFromAxisAngle(t,a),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new s(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new s(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new s(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new s;return function(t,a){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(a)),this}}(),translateX:function(){var e=new s(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new s(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new s(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new W;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new i,a=new W,r=new s,o=new s;return function(n,i,s){n.isVector3?r.copy(n):r.set(n,i,s),n=this.parent,this.updateWorldMatrix(!0,!1),o.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?a.lookAt(o,r,this.up):a.lookAt(r,o,this.up),this.quaternion.setFromRotationMatrix(a),n&&(a.extractRotation(n.matrixWorld),t.setFromRotationMatrix(a),this.quaternion.premultiply(t.inverse()))}}(),add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}return t=this.children.indexOf(e),-1!==t&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(t,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(t,a){if(this[t]===a)return this;for(var r=0,o=this.children.length,n;r<o;r++)if(n=this.children[r].getObjectByProperty(t,a),void 0!==n)return n},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new s),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var e=new s,t=new s;return function(a){return void 0===a&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),a=new i),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,a,t),a}}(),getWorldScale:function(){var e=new s,t=new i;return function(a){return void 0===a&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),a=new s),this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,a),a}}(),getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new s),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,a=0,r=t.length;a<r;a++)t[a].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,a=0,r=t.length;a<r;a++)t[a].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,r=0,o=t.length;r<o;r++)t[r].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(e=this.children,t=0,r=e.length;t<r;t++)e[t].updateWorldMatrix(!1,!0)},toJSON:function(t){function r(e,a){return void 0===e[a.uuid]&&(e[a.uuid]=a.toJSON(t)),a.uuid}function o(e){var t=[],a;for(a in e){var r=e[a];delete r.metadata,t.push(r)}return t}var n=void 0===t||"string"==typeof t,i={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var e={};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),!0===this.castShadow&&(e.castShadow=!0),!0===this.receiveShadow&&(e.receiveShadow=!0),!1===this.visible&&(e.visible=!1),!1===this.frustumCulled&&(e.frustumCulled=!1),0!==this.renderOrder&&(e.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(e.userData=this.userData),e.layers=this.layers.mask,e.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(e.matrixAutoUpdate=!1),this.isMesh&&0!==this.drawMode&&(e.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){e.geometry=r(t.geometries,this.geometry);var s=this.geometry.parameters;if(void 0!==s&&void 0!==s.shapes)if(s=s.shapes,Array.isArray(s))for(var p=0,c=s.length;p<c;p++)r(t.shapes,s[p]);else r(t.shapes,s)}if(void 0!==this.material)if(Array.isArray(this.material)){for(s=[],p=0,c=this.material.length;p<c;p++)s.push(r(t.materials,this.material[p]));e.material=s}else e.material=r(t.materials,this.material);if(0<this.children.length)for(e.children=[],p=0;p<this.children.length;p++)e.children.push(this.children[p].toJSON(t).object);if(n){n=o(t.geometries),p=o(t.materials),c=o(t.textures);var u=o(t.images);s=o(t.shapes),0<n.length&&(i.geometries=n),0<p.length&&(i.materials=p),0<c.length&&(i.textures=c),0<u.length&&(i.images=u),0<s.length&&(i.shapes=s)}return i.object=e,i},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(t=0;t<e.children.length;t++)this.add(e.children[t].clone());return this}});var pi=0;F.prototype=Object.assign(Object.create(t.prototype),{constructor:F,isGeometry:!0,applyMatrix:function(t){for(var r=new y().getNormalMatrix(t),o=0,n=this.vertices.length;o<n;o++)this.vertices[o].applyMatrix4(t);for(o=0,n=this.faces.length;o<n;o++){t=this.faces[o],t.normal.applyMatrix3(r).normalize();for(var i=0,s=t.vertexNormals.length;i<s;i++)t.vertexNormals[i].applyMatrix3(r).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(){var e=new W;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new W;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new W;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new W;return function(t,a,r){return e.makeTranslation(t,a,r),this.applyMatrix(e),this}}(),scale:function(){var e=new W;return function(t,a,r){return e.makeScale(t,a,r),this.applyMatrix(e),this}}(),lookAt:function(){var e=new A;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),fromBufferGeometry:function(r){function a(t,a,r,i){var d=void 0===g?[]:[n.colors[t].clone(),n.colors[a].clone(),n.colors[r].clone()],p=void 0===u?[]:[new s().fromArray(u,3*t),new s().fromArray(u,3*a),new s().fromArray(u,3*r)];i=new L(t,a,r,p,d,i),n.faces.push(i),void 0!==h&&n.faceVertexUvs[0].push([new o().fromArray(h,2*t),new o().fromArray(h,2*a),new o().fromArray(h,2*r)]),void 0!==l&&n.faceVertexUvs[1].push([new o().fromArray(l,2*t),new o().fromArray(l,2*a),new o().fromArray(l,2*r)])}var n=this,i=null===r.index?void 0:r.index.array,d=r.attributes,c=d.position.array,u=void 0===d.normal?void 0:d.normal.array,g=void 0===d.color?void 0:d.color.array,h=void 0===d.uv?void 0:d.uv.array,l=void 0===d.uv2?void 0:d.uv2.array;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var m=d=0;d<c.length;d+=3,m+=2)n.vertices.push(new s().fromArray(c,d)),void 0!==g&&n.colors.push(new w().fromArray(g,d));var y=r.groups;if(0<y.length)for(d=0;d<y.length;d++){c=y[d];var p=c.start,x=c.count;for(m=p,p+=x;m<p;m+=3)void 0===i?a(m,m+1,m+2,c.materialIndex):a(i[m],i[m+1],i[m+2],c.materialIndex)}else if(void 0!==i)for(d=0;d<i.length;d+=3)a(i[d],i[d+1],i[d+2]);else for(d=0;d<c.length/3;d+=3)a(d,d+1,d+2);return this.computeFaceNormals(),null!==r.boundingBox&&(this.boundingBox=r.boundingBox.clone()),null!==r.boundingSphere&&(this.boundingSphere=r.boundingSphere.clone()),this},center:function(){var e=new s;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius;t=0===t?1:1/t;var a=new W;return a.set(t,0,0,-t*e.x,0,t,0,-t*e.y,0,0,t,-t*e.z,0,0,0,1),this.applyMatrix(a),this},computeFaceNormals:function(){for(var t=new s,a=new s,r=0,o=this.faces.length;r<o;r++){var n=this.faces[r],e=this.vertices[n.a],i=this.vertices[n.b];t.subVectors(this.vertices[n.c],i),a.subVectors(e,i),t.cross(a),t.normalize(),n.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var r=Array(this.vertices.length),o=0,n;for(n=this.vertices.length;o<n;o++)r[o]=new s;if(t){var i=new s,e=new s;for(t=0,o=this.faces.length;t<o;t++){n=this.faces[t];var p=this.vertices[n.a],c=this.vertices[n.b],u=this.vertices[n.c];i.subVectors(u,c),e.subVectors(p,c),i.cross(e),r[n.a].add(i),r[n.b].add(i),r[n.c].add(i)}}else for(this.computeFaceNormals(),t=0,o=this.faces.length;t<o;t++)n=this.faces[t],r[n.a].add(n.normal),r[n.b].add(n.normal),r[n.c].add(n.normal);for(o=0,n=this.vertices.length;o<n;o++)r[o].normalize();for(t=0,o=this.faces.length;t<o;t++)n=this.faces[t],p=n.vertexNormals,3===p.length?(p[0].copy(r[n.a]),p[1].copy(r[n.b]),p[2].copy(r[n.c])):(p[0]=r[n.a].clone(),p[1]=r[n.b].clone(),p[2]=r[n.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e;this.computeFaceNormals();var t=0;for(e=this.faces.length;t<e;t++){var r=this.faces[t],o=r.vertexNormals;3===o.length?(o[0].copy(r.normal),o[1].copy(r.normal),o[2].copy(r.normal)):(o[0]=r.normal.clone(),o[1]=r.normal.clone(),o[2]=r.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t=0,r,o;for(o=this.faces.length;t<o;t++){var n=this.faces[t];n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]);var i=0;for(r=n.vertexNormals.length;i<r;i++)n.__originalVertexNormals[i]?n.__originalVertexNormals[i].copy(n.vertexNormals[i]):n.__originalVertexNormals[i]=n.vertexNormals[i].clone()}var p=new F;for(p.faces=this.faces,i=0,r=this.morphTargets.length;i<r;i++){if(!this.morphNormals[i]){this.morphNormals[i]={},this.morphNormals[i].faceNormals=[],this.morphNormals[i].vertexNormals=[],n=this.morphNormals[i].faceNormals;var u=this.morphNormals[i].vertexNormals;for(t=0,o=this.faces.length;t<o;t++){var m=new s,f={a:new s,b:new s,c:new s};n.push(m),u.push(f)}}for(u=this.morphNormals[i],p.vertices=this.morphTargets[i].vertices,p.computeFaceNormals(),p.computeVertexNormals(),t=0,o=this.faces.length;t<o;t++)n=this.faces[t],m=u.faceNormals[t],f=u.vertexNormals[t],m.copy(n.normal),f.a.copy(n.vertexNormals[0]),f.b.copy(n.vertexNormals[1]),f.c.copy(n.vertexNormals[2])}for(t=0,o=this.faces.length;t<o;t++)n=this.faces[t],n.normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new u),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new S),this.boundingSphere.setFromPoints(this.vertices)},merge:function(o,i,s){if(o&&o.isGeometry){var x=this.vertices.length,e=this.vertices,v=o.vertices,_=this.faces,h=o.faces,l=this.faceVertexUvs[0],m=o.faceVertexUvs[0],T=this.colors,S=o.colors,E;void 0===s&&(s=0),void 0!==i&&(E=new y().getNormalMatrix(i)),o=0;for(var w=v.length,A;o<w;o++)A=v[o].clone(),void 0!==i&&A.applyMatrix4(i),e.push(A);for(o=0,w=S.length;o<w;o++)T.push(S[o].clone());for(o=0,w=h.length;o<w;o++){v=h[o];var M=v.vertexNormals;for(S=v.vertexColors,T=new L(v.a+x,v.b+x,v.c+x),T.normal.copy(v.normal),void 0!==E&&T.normal.applyMatrix3(E).normalize(),i=0,e=M.length;i<e;i++)A=M[i].clone(),void 0!==E&&A.applyMatrix3(E).normalize(),T.vertexNormals.push(A);for(T.color.copy(v.color),i=0,e=S.length;i<e;i++)A=S[i],T.vertexColors.push(A.clone());T.materialIndex=v.materialIndex+s,_.push(T)}for(o=0,w=m.length;o<w;o++)if(s=m[o],E=[],void 0!==s){for(i=0,e=s.length;i<e;i++)E.push(s[i].clone());l.push(E)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",o)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var t={},r=[],o=[],n=qn(10,4),i=0,s;for(s=this.vertices.length;i<s;i++){var l=this.vertices[i];l=Hn(l.x*n)+"_"+Hn(l.y*n)+"_"+Hn(l.z*n),void 0===t[l]?(t[l]=i,r.push(this.vertices[i]),o[i]=r.length-1):o[i]=o[t[l]]}for(t=[],i=0,s=this.faces.length;i<s;i++)for(n=this.faces[i],n.a=o[n.a],n.b=o[n.b],n.c=o[n.c],n=[n.a,n.b,n.c],l=0;3>l;l++)if(n[l]===n[(l+1)%3]){t.push(i);break}for(i=t.length-1;0<=i;i--)for(n=t[i],this.faces.splice(n,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(n,1);return i=this.vertices.length-r.length,this.vertices=r,i},setFromPoints:function(e){this.vertices=[];for(var t=0,a=e.length,r;t<a;t++)r=e[t],this.vertices.push(new s(r.x,r.y,r.z||0));return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,a=t.length,r=0;r<a;r++)t[r]._id=r;t.sort(function(e,t){return e.materialIndex-t.materialIndex});var o=this.faceVertexUvs[0],n=this.faceVertexUvs[1],e,i;for(o&&o.length===a&&(e=[]),n&&n.length===a&&(i=[]),r=0;r<a;r++){var s=t[r]._id;e&&e.push(o[s]),i&&i.push(n[s])}e&&(this.faceVertexUvs[0]=e),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){function o(e,t,a){return a?e|1<<t:e&~(1<<t)}function a(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0===l[t]?(l[t]=_.length/3,_.push(e.x,e.y,e.z),l[t]):l[t]}function i(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0===T[t]?(T[t]=m.length,m.push(e.getHex()),T[t]):T[t]}function s(e){var t=e.x.toString()+e.y.toString();return void 0===n[t]?(n[t]=p.length/2,p.push(e.x,e.y),n[t]):n[t]}var d={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),void 0!==this.parameters){var e=this.parameters,c;for(c in e)void 0!==e[c]&&(d[c]=e[c]);return d}for(e=[],c=0;c<this.vertices.length;c++){var v=this.vertices[c];e.push(v.x,v.y,v.z)}v=[];var _=[],l={},m=[],T={},p=[],n={};for(c=0;c<this.faces.length;c++){var t=this.faces[c],b=void 0!==this.faceVertexUvs[0][c],S=0<t.normal.length(),E=0<t.vertexNormals.length,A=1!==t.color.r||1!==t.color.g||1!==t.color.b,x=0<t.vertexColors.length,y=0;y=o(y,0,0),y=o(y,1,!0),y=o(y,2,!1),y=o(y,3,b),y=o(y,4,S),y=o(y,5,E),y=o(y,6,A),y=o(y,7,x),v.push(y),v.push(t.a,t.b,t.c),v.push(t.materialIndex),b&&(b=this.faceVertexUvs[0][c],v.push(s(b[0]),s(b[1]),s(b[2]))),S&&v.push(a(t.normal)),E&&(S=t.vertexNormals,v.push(a(S[0]),a(S[1]),a(S[2]))),A&&v.push(i(t.color)),x&&(t=t.vertexColors,v.push(i(t[0]),i(t[1]),i(t[2])))}return d.data={},d.data.vertices=e,d.data.normals=_,0<m.length&&(d.data.colors=m),0<p.length&&(d.data.uvs=[p]),d.data.faces=v,d},clone:function(){return new F().copy(this)},copy:function(t){var a,r,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var n=t.vertices,i=0;for(a=n.length;i<a;i++)this.vertices.push(n[i].clone());for(n=t.colors,i=0,a=n.length;i<a;i++)this.colors.push(n[i].clone());for(n=t.faces,i=0,a=n.length;i<a;i++)this.faces.push(n[i].clone());for(i=0,a=t.faceVertexUvs.length;i<a;i++){var s=t.faceVertexUvs[i];for(void 0===this.faceVertexUvs[i]&&(this.faceVertexUvs[i]=[]),n=0,r=s.length;n<r;n++){var p=s[n],u=[],l=0;for(o=p.length;l<o;l++)u.push(p[l].clone());this.faceVertexUvs[i].push(u)}}for(l=t.morphTargets,i=0,a=l.length;i<a;i++){if(o={},o.name=l[i].name,void 0!==l[i].vertices)for(o.vertices=[],n=0,r=l[i].vertices.length;n<r;n++)o.vertices.push(l[i].vertices[n].clone());if(void 0!==l[i].normals)for(o.normals=[],n=0,r=l[i].normals.length;n<r;n++)o.normals.push(l[i].normals[n].clone());this.morphTargets.push(o)}for(l=t.morphNormals,i=0,a=l.length;i<a;i++){if(o={},void 0!==l[i].vertexNormals)for(o.vertexNormals=[],n=0,r=l[i].vertexNormals.length;n<r;n++)s=l[i].vertexNormals[n],p={},p.a=s.a.clone(),p.b=s.b.clone(),p.c=s.c.clone(),o.vertexNormals.push(p);if(void 0!==l[i].faceNormals)for(o.faceNormals=[],n=0,r=l[i].faceNormals.length;n<r;n++)o.faceNormals.push(l[i].faceNormals[n].clone());this.morphNormals.push(o)}for(n=t.skinWeights,i=0,a=n.length;i<a;i++)this.skinWeights.push(n[i].clone());for(n=t.skinIndices,i=0,a=n.length;i<a;i++)this.skinIndices.push(n[i].clone());for(n=t.lineDistances,i=0,a=n.length;i<a;i++)this.lineDistances.push(n[i]);return i=t.boundingBox,null!==i&&(this.boundingBox=i.clone()),i=t.boundingSphere,null!==i&&(this.boundingSphere=i.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(I.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(I.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0===e?0:e.length/this.itemSize,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(t,r,o){t*=this.itemSize,o*=r.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[t+n]=r.array[o+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(t){for(var a=this.array,r=0,o=0,n=t.length,e;o<n;o++)e=t[o],void 0===e&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",o),e=new w),a[r++]=e.r,a[r++]=e.g,a[r++]=e.b;return this},copyVector2sArray:function(t){for(var a=this.array,r=0,n=0,i=t.length,e;n<i;n++)e=t[n],void 0===e&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),e=new o),a[r++]=e.x,a[r++]=e.y;return this},copyVector3sArray:function(t){for(var a=this.array,r=0,o=0,n=t.length,e;o<n;o++)e=t[o],void 0===e&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",o),e=new s),a[r++]=e.x,a[r++]=e.y,a[r++]=e.z;return this},copyVector4sArray:function(t){for(var a=this.array,r=0,o=0,n=t.length,e;o<n;o++)e=t[o],void 0===e&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",o),e=new _),a[r++]=e.x,a[r++]=e.y,a[r++]=e.z,a[r++]=e.w;return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,o){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=o,this},setXYZW:function(t,r,o,n,i){return t*=this.itemSize,this.array[t+0]=r,this.array[t+1]=o,this.array[t+2]=n,this.array[t+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),g.prototype=Object.create(I.prototype),g.prototype.constructor=g,h.prototype=Object.create(I.prototype),h.prototype.constructor=h,N.prototype=Object.create(I.prototype),N.prototype.constructor=N,D.prototype=Object.create(I.prototype),D.prototype.constructor=D,z.prototype=Object.create(I.prototype),z.prototype.constructor=z,G.prototype=Object.create(I.prototype),G.prototype.constructor=G,H.prototype=Object.create(I.prototype),H.prototype.constructor=H,j.prototype=Object.create(I.prototype),j.prototype.constructor=j,E.prototype=Object.create(I.prototype),E.prototype.constructor=E,Object.assign(b.prototype,{computeGroups:function(t){var r=[],o;t=t.faces;for(var n=0,i;n<t.length;n++)if(i=t[n],i.materialIndex!==o){o=i.materialIndex,void 0!==s&&(s.count=3*n-s.start,r.push(s));var s={start:3*n,materialIndex:o}}void 0!==s&&(s.count=3*n-s.start,r.push(s)),this.groups=r},fromGeometry:function(i){var a=i.faces,s=i.vertices,c=i.faceVertexUvs,d=c[0]&&0<c[0].length,e=c[1]&&0<c[1].length,f=i.morphTargets,g=f.length;if(0<g){for(var h=[],l=0;l<g;l++)h[l]={name:f[l].name,data:[]};this.morphTargets.position=h}var v=i.morphNormals,b=v.length;if(0<b){var p=[];for(l=0;l<b;l++)p[l]={name:v[l].name,data:[]};this.morphTargets.normal=p}var n=i.skinIndices,t=i.skinWeights,r=n.length===s.length,u=t.length===s.length;for(0<s.length&&0===a.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),l=0;l<a.length;l++){var _=a[l];this.vertices.push(s[_.a],s[_.b],s[_.c]);var T=_.vertexNormals;for(3===T.length?this.normals.push(T[0],T[1],T[2]):(T=_.normal,this.normals.push(T,T,T)),T=_.vertexColors,3===T.length?this.colors.push(T[0],T[1],T[2]):(T=_.color,this.colors.push(T,T,T)),!0===d&&(T=c[0][l],void 0===T?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new o,new o,new o)):this.uvs.push(T[0],T[1],T[2])),!0===e&&(T=c[1][l],void 0===T?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new o,new o,new o)):this.uvs2.push(T[0],T[1],T[2])),T=0;T<g;T++){var S=f[T].vertices;h[T].data.push(S[_.a],S[_.b],S[_.c])}for(T=0;T<b;T++)S=v[T].vertexNormals[l],p[T].data.push(S.a,S.b,S.c);r&&this.skinIndices.push(n[_.a],n[_.b],n[_.c]),u&&this.skinWeights.push(t[_.a],t[_.b],t[_.c])}return this.computeGroups(i),this.verticesNeedUpdate=i.verticesNeedUpdate,this.normalsNeedUpdate=i.normalsNeedUpdate,this.colorsNeedUpdate=i.colorsNeedUpdate,this.uvsNeedUpdate=i.uvsNeedUpdate,this.groupsNeedUpdate=i.groupsNeedUpdate,this}});var ci=1;Z.prototype=Object.assign(Object.create(t.prototype),{constructor:Z,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){this.index=Array.isArray(e)?new(65535<Y(e)?H:z)(e,1):e},addAttribute:function(e,t,a){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new I(t,a)))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,a){this.groups.push({start:e,count:t,materialIndex:void 0===a?0:a})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var a=this.attributes.normal;return void 0!==a&&(t=new y().getNormalMatrix(e),t.applyToBufferAttribute(a),a.needsUpdate=!0),a=this.attributes.tangent,void 0!==a&&(t=new y().getNormalMatrix(e),t.applyToBufferAttribute(a),a.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new W;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new W;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new W;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new W;return function(t,a,r){return e.makeTranslation(t,a,r),this.applyMatrix(e),this}}(),scale:function(){var e=new W;return function(t,a,r){return e.makeScale(t,a,r),this.applyMatrix(e),this}}(),lookAt:function(){var e=new A;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){var e=new s;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e).negate(),this.translate(e.x,e.y,e.z),this}}(),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){e=new j(3*t.vertices.length,3);var r=new j(3*t.colors.length,3);this.addAttribute("position",e.copyVector3sArray(t.vertices)),this.addAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length&&(e=new j(t.lineDistances.length,1),this.addAttribute("lineDistance",e.copyArray(t.lineDistances))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(t){for(var a=[],r=0,o=t.length,n;r<o;r++)n=t[r],a.push(n.x,n.y,n.z||0);return this.addAttribute("position",new j(a,3)),this},updateFromObject:function(e){var t=e.geometry;if(e.isMesh){var a=t.__directGeometry;if(!0===t.elementsNeedUpdate&&(a=void 0,t.elementsNeedUpdate=!1),void 0===a)return this.fromGeometry(t);a.verticesNeedUpdate=t.verticesNeedUpdate,a.normalsNeedUpdate=t.normalsNeedUpdate,a.colorsNeedUpdate=t.colorsNeedUpdate,a.uvsNeedUpdate=t.uvsNeedUpdate,a.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=a}return!0===t.verticesNeedUpdate&&(a=this.attributes.position,void 0!==a&&(a.copyVector3sArray(t.vertices),a.needsUpdate=!0),t.verticesNeedUpdate=!1),!0===t.normalsNeedUpdate&&(a=this.attributes.normal,void 0!==a&&(a.copyVector3sArray(t.normals),a.needsUpdate=!0),t.normalsNeedUpdate=!1),!0===t.colorsNeedUpdate&&(a=this.attributes.color,void 0!==a&&(a.copyColorsArray(t.colors),a.needsUpdate=!0),t.colorsNeedUpdate=!1),t.uvsNeedUpdate&&(a=this.attributes.uv,void 0!==a&&(a.copyVector2sArray(t.uvs),a.needsUpdate=!0),t.uvsNeedUpdate=!1),t.lineDistancesNeedUpdate&&(a=this.attributes.lineDistance,void 0!==a&&(a.copyArray(t.lineDistances),a.needsUpdate=!0),t.lineDistancesNeedUpdate=!1),t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new b().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(t){var a=new Float32Array(3*t.vertices.length);for(var r in this.addAttribute("position",new I(a,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(a=new Float32Array(3*t.normals.length),this.addAttribute("normal",new I(a,3).copyVector3sArray(t.normals))),0<t.colors.length&&(a=new Float32Array(3*t.colors.length),this.addAttribute("color",new I(a,3).copyColorsArray(t.colors))),0<t.uvs.length&&(a=new Float32Array(2*t.uvs.length),this.addAttribute("uv",new I(a,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(a=new Float32Array(2*t.uvs2.length),this.addAttribute("uv2",new I(a,2).copyVector2sArray(t.uvs2))),this.groups=t.groups,t.morphTargets){a=[];for(var o=t.morphTargets[r],n=0,i=o.length;n<i;n++){var s=o[n],l=new j(3*s.data.length,3);l.name=s.name,a.push(l.copyVector3sArray(s.data))}this.morphAttributes[r]=a}return 0<t.skinIndices.length&&(r=new j(4*t.skinIndices.length,4),this.addAttribute("skinIndex",r.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(r=new j(4*t.skinWeights.length,4),this.addAttribute("skinWeight",r.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){var e=new u;return function(){null===this.boundingBox&&(this.boundingBox=new u);var t=this.attributes.position,a=this.morphAttributes.position;if(!(void 0!==t))this.boundingBox.makeEmpty();else if(this.boundingBox.setFromBufferAttribute(t),a){t=0;for(var r=a.length;t<r;t++)e.setFromBufferAttribute(a[t]),this.boundingBox.expandByPoint(e.min),this.boundingBox.expandByPoint(e.max)}(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error("THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.",this)}}(),computeBoundingSphere:function(){var t=new u,a=new u,e=new s;return function(){null===this.boundingSphere&&(this.boundingSphere=new S);var r=this.attributes.position,o=this.morphAttributes.position;if(r){var n=this.boundingSphere.center;if(t.setFromBufferAttribute(r),o)for(var i=0,s=o.length,p;i<s;i++)p=o[i],a.setFromBufferAttribute(p),t.expandByPoint(a.min),t.expandByPoint(a.max);t.getCenter(n);var c=0;for(i=0,s=r.count;i<s;i++)e.fromBufferAttribute(r,i),c=ei(c,n.distanceToSquared(e));if(o)for(i=0,s=o.length;i<s;i++){p=o[i],r=0;for(var u=p.count;r<u;r++)e.fromBufferAttribute(p,r),c=ei(c,n.distanceToSquared(e))}this.boundingSphere.radius=Jn(c),isNaN(this.boundingSphere.radius)&&console.error("THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.",this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var r=this.index,o=this.attributes;if(o.position){var n=o.position.array;if(void 0===o.normal)this.addAttribute("normal",new I(new Float32Array(n.length),3));else for(var i=o.normal.array,c=0,u=i.length;c<u;c++)i[c]=0;i=o.normal.array;var y=new s,g=new s,h=new s,l=new s,m=new s;if(r){var x=r.array;for(c=0,u=r.count;c<u;c+=3){r=3*x[c+0];var p=3*x[c+1],v=3*x[c+2];y.fromArray(n,r),g.fromArray(n,p),h.fromArray(n,v),l.subVectors(h,g),m.subVectors(y,g),l.cross(m),i[r]+=l.x,i[r+1]+=l.y,i[r+2]+=l.z,i[p]+=l.x,i[p+1]+=l.y,i[p+2]+=l.z,i[v]+=l.x,i[v+1]+=l.y,i[v+2]+=l.z}}else for(c=0,u=n.length;c<u;c+=9)y.fromArray(n,c),g.fromArray(n,c+3),h.fromArray(n,c+6),l.subVectors(h,g),m.subVectors(y,g),l.cross(m),i[c]=l.x,i[c+1]=l.y,i[c+2]=l.z,i[c+3]=l.x,i[c+4]=l.y,i[c+5]=l.z,i[c+6]=l.x,i[c+7]=l.y,i[c+8]=l.z;this.normalizeNormals(),o.normal.needsUpdate=!0}},merge:function(t,a){if(t&&t.isBufferGeometry){void 0===a&&(a=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r=this.attributes,o;for(o in r)if(void 0!==t.attributes[o]){var n=r[o].array,e=t.attributes[o],i=e.array,s=e.itemSize*a;e=ai(i.length,n.length-s);for(var p=0;p<e;p++,s++)n[s]=i[p]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){var e=new s;return function(){for(var t=this.attributes.normal,a=0,r=t.count;a<r;a++)e.x=t.getX(a),e.y=t.getY(a),e.z=t.getZ(a),e.normalize(),t.setXYZ(a,e.x,e.y,e.z)}}(),toNonIndexed:function(){function t(t,r){var o=t.array;t=t.itemSize;for(var n=new o.constructor(r.length*t),i=0,s=0,d=r.length,p;s<d;s++){p=r[s]*t;for(var c=0;c<t;c++)n[i++]=o[p++]}return new I(n,t)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var a=new Z,r=this.index.array,o=this.attributes,n;for(n in o){var i=o[n];i=t(i,r),a.addAttribute(n,i)}var s=this.morphAttributes;for(n in s){var p=[],u=s[n];o=0;for(var l=u.length;o<l;o++)i=u[o],i=t(i,r),p.push(i);a.morphAttributes[n]=p}for(r=this.groups,o=0,n=r.length;o<n;o++)i=r[o],a.addGroup(i.start,i.count,i.materialIndex);return a},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),0<Object.keys(this.userData).length&&(t.userData=this.userData),void 0!==this.parameters){var a=this.parameters;for(l in a)void 0!==a[l]&&(t[l]=a[l]);return t}t.data={attributes:{}},a=this.index,null!==a&&(t.data.index={type:a.array.constructor.name,array:Array.prototype.slice.call(a.array)});var r=this.attributes;for(l in r){a=r[l];var o={itemSize:a.itemSize,type:a.array.constructor.name,array:Array.prototype.slice.call(a.array),normalized:a.normalized};""!==a.name&&(o.name=a.name),t.data.attributes[l]=o}r={};var n=!1;for(l in this.morphAttributes){for(var i=this.morphAttributes[l],s=[],p=0,u=i.length;p<u;p++)a=i[p],o={itemSize:a.itemSize,type:a.array.constructor.name,array:Array.prototype.slice.call(a.array),normalized:a.normalized},""!==a.name&&(o.name=a.name),s.push(o);0<s.length&&(r[l]=s,n=!0)}n&&(t.data.morphAttributes=r);var l=this.groups;return 0<l.length&&(t.data.groups=JSON.parse(JSON.stringify(l))),l=this.boundingSphere,null!==l&&(t.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),t},clone:function(){return new Z().copy(this)},copy:function(t){var a;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var r=t.index;for(i in null!==r&&this.setIndex(r.clone()),r=t.attributes,r)this.addAttribute(i,r[i].clone());var o=t.morphAttributes;for(i in o){var n=[],e=o[i];for(r=0,a=e.length;r<a;r++)n.push(e[r].clone());this.morphAttributes[i]=n}var i=t.groups;for(r=0,a=i.length;r<a;r++)o=i[r],this.addGroup(o.start,o.count,o.materialIndex);return i=t.boundingBox,null!==i&&(this.boundingBox=i.clone()),i=t.boundingSphere,null!==i&&(this.boundingSphere=i.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),B.prototype=Object.create(F.prototype),B.prototype.constructor=B,K.prototype=Object.create(Z.prototype),K.prototype.constructor=K,k.prototype=Object.create(F.prototype),k.prototype.constructor=k,ee.prototype=Object.create(Z.prototype),ee.prototype.constructor=ee;var ui=0;q.prototype=Object.assign(Object.create(t.prototype),{constructor:q,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var a=e[t];if(void 0===a)console.warn("THREE.Material: '"+t+"' parameter is undefined.");else if("shading"===t)console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=!(1!==a);else{var r=this[t];void 0===r?console.warn("THREE."+this.type+": '"+t+"' is not a property of this material."):r&&r.isColor?r.set(a):r&&r.isVector3&&a&&a.isVector3?r.copy(a):this[t]=a}}},toJSON:function(e){function t(e){var t=[],a;for(a in e){var r=e[a];delete r.metadata,t.push(r)}return t}var r=void 0===e||"string"==typeof e;r&&(e={textures:{},images:{}});var o={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),this.color&&this.color.isColor&&(o.color=this.color.getHex()),void 0!==this.roughness&&(o.roughness=this.roughness),void 0!==this.metalness&&(o.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(o.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(o.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(o.specular=this.specular.getHex()),void 0!==this.shininess&&(o.shininess=this.shininess),void 0!==this.clearCoat&&(o.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(o.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(o.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(o.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(o.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(o.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(o.aoMap=this.aoMap.toJSON(e).uuid,o.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(o.bumpMap=this.bumpMap.toJSON(e).uuid,o.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(o.normalMap=this.normalMap.toJSON(e).uuid,o.normalMapType=this.normalMapType,o.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(o.displacementMap=this.displacementMap.toJSON(e).uuid,o.displacementScale=this.displacementScale,o.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(o.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(o.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(o.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(o.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(o.envMap=this.envMap.toJSON(e).uuid,o.reflectivity=this.reflectivity,void 0!==this.combine&&(o.combine=this.combine),void 0!==this.envMapIntensity&&(o.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(o.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(o.size=this.size),void 0!==this.sizeAttenuation&&(o.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(o.blending=this.blending),!0===this.flatShading&&(o.flatShading=this.flatShading),0!==this.side&&(o.side=this.side),0!==this.vertexColors&&(o.vertexColors=this.vertexColors),1>this.opacity&&(o.opacity=this.opacity),!0===this.transparent&&(o.transparent=this.transparent),o.depthFunc=this.depthFunc,o.depthTest=this.depthTest,o.depthWrite=this.depthWrite,0!==this.rotation&&(o.rotation=this.rotation),!0===this.polygonOffset&&(o.polygonOffset=!0),0!==this.polygonOffsetFactor&&(o.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(o.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(o.linewidth=this.linewidth),void 0!==this.dashSize&&(o.dashSize=this.dashSize),void 0!==this.gapSize&&(o.gapSize=this.gapSize),void 0!==this.scale&&(o.scale=this.scale),!0===this.dithering&&(o.dithering=!0),0<this.alphaTest&&(o.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(o.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(o.wireframe=this.wireframe),1<this.wireframeLinewidth&&(o.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(o.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(o.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(o.morphTargets=!0),!0===this.skinning&&(o.skinning=!0),!1===this.visible&&(o.visible=!1),"{}"!==JSON.stringify(this.userData)&&(o.userData=this.userData),r&&(r=t(e.textures),e=t(e.images),0<r.length&&(o.textures=r),0<e.length&&(o.images=e)),o},clone:function(){return new this.constructor().copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var a=t.clippingPlanes,r=null;if(null!==a){var o=a.length;r=Array(o);for(var n=0;n!==o;++n)r[n]=a[n].clone()}return this.clippingPlanes=r,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Q.prototype=Object.create(q.prototype),Q.prototype.constructor=Q,Q.prototype.isShaderMaterial=!0,Q.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=v(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Q.prototype.toJSON=function(t){var r=q.prototype.toJSON.call(this,t);for(var o in r.uniforms={},this.uniforms){var n=this.uniforms[o].value;r.uniforms[o]=n&&n.isTexture?{type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?{type:"c",value:n.getHex()}:n&&n.isVector2?{type:"v2",value:n.toArray()}:n&&n.isVector3?{type:"v3",value:n.toArray()}:n&&n.isVector4?{type:"v4",value:n.toArray()}:n&&n.isMatrix3?{type:"m3",value:n.toArray()}:n&&n.isMatrix4?{type:"m4",value:n.toArray()}:{value:n}}for(var i in 0<Object.keys(this.defines).length&&(r.defines=this.defines),r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader,t={},this.extensions)!0===this.extensions[i]&&(t[i]=!0);return 0<Object.keys(t).length&&(r.extensions=t),r},Object.assign(de.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new s),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new s;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new s),t.subVectors(e,this.origin),e=t.dot(this.direction),0>e?t.copy(this.origin):t.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(e){return Jn(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new s;return function(t){var a=e.subVectors(t,this.origin).dot(this.direction);return 0>a?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(a).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:function(){var r=new s,a=new s,o=new s;return function(i,s,c,u){r.copy(i).add(s).multiplyScalar(.5),a.copy(s).sub(i).normalize(),o.copy(this.origin).sub(r);var f=.5*i.distanceTo(s),g=-this.direction.dot(a),y=o.dot(this.direction),m=-o.dot(a),x=o.lengthSq(),p=ri(1-g*g);if(0<p){i=g*m-y,s=g*y-m;var n=f*p;0<=i?s>=-n?s<=n?(f=1/p,i*=f,s*=f,g=i*(i+g*s+2*y)+s*(g*i+s+2*m)+x):(s=f,i=ei(0,-(g*s+y)),g=-i*i+s*(s+2*m)+x):(s=-f,i=ei(0,-(g*s+y)),g=-i*i+s*(s+2*m)+x):s<=-n?(i=ei(0,-(-g*f+y)),s=0<i?-f:ai(ei(-f,-m),f),g=-i*i+s*(s+2*m)+x):s<=n?(i=0,s=ai(ei(-f,-m),f),g=s*(s+2*m)+x):(i=ei(0,-(g*f+y)),s=0<i?f:ai(ei(-f,-m),f),g=-i*i+s*(s+2*m)+x)}else s=0<g?-f:f,i=ei(0,-(g*s+y)),g=-i*i+s*(s+2*m)+x;return c&&c.copy(this.direction).multiplyScalar(i).add(this.origin),u&&u.copy(a).multiplyScalar(s).add(r),g}}(),intersectSphere:function(){var t=new s;return function(a,r){t.subVectors(a.center,this.origin);var o=t.dot(this.direction),n=t.dot(t)-o*o;return(a=a.radius*a.radius,n>a)?null:(a=Jn(a-n),n=o-a,o+=a,0>n&&0>o?null:0>n?this.at(o,r):this.at(n,r))}}(),intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);return 0===t?0===e.distanceToPoint(this.origin)?0:null:(e=-(this.origin.dot(e.normal)+e.constant)/t,0<=e?e:null)},intersectPlane:function(e,t){return e=this.distanceToPlane(e),null===e?null:this.at(e,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return!!(0===t||0>e.normal.dot(this.direction)*t)},intersectBox:function(t,r){var o=1/this.direction.x,n=1/this.direction.y,i=1/this.direction.z,e=this.origin;if(0<=o){var s=(t.min.x-e.x)*o;o*=t.max.x-e.x}else s=(t.max.x-e.x)*o,o*=t.min.x-e.x;if(0<=n){var l=(t.min.y-e.y)*n;n*=t.max.y-e.y}else l=(t.max.y-e.y)*n,n*=t.min.y-e.y;return s>n||l>o?null:((l>s||s!==s)&&(s=l),(n<o||o!==o)&&(o=n),0<=i?(l=(t.min.z-e.z)*i,t=(t.max.z-e.z)*i):(l=(t.max.z-e.z)*i,t=(t.min.z-e.z)*i),s>t||l>o)?null:((l>s||s!==s)&&(s=l),(t<o||o!==o)&&(o=t),0>o?null:this.at(0<=s?s:o,r))},intersectsBox:function(){var e=new s;return function(t){return null!==this.intersectBox(t,e)}}(),intersectTriangle:function(){var t=new s,a=new s,r=new s,o=new s;return function(n,i,s,d,p){if(a.subVectors(i,n),r.subVectors(s,n),o.crossVectors(a,r),i=this.direction.dot(o),0<i){if(d)return null;d=1}else if(0>i)d=-1,i=-i;else return null;return(t.subVectors(this.origin,n),n=d*this.direction.dot(r.crossVectors(t,r)),0>n)?null:(s=d*this.direction.dot(a.cross(t)),0>s||n+s>i)?null:(n=-d*t.dot(o),0>n?null:this.at(n/i,p))}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(ce,{getNormal:function(){var t=new s;return function(a,r,o,n){return void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new s),n.subVectors(o,r),t.subVectors(a,r),n.cross(t),a=n.lengthSq(),0<a?n.multiplyScalar(1/Jn(a)):n.set(0,0,0)}}(),getBarycoord:function(){var t=new s,a=new s,r=new s;return function(o,n,i,p,c){t.subVectors(p,n),a.subVectors(i,n),r.subVectors(o,n),o=t.dot(t),n=t.dot(a),i=t.dot(r);var u=a.dot(a);p=a.dot(r);var y=o*u-n*n;return(void 0===c&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),c=new s),0==y)?c.set(-2,-1,-1):(y=1/y,u=(u*i-n*p)*y,o=(o*p-n*i)*y,c.set(1-u-o,o,u))}}(),containsPoint:function(){var t=new s;return function(a,r,o,n){return ce.getBarycoord(a,r,o,n,t),0<=t.x&&0<=t.y&&1>=t.x+t.y}}(),getUV:function(){var t=new s;return function(a,r,o,n,e,i,s,d){return this.getBarycoord(a,r,o,n,t),d.set(0,0),d.addScaledVector(e,t.x),d.addScaledVector(i,t.y),d.addScaledVector(s,t.z),d}}()}),Object.assign(ce.prototype,{set:function(e,t,a){return this.a.copy(e),this.b.copy(t),this.c.copy(a),this},setFromPointsAndIndices:function(e,t,a,r){return this.a.copy(e[t]),this.b.copy(e[a]),this.c.copy(e[r]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){var e=new s,t=new s;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new s),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return ce.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new s),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return ce.getBarycoord(e,this.a,this.b,this.c,t)},containsPoint:function(e){return ce.containsPoint(e,this.a,this.b,this.c)},getUV:function(t,a,r,o,n){return ce.getUV(t,this.a,this.b,this.c,a,r,o,n)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(){var o=new s,a=new s,n=new s,i=new s,d=new s,e=new s;return function(c,f){void 0===f&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),f=new s);var y=this.a,l=this.b,x=this.c;o.subVectors(l,y),a.subVectors(x,y),i.subVectors(c,y);var b=o.dot(i),_=a.dot(i);if(0>=b&&0>=_)return f.copy(y);d.subVectors(c,l);var T=o.dot(d),t=a.dot(d);if(0<=T&&t<=T)return f.copy(l);var r=b*t-T*_;if(0>=r&&0<=b&&0>=T)return l=b/(b-T),f.copy(y).addScaledVector(o,l);e.subVectors(c,x),c=o.dot(e);var S=a.dot(e);return 0<=S&&c<=S?f.copy(x):(b=c*_-b*S,0>=b&&0<=_&&0>=S)?(r=_/(_-S),f.copy(y).addScaledVector(a,r)):(_=T*S-c*t,0>=_&&0<=t-T&&0<=c-S)?(n.subVectors(x,l),r=(t-T)/(t-T+(c-S)),f.copy(l).addScaledVector(n,r)):(x=1/(_+b+r),l=b*x,r*=x,f.copy(y).addScaledVector(o,l).addScaledVector(a,r))}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),fe.prototype=Object.create(q.prototype),fe.prototype.constructor=fe,fe.prototype.isMeshBasicMaterial=!0,fe.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},ge.prototype=Object.assign(Object.create(A.prototype),{constructor:ge,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return A.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var t=Object.keys(e);if(0<t.length){var r=e[t[0]];if(void 0!==r)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=r.length;e<t;e++){var o=r[e].name||e+"";this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=e}}}else e=e.morphTargets,void 0!==e&&0<e.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(){function i(r,a,o,n,i,e,s,l){return null===(1===a.side?n.intersectTriangle(s,e,i,!0,l):n.intersectTriangle(i,e,s,2!==a.side,l))?null:(t.copy(l),t.applyMatrix4(r.matrixWorld),a=o.ray.origin.distanceTo(t),a<o.near||a>o.far?null:{distance:a,point:t.clone(),object:r})}function a(t,a,s,d,c,S,n,M,P,A){if(_.fromBufferAttribute(c,M),f.fromBufferAttribute(c,P),g.fromBufferAttribute(c,A),c=t.morphTargetInfluences,a.morphTargets&&S&&c){h.set(0,0,0),p.set(0,0,0),v.set(0,0,0);for(var C=0,R=S.length;C<R;C++){var I=c[C],F=S[C];0!==I&&(e.fromBufferAttribute(F,M),l.fromBufferAttribute(F,P),m.fromBufferAttribute(F,A),h.addScaledVector(e.sub(_),I),p.addScaledVector(l.sub(f),I),v.addScaledVector(m.sub(g),I))}_.add(h),f.add(p),g.add(v)}return(t=i(t,a,s,d,_,f,g,w))&&(n&&(T.fromBufferAttribute(n,M),r.fromBufferAttribute(n,P),u.fromBufferAttribute(n,A),t.uv=ce.getUV(w,_,f,g,T,r,u,new o)),n=new L(M,P,A),ce.getNormal(_,f,g,n.normal),t.face=n),t}var b=new W,c=new de,d=new S,_=new s,f=new s,g=new s,e=new s,l=new s,m=new s,h=new s,p=new s,v=new s,T=new o,r=new o,u=new o,w=new s,t=new s;return function(e,s){var f=this.geometry,g=this.material,l=this.matrixWorld;if(void 0!==g&&(null===f.boundingSphere&&f.computeBoundingSphere(),d.copy(f.boundingSphere),d.applyMatrix4(l),!1!==e.ray.intersectsSphere(d)&&(b.getInverse(l),c.copy(e.ray).applyMatrix4(b),null===f.boundingBox||!1!==c.intersectsBox(f.boundingBox))))if(f.isBufferGeometry){var _=f.index;l=f.attributes.position;var S=f.morphAttributes.position,M=f.attributes.uv,P=f.groups,L=f.drawRange,C,R;if(null!==_){if(Array.isArray(g)){var I=0;for(C=P.length;I<C;I++){var N=P[I],U=g[N.materialIndex],O=ei(N.start,L.start);for(R=f=ai(N.start+N.count,L.start+L.count);O<R;O+=3){f=_.getX(O);var z=_.getX(O+1),G=_.getX(O+2);(f=a(this,U,e,c,l,S,M,f,z,G))&&(f.faceIndex=oi(O/3),f.face.materialIndex=N.materialIndex,s.push(f))}}}else for(O=ei(0,L.start),f=ai(_.count,L.start+L.count),I=O,C=f;I<C;I+=3)(f=_.getX(I),z=_.getX(I+1),G=_.getX(I+2),f=a(this,g,e,c,l,S,M,f,z,G))&&(f.faceIndex=oi(I/3),s.push(f));}else if(void 0!==l)if(Array.isArray(g))for(I=0,C=P.length;I<C;I++)for(N=P[I],U=g[N.materialIndex],O=ei(N.start,L.start),R=f=ai(N.start+N.count,L.start+L.count);O<R;O+=3)(f=O,z=O+1,G=O+2,f=a(this,U,e,c,l,S,M,f,z,G))&&(f.faceIndex=oi(O/3),f.face.materialIndex=N.materialIndex,s.push(f));else for(O=ei(0,L.start),f=ai(l.count,L.start+L.count),I=O,C=f;I<C;I+=3)(f=I,z=I+1,G=I+2,f=a(this,g,e,c,l,S,M,f,z,G))&&(f.faceIndex=oi(I/3),s.push(f))}else if(f.isGeometry)for(l=Array.isArray(g),S=f.vertices,M=f.faces,f=f.faceVertexUvs[0],0<f.length&&(_=f),C=0,N=M.length;C<N;C++)(U=M[C],f=l?g[U.materialIndex]:g,void 0!==f&&(P=S[U.a],L=S[U.b],I=S[U.c],f=i(this,f,e,c,P,L,I,w)))&&(_&&_[C]&&(O=_[C],T.copy(O[0]),r.copy(O[1]),u.copy(O[2]),f.uv=ce.getUV(w,P,L,I,T,r,u,new o)),f.face=U,f.faceIndex=C,s.push(f))}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),lt.prototype=Object.create(r.prototype),lt.prototype.constructor=lt,lt.prototype.isCubeTexture=!0,Object.defineProperty(lt.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),dt.prototype=Object.create(r.prototype),dt.prototype.constructor=dt,dt.prototype.isDataTexture2DArray=!0,pt.prototype=Object.create(r.prototype),pt.prototype.constructor=pt,pt.prototype.isDataTexture3D=!0;var mi=new r,fi=new dt,gi=new pt,hi=new lt,yi=[],Xe=[],Ze=new Float32Array(16),xi=new Float32Array(9),vi=new Float32Array(4);kt.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),X(t,e)},Ht.prototype.setValue=function(t,a,r){for(var o=this.seq,n=0,i=o.length,s;n!==i;++n)s=o[n],s.setValue(t,a[s.id],r)};var $e=/([\w\d_]+)(\])?(\[|\.)?/g;Vt.prototype.setValue=function(e,t,a,r){t=this.map[t],void 0!==t&&t.setValue(e,a,r)},Vt.prototype.setOptional=function(e,t,a){t=t[a],void 0!==t&&this.setValue(e,a,t)},Vt.upload=function(t,a,r,o){for(var n=0,i=a.length;n!==i;++n){var s=a[n],l=r[s.id];!1!==l.needsUpdate&&s.setValue(t,l.value,o)}},Vt.seqWithValue=function(t,a){for(var r=[],o=0,n=t.length,e;o!==n;++o)e=t[o],e.id in a&&r.push(e);return r};var he=0,bi=0;_a.prototype=Object.create(q.prototype),_a.prototype.constructor=_a,_a.prototype.isMeshDepthMaterial=!0,_a.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Ta.prototype=Object.create(q.prototype),Ta.prototype.constructor=Ta,Ta.prototype.isMeshDistanceMaterial=!0,Ta.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},Aa.prototype=Object.assign(Object.create(A.prototype),{constructor:Aa,isGroup:!0}),Ba.prototype=Object.assign(Object.create(A.prototype),{constructor:Ba,isCamera:!0,copy:function(e,t){return A.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new s),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){A.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),Ha.prototype=Object.assign(Object.create(Ba.prototype),{constructor:Ha,isPerspectiveCamera:!0,copy:function(e,t){return Ba.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e,this.fov=2*ni.RAD2DEG*Gn(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=Oe(.5*ni.DEG2RAD*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*ni.RAD2DEG*Gn(Oe(.5*ni.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*ai(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/ei(this.aspect,1)},setViewOffset:function(t,a,r,o,n,e){this.aspect=t/a,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=a,this.view.offsetX=r,this.view.offsetY=o,this.view.width=n,this.view.height=e,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,a=t*Oe(.5*ni.DEG2RAD*this.fov)/this.zoom,r=2*a,o=this.aspect*r,n=-.5*o,i=this.view;if(null!==this.view&&this.view.enabled){var s=i.fullWidth,l=i.fullHeight;n+=i.offsetX*o/s,a-=i.offsetY*r/l,o*=i.width/s,r*=i.height/l}i=this.filmOffset,0!==i&&(n+=t*i/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+o,a,a-r,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return e=A.prototype.toJSON.call(this,e),e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),ca.prototype=Object.assign(Object.create(Ha.prototype),{constructor:ca,isArrayCamera:!0});var _i=new s,Ti=new s;Object.assign(je.prototype,{isFogExp2:!0,clone:function(){return new je(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(qa.prototype,{isFog:!0,clone:function(){return new qa(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),tr.prototype=Object.assign(Object.create(A.prototype),{constructor:tr,isScene:!0,copy:function(e,t){return A.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=A.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(ar.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ar.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0===e?0:e.length/this.stride,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(t,r,o){t*=this.stride,o*=r.stride;for(var n=0,i=this.stride;n<i;n++)this.array[t+n]=r.array[o+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(rr.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(rr.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this},setXYZ:function(e,t,r,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=o,this},setXYZW:function(t,r,o,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=r,this.data.array[t+1]=o,this.data.array[t+2]=n,this.data.array[t+3]=i,this}}),or.prototype=Object.create(q.prototype),or.prototype.constructor=or,or.prototype.isSpriteMaterial=!0,or.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var Si;nr.prototype=Object.assign(Object.create(A.prototype),{constructor:nr,isSprite:!0,raycast:function(){function i(r,a,o,n,i,s){t.subVectors(r,o).addScalar(.5).multiply(n),void 0===i?e.copy(t):(e.x=s*t.x-i*t.y,e.y=i*t.x+s*t.y),r.copy(a),r.x+=e.x,r.y+=e.y,r.applyMatrix4(y)}var a=new s,u=new s,c=new s,t=new o,e=new o,y=new W,d=new s,g=new s,l=new s,m=new o,h=new o,p=new o;return function(s,e){u.setFromMatrixScale(this.matrixWorld),y.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),c.setFromMatrixPosition(this.modelViewMatrix);var f=this.material.rotation;if(0!==f)var x=ti(f),n=Yn(f);f=this.center,i(d.set(-.5,-.5,0),c,f,u,n,x),i(g.set(.5,-.5,0),c,f,u,n,x),i(l.set(.5,.5,0),c,f,u,n,x),m.set(0,0),h.set(1,0),p.set(1,1);var v=s.ray.intersectTriangle(d,g,l,!1,a);null===v&&(i(g.set(-.5,.5,0),c,f,u,n,x),h.set(0,1),v=s.ray.intersectTriangle(d,l,g,!1,a),null===v)||(n=s.ray.origin.distanceTo(a),n<s.near||n>s.far||e.push({distance:n,point:a.clone(),uv:ce.getUV(a,d,g,l,m,h,p,new o),face:null,object:this}))}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return A.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),ir.prototype=Object.assign(Object.create(A.prototype),{constructor:ir,isLOD:!0,copy:function(e){A.prototype.copy.call(this,e,!1),e=e.levels;for(var t=0,r=e.length,o;t<r;t++)o=e[t],this.addLevel(o.object.clone(),o.distance);return this},addLevel:function(e,t){void 0===t&&(t=0),t=ri(t);for(var a=this.levels,r=0;r<a.length&&!(t<a[r].distance);r++);return a.splice(r,0,{distance:t,object:e}),this.add(e),this},getObjectForDistance:function(e){for(var t=this.levels,a=1,r=t.length;a<r&&!(e<t[a].distance);a++);return t[a-1].object},raycast:function(){var e=new s;return function(t,a){e.setFromMatrixPosition(this.matrixWorld);var r=t.ray.origin.distanceTo(e);this.getObjectForDistance(r).raycast(t,a)}}(),update:function(){var t=new s,a=new s;return function(r){var o=this.levels;if(1<o.length){t.setFromMatrixPosition(r.matrixWorld),a.setFromMatrixPosition(this.matrixWorld),r=t.distanceTo(a),o[0].object.visible=!0;for(var n=1,i=o.length;n<i&&r>=o[n].distance;n++)o[n-1].object.visible=!1,o[n].object.visible=!0;for(;n<i;n++)o[n].object.visible=!1}}}(),toJSON:function(t){t=A.prototype.toJSON.call(this,t),t.object.levels=[];for(var r=this.levels,o=0,n=r.length,i;o<n;o++)i=r[o],t.object.levels.push({object:i.object.uuid,distance:i.distance});return t}}),sr.prototype=Object.assign(Object.create(ge.prototype),{constructor:sr,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new _,a=this.geometry.attributes.skinWeight,r=0,o=a.count;r<o;r++){t.x=a.getX(r),t.y=a.getY(r),t.z=a.getZ(r),t.w=a.getW(r);var n=1/t.manhattanLength();1/0==n?t.set(1,0,0,0):t.multiplyScalar(n),a.setXYZW(r,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(e){ge.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(lr.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length,r;e<t;e++)r=new W,this.bones[e]&&r.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(r)},pose:function(){var e=0,t,r;for(r=this.bones.length;e<r;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,r=this.bones.length;e<r;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new W,a=new W;return function(){for(var r=this.bones,o=this.boneInverses,n=this.boneMatrices,e=this.boneTexture,i=0,s=r.length;i<s;i++)t.multiplyMatrices(r[i]?r[i].matrixWorld:a,o[i]),t.toArray(n,16*i);void 0!==e&&(e.needsUpdate=!0)}}(),clone:function(){return new lr(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,a=this.bones.length,r;t<a;t++)if(r=this.bones[t],r.name===e)return r}}),dr.prototype=Object.assign(Object.create(A.prototype),{constructor:dr,isBone:!0}),ke.prototype=Object.create(q.prototype),ke.prototype.constructor=ke,ke.prototype.isLineBasicMaterial=!0,ke.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},U.prototype=Object.assign(Object.create(A.prototype),{constructor:U,isLine:!0,computeLineDistances:function(){var t=new s,a=new s;return function(){var r=this.geometry;if(r.isBufferGeometry){if(null===r.index){for(var o=r.attributes.position,n=[0],i=1,s=o.count;i<s;i++)t.fromBufferAttribute(o,i-1),a.fromBufferAttribute(o,i),n[i]=n[i-1],n[i]+=t.distanceTo(a);r.addAttribute("lineDistance",new j(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");}else if(r.isGeometry)for(o=r.vertices,n=r.lineDistances,n[0]=0,i=1,s=o.length;i<s;i++)n[i]=n[i-1],n[i]+=o[i-1].distanceTo(o[i]);return this}}(),raycast:function(){var o=new W,a=new de,n=new S;return function(i,d){var e=i.linePrecision,c=this.geometry,y=this.matrixWorld;if(null===c.boundingSphere&&c.computeBoundingSphere(),n.copy(c.boundingSphere),n.applyMatrix4(y),n.radius+=e,!1!==i.ray.intersectsSphere(n)){o.getInverse(y),a.copy(i.ray).applyMatrix4(o),e/=(this.scale.x+this.scale.y+this.scale.z)/3,e*=e;var x=new s,b=new s;y=new s;var _=new s,T=this&&this.isLineSegments?2:1;if(c.isBufferGeometry){var p=c.index,S=c.attributes.position.array;if(null!==p){p=p.array,c=0;for(var t=p.length-1,E;c<t;c+=T)E=p[c+1],x.fromArray(S,3*p[c]),b.fromArray(S,3*E),E=a.distanceSqToSegment(x,b,_,y),E>e||(_.applyMatrix4(this.matrixWorld),E=i.ray.origin.distanceTo(_),E<i.near||E>i.far||d.push({distance:E,point:y.clone().applyMatrix4(this.matrixWorld),index:c,face:null,faceIndex:null,object:this}))}else for(c=0,t=S.length/3-1;c<t;c+=T)x.fromArray(S,3*c),b.fromArray(S,3*c+3),E=a.distanceSqToSegment(x,b,_,y),E>e||(_.applyMatrix4(this.matrixWorld),E=i.ray.origin.distanceTo(_),E<i.near||E>i.far||d.push({distance:E,point:y.clone().applyMatrix4(this.matrixWorld),index:c,face:null,faceIndex:null,object:this}))}else if(c.isGeometry)for(x=c.vertices,b=x.length,c=0;c<b-1;c+=T)E=a.distanceSqToSegment(x[c],x[c+1],_,y),E>e||(_.applyMatrix4(this.matrixWorld),E=i.ray.origin.distanceTo(_),E<i.near||E>i.far||d.push({distance:E,point:y.clone().applyMatrix4(this.matrixWorld),index:c,face:null,faceIndex:null,object:this}))}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ka.prototype=Object.assign(Object.create(U.prototype),{constructor:ka,isLineSegments:!0,computeLineDistances:function(){var t=new s,a=new s;return function(){var r=this.geometry;if(r.isBufferGeometry){if(null===r.index){for(var o=r.attributes.position,n=[],i=0,s=o.count;i<s;i+=2)t.fromBufferAttribute(o,i),a.fromBufferAttribute(o,i+1),n[i]=0==i?0:n[i-1],n[i+1]=n[i]+t.distanceTo(a);r.addAttribute("lineDistance",new j(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");}else if(r.isGeometry)for(o=r.vertices,n=r.lineDistances,i=0,s=o.length;i<s;i+=2)t.copy(o[i]),a.copy(o[i+1]),n[i]=0==i?0:n[i-1],n[i+1]=n[i]+t.distanceTo(a);return this}}()}),V.prototype=Object.assign(Object.create(U.prototype),{constructor:V,isLineLoop:!0}),pr.prototype=Object.create(q.prototype),pr.prototype.constructor=pr,pr.prototype.isPointsMaterial=!0,pr.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},Ia.prototype=Object.assign(Object.create(A.prototype),{constructor:Ia,isPoints:!0,raycast:function(){var e=new W,o=new de,a=new S;return function(n,i){function d(e,t){var r=o.distanceSqToPoint(e);r<x&&(o.closestPointToPoint(e,b),b.applyMatrix4(g),e=n.ray.origin.distanceTo(b),e<n.near||e>n.far||i.push({distance:e,distanceToRay:Jn(r),point:b.clone(),index:t,face:null,object:y}))}var y=this,c=this.geometry,g=this.matrixWorld,l=n.params.Points.threshold;if(null===c.boundingSphere&&c.computeBoundingSphere(),a.copy(c.boundingSphere),a.applyMatrix4(g),a.radius+=l,!1!==n.ray.intersectsSphere(a)){e.getInverse(g),o.copy(n.ray).applyMatrix4(e),l/=(this.scale.x+this.scale.y+this.scale.z)/3;var x=l*l;l=new s;var b=new s;if(c.isBufferGeometry){var p=c.index;if(c=c.attributes.position.array,null!==p){var f=p.array;p=0;for(var _=f.length,r;p<_;p++)r=f[p],l.fromArray(c,3*r),d(l,r)}else for(p=0,f=c.length/3;p<f;p++)l.fromArray(c,3*p),d(l,p)}else for(l=c.vertices,p=0,f=l.length;p<f;p++)d(l[p],p)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),cr.prototype=Object.assign(Object.create(r.prototype),{constructor:cr,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),le.prototype=Object.create(r.prototype),le.prototype.constructor=le,le.prototype.isCompressedTexture=!0,ur.prototype=Object.create(r.prototype),ur.prototype.constructor=ur,ur.prototype.isCanvasTexture=!0,mr.prototype=Object.create(r.prototype),mr.prototype.constructor=mr,mr.prototype.isDepthTexture=!0,fr.prototype=Object.create(Z.prototype),fr.prototype.constructor=fr,gr.prototype=Object.create(F.prototype),gr.prototype.constructor=gr,hr.prototype=Object.create(Z.prototype),hr.prototype.constructor=hr,yr.prototype=Object.create(F.prototype),yr.prototype.constructor=yr,xr.prototype=Object.create(Z.prototype),xr.prototype.constructor=xr,la.prototype=Object.create(F.prototype),la.prototype.constructor=la,vr.prototype=Object.create(xr.prototype),vr.prototype.constructor=vr,br.prototype=Object.create(F.prototype),br.prototype.constructor=br,_r.prototype=Object.create(xr.prototype),_r.prototype.constructor=_r,Tr.prototype=Object.create(F.prototype),Tr.prototype.constructor=Tr,Sr.prototype=Object.create(xr.prototype),Sr.prototype.constructor=Sr,Er.prototype=Object.create(F.prototype),Er.prototype.constructor=Er,wr.prototype=Object.create(xr.prototype),wr.prototype.constructor=wr,Ar.prototype=Object.create(F.prototype),Ar.prototype.constructor=Ar,Mr.prototype=Object.create(Z.prototype),Mr.prototype.constructor=Mr,Mr.prototype.toJSON=function(){var e=Z.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},Pr.prototype=Object.create(F.prototype),Pr.prototype.constructor=Pr,Lr.prototype=Object.create(Z.prototype),Lr.prototype.constructor=Lr,Cr.prototype=Object.create(F.prototype),Cr.prototype.constructor=Cr,Rr.prototype=Object.create(Z.prototype),Rr.prototype.constructor=Rr;var Ei={triangulate:function(o,a,i){i=i||2;var s=a&&a.length,u=s?a[0]*i:o.length,e=Fr(o,0,u,i,!0),y=[];if(!e)return y;var g;if(s){var x=i;s=[];var v=0,_;for(_=a.length;v<_;v++){var T=a[v]*x,S=v<_-1?a[v+1]*x:o.length;T=Fr(o,T,S,x,!1),T===T.next&&(T.steiner=!0),s.push(me(T))}for(s.sort(Dr),v=0;v<s.length;v++)a=s[v],x=e,(x=Br(a,x))&&(a=Hr(x,a),Ir(a,a.next)),e=Ir(e,e.next)}if(o.length>80*i){var n=g=o[0],E=s=o[1];for(x=i;x<u;x+=i)v=o[x],a=o[x+1],v<n&&(n=v),a<E&&(E=a),v>g&&(g=v),a>s&&(s=a);g=ei(g-n,s-E),g=0===g?0:1/g}return Nr(e,y,i,n,E,g),y}},wi={area:function(t){for(var a=t.length,r=0,o=a-1,n=0;n<a;o=n++)r+=t[o].x*t[n].y-t[n].x*t[o].y;return .5*r},isClockWise:function(e){return 0>wi.area(e)},triangulateShape:function(t,r){var o=[],n=[],i=[];ne(t),jr(o,t);var e=t.length;for(r.forEach(ne),t=0;t<r.length;t++)n.push(e),e+=r[t].length,jr(o,r[t]);for(r=Ei.triangulate(o,n),t=0;t<r.length;t+=3)i.push(r.slice(t,t+3));return i}};Yr.prototype=Object.create(F.prototype),Yr.prototype.constructor=Yr,Yr.prototype.toJSON=function(){var e=F.prototype.toJSON.call(this);return Ya(this.parameters.shapes,this.parameters.options,e)},Qr.prototype=Object.create(Z.prototype),Qr.prototype.constructor=Qr,Qr.prototype.toJSON=function(){var e=Z.prototype.toJSON.call(this);return Ya(this.parameters.shapes,this.parameters.options,e)};var Ai={generateTopUV:function(t,r,n,i,s){t=r[3*i],i=r[3*i+1];var l=r[3*s];return s=r[3*s+1],[new o(r[3*n],r[3*n+1]),new o(t,i),new o(l,s)]},generateSideWallUV:function(t,r,i,s,u,y){t=r[3*i];var f=r[3*i+1];i=r[3*i+2];var g=r[3*s],h=r[3*s+1];s=r[3*s+2];var l=r[3*u],m=r[3*u+1];u=r[3*u+2];var x=r[3*y],p=r[3*y+1];return r=r[3*y+2],.01>ri(f-h)?[new o(t,1-i),new o(g,1-s),new o(l,1-u),new o(x,1-r)]:[new o(f,1-i),new o(h,1-s),new o(m,1-u),new o(p,1-r)]}};qr.prototype=Object.create(F.prototype),qr.prototype.constructor=qr,Zr.prototype=Object.create(Qr.prototype),Zr.prototype.constructor=Zr,Jr.prototype=Object.create(F.prototype),Jr.prototype.constructor=Jr,Kr.prototype=Object.create(Z.prototype),Kr.prototype.constructor=Kr,$r.prototype=Object.create(F.prototype),$r.prototype.constructor=$r,eo.prototype=Object.create(Z.prototype),eo.prototype.constructor=eo,to.prototype=Object.create(F.prototype),to.prototype.constructor=to,ao.prototype=Object.create(Z.prototype),ao.prototype.constructor=ao,ro.prototype=Object.create(F.prototype),ro.prototype.constructor=ro,ro.prototype.toJSON=function(){var e=F.prototype.toJSON.call(this);return no(this.parameters.shapes,e)},oo.prototype=Object.create(Z.prototype),oo.prototype.constructor=oo,oo.prototype.toJSON=function(){var e=Z.prototype.toJSON.call(this);return no(this.parameters.shapes,e)},io.prototype=Object.create(Z.prototype),io.prototype.constructor=io,so.prototype=Object.create(F.prototype),so.prototype.constructor=so,lo.prototype=Object.create(Z.prototype),lo.prototype.constructor=lo,po.prototype=Object.create(so.prototype),po.prototype.constructor=po,co.prototype=Object.create(lo.prototype),co.prototype.constructor=co,uo.prototype=Object.create(F.prototype),uo.prototype.constructor=uo,mo.prototype=Object.create(Z.prototype),mo.prototype.constructor=mo;var Mi=Object.freeze({WireframeGeometry:fr,ParametricGeometry:gr,ParametricBufferGeometry:hr,TetrahedronGeometry:la,TetrahedronBufferGeometry:vr,OctahedronGeometry:br,OctahedronBufferGeometry:_r,IcosahedronGeometry:Tr,IcosahedronBufferGeometry:Sr,DodecahedronGeometry:Er,DodecahedronBufferGeometry:wr,PolyhedronGeometry:yr,PolyhedronBufferGeometry:xr,TubeGeometry:Ar,TubeBufferGeometry:Mr,TorusKnotGeometry:Pr,TorusKnotBufferGeometry:Lr,TorusGeometry:Cr,TorusBufferGeometry:Rr,TextGeometry:qr,TextBufferGeometry:Zr,SphereGeometry:Jr,SphereBufferGeometry:Kr,RingGeometry:$r,RingBufferGeometry:eo,PlaneGeometry:k,PlaneBufferGeometry:ee,LatheGeometry:to,LatheBufferGeometry:ao,ShapeGeometry:ro,ShapeBufferGeometry:oo,ExtrudeGeometry:Yr,ExtrudeBufferGeometry:Qr,EdgesGeometry:io,ConeGeometry:po,ConeBufferGeometry:co,CylinderGeometry:so,CylinderBufferGeometry:lo,CircleGeometry:uo,CircleBufferGeometry:mo,BoxGeometry:B,BoxBufferGeometry:K});fo.prototype=Object.create(q.prototype),fo.prototype.constructor=fo,fo.prototype.isShadowMaterial=!0,fo.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.color.copy(e.color),this},go.prototype=Object.create(Q.prototype),go.prototype.constructor=go,go.prototype.isRawShaderMaterial=!0,ho.prototype=Object.create(q.prototype),ho.prototype.constructor=ho,ho.prototype.isMeshStandardMaterial=!0,ho.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Za.prototype=Object.create(ho.prototype),Za.prototype.constructor=Za,Za.prototype.isMeshPhysicalMaterial=!0,Za.prototype.copy=function(e){return ho.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},yo.prototype=Object.create(q.prototype),yo.prototype.constructor=yo,yo.prototype.isMeshPhongMaterial=!0,yo.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ja.prototype=Object.create(yo.prototype),Ja.prototype.constructor=Ja,Ja.prototype.isMeshToonMaterial=!0,Ja.prototype.copy=function(e){return yo.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},xo.prototype=Object.create(q.prototype),xo.prototype.constructor=xo,xo.prototype.isMeshNormalMaterial=!0,xo.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},vo.prototype=Object.create(q.prototype),vo.prototype.constructor=vo,vo.prototype.isMeshLambertMaterial=!0,vo.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},bo.prototype=Object.create(q.prototype),bo.prototype.constructor=bo,bo.prototype.isMeshMatcapMaterial=!0,bo.prototype.copy=function(e){return q.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},_o.prototype=Object.create(ke.prototype),_o.prototype.constructor=_o,_o.prototype.isLineDashedMaterial=!0,_o.prototype.copy=function(e){return ke.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var xa=Object.freeze({ShadowMaterial:fo,SpriteMaterial:or,RawShaderMaterial:go,ShaderMaterial:Q,PointsMaterial:pr,MeshPhysicalMaterial:Za,MeshStandardMaterial:ho,MeshPhongMaterial:yo,MeshToonMaterial:Ja,MeshNormalMaterial:xo,MeshLambertMaterial:vo,MeshDepthMaterial:_a,MeshDistanceMaterial:Ta,MeshBasicMaterial:fe,MeshMatcapMaterial:bo,LineDashedMaterial:_o,LineBasicMaterial:ke,Material:q}),Pi={arraySlice:function(e,t,a){return Pi.isTypedArray(e)?new e.constructor(e.subarray(t,void 0===a?e.length:a)):e.slice(t,a)},convertArray:function(e,t,a){return e&&(a||e.constructor!==t)?"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,a=Array(t),r=0;r!==t;++r)a[r]=r;return a.sort(function(t,a){return e[t]-e[a]}),a},sortedArray:function(t,a,r){for(var o=t.length,n=new t.constructor(o),e=0,i=0;i!==o;++e)for(var s=r[e]*a,d=0;d!==a;++d)n[i++]=t[s+d];return n},flattenJSON:function(t,a,r,o){for(var n=1,i=t[0];void 0!==i&&void 0===i[o];)i=t[n++];if(void 0!==i){var s=i[o];if(void 0!==s)if(Array.isArray(s))do s=i[o],void 0!==s&&(a.push(i.time),r.push.apply(r,s)),i=t[n++];while(void 0!==i);else if(void 0!==s.toArray)do s=i[o],void 0!==s&&(a.push(i.time),s.toArray(r,r.length)),i=t[n++];while(void 0!==i);else do s=i[o],void 0!==s&&(a.push(i.time),r.push(s)),i=t[n++];while(void 0!==i)}}};Object.assign(To.prototype,{evaluate:function(t){var a=this.parameterPositions,r=this._cachedIndex,o=a[r],n=a[r-1];a:{b:{c:{d:if(!(t<o)){for(var i=r+2;;){if(void 0===o){if(t<n)break d;return this._cachedIndex=r=a.length,this.afterEnd_(r-1,t,n)}if(r===i)break;if(n=o,o=a[++r],t<o)break b}o=a.length;break c}if(t>=n)break a;else{for(i=a[1],t<i&&(r=2,n=i),i=r-2;;){if(void 0===n)return this._cachedIndex=0,this.beforeStart_(0,t,o);if(r===i)break;if(o=n,n=a[--r-1],t>=n)break b}o=r,r=0}}for(;r<o;)n=r+o>>>1,t<a[n]?o=n:r=n+1;if(o=a[r],n=a[r-1],void 0===n)return this._cachedIndex=0,this.beforeStart_(0,t,o);if(void 0===o)return this._cachedIndex=r=a.length,this.afterEnd_(r-1,n,t)}this._cachedIndex=r,this.intervalChanged_(r,n,o)}return this.interpolate_(r,n,t,o)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var r=this.resultBuffer,o=this.sampleValues,n=this.valueSize;t*=n;for(var i=0;i!==n;++i)r[i]=o[t+i];return r},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(To.prototype,{beforeStart_:To.prototype.copySampleValue_,afterEnd_:To.prototype.copySampleValue_}),Da.prototype=Object.assign(Object.create(To.prototype),{constructor:Da,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,r,o){var n=this.parameterPositions,i=t-2,s=t+1,l=n[i],p=n[s];if(void 0===l)switch(this.getSettings_().endingStart){case 2401:i=t,l=2*r-o;break;case 2402:i=n.length-2,l=r+n[i]-n[i+1];break;default:i=t,l=o;}if(void 0===p)switch(this.getSettings_().endingEnd){case 2401:s=t,p=2*o-r;break;case 2402:s=1,p=o+n[1]-n[0];break;default:s=t-1,p=r;}t=.5*(o-r),n=this.valueSize,this._weightPrev=t/(r-l),this._weightNext=t/(p-o),this._offsetPrev=i*n,this._offsetNext=s*n},interpolate_:function(t,r,o,i){var s=this.resultBuffer,e=this.sampleValues,u=this.valueSize;t*=u;var f=t-u,g=this._offsetPrev,l=this._offsetNext,m=this._weightPrev,h=this._weightNext,y=(o-r)/(i-r);for(o=y*y,i=o*y,r=-m*i+2*m*o-m*y,m=(1+m)*i+(-1.5-2*m)*o+(-.5+m)*y+1,y=(-1-h)*i+(1.5+h)*o+.5*y,h=h*i-h*o,o=0;o!==u;++o)s[o]=r*e[g+o]+m*e[f+o]+y*e[t+o]+h*e[l+o];return s}}),So.prototype=Object.assign(Object.create(To.prototype),{constructor:So,interpolate_:function(t,r,o,n){var i=this.resultBuffer,e=this.sampleValues,s=this.valueSize;t*=s;var l=t-s;for(r=(o-r)/(n-r),o=1-r,n=0;n!==s;++n)i[n]=e[l+n]*o+e[t+n]*r;return i}}),Eo.prototype=Object.assign(Object.create(To.prototype),{constructor:Eo,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(wo,{toJSON:function(e){var t=e.constructor;if(void 0!==t.toJSON)t=t.toJSON(e);else{t={name:e.name,times:Pi.convertArray(e.times,Array),values:Pi.convertArray(e.values,Array)};var a=e.getInterpolation();a!==e.DefaultInterpolation&&(t.interpolation=a)}return t.type=e.ValueTypeName,t}}),Object.assign(wo.prototype,{constructor:wo,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Eo(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new So(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Da(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){switch(e){case 2300:var t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth;}if(void 0===t){if(t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(t);return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302;}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,a=0,r=t.length;a!==r;++a)t[a]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,a=0,r=t.length;a!==r;++a)t[a]*=e;return this},trim:function(t,r){for(var o=this.times,n=o.length,i=0,s=n-1;i!==n&&o[i]<t;)++i;for(;-1!==s&&o[s]>r;)--s;return++s,(0!=i||s!==n)&&(i>=s&&(s=ei(s,1),i=s-1),t=this.getValueSize(),this.times=Pi.arraySlice(o,i,s),this.values=Pi.arraySlice(this.values,i*t,s*t)),this},validate:function(){var t=!0,r=this.getValueSize();0!=r-oi(r)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var o=this.times;r=this.values;var n=o.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var i=null,s=0,l;s!==n;s++){if(l=o[s],"number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,l),t=!1;break}if(null!==i&&i>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,l,i),t=!1;break}i=l}if(void 0!==r&&Pi.isTypedArray(r))for(s=0,o=r.length;s!==o;++s)if(n=r[s],isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,n),t=!1;break}return t},optimize:function(){for(var t=this.times,a=this.values,r=this.getValueSize(),o=2302===this.getInterpolation(),i=1,s=t.length-1,d=1;d<s;++d){var c=!1,u=t[d];if(u!==t[d+1]&&(1!==d||u!==u[0]))if(o)c=!0;else{var m=d*r,f=m-r,n=m+r;for(u=0;u!==r;++u){var p=a[m+u];if(p!==a[f+u]||p!==a[n+u]){c=!0;break}}}if(c){if(d!==i)for(t[i]=t[d],c=d*r,m=i*r,u=0;u!==r;++u)a[m+u]=a[c+u];++i}}if(0<s){for(t[i]=t[s],c=s*r,m=i*r,u=0;u!==r;++u)a[m+u]=a[c+u];++i}return i!==t.length&&(this.times=Pi.arraySlice(t,0,i),this.values=Pi.arraySlice(a,0,i*r)),this},clone:function(){var e=Pi.arraySlice(this.times,0),t=Pi.arraySlice(this.values,0);return e=new this.constructor(this.name,e,t),e.createInterpolant=this.createInterpolant,e}}),da.prototype=Object.assign(Object.create(wo.prototype),{constructor:da,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ao.prototype=Object.assign(Object.create(wo.prototype),{constructor:Ao,ValueTypeName:"color"}),Mo.prototype=Object.assign(Object.create(wo.prototype),{constructor:Mo,ValueTypeName:"number"}),Po.prototype=Object.assign(Object.create(To.prototype),{constructor:Po,interpolate_:function(t,r,o,n){var s=this.resultBuffer,e=this.sampleValues,l=this.valueSize;for(t*=l,r=(o-r)/(n-r),o=t+l;t!==o;t+=4)i.slerpFlat(s,0,e,t-l,e,t,r);return s}}),Lo.prototype=Object.assign(Object.create(wo.prototype),{constructor:Lo,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new Po(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Co.prototype=Object.assign(Object.create(wo.prototype),{constructor:Co,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ro.prototype=Object.assign(Object.create(wo.prototype),{constructor:Ro,ValueTypeName:"vector"}),Object.assign(Fo,{parse:function(t){for(var a=[],r=t.tracks,o=1/(t.fps||1),n=0,i=r.length;n!==i;++n)a.push(Io(r[n]).scale(o));return new Fo(t.name,t.duration,a)},toJSON:function(t){var r=[],o=t.tracks;t={name:t.name,duration:t.duration,tracks:r,uuid:t.uuid};for(var n=0,i=o.length;n!==i;++n)r.push(wo.toJSON(o[n]));return t},CreateFromMorphTargetSequence:function(t,a,r,o){for(var n=a.length,e=[],i=0;i<n;i++){var s=[],d=[];s.push((i+n-1)%n,i,(i+1)%n),d.push(0,1,0);var p=Pi.getKeyframeOrder(s);s=Pi.sortedArray(s,1,p),d=Pi.sortedArray(d,1,p),o||0!==s[0]||(s.push(n),d.push(d[0])),e.push(new Mo(".morphTargetInfluences["+a[i].name+"]",s,d).scale(1/r))}return new Fo(t,-1,e)},findByName:function(e,t){var r=e;for(Array.isArray(e)||(r=e.geometry&&e.geometry.animations||e.animations),e=0;e<r.length;e++)if(r[e].name===t)return r[e];return null},CreateClipsFromMorphTargetSequences:function(t,r,o){for(var n={},i=/^([\w-]*?)([\d]+)$/,e=0,s=t.length;e<s;e++){var d=t[e],p=d.name.match(i);if(p&&1<p.length){var c=p[1];(p=n[c])||(n[c]=p=[]),p.push(d)}}for(c in t=[],n)t.push(Fo.CreateFromMorphTargetSequence(c,n[c],r,o));return t},parseAnimation:function(o,i){if(!o)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var s=function(t,a,r,o,n){if(0!==r.length){var e=[],i=[];Pi.flattenJSON(r,e,i,o),0!==e.length&&n.push(new t(a,e,i))}},c=[],d=o.name||"default",e=o.length||-1,u=o.fps||30;o=o.hierarchy||[];for(var m=0,g;m<o.length;m++)if(g=o[m].keys,g&&0!==g.length)if(g[0].morphTargets){e={};for(var y=0;y<g.length;y++)if(g[y].morphTargets)for(var x=0;x<g[y].morphTargets.length;x++)e[g[y].morphTargets[x]]=-1;for(var b in e){var p=[],v=[];for(x=0;x!==g[y].morphTargets.length;++x){var t=g[y];p.push(t.time),v.push(t.morphTarget===b?1:0)}c.push(new Mo(".morphTargetInfluence["+b+"]",p,v))}e=e.length*(u||1)}else y=".bones["+i[m].name+"]",s(Ro,y+".position",g,"pos",c),s(Lo,y+".quaternion",g,"rot",c),s(Ro,y+".scale",g,"scl",c);return 0===c.length?null:new Fo(d,e,c)}}),Object.assign(Fo.prototype,{resetDuration:function(){for(var e=0,t=0,r=this.tracks.length,o;t!==r;++t)o=this.tracks[t],e=ei(e,o.times[o.times.length-1]);return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Fo(this.name,this.duration,e)}});var ba={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Li=new No,za={};Object.assign(oe.prototype,{load:function(t,r,o,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var s=this,e=ba.get(t);if(void 0!==e)return s.manager.itemStart(t),setTimeout(function(){r&&r(e),s.manager.itemEnd(t)},0),e;if(void 0!==za[t])za[t].push({onLoad:r,onProgress:o,onError:i});else{var d=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(d){o=d[1];var u=!!d[2];d=d[3],d=decodeURIComponent(d),u&&(d=atob(d));try{var m=(this.responseType||"").toLowerCase();switch(m){case"arraybuffer":case"blob":var l=new Uint8Array(d.length);for(u=0;u<d.length;u++)l[u]=d.charCodeAt(u);var f="blob"===m?new Blob([l.buffer],{type:o}):l.buffer;break;case"document":f=new DOMParser().parseFromString(d,o);break;case"json":f=JSON.parse(d);break;default:f=d;}setTimeout(function(){r&&r(f),s.manager.itemEnd(t)},0)}catch(e){setTimeout(function(){i&&i(e),s.manager.itemError(t),s.manager.itemEnd(t)},0)}}else{za[t]=[],za[t].push({onLoad:r,onProgress:o,onError:i});var y=new XMLHttpRequest;for(u in y.open("GET",t,!0),y.addEventListener("load",function(e){var a=this.response;ba.add(t,a);var r=za[t];if(delete za[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var o=0,n=r.length,i;o<n;o++)i=r[o],i.onLoad&&i.onLoad(a)}else{for(o=0,n=r.length;o<n;o++)(i=r[o],i.onError)&&i.onError(e);s.manager.itemError(t)}s.manager.itemEnd(t)},!1),y.addEventListener("progress",function(a){for(var r=za[t],o=0,n=r.length,e;o<n;o++)e=r[o],e.onProgress&&e.onProgress(a)},!1),y.addEventListener("error",function(e){var a=za[t];delete za[t];for(var r=0,o=a.length,n;r<o;r++)n=a[r],n.onError&&n.onError(e);s.manager.itemError(t),s.manager.itemEnd(t)},!1),y.addEventListener("abort",function(e){var a=za[t];delete za[t];for(var r=0,o=a.length,n;r<o;r++)n=a[r],n.onError&&n.onError(e);s.manager.itemError(t),s.manager.itemEnd(t)},!1),void 0!==this.responseType&&(y.responseType=this.responseType),void 0!==this.withCredentials&&(y.withCredentials=this.withCredentials),y.overrideMimeType&&y.overrideMimeType(void 0===this.mimeType?"text/plain":this.mimeType),this.requestHeader)y.setRequestHeader(u,this.requestHeader[u]);y.send(null)}return s.manager.itemStart(t),y}},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(Ka.prototype,{load:function(t,r,a,o){var n=this,e=new oe(n.manager);e.setPath(n.path),e.load(t,function(e){r(n.parse(JSON.parse(e)))},a,o)},parse:function(e){for(var t=[],a=0,r;a<e.length;a++)r=Fo.parse(e[a]),t.push(r);return t},setPath:function(e){return this.path=e,this}}),Object.assign(Do.prototype,{load:function(t,r,a,o){function i(n){d.load(t[n],function(e){e=s._parser(e,!0),c[n]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps},l+=1,6===l&&(1===e.mipmapCount&&(u.minFilter=1006),u.format=e.format,u.needsUpdate=!0,r&&r(u))},a,o)}var s=this,c=[],u=new le;u.image=c;var d=new oe(this.manager);if(d.setPath(this.path),d.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,e=0,m=t.length;e<m;++e)i(e);else d.load(t,function(t){if(t=s._parser(t,!0),t.isCubemap)for(var o=t.mipmaps.length/t.mipmapCount,n=0;n<o;n++){c[n]={mipmaps:[]};for(var i=0;i<t.mipmapCount;i++)c[n].mipmaps.push(t.mipmaps[n*t.mipmapCount+i]),c[n].format=t.format,c[n].width=t.width,c[n].height=t.height}else u.image.width=t.width,u.image.height=t.height,u.mipmaps=t.mipmaps;1===t.mipmapCount&&(u.minFilter=1006),u.format=t.format,u.needsUpdate=!0,r&&r(u)},a,o);return u},setPath:function(e){return this.path=e,this}}),Object.assign(Bo.prototype,{load:function(t,r,a,o){var n=this,e=new p,i=new oe(this.manager);return i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(t,function(t){(t=n._parser(t))&&(void 0===t.image?void 0!==t.data&&(e.image.width=t.width,e.image.height=t.height,e.image.data=t.data):e.image=t.image,e.wrapS=void 0===t.wrapS?1001:t.wrapS,e.wrapT=void 0===t.wrapT?1001:t.wrapT,e.magFilter=void 0===t.magFilter?1006:t.magFilter,e.minFilter=void 0===t.minFilter?1008:t.minFilter,e.anisotropy=void 0===t.anisotropy?1:t.anisotropy,void 0!==t.format&&(e.format=t.format),void 0!==t.type&&(e.type=t.type),void 0!==t.mipmaps&&(e.mipmaps=t.mipmaps),1===t.mipmapCount&&(e.minFilter=1006),e.needsUpdate=!0,r&&r(e,t))},a,o),e},setPath:function(e){return this.path=e,this}}),Object.assign(pe.prototype,{crossOrigin:"anonymous",load:function(t,r,o,n){function i(){p.removeEventListener("load",i,!1),p.removeEventListener("error",e,!1),ba.add(t,this),r&&r(this),s.manager.itemEnd(t)}function e(a){p.removeEventListener("load",i,!1),p.removeEventListener("error",e,!1),n&&n(a),s.manager.itemError(t),s.manager.itemEnd(t)}void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var s=this,d=ba.get(t);if(void 0!==d)return s.manager.itemStart(t),setTimeout(function(){r&&r(d),s.manager.itemEnd(t)},0),d;var p=document.createElementNS("http://www.w3.org/1999/xhtml","img");return p.addEventListener("load",i,!1),p.addEventListener("error",e,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(p.crossOrigin=this.crossOrigin),s.manager.itemStart(t),p.src=t,p},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Uo.prototype,{crossOrigin:"anonymous",load:function(t,r,a,o){function n(n){i.load(t[n],function(t){e.images[n]=t,s++,6===s&&(e.needsUpdate=!0,r&&r(e))},void 0,o)}var e=new lt,i=new pe(this.manager);i.setCrossOrigin(this.crossOrigin),i.setPath(this.path);var s=0;for(a=0;a<t.length;++a)n(a);return e},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(qe.prototype,{crossOrigin:"anonymous",load:function(t,a,o,n){var i=new r,e=new pe(this.manager);return e.setCrossOrigin(this.crossOrigin),e.setPath(this.path),e.load(t,function(e){i.image=e,e=0<t.search(/\.jpe?g($|\?)/i)||0===t.search(/^data:image\/jpeg/),i.format=e?1022:1023,i.needsUpdate=!0,void 0!==a&&a(i)},o,n),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Oo.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){return e=this.getUtoTmapping(e),this.getPoint(e,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var r=[],o=this.getPoint(0),n=0,i;for(r.push(0),i=1;i<=t;i++){var s=this.getPoint(i/t);n+=s.distanceTo(o),r.push(n),o=s}return this.cacheArcLengths=r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,r){var o=this.getLengths(),n=o.length;r=r?r:t*o[n-1];for(var i=0,s=n-1,l;i<=s;)if(t=oi(i+(s-i)/2),l=o[t]-r,0>l)i=t+1;else if(0<l)s=t-1;else{s=t;break}return(t=s,o[t]===r)?t/(n-1):(i=o[t],(t+(r-i)/(o[t+1]-i))/(n-1))},getTangent:function(e){var t=e-1E-4;return e+=1E-4,0>t&&(t=0),1<e&&(e=1),t=this.getPoint(t),this.getPoint(e).clone().sub(t).normalize()},getTangentAt:function(e){return e=this.getUtoTmapping(e),this.getTangent(e)},computeFrenetFrames:function(t,a){var r=new s,o=[],n=[],e=[],i=new s,d=new W,u;for(u=0;u<=t;u++){var m=u/t;o[u]=this.getTangentAt(m),o[u].normalize()}n[0]=new s,e[0]=new s,u=Number.MAX_VALUE,m=ri(o[0].x);var f=ri(o[0].y),g=ri(o[0].z);for(m<=u&&(u=m,r.set(1,0,0)),f<=u&&(u=f,r.set(0,1,0)),g<=u&&r.set(0,0,1),i.crossVectors(o[0],r).normalize(),n[0].crossVectors(o[0],i),e[0].crossVectors(o[0],n[0]),u=1;u<=t;u++)n[u]=n[u-1].clone(),e[u]=e[u-1].clone(),i.crossVectors(o[u-1],o[u]),i.length()>jn&&(i.normalize(),r=kn(ni.clamp(o[u-1].dot(o[u]),-1,1)),n[u].applyMatrix4(d.makeRotationAxis(i,r))),e[u].crossVectors(o[u],n[u]);if(!0===a)for(r=kn(ni.clamp(n[0].dot(n[t]),-1,1)),r/=t,0<o[0].dot(i.crossVectors(n[0],n[t]))&&(r=-r),u=1;u<=t;u++)n[u].applyMatrix4(d.makeRotationAxis(o[u],r*u)),e[u].crossVectors(o[u],n[u]);return{tangents:o,normals:n,binormals:e}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"},arcLengthDivisions:this.arcLengthDivisions,type:this.type};return e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),M.prototype=Object.create(Oo.prototype),M.prototype.constructor=M,M.prototype.isEllipseCurve=!0,M.prototype.getPoint=function(t,r){r=r||new o;for(var n=2*Zn,i=this.aEndAngle-this.aStartAngle,s=ri(i)<jn;0>i;)i+=n;for(;i>n;)i-=n;i<jn&&(i=s?0:n),!0!==this.aClockwise||s||(i=i===n?-n:i-n),n=this.aStartAngle+t*i,t=this.aX+this.xRadius*ti(n);var l=this.aY+this.yRadius*Yn(n);return 0!==this.aRotation&&(n=ti(this.aRotation),i=Yn(this.aRotation),s=t-this.aX,l-=this.aY,t=s*n-l*i+this.aX,l=s*i+l*n+this.aY),r.set(t,l)},M.prototype.copy=function(e){return Oo.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},M.prototype.toJSON=function(){var e=Oo.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},M.prototype.fromJSON=function(e){return Oo.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Ea.prototype=Object.create(M.prototype),Ea.prototype.constructor=Ea,Ea.prototype.isArcCurve=!0;var Ra=new s,ae=new zo,Pe=new zo,Qe=new zo;re.prototype=Object.create(Oo.prototype),re.prototype.constructor=re,re.prototype.isCatmullRomCurve3=!0,re.prototype.getPoint=function(t,r){r=r||new s;var o=this.points,n=o.length;t*=n-(this.closed?0:1);var i=oi(t);if(t-=i,this.closed?i+=0<i?0:(oi(ri(i)/n)+1)*n:0===t&&i===n-1&&(i=n-2,t=1),this.closed||0<i)var p=o[(i-1)%n];else Ra.subVectors(o[0],o[1]).add(o[0]),p=Ra;var u=o[i%n],m=o[(i+1)%n];if(this.closed||i+2<n?o=o[(i+2)%n]:(Ra.subVectors(o[n-1],o[n-2]).add(o[n-1]),o=Ra),"centripetal"===this.curveType||"chordal"===this.curveType){var g="chordal"===this.curveType?.5:.25;n=qn(p.distanceToSquared(u),g),i=qn(u.distanceToSquared(m),g),g=qn(m.distanceToSquared(o),g),1E-4>i&&(i=1),1E-4>n&&(n=i),1E-4>g&&(g=i),ae.initNonuniformCatmullRom(p.x,u.x,m.x,o.x,n,i,g),Pe.initNonuniformCatmullRom(p.y,u.y,m.y,o.y,n,i,g),Qe.initNonuniformCatmullRom(p.z,u.z,m.z,o.z,n,i,g)}else"catmullrom"===this.curveType&&(ae.initCatmullRom(p.x,u.x,m.x,o.x,this.tension),Pe.initCatmullRom(p.y,u.y,m.y,o.y,this.tension),Qe.initCatmullRom(p.z,u.z,m.z,o.z,this.tension));return r.set(ae.calc(t),Pe.calc(t),Qe.calc(t)),r},re.prototype.copy=function(e){Oo.prototype.copy.call(this,e),this.points=[];for(var t=0,a=e.points.length;t<a;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},re.prototype.toJSON=function(){var e=Oo.prototype.toJSON.call(this);e.points=[];for(var t=0,a=this.points.length;t<a;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},re.prototype.fromJSON=function(e){Oo.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,a=e.points.length,r;t<a;t++)r=e.points[t],this.points.push(new s().fromArray(r));return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Ho.prototype=Object.create(Oo.prototype),Ho.prototype.constructor=Ho,Ho.prototype.isCubicBezierCurve=!0,Ho.prototype.getPoint=function(t,a){a=a||new o;var r=this.v0,n=this.v1,i=this.v2,e=this.v3;return a.set(ko(t,r.x,n.x,i.x,e.x),ko(t,r.y,n.y,i.y,e.y)),a},Ho.prototype.copy=function(e){return Oo.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Ho.prototype.toJSON=function(){var e=Oo.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Ho.prototype.fromJSON=function(e){return Oo.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},La.prototype=Object.create(Oo.prototype),La.prototype.constructor=La,La.prototype.isCubicBezierCurve3=!0,La.prototype.getPoint=function(t,a){a=a||new s;var r=this.v0,o=this.v1,n=this.v2,e=this.v3;return a.set(ko(t,r.x,o.x,n.x,e.x),ko(t,r.y,o.y,n.y,e.y),ko(t,r.z,o.z,n.z,e.z)),a},La.prototype.copy=function(e){return Oo.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},La.prototype.toJSON=function(){var e=Oo.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},La.prototype.fromJSON=function(e){return Oo.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},$a.prototype=Object.create(Oo.prototype),$a.prototype.constructor=$a,$a.prototype.isLineCurve=!0,$a.prototype.getPoint=function(e,t){return t=t||new o,1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},$a.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},$a.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},$a.prototype.copy=function(e){return Oo.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},$a.prototype.toJSON=function(){var e=Oo.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},$a.prototype.fromJSON=function(e){return Oo.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},wa.prototype=Object.create(Oo.prototype),wa.prototype.constructor=wa,wa.prototype.isLineCurve3=!0,wa.prototype.getPoint=function(e,t){return t=t||new s,1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},wa.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},wa.prototype.copy=function(e){return Oo.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},wa.prototype.toJSON=function(){var e=Oo.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},wa.prototype.fromJSON=function(e){return Oo.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ma.prototype=Object.create(Oo.prototype),Ma.prototype.constructor=Ma,Ma.prototype.isQuadraticBezierCurve=!0,Ma.prototype.getPoint=function(t,a){a=a||new o;var r=this.v0,n=this.v1,i=this.v2;return a.set(Go(t,r.x,n.x,i.x),Go(t,r.y,n.y,i.y)),a},Ma.prototype.copy=function(e){return Oo.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ma.prototype.toJSON=function(){var e=Oo.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ma.prototype.fromJSON=function(e){return Oo.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Na.prototype=Object.create(Oo.prototype),Na.prototype.constructor=Na,Na.prototype.isQuadraticBezierCurve3=!0,Na.prototype.getPoint=function(t,a){a=a||new s;var r=this.v0,o=this.v1,n=this.v2;return a.set(Go(t,r.x,o.x,n.x),Go(t,r.y,o.y,n.y),Go(t,r.z,o.z,n.z)),a},Na.prototype.copy=function(e){return Oo.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Na.prototype.toJSON=function(){var e=Oo.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Na.prototype.fromJSON=function(e){return Oo.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Vo.prototype=Object.create(Oo.prototype),Vo.prototype.constructor=Vo,Vo.prototype.isSplineCurve=!0,Vo.prototype.getPoint=function(t,r){r=r||new o;var n=this.points,i=(n.length-1)*t;t=oi(i),i-=t;var s=n[0===t?t:t-1],e=n[t],l=n[t>n.length-2?n.length-1:t+1];return n=n[t>n.length-3?n.length-1:t+2],r.set(oa(i,s.x,e.x,l.x,n.x),oa(i,s.y,e.y,l.y,n.y)),r},Vo.prototype.copy=function(e){Oo.prototype.copy.call(this,e),this.points=[];for(var t=0,a=e.points.length;t<a;t++)this.points.push(e.points[t].clone());return this},Vo.prototype.toJSON=function(){var e=Oo.prototype.toJSON.call(this);e.points=[];for(var t=0,a=this.points.length;t<a;t++)e.points.push(this.points[t].toArray());return e},Vo.prototype.fromJSON=function(e){Oo.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,a=e.points.length,r;t<a;t++)r=e.points[t],this.points.push(new o().fromArray(r));return this};var Re=Object.freeze({ArcCurve:Ea,CatmullRomCurve3:re,CubicBezierCurve:Ho,CubicBezierCurve3:La,EllipseCurve:M,LineCurve:$a,LineCurve3:wa,QuadraticBezierCurve:Ma,QuadraticBezierCurve3:Na,SplineCurve:Vo});Oa.prototype=Object.assign(Object.create(Oo.prototype),{constructor:Oa,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new $a(t,e))},getPoint:function(e){var t=e*this.getLength(),r=this.getCurveLengths();for(e=0;e<r.length;){if(r[e]>=t)return t=r[e]-t,e=this.curves[e],r=e.getLength(),e.getPointAt(0===r?0:1-t/r);e++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,a=0,r=this.curves.length;a<r;a++)t+=this.curves[a].getLength(),e.push(t);return this.cacheLengths=e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(t){t=t||12;for(var r=[],o=0,n=this.curves,e,i;o<n.length;o++){i=n[o],i=i.getPoints(i&&i.isEllipseCurve?2*t:i&&(i.isLineCurve||i.isLineCurve3)?1:i&&i.isSplineCurve?t*i.points.length:t);for(var s=0,l;s<i.length;s++)l=i[s],e&&e.equals(l)||(r.push(l),e=l)}return this.autoClose&&1<r.length&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(e){Oo.prototype.copy.call(this,e),this.curves=[];for(var t=0,a=e.curves.length;t<a;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this},toJSON:function(){var e=Oo.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,a=this.curves.length;t<a;t++)e.curves.push(this.curves[t].toJSON());return e},fromJSON:function(e){Oo.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,a=e.curves.length,r;t<a;t++)r=e.curves[t],this.curves.push(new Re[r.type]().fromJSON(r));return this}}),Wo.prototype=Object.assign(Object.create(Oa.prototype),{constructor:Wo,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,a=e.length;t<a;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var a=new $a(this.currentPoint.clone(),new o(e,t));this.curves.push(a),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,r,n){e=new Ma(this.currentPoint.clone(),new o(e,t),new o(r,n)),this.curves.push(e),this.currentPoint.set(r,n)},bezierCurveTo:function(t,r,n,i,s,e){t=new Ho(this.currentPoint.clone(),new o(t,r),new o(n,i),new o(s,e)),this.curves.push(t),this.currentPoint.set(s,e)},splineThru:function(e){var t=[this.currentPoint.clone()].concat(e);t=new Vo(t),this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(t,a,r,o,n,e){this.absarc(t+this.currentPoint.x,a+this.currentPoint.y,r,o,n,e)},absarc:function(t,a,r,o,n,e){this.absellipse(t,a,r,r,o,n,e)},ellipse:function(t,a,r,o,n,e,i,s){this.absellipse(t+this.currentPoint.x,a+this.currentPoint.y,r,o,n,e,i,s)},absellipse:function(t,r,o,n,i,e,s,l){t=new M(t,r,o,n,i,e,s,l),0<this.curves.length&&(r=t.getPoint(0),r.equals(this.currentPoint)||this.lineTo(r.x,r.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t)},copy:function(e){return Oa.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Oa.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Oa.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Pa.prototype=Object.assign(Object.create(Wo.prototype),{constructor:Pa,getPointsHoles:function(e){for(var t=[],a=0,r=this.holes.length;a<r;a++)t[a]=this.holes[a].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Wo.prototype.copy.call(this,e),this.holes=[];for(var t=0,a=e.holes.length;t<a;t++)this.holes.push(e.holes[t].clone());return this},toJSON:function(){var e=Wo.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,a=this.holes.length;t<a;t++)e.holes.push(this.holes[t].toJSON());return e},fromJSON:function(e){Wo.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,a=e.holes.length,r;t<a;t++)r=e.holes[t],this.holes.push(new Wo().fromJSON(r));return this}}),Xo.prototype=Object.assign(Object.create(A.prototype),{constructor:Xo,isLight:!0,copy:function(e){return A.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){return e=A.prototype.toJSON.call(this,e),e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),T.prototype=Object.assign(Object.create(Xo.prototype),{constructor:T,isHemisphereLight:!0,copy:function(e){return Xo.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(jo.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Yo.prototype=Object.assign(Object.create(jo.prototype),{constructor:Yo,isSpotLightShadow:!0,update:function(e){var t=this.camera,r=2*ni.RAD2DEG*e.angle,o=this.mapSize.width/this.mapSize.height;e=e.distance||t.far,(r!==t.fov||o!==t.aspect||e!==t.far)&&(t.fov=r,t.aspect=o,t.far=e,t.updateProjectionMatrix())}}),Qo.prototype=Object.assign(Object.create(Xo.prototype),{constructor:Qo,isSpotLight:!0,copy:function(e){return Xo.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),qo.prototype=Object.assign(Object.create(Xo.prototype),{constructor:qo,isPointLight:!0,copy:function(e){return Xo.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Zo.prototype=Object.assign(Object.create(Ba.prototype),{constructor:Zo,isOrthographicCamera:!0,copy:function(e,t){return Ba.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(t,a,r,o,n,e){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=a,this.view.offsetX=r,this.view.offsetY=o,this.view.width=n,this.view.height=e,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=o-t;if(o+=t,t=n+r,r=n-r,null!==this.view&&this.view.enabled){o=this.zoom/(this.view.width/this.view.fullWidth),r=this.zoom/(this.view.height/this.view.fullHeight);var s=(this.right-this.left)/this.view.width;n=(this.top-this.bottom)/this.view.height,i+=this.view.offsetX/o*s,o=i+this.view.width/o*s,t-=this.view.offsetY/r*n,r=t-this.view.height/r*n}this.projectionMatrix.makeOrthographic(i,o,t,r,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return e=A.prototype.toJSON.call(this,e),e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Jo.prototype=Object.assign(Object.create(jo.prototype),{constructor:Jo}),Ko.prototype=Object.assign(Object.create(Xo.prototype),{constructor:Ko,isDirectionalLight:!0,copy:function(e){return Xo.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),$o.prototype=Object.assign(Object.create(Xo.prototype),{constructor:$o,isAmbientLight:!0}),en.prototype=Object.assign(Object.create(Xo.prototype),{constructor:en,isRectAreaLight:!0,copy:function(e){return Xo.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){return e=Xo.prototype.toJSON.call(this,e),e.object.width=this.width,e.object.height=this.height,e}}),Object.assign(tn.prototype,{load:function(t,r,a,o){var n=this,e=new oe(n.manager);e.setPath(n.path),e.load(t,function(e){r(n.parse(JSON.parse(e)))},a,o)},parse:function(t){function a(e){return void 0===r[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),r[e]}var r=this.textures,n=new xa[t.type];if(void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearCoat&&(n.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(n.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.vertexColors&&(n.vertexColors=t.vertexColors),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.combine&&(n.combine=t.combine),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.polygonOffset&&(n.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(n.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(n.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.uniforms)for(var i in t.uniforms){var l=t.uniforms[i];switch(n.uniforms[i]={},l.type){case"t":n.uniforms[i].value=a(l.value);break;case"c":n.uniforms[i].value=new w().setHex(l.value);break;case"v2":n.uniforms[i].value=new o().fromArray(l.value);break;case"v3":n.uniforms[i].value=new s().fromArray(l.value);break;case"v4":n.uniforms[i].value=new _().fromArray(l.value);break;case"m3":n.uniforms[i].value=new y().fromArray(l.value);case"m4":n.uniforms[i].value=new W().fromArray(l.value);break;default:n.uniforms[i].value=l.value;}}if(void 0!==t.defines&&(n.defines=t.defines),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var d in t.extensions)n.extensions[d]=t.extensions[d];return void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=a(t.map)),void 0!==t.matcap&&(n.matcap=a(t.matcap)),void 0!==t.alphaMap&&(n.alphaMap=a(t.alphaMap),n.transparent=!0),void 0!==t.bumpMap&&(n.bumpMap=a(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=a(t.normalMap)),void 0!==t.normalMapType&&(n.normalMapType=t.normalMapType),void 0!==t.normalScale&&(i=t.normalScale,!1===Array.isArray(i)&&(i=[i,i]),n.normalScale=new o().fromArray(i)),void 0!==t.displacementMap&&(n.displacementMap=a(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=a(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=a(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=a(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=a(t.specularMap)),void 0!==t.envMap&&(n.envMap=a(t.envMap)),void 0!==t.envMapIntensity&&(n.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.lightMap&&(n.lightMap=a(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=a(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=a(t.gradientMap)),n},setPath:function(e){return this.path=e,this},setTextures:function(e){return this.textures=e,this}});var Se={decodeText:function(e){if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);for(var t="",a=0,r=e.length;a<r;a++)t+=String.fromCharCode(e[a]);return decodeURIComponent(escape(t))},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};Object.assign(an.prototype,{load:function(t,r,a,o){var n=this,e=new oe(n.manager);e.setPath(n.path),e.load(t,function(e){r(n.parse(JSON.parse(e)))},a,o)},parse:function(t){var a=new Z,r=t.data.index;if(void 0!==r){var o=new Te[r.type](r.array);a.setIndex(new I(o,1))}for(var n in r=t.data.attributes,r){var i=r[n];o=new Te[i.type](i.array),o=new I(o,i.itemSize,i.normalized),void 0!==i.name&&(o.name=i.name),a.addAttribute(n,o)}var p=t.data.morphAttributes;if(p)for(n in p){var u=p[n],m=[];r=0;for(var l=u.length;r<l;r++)i=u[r],o=new Te[i.type](i.array),o=new I(o,i.itemSize,i.normalized),void 0!==i.name&&(o.name=i.name),m.push(o);a.morphAttributes[n]=m}if(n=t.data.groups||t.data.drawcalls||t.data.offsets,void 0!==n)for(r=0,i=n.length;r!==i;++r)o=n[r],a.addGroup(o.start,o.count,o.materialIndex);return r=t.data.boundingSphere,void 0!==r&&(n=new s,void 0!==r.center&&n.fromArray(r.center),a.boundingSphere=new S(n,r.radius)),t.name&&(a.name=t.name),t.userData&&(a.userData=t.userData),a},setPath:function(e){return this.path=e,this}});var Te={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"==typeof Uint8ClampedArray?Uint8Array:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};Object.assign(se.prototype,{crossOrigin:"anonymous",load:function(t,a,r,o){var n=this,e=void 0===this.path?Se.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||e,e=new oe(n.manager),e.setPath(this.path),e.load(t,function(e){var r=null;try{r=JSON.parse(e)}catch(e){return void 0!==o&&o(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}e=r.metadata,void 0===e||void 0===e.type||"geometry"===e.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+t):n.parse(r,a)},r,o)},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(t,a){var r=this.parseShape(t.shapes);r=this.parseGeometries(t.geometries,r);var o=this.parseImages(t.images,function(){void 0!==a&&a(n)});o=this.parseTextures(t.textures,o),o=this.parseMaterials(t.materials,o);var n=this.parseObject(t.object,r,o);return t.animations&&(n.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===a||a(n),n},parseShape:function(t){var a={};if(void 0!==t)for(var r=0,o=t.length,n;r<o;r++)n=new Pa().fromJSON(t[r]),a[n.uuid]=n;return a},parseGeometries:function(t,a){var r={};if(void 0!==t)for(var o=new an,i=0,s=t.length,d;i<s;i++){switch(d=t[i],d.type){case"PlaneGeometry":case"PlaneBufferGeometry":var p=new Mi[d.type](d.width,d.height,d.widthSegments,d.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":p=new Mi[d.type](d.width,d.height,d.depth,d.widthSegments,d.heightSegments,d.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":p=new Mi[d.type](d.radius,d.segments,d.thetaStart,d.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":p=new Mi[d.type](d.radiusTop,d.radiusBottom,d.height,d.radialSegments,d.heightSegments,d.openEnded,d.thetaStart,d.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":p=new Mi[d.type](d.radius,d.height,d.radialSegments,d.heightSegments,d.openEnded,d.thetaStart,d.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":p=new Mi[d.type](d.radius,d.widthSegments,d.heightSegments,d.phiStart,d.phiLength,d.thetaStart,d.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":p=new Mi[d.type](d.radius,d.detail);break;case"RingGeometry":case"RingBufferGeometry":p=new Mi[d.type](d.innerRadius,d.outerRadius,d.thetaSegments,d.phiSegments,d.thetaStart,d.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":p=new Mi[d.type](d.radius,d.tube,d.radialSegments,d.tubularSegments,d.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":p=new Mi[d.type](d.radius,d.tube,d.tubularSegments,d.radialSegments,d.p,d.q);break;case"TubeGeometry":case"TubeBufferGeometry":p=new Mi[d.type](new Re[d.path.type]().fromJSON(d.path),d.tubularSegments,d.radius,d.radialSegments,d.closed);break;case"LatheGeometry":case"LatheBufferGeometry":p=new Mi[d.type](d.points,d.segments,d.phiStart,d.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":p=new Mi[d.type](d.vertices,d.indices,d.radius,d.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":p=[];for(var c=0,u=d.shapes.length,m;c<u;c++)m=a[d.shapes[c]],p.push(m);p=new Mi[d.type](p,d.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(p=[],c=0,u=d.shapes.length;c<u;c++)m=a[d.shapes[c]],p.push(m);c=d.options.extrudePath,void 0!==c&&(d.options.extrudePath=new Re[c.type]().fromJSON(c)),p=new Mi[d.type](p,d.options);break;case"BufferGeometry":p=o.parse(d);break;case"Geometry":"THREE"in window&&"LegacyJSONLoader"in THREE?p=new THREE.LegacyJSONLoader().parse(d,this.resourcePath).geometry:console.error("THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type \"Geometry\".");break;default:console.warn("THREE.ObjectLoader: Unsupported geometry type \""+d.type+"\"");continue;}p.uuid=d.uuid,void 0!==d.name&&(p.name=d.name),!0===p.isBufferGeometry&&void 0!==d.userData&&(p.userData=d.userData),r[d.uuid]=p}return r},parseMaterials:function(t,a){var r={},o={};if(void 0!==t){var n=new tn;n.setTextures(a),a=0;for(var e=t.length,i;a<e;a++)if(i=t[a],"MultiMaterial"===i.type){for(var s=[],d=0,p;d<i.materials.length;d++)p=i.materials[d],void 0===r[p.uuid]&&(r[p.uuid]=n.parse(p)),s.push(r[p.uuid]);o[i.uuid]=s}else void 0===r[i.uuid]&&(r[i.uuid]=n.parse(i)),o[i.uuid]=r[i.uuid]}return o},parseAnimations:function(t){for(var a=[],r=0;r<t.length;r++){var o=t[r],n=Fo.parse(o);void 0!==o.uuid&&(n.uuid=o.uuid),a.push(n)}return a},parseImages:function(t,a){function r(t){return o.manager.itemStart(t),e.load(t,function(){o.manager.itemEnd(t)},void 0,function(){o.manager.itemError(t),o.manager.itemEnd(t)})}var o=this,i={};if(void 0!==t&&0<t.length){a=new No(a);var e=new pe(a);e.setCrossOrigin(this.crossOrigin),a=0;for(var s=t.length;a<s;a++){var d=t[a],c=d.url;if(Array.isArray(c)){i[d.uuid]=[];for(var l=0,u=c.length,n;l<u;l++)n=c[l],n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:o.resourcePath+n,i[d.uuid].push(r(n))}else n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d.url)?d.url:o.resourcePath+d.url,i[d.uuid]=r(n)}}return i},parseTextures:function(t,a){function o(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var n={};if(void 0!==t)for(var i=0,s=t.length,l;i<s;i++){l=t[i],void 0===l.image&&console.warn("THREE.ObjectLoader: No \"image\" specified for",l.uuid),void 0===a[l.image]&&console.warn("THREE.ObjectLoader: Undefined image",l.image);var d=Array.isArray(a[l.image])?new lt(a[l.image]):new r(a[l.image]);d.needsUpdate=!0,d.uuid=l.uuid,void 0!==l.name&&(d.name=l.name),void 0!==l.mapping&&(d.mapping=o(l.mapping,Ue)),void 0!==l.offset&&d.offset.fromArray(l.offset),void 0!==l.repeat&&d.repeat.fromArray(l.repeat),void 0!==l.center&&d.center.fromArray(l.center),void 0!==l.rotation&&(d.rotation=l.rotation),void 0!==l.wrap&&(d.wrapS=o(l.wrap[0],Ci),d.wrapT=o(l.wrap[1],Ci)),void 0!==l.format&&(d.format=l.format),void 0!==l.type&&(d.type=l.type),void 0!==l.encoding&&(d.encoding=l.encoding),void 0!==l.minFilter&&(d.minFilter=o(l.minFilter,Ri)),void 0!==l.magFilter&&(d.magFilter=o(l.magFilter,Ri)),void 0!==l.anisotropy&&(d.anisotropy=l.anisotropy),void 0!==l.flipY&&(d.flipY=l.flipY),void 0!==l.premultiplyAlpha&&(d.premultiplyAlpha=l.premultiplyAlpha),void 0!==l.unpackAlignment&&(d.unpackAlignment=l.unpackAlignment),n[l.uuid]=d}return n},parseObject:function(t,r,o){function n(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),r[e]}function i(t){if(void 0!==t){if(Array.isArray(t)){for(var a=[],r=0,n=t.length,e;r<n;r++)e=t[r],void 0===o[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),a.push(o[e]);return a}return void 0===o[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),o[t]}}switch(t.type){case"Scene":var e=new tr;void 0!==t.background&&Wn(t.background)&&(e.background=new w(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?e.fog=new qa(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(e.fog=new je(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":e=new Ha(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(e.focus=t.focus),void 0!==t.zoom&&(e.zoom=t.zoom),void 0!==t.filmGauge&&(e.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(e.filmOffset=t.filmOffset),void 0!==t.view&&(e.view=Object.assign({},t.view));break;case"OrthographicCamera":e=new Zo(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(e.zoom=t.zoom),void 0!==t.view&&(e.view=Object.assign({},t.view));break;case"AmbientLight":e=new $o(t.color,t.intensity);break;case"DirectionalLight":e=new Ko(t.color,t.intensity);break;case"PointLight":e=new qo(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":e=new en(t.color,t.intensity,t.width,t.height);break;case"SpotLight":e=new Qo(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":e=new T(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":e=n(t.geometry);var s=i(t.material);e=e.bones&&0<e.bones.length?new sr(e,s):new ge(e,s),void 0!==t.drawMode&&e.setDrawMode(t.drawMode);break;case"LOD":e=new ir;break;case"Line":e=new U(n(t.geometry),i(t.material),t.mode);break;case"LineLoop":e=new V(n(t.geometry),i(t.material));break;case"LineSegments":e=new ka(n(t.geometry),i(t.material));break;case"PointCloud":case"Points":e=new Ia(n(t.geometry),i(t.material));break;case"Sprite":e=new nr(i(t.material));break;case"Group":e=new Aa;break;default:e=new A;}if(e.uuid=t.uuid,void 0!==t.name&&(e.name=t.name),void 0===t.matrix?(void 0!==t.position&&e.position.fromArray(t.position),void 0!==t.rotation&&e.rotation.fromArray(t.rotation),void 0!==t.quaternion&&e.quaternion.fromArray(t.quaternion),void 0!==t.scale&&e.scale.fromArray(t.scale)):(e.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(e.matrixAutoUpdate=t.matrixAutoUpdate),e.matrixAutoUpdate&&e.matrix.decompose(e.position,e.quaternion,e.scale)),void 0!==t.castShadow&&(e.castShadow=t.castShadow),void 0!==t.receiveShadow&&(e.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(e.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(e.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&e.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(e.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(e.visible=t.visible),void 0!==t.frustumCulled&&(e.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(e.renderOrder=t.renderOrder),void 0!==t.userData&&(e.userData=t.userData),void 0!==t.layers&&(e.layers.mask=t.layers),void 0!==t.children){s=t.children;for(var d=0;d<s.length;d++)e.add(this.parseObject(s[d],r,o))}if("LOD"===t.type)for(t=t.levels,s=0;s<t.length;s++){d=t[s];var p=e.getObjectByProperty("uuid",d.object);void 0!==p&&e.addLevel(p,d.distance)}return e}});var Ue={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},Ci={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Ri={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};te.prototype={constructor:te,setOptions:function(e){return this.options=e,this},load:function(t,r,o,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,e=ba.get(t);return void 0===e?void(fetch(t).then(function(e){return e.blob()}).then(function(e){return void 0===i.options?createImageBitmap(e):createImageBitmap(e,i.options)}).then(function(e){ba.add(t,e),r&&r(e),i.manager.itemEnd(t)}).catch(function(e){n&&n(e),i.manager.itemError(t),i.manager.itemEnd(t)}),i.manager.itemStart(t)):(i.manager.itemStart(t),setTimeout(function(){r&&r(e),i.manager.itemEnd(t)},0),e)},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(ue.prototype,{moveTo:function(e,t){this.currentPath=new Wo,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,a,r){this.currentPath.quadraticCurveTo(e,t,a,r)},bezierCurveTo:function(t,a,r,o,n,e){this.currentPath.bezierCurveTo(t,a,r,o,n,e)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(o,i){function s(t){for(var a=[],r=0,o=t.length;r<o;r++){var n=t[r],e=new Pa;e.curves=n.curves,a.push(e)}return a}function c(t,a){for(var r=a.length,o=!1,n=r-1,i=0;i<r;n=i++){var s=a[n],p=a[i],c=p.x-s.x,u=p.y-s.y;if(ri(u)>jn){if(0>u&&(s=a[i],c=-c,p=a[n],u=-u),!(t.y<s.y||t.y>p.y))if(t.y!==s.y){if(n=u*(t.x-s.x)-c*(t.y-s.y),0===n)return!0;0>n||(o=!o)}else if(t.x===s.x)return!0;}else if(t.y===s.y&&(p.x<=t.x&&t.x<=s.x||s.x<=t.x&&t.x<=p.x))return!0}return o}var d=wi.isClockWise,m=this.subPaths;if(0===m.length)return[];if(!0===i)return s(m);if(i=[],1===m.length){var y=m[0],x=new Pa;return x.curves=y.curves,i.push(x),i}var _=!d(m[0].getPoints());_=o?!_:_,x=[];var T=[],S=[],E=0;T[E]=void 0,S[E]=[];for(var w=0,A=m.length;w<A;w++){y=m[w];var t=y.getPoints(),M=d(t);(M=o?!M:M)?(!_&&T[E]&&E++,T[E]={s:new Pa,p:t},T[E].s.curves=y.curves,_&&E++,S[E]=[]):S[E].push({h:y,p:t[0]})}if(!T[0])return s(m);if(1<T.length){for(w=!1,o=[],d=0,m=T.length;d<m;d++)x[d]=[];for(d=0,m=T.length;d<m;d++)for(y=S[d],M=0;M<y.length;M++){for(_=y[M],E=!0,t=0;t<T.length;t++)c(_.p,T[t].p)&&(d!==t&&o.push({froms:d,tos:t,hole:M}),E?(E=!1,x[t].push(_)):w=!0);E&&x[d].push(_)}0<o.length&&(w||(S=x))}for(w=0,d=T.length;w<d;w++)for(x=T[w].s,i.push(x),o=S[w],m=0,y=o.length;m<y;m++)x.holes.push(o[m].h);return i}}),Object.assign(ve.prototype,{isFont:!0,generateShapes:function(o,i){void 0===i&&(i=100);var s=[],c=i;i=this.data;var m=Array.from?Array.from(o):(o+"").split("");c/=i.resolution;var _=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*c;o=[];for(var f=0,T=0,S=0,E;S<m.length;S++)if(E=m[S],"\n"===E)f=0,T-=_;else{var M=c,P=f,p=T;if(E=i.glyphs[E]||i.glyphs["?"]){var v=new ue;if(E.o)for(var t=E._cachedOutline||(E._cachedOutline=E.o.split(" ")),r=0,L=t.length;r<L;)switch(t[r++]){case"m":var w=t[r++]*M+P,R=t[r++]*M+p;v.moveTo(w,R);break;case"l":w=t[r++]*M+P,R=t[r++]*M+p,v.lineTo(w,R);break;case"q":var F=t[r++]*M+P,I=t[r++]*M+p,N=t[r++]*M+P,D=t[r++]*M+p;v.quadraticCurveTo(N,D,F,I);break;case"b":F=t[r++]*M+P,I=t[r++]*M+p,N=t[r++]*M+P,D=t[r++]*M+p,w=t[r++]*M+P,R=t[r++]*M+p,v.bezierCurveTo(N,D,w,R,F,I);}M={offsetX:E.ha*M,path:v}}else M=void 0;f+=M.offsetX,o.push(M.path)}for(i=0,m=o.length;i<m;i++)Array.prototype.push.apply(s,o[i].toShapes());return s}}),Object.assign(we.prototype,{load:function(t,r,a,o){var n=this,e=new oe(this.manager);e.setPath(this.path),e.load(t,function(e){try{var t=JSON.parse(e)}catch(a){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),t=JSON.parse(e.substring(65,e.length-2))}e=n.parse(t),r&&r(e)},a,o)},parse:function(e){return new ve(e)},setPath:function(e){return this.path=e,this}}),rn.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(t){for(var a=this.handlers,r=0,o=a.length,n;r<o;r+=2)if(n=a[r+1],a[r].test(t))return n;return null}},Object.assign(rn.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,a,r){for(var o=[],n=0;n<t.length;++n)o[n]=this.createMaterial(t[n],a,r);return o},createMaterial:function(){var t={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},a=new w,r=new qe,o=new tn;return function(i,s,c){function e(t,o,n,i,e){t=s+t;var l=rn.Handlers.get(t);return null===l?(r.setCrossOrigin(c),t=r.load(t)):t=l.load(t),void 0!==o&&(t.repeat.fromArray(o),1!==o[0]&&(t.wrapS=1E3),1!==o[1]&&(t.wrapT=1E3)),void 0!==n&&t.offset.fromArray(n),void 0!==i&&("repeat"===i[0]&&(t.wrapS=1E3),"mirror"===i[0]&&(t.wrapS=1002),"repeat"===i[1]&&(t.wrapT=1E3),"mirror"===i[1]&&(t.wrapT=1002)),void 0!==e&&(t.anisotropy=e),o=ni.generateUUID(),u[o]=t,o}var u={},l={uuid:ni.generateUUID(),type:"MeshLambertMaterial"},d;for(d in i){var m=i[d];switch(d){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":l.name=m;break;case"blending":l.blending=t[m];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",d,"is no longer supported.");break;case"colorDiffuse":l.color=a.fromArray(m).getHex();break;case"colorSpecular":l.specular=a.fromArray(m).getHex();break;case"colorEmissive":l.emissive=a.fromArray(m).getHex();break;case"specularCoef":l.shininess=m;break;case"shading":"basic"===m.toLowerCase()&&(l.type="MeshBasicMaterial"),"phong"===m.toLowerCase()&&(l.type="MeshPhongMaterial"),"standard"===m.toLowerCase()&&(l.type="MeshStandardMaterial");break;case"mapDiffuse":l.map=e(m,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":l.emissiveMap=e(m,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":l.lightMap=e(m,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":l.aoMap=e(m,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":l.bumpMap=e(m,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":l.bumpScale=m;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":l.normalMap=e(m,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":l.normalScale=m;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":l.specularMap=e(m,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":l.metalnessMap=e(m,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":l.roughnessMap=e(m,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":l.alphaMap=e(m,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":l.side=1;break;case"doubleSided":l.side=2;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),l.opacity=m;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":l[d]=m;break;case"vertexColors":!0===m&&(l.vertexColors=2),"face"===m&&(l.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",d,m);}}return"MeshBasicMaterial"===l.type&&delete l.emissive,"MeshPhongMaterial"!==l.type&&delete l.specular,1>l.opacity&&(l.transparent=!0),o.setTextures(u),o.parse(l)}}()});var Fi={getContext:function(){return void 0===Ce&&(Ce=new(window.AudioContext||window.webkitAudioContext)),Ce},setContext:function(e){Ce=e}},Ce;Object.assign(on.prototype,{load:function(t,r,a,o){var n=new oe(this.manager);n.setResponseType("arraybuffer"),n.setPath(this.path),n.load(t,function(e){e=e.slice(0),Fi.getContext().decodeAudioData(e,function(e){r(e)})},a,o)},setPath:function(e){return this.path=e,this}}),Object.assign(xe.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;9>t;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;9>e;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(t,r){var o=t.x,n=t.y;t=t.z;var i=this.coefficients;return r=.282095*i[0],r+=.488603*i[1]*n,r+=.488603*i[2]*t,r+=.488603*i[3]*o,r+=1.092548*i[4]*o*n,r+=1.092548*i[5]*n*t,r+=.315392*i[6]*(3*t*t-1),r+=1.092548*i[7]*o*t,r+=.546274*i[8]*(o*o-n*n)},getIrradianceAt:function(t,r){var o=t.x,n=t.y;t=t.z;var i=this.coefficients;return r=.886227*i[0],r+=1.023328*i[1]*n,r+=1.023328*i[2]*t,r+=1.023328*i[3]*o,r+=.858086*i[4]*o*n,r+=.858086*i[5]*n*t,r+=i[6]*(.743125*t*t-.247708),r+=.858086*i[7]*o*t,r+=.429043*i[8]*(o*o-n*n)},add:function(e){for(var t=0;9>t;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;9>t;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var a=0;9>a;a++)this.coefficients[a].lerp(e.coefficients[a],t);return this},equals:function(e){for(var t=0;9>t;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(e){for(var t=this.coefficients,a=0;9>a;a++)t[a].fromArray(e,3*a);return this},toArray:function(){for(var e=[],t=this.coefficients,a=0;9>a;a++)t[a].toArray(e,3*a);return e}}),Object.assign(xe,{getBasisAt:function(e,t){var r=e.x,o=e.y;e=e.z,t[0]=.282095,t[1]=.488603*o,t[2]=.488603*e,t[3]=.488603*r,t[4]=1.092548*r*o,t[5]=1.092548*o*e,t[6]=.315392*(3*e*e-1),t[7]=1.092548*r*e,t[8]=.546274*(r*r-o*o)}}),nn.prototype=Object.assign(Object.create(Xo.prototype),{constructor:nn,isLightProbe:!0,copy:function(e){return Xo.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return Xo.prototype.toJSON.call(this,e)}}),Qa.prototype=Object.assign(Object.create(nn.prototype),{constructor:Qa,isHemisphereLightProbe:!0,copy:function(e){return nn.prototype.copy.call(this,e),this},toJSON:function(e){return nn.prototype.toJSON.call(this,e)}}),ye.prototype=Object.assign(Object.create(nn.prototype),{constructor:ye,isAmbientLightProbe:!0,copy:function(e){return nn.prototype.copy.call(this,e),this},toJSON:function(e){return nn.prototype.toJSON.call(this,e)}}),Object.assign(ze.prototype,{update:function(){var o=new W,i=new W,s,l,p,y,x,v,_,T;return function(e){if(s!==this||l!==e.focus||p!==e.fov||y!==e.aspect*this.aspect||x!==e.near||v!==e.far||_!==e.zoom||T!==this.eyeSep){s=this,l=e.focus,p=e.fov,y=e.aspect*this.aspect,x=e.near,v=e.far,_=e.zoom;var a=e.projectionMatrix.clone();T=this.eyeSep/2;var n=T*x/l,d=x*Oe(.5*(ni.DEG2RAD*p))/_;i.elements[12]=-T,o.elements[12]=T;var t=-d*y+n,c=d*y+n;a.elements[0]=2*x/(c-t),a.elements[8]=(c+t)/(c-t),this.cameraL.projectionMatrix.copy(a),t=-d*y-n,c=d*y-n,a.elements[0]=2*x/(c-t),a.elements[8]=(c+t)/(c-t),this.cameraR.projectionMatrix.copy(a)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(i),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(o)}}()}),sn.prototype=Object.create(A.prototype),sn.prototype.constructor=sn,Object.assign(ln.prototype,{start:function(){this.oldTime=this.startTime=("undefined"==typeof performance?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1E3,this.oldTime=t,this.elapsedTime+=e}return e}}),Ae.prototype=Object.assign(Object.create(A.prototype),{constructor:Ae,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(){var t=new s,a=new i,r=new s,o=new s,n=new ln;return function(e){A.prototype.updateMatrixWorld.call(this,e),e=this.context.listener;var i=this.up;if(this.timeDelta=n.getDelta(),this.matrixWorld.decompose(t,a,r),o.set(0,0,-1).applyQuaternion(a),e.positionX){var s=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(t.x,s),e.positionY.linearRampToValueAtTime(t.y,s),e.positionZ.linearRampToValueAtTime(t.z,s),e.forwardX.linearRampToValueAtTime(o.x,s),e.forwardY.linearRampToValueAtTime(o.y,s),e.forwardZ.linearRampToValueAtTime(o.z,s),e.upX.linearRampToValueAtTime(i.x,s),e.upY.linearRampToValueAtTime(i.y,s),e.upZ.linearRampToValueAtTime(i.z,s)}else e.setPosition(t.x,t.y,t.z),e.setOrientation(o.x,o.y,o.z,i.x,i.y,i.z)}}()}),Be.prototype=Object.assign(Object.create(A.prototype),{constructor:Be,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else{var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}},pause:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this)},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),dn.prototype=Object.assign(Object.create(Be.prototype),{constructor:dn,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,a){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=a,this},updateMatrixWorld:function(){var t=new s,a=new i,r=new s,o=new s;return function(n){if(A.prototype.updateMatrixWorld.call(this,n),!0!==this.hasPlaybackControl||!1!==this.isPlaying)if(this.matrixWorld.decompose(t,a,r),o.set(0,0,1).applyQuaternion(a),n=this.panner,n.positionX){var i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(t.x,i),n.positionY.linearRampToValueAtTime(t.y,i),n.positionZ.linearRampToValueAtTime(t.z,i),n.orientationX.linearRampToValueAtTime(o.x,i),n.orientationY.linearRampToValueAtTime(o.y,i),n.orientationZ.linearRampToValueAtTime(o.z,i)}else n.setPosition(t.x,t.y,t.z),n.setOrientation(o.x,o.y,o.z)}}()}),Object.assign(De.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),r=0;r<t.length;r++)e+=t[r];return e/t.length}}),Object.assign(Ee.prototype,{accumulate:function(t,r){var o=this.buffer,n=this.valueSize;t=t*n+n;var i=this.cumulativeWeight;if(0===i){for(i=0;i!==n;++i)o[t+i]=o[i];i=r}else i+=r,this._mixBufferRegion(o,t,0,r/i,n);this.cumulativeWeight=i},apply:function(t){var r=this.valueSize,o=this.buffer;t=t*r+r;var n=this.cumulativeWeight,i=this.binding;this.cumulativeWeight=0,1>n&&this._mixBufferRegion(o,t,3*r,1-n,r),n=r;for(;n!==r+r;++n)if(o[n]!==o[n+r]){i.setValue(o,t);break}},saveOriginalState:function(){var e=this.buffer,t=this.valueSize,a=3*t;this.binding.getValue(e,a);for(var r=t;r!==a;++r)e[r]=e[a+r%t];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(t,a,r,o,n){if(.5<=o)for(o=0;o!==n;++o)t[a+o]=t[r+o]},_slerp:function(e,t,a,r){i.slerpFlat(e,t,e,t,e,a,r)},_lerp:function(t,a,r,o,n){for(var e=0,i;e!==n;++e)i=a+e,t[i]=t[i]*(1-o)+t[r+e]*o}}),Object.assign(Fe.prototype,{getValue:function(e,t){this.bind();var a=this._bindings[this._targetGroup.nCachedObjects_];void 0!==a&&a.getValue(e,t)},setValue:function(t,a){for(var r=this._bindings,o=this._targetGroup.nCachedObjects_,n=r.length;o!==n;++o)r[o].setValue(t,a)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,a=e.length;t!==a;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,a=e.length;t!==a;++t)e[t].unbind()}}),Object.assign(pn,{Composite:Fe,create:function(e,t,a){return e&&e.isAnimationObjectGroup?new pn.Composite(e,t,a):new pn(e,t,a)},sanitizeNodeName:function(){var e=/[\[\]\.:\/]/g;return function(t){return t.replace(/\s/g,"_").replace(e,"")}}(),parseTrackName:function(){var t="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",r=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]");t=/(WCOD+)?/.source.replace("WCOD",t);var o=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),n=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),i=new RegExp("^"+r+t+o+n+"$"),e=["material","materials","bones"];return function(t){var a=i.exec(t);if(!a)throw Error("PropertyBinding: Cannot parse trackName: "+t);a={nodeName:a[2],objectName:a[3],objectIndex:a[4],propertyName:a[5],propertyIndex:a[6]};var r=a.nodeName&&a.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var o=a.nodeName.substring(r+1);-1!==e.indexOf(o)&&(a.nodeName=a.nodeName.substring(0,r),a.objectName=o)}if(null===a.propertyName||0===a.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+t);return a}}(),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){var o=function(r){for(var a=0,n;a<r.length;a++)if(n=r[a],n.name===t||n.uuid===t||(n=o(n.children)))return n;return null};if(e=o(e.children))return e}return null}}),Object.assign(pn.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(t,a){for(var r=this.resolvedProperty,o=0,n=r.length;o!==n;++o)t[a++]=r[o]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,a){for(var r=this.resolvedProperty,o=0,n=r.length;o!==n;++o)r[o]=t[a++]},function(t,a){for(var r=this.resolvedProperty,o=0,n=r.length;o!==n;++o)r[o]=t[a++];this.targetObject.needsUpdate=!0},function(t,a){for(var r=this.resolvedProperty,o=0,n=r.length;o!==n;++o)r[o]=t[a++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var t=this.node,r=this.parsedPath,o=r.objectName,n=r.propertyName,i=r.propertyIndex;if(t||(this.node=t=pn.findNode(this.rootNode,r.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(o){var s=r.objectIndex;switch(o){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(t=t.skeleton.bones,o=0;o<t.length;o++)if(t[o].name===s){s=o;break}break;default:if(void 0===t[o])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[o];}if(void 0!==s){if(void 0===t[s])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[s]}}if(s=t[n],void 0===s)console.error("THREE.PropertyBinding: Trying to update property for track: "+r.nodeName+"."+n+" but it wasn't found.",t);else{if(r=this.Versioning.None,this.targetObject=t,void 0===t.needsUpdate?void 0!==t.matrixWorldNeedsUpdate&&(r=this.Versioning.MatrixWorldNeedsUpdate):r=this.Versioning.NeedsUpdate,o=this.BindingType.Direct,void 0!==i){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===i){i=o;break}}}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][r]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(pn.prototype,{_getValue_unbound:pn.prototype.getValue,_setValue_unbound:pn.prototype.setValue}),Object.assign(ia.prototype,{isAnimationObjectGroup:!0,add:function(){for(var o=this._objects,a=o.length,i=this.nCachedObjects_,s=this._indicesByUUID,d=this._paths,e=this._parsedPaths,m=this._bindings,f=m.length,g=void 0,h=0,y=arguments.length;h!==y;++h){var n=arguments[h],p=n.uuid,x=s[p];if(void 0===x){x=a++,s[p]=x,o.push(n),p=0;for(var _=f;p!==_;++p)m[p].push(new pn(n,d[p],e[p]))}else if(x<i){g=o[x];var T=--i;for(_=o[T],s[_.uuid]=x,o[x]=_,s[p]=T,o[T]=n,p=0,_=f;p!==_;++p){var u=m[p],S=u[x];u[x]=u[T],void 0===S&&(S=new pn(n,d[p],e[p])),u[T]=S}}else o[x]!==g&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var t=this._objects,a=this.nCachedObjects_,r=this._indicesByUUID,o=this._bindings,i=o.length,e=0,s=arguments.length;e!==s;++e){var d=arguments[e],c=d.uuid,u=r[c];if(void 0!==u&&u>=a){var m=a++,n=t[m];for(r[n.uuid]=u,t[u]=n,r[c]=m,t[m]=d,d=0,c=i;d!==c;++d){n=o[d];var g=n[u];n[u]=n[m],n[m]=g}}}this.nCachedObjects_=a},uncache:function(){for(var o=this._objects,a=o.length,i=this.nCachedObjects_,s=this._indicesByUUID,d=this._bindings,e=d.length,u=0,m=arguments.length;u!==m;++u){var f=arguments[u].uuid,h=s[f];if(void 0!==h)if(delete s[f],h<i){f=--i;var y=o[f],x=--a,_=o[x];for(s[y.uuid]=h,o[h]=y,s[_.uuid]=f,o[f]=_,o.pop(),y=0,_=e;y!==_;++y){var T=d[y],S=T[x];T[h]=T[f],T[f]=S,T.pop()}}else for(x=--a,_=o[x],s[_.uuid]=h,o[h]=_,o.pop(),y=0,_=e;y!==_;++y)T=d[y],T[h]=T[x],T.pop()}this.nCachedObjects_=i},subscribe_:function(t,a){var r=this._bindingsIndicesByPath,o=r[t],n=this._bindings;if(void 0!==o)return n[o];var e=this._paths,i=this._parsedPaths,s=this._objects,l=this.nCachedObjects_,p=Array(s.length);for(o=n.length,r[t]=o,e.push(t),i.push(a),n.push(p),r=l,o=s.length;r!==o;++r)p[r]=new pn(s[r],t,a);return p},unsubscribe_:function(t){var a=this._bindingsIndicesByPath,r=a[t];if(void 0!==r){var o=this._paths,n=this._parsedPaths,e=this._bindings,i=e.length-1,s=e[i];a[t[i]]=r,e[r]=s,e.pop(),n[r]=n[i],n.pop(),o[r]=o[i],o.pop()}}}),Object.assign(cn.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(t,a,r){if(t.fadeOut(a),this.fadeIn(a),r){r=this._clip.duration;var o=t._clip.duration,n=r/o;t.warp(1,o/r,a),this.warp(n,1,a)}return this},crossFadeTo:function(e,t,a){return e.crossFadeFrom(this,t,a)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(t,a,r){var o=this._mixer,n=o.time,e=this._timeScaleInterpolant,i=this.timeScale;return null===e&&(this._timeScaleInterpolant=e=o._lendControlInterpolant()),o=e.parameterPositions,e=e.sampleValues,o[0]=n,o[1]=n+r,e[0]=t/i,e[1]=a/i,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,r,o,n){if(this.enabled){var i=this._startTime;if(null!==i){if(r=(t-i)*o,0>r||0===o)return;this._startTime=null,r*=o}if(r*=this._updateTimeScale(t),o=this._updateTime(r),t=this._updateWeight(t),0<t){r=this._interpolants,i=this._propertyBindings;for(var s=0,l=r.length;s!==l;++s)r[s].evaluate(o),i[s].accumulate(n,t)}}else this._updateWeight(t)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var a=this._weightInterpolant;if(null!==a){var r=a.evaluate(e)[0];t*=r,e>a.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var a=this._timeScaleInterpolant;if(null!==a){var r=a.evaluate(e)[0];t*=r,e>a.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t},_updateTime:function(t){var r=this.time+t,o=this._clip.duration,n=this.loop,i=this._loopCount,s=2202===n;if(0===t)return-1===i?r:s&&1==(1&i)?o-r:r;if(2200===n)a:{if(-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1)),r>=o)r=o;else if(0>r)r=0;else break a;this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}else{if(-1===i&&(0<=t?(i=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),r>=o||0>r){n=oi(r/o),r-=o*n,i+=ri(n);var l=this.repetitions-i;0>=l?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=0<t?o:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(1===l?(t=0>t,this._setEndings(t,!t,s)):this._setEndings(!1,!1,s),this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n}))}if(s&&1==(1&i))return this.time=r,o-r}return this.time=r},_setEndings:function(e,t,a){var r=this._interpolantSettings;a?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,a,r){var o=this._mixer,n=o.time,e=this._weightInterpolant;return null===e&&(this._weightInterpolant=e=o._lendControlInterpolant()),o=e.parameterPositions,e=e.sampleValues,o[0]=n,e[0]=a,o[1]=n+t,e[1]=r,this}}),un.prototype=Object.assign(Object.create(t.prototype),{constructor:un,_bindAction:function(t,r){var o=t._localRoot||this._root,i=t._clip.tracks,s=i.length,e=t._propertyBindings;t=t._interpolants;var l=o.uuid,d=this._bindingsByRootAndName,c=d[l];for(void 0===c&&(c={},d[l]=c),d=0;d!==s;++d){var u=i[d],m=u.name,n=c[m];if(void 0===n){if(n=e[d],void 0!==n){null===n._cacheIndex&&(++n.referenceCount,this._addInactiveBinding(n,l,m));continue}n=new Ee(pn.create(o,m,r&&r._propertyBindings[d].binding.parsedPath),u.ValueTypeName,u.getValueSize()),++n.referenceCount,this._addInactiveBinding(n,l,m)}e[d]=n,t[d].resultBuffer=n.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var a=(t._localRoot||this._root).uuid,r=t._clip.uuid,o=this._actionsByClip[r];this._bindAction(t,o&&o.knownActions[0]),this._addInactiveAction(t,r,a)}for(a=t._propertyBindings,r=0,o=a.length;r!==o;++r){var n=a[r];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var a=t._propertyBindings,r=0,o=a.length,n;r!==o;++r)n=a[r],0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n));this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){return e=e._cacheIndex,null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,a,r){var o=this._actions,n=this._actionsByClip,e=n[a];void 0===e?(e={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,n[a]=e):(a=e.knownActions,t._byClipCacheIndex=a.length,a.push(t)),t._cacheIndex=o.length,o.push(t),e.actionByRoot[r]=t},_removeInactiveAction:function(t){var a=this._actions,r=a[a.length-1],o=t._cacheIndex;r._cacheIndex=o,a[o]=r,a.pop(),t._cacheIndex=null,a=t._clip.uuid,r=this._actionsByClip,o=r[a];var n=o.knownActions,e=n[n.length-1],i=t._byClipCacheIndex;e._byClipCacheIndex=i,n[i]=e,n.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===n.length&&delete r[a],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(e){e=e._propertyBindings;for(var t=0,r=e.length,o;t!==r;++t)o=e[t],0==--o.referenceCount&&this._removeInactiveBinding(o)},_lendAction:function(t){var a=this._actions,r=t._cacheIndex,o=this._nActiveActions++,n=a[o];t._cacheIndex=o,a[o]=t,n._cacheIndex=r,a[r]=n},_takeBackAction:function(t){var a=this._actions,r=t._cacheIndex,o=--this._nActiveActions,n=a[o];t._cacheIndex=o,a[o]=t,n._cacheIndex=r,a[r]=n},_addInactiveBinding:function(t,a,r){var o=this._bindingsByRootAndName,n=o[a],i=this._bindings;void 0===n&&(n={},o[a]=n),n[r]=t,t._cacheIndex=i.length,i.push(t)},_removeInactiveBinding:function(t){var r=this._bindings,o=t.binding,n=o.rootNode.uuid;o=o.path;var i=this._bindingsByRootAndName,e=i[n],s=r[r.length-1];t=t._cacheIndex,s._cacheIndex=t,r[t]=s,r.pop(),delete e[o];a:{for(var l in e)break a;delete i[n]}},_lendBinding:function(t){var a=this._bindings,r=t._cacheIndex,o=this._nActiveBindings++,n=a[o];t._cacheIndex=o,a[o]=t,n._cacheIndex=r,a[r]=n},_takeBackBinding:function(t){var a=this._bindings,r=t._cacheIndex,o=--this._nActiveBindings,n=a[o];t._cacheIndex=o,a[o]=t,n._cacheIndex=r,a[r]=n},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,a=e[t];return void 0===a&&(a=new So(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),a.__cacheIndex=t,e[t]=a),a},_takeBackControlInterpolant:function(t){var a=this._controlInterpolants,r=t.__cacheIndex,o=--this._nActiveControlInterpolants,n=a[o];t.__cacheIndex=o,a[o]=t,n.__cacheIndex=r,a[r]=n},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,r){var o=r||this._root,n=o.uuid;o="string"==typeof t?Fo.findByName(o,t):t,t=null===o?t:o.uuid;var i=this._actionsByClip[t],e=null;if(void 0!==i){if(e=i.actionByRoot[n],void 0!==e)return e;e=i.knownActions[0],null===o&&(o=e._clip)}return null===o?null:(r=new cn(this,o,r),this._bindAction(r,e),this._addInactiveAction(r,t,n),r)},existingAction:function(e,t){var r=t||this._root;return t=r.uuid,r="string"==typeof e?Fo.findByName(r,e):e,e=this._actionsByClip[r?r.uuid:e],void 0===e?null:e.actionByRoot[t]||null},stopAllAction:function(){for(var t=this._actions,a=this._nActiveActions,r=this._bindings,o=this._nActiveBindings,n=this._nActiveBindings=this._nActiveActions=0;n!==a;++n)t[n].reset();for(n=0;n!==o;++n)r[n].useCount=0;return this},update:function(t){t*=this.timeScale;for(var r=this._actions,o=this._nActiveActions,n=this.time+=t,i=Xn(t),e=this._accuIndex^=1,s=0;s!==o;++s)r[s]._update(n,t,i,e);for(t=this._bindings,r=this._nActiveBindings,s=0;s!==r;++s)t[s].apply(e);return this},getRoot:function(){return this._root},uncacheClip:function(t){var r=this._actions;t=t.uuid;var o=this._actionsByClip,n=o[t];if(void 0!==n){n=n.knownActions;for(var i=0,s=n.length,l;i!==s;++i){l=n[i],this._deactivateAction(l);var p=l._cacheIndex,c=r[r.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=p,r[p]=c,r.pop(),this._removeInactiveBindingsForAction(l)}delete o[t]}},uncacheRoot:function(t){t=t.uuid;var r=this._actionsByClip;for(n in r){var o=r[n].actionByRoot[t];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var n=this._bindingsByRootAndName[t];if(void 0!==n)for(var i in n)t=n[i],t.restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(e,t){e=this.existingAction(e,t),null!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}}),Ge.prototype.clone=function(){return new Ge(void 0===this.value.clone?this.value:this.value.clone())},mn.prototype=Object.assign(Object.create(Z.prototype),{constructor:mn,isInstancedBufferGeometry:!0,copy:function(e){return Z.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)}}),He.prototype=Object.assign(Object.create(ar.prototype),{constructor:He,isInstancedInterleavedBuffer:!0,copy:function(e){return ar.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Ie.prototype=Object.assign(Object.create(I.prototype),{constructor:Ie,isInstancedBufferAttribute:!0,copy:function(e){return I.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Je.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,a){return a=a||[],gn(e,this,a,t),a.sort(fn),a},intersectObjects:function(t,a,r){if(r=r||[],!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var o=0,n=t.length;o<n;o++)gn(t[o],this,r,a);return r.sort(fn),r}}),Object.assign(Ke.prototype,{set:function(e,t,a){return this.radius=e,this.phi=t,this.theta=a,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=ei(1E-6,ai(Zn-1E-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,a){return this.radius=Jn(e*e+t*t+a*a),0===this.radius?this.phi=this.theta=0:(this.theta=Qn(e,a),this.phi=kn(ni.clamp(t/this.radius,-1,1))),this}}),Object.assign(hn.prototype,{set:function(e,t,a){return this.radius=e,this.theta=t,this.y=a,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,a){return this.radius=Jn(e*e+a*a),this.theta=Qn(e,a),this.y=t,this}}),Object.assign(yn.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,a=e.length;t<a;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new o;return function(t,a){return a=e.copy(a).multiplyScalar(.5),this.min.copy(t).sub(a),this.max.copy(t).add(a),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new o),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new o),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new o),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new o),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new o;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Le.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new s),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new s),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new s),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new s,t=new s;return function(a,r){return e.subVectors(a,this.start),t.subVectors(this.end,this.start),a=t.dot(t),a=t.dot(e)/a,r&&(a=ni.clamp(a,0,1)),a}}(),closestPointToPoint:function(e,t,r){return e=this.closestPointToPointParameter(e,t),void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new s),this.delta(r).multiplyScalar(e).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Me.prototype=Object.create(A.prototype),Me.prototype.constructor=Me,Me.prototype.isImmediateRenderObject=!0,xn.prototype=Object.create(ka.prototype),xn.prototype.constructor=xn,xn.prototype.update=function(){var o=new s,a=new s,i=new y;return function(){var s=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var l=this.object.matrixWorld,e=this.geometry.attributes.position,c=this.object.geometry;if(c&&c.isGeometry)for(var u=c.vertices,f=c.faces,y=c=0,x=f.length;y<x;y++)for(var n=f[y],p=0,b=n.vertexNormals.length,_;p<b;p++)_=n.vertexNormals[p],o.copy(u[n[s[p]]]).applyMatrix4(l),a.copy(_).applyMatrix3(i).normalize().multiplyScalar(this.size).add(o),e.setXYZ(c,o.x,o.y,o.z),c+=1,e.setXYZ(c,a.x,a.y,a.z),c+=1;else if(c&&c.isBufferGeometry)for(s=c.attributes.position,u=c.attributes.normal,p=c=0,b=s.count;p<b;p++)o.set(s.getX(p),s.getY(p),s.getZ(p)).applyMatrix4(l),a.set(u.getX(p),u.getY(p),u.getZ(p)),a.applyMatrix3(i).normalize().multiplyScalar(this.size).add(o),e.setXYZ(c,o.x,o.y,o.z),c+=1,e.setXYZ(c,a.x,a.y,a.z),c+=1;e.needsUpdate=!0}}(),vn.prototype=Object.create(A.prototype),vn.prototype.constructor=vn,vn.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},vn.prototype.update=function(){var e=new s;return function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1E3,a=t*Oe(this.light.angle);this.cone.scale.set(a,a,t),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e),void 0===this.color?this.cone.material.color.copy(this.light.color):this.cone.material.color.set(this.color)}}(),_n.prototype=Object.create(ka.prototype),_n.prototype.constructor=_n,_n.prototype.updateMatrixWorld=function(){var t=new s,a=new W,r=new W;return function(o){var n=this.bones,e=this.geometry,i=e.getAttribute("position");r.getInverse(this.root.matrixWorld);for(var s=0,l=0,d;s<n.length;s++)d=n[s],d.parent&&d.parent.isBone&&(a.multiplyMatrices(r,d.matrixWorld),t.setFromMatrixPosition(a),i.setXYZ(l,t.x,t.y,t.z),a.multiplyMatrices(r,d.parent.matrixWorld),t.setFromMatrixPosition(a),i.setXYZ(l+1,t.x,t.y,t.z),l+=2);e.getAttribute("position").needsUpdate=!0,A.prototype.updateMatrixWorld.call(this,o)}}(),Tn.prototype=Object.create(ge.prototype),Tn.prototype.constructor=Tn,Tn.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Tn.prototype.update=function(){void 0===this.color?this.material.color.copy(this.light.color):this.material.color.set(this.color)},Sn.prototype=Object.create(U.prototype),Sn.prototype.constructor=Sn,Sn.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color,t=ei(e.r,e.g,e.b);1<t&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}},Sn.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},En.prototype=Object.create(A.prototype),En.prototype.constructor=En,En.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},En.prototype.update=function(){var t=new s,a=new w,r=new w;return function(){var o=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var n=o.geometry.getAttribute("color");a.copy(this.light.color),r.copy(this.light.groundColor);for(var e=0,i=n.count,s;e<i;e++)s=e<i/2?a:r,n.setXYZ(e,s.r,s.g,s.b);n.needsUpdate=!0}o.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),wn.prototype=Object.create(ge.prototype),wn.prototype.constructor=wn,wn.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},wn.prototype.onBeforeRender=function(){return function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity}}(),An.prototype=Object.assign(Object.create(ka.prototype),{constructor:An,copy:function(e){return ka.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return new this.constructor().copy(this)}}),Mn.prototype=Object.create(ka.prototype),Mn.prototype.constructor=Mn,Pn.prototype=Object.create(U.prototype),Pn.prototype.constructor=Pn,Pn.prototype.update=function(){function r(r,a,n,i){for(n=(a-r)/n,g.setXYZ(c,0,0,0),u++,t=r;t<a;t+=n)h=c+u,g.setXYZ(h,Yn(t)*o,0,ti(t)*o),g.setXYZ(h+1,Yn(ai(t+n,a))*o,0,ti(ai(t+n,a))*o),g.setXYZ(h+2,0,0,0),u+=3;f.addGroup(c,u,i),c+=u,u=0}var a=this.audio,o=this.range,i=this.divisionsInnerAngle,s=this.divisionsOuterAngle,e=ni.degToRad(a.panner.coneInnerAngle);a=ni.degToRad(a.panner.coneOuterAngle);var l=e/2,d=a/2,c=0,u=0,f=this.geometry,g=f.attributes.position,t,h;f.clearGroups(),r(-d,-l,s,0),r(-l,l,i,1),r(l,d,s,0),g.needsUpdate=!0,e===a&&(this.material[0].visible=!1)},Pn.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},Ln.prototype=Object.create(ka.prototype),Ln.prototype.constructor=Ln,Ln.prototype.update=function(){var t=new s,a=new s,r=new y;return function(){this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);var o=this.object.matrixWorld,i=this.geometry.attributes.position,e=this.object.geometry,s=e.vertices;e=e.faces;for(var l=0,d=0,c=e.length;d<c;d++){var u=e[d],n=u.normal;t.copy(s[u.a]).add(s[u.b]).add(s[u.c]).divideScalar(3).applyMatrix4(o),a.copy(n).applyMatrix3(r).normalize().multiplyScalar(this.size).add(t),i.setXYZ(l,t.x,t.y,t.z),l+=1,i.setXYZ(l,a.x,a.y,a.z),l+=1}i.needsUpdate=!0}}(),Cn.prototype=Object.create(A.prototype),Cn.prototype.constructor=Cn,Cn.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Cn.prototype.update=function(){var e=new s,t=new s,a=new s;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),a.subVectors(t,e),this.lightPlane.lookAt(t),void 0===this.color?(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)):(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)),this.targetLine.lookAt(t),this.targetLine.scale.z=a.length()}}(),Rn.prototype=Object.create(ka.prototype),Rn.prototype.constructor=Rn,Rn.prototype.update=function(){function t(t,i,s,l){if(r.set(i,s,l).unproject(o),t=n[t],void 0!==t)for(i=e.getAttribute("position"),s=0,l=t.length;s<l;s++)i.setXYZ(t[s],r.x,r.y,r.z)}var r=new s,o=new Ba,e,n;return function(){e=this.geometry,n=this.pointMap,o.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),Fn.prototype=Object.create(ka.prototype),Fn.prototype.constructor=Fn,Fn.prototype.update=function(){var t=new u;return function(a){if(void 0!==a&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){a=t.min;var r=t.max,o=this.geometry.attributes.position,n=o.array;n[0]=r.x,n[1]=r.y,n[2]=r.z,n[3]=a.x,n[4]=r.y,n[5]=r.z,n[6]=a.x,n[7]=a.y,n[8]=r.z,n[9]=r.x,n[10]=a.y,n[11]=r.z,n[12]=r.x,n[13]=r.y,n[14]=a.z,n[15]=a.x,n[16]=r.y,n[17]=a.z,n[18]=a.x,n[19]=a.y,n[20]=a.z,n[21]=r.x,n[22]=a.y,n[23]=a.z,o.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),Fn.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Fn.prototype.copy=function(e){return ka.prototype.copy.call(this,e),this.object=e.object,this},Fn.prototype.clone=function(){return new this.constructor().copy(this)},In.prototype=Object.create(ka.prototype),In.prototype.constructor=In,In.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),A.prototype.updateMatrixWorld.call(this,e))},Nn.prototype=Object.create(U.prototype),Nn.prototype.constructor=Nn,Nn.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;1e-8>ri(t)&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=0>t?1:0,this.lookAt(this.plane.normal),A.prototype.updateMatrixWorld.call(this,e)};var Ii,Ni;Dn.prototype=Object.create(A.prototype),Dn.prototype.constructor=Dn,Dn.prototype.setDirection=function(){var e=new s,t;return function(a){.99999<a.y?this.quaternion.set(0,0,0,1):-.99999>a.y?this.quaternion.set(1,0,0,0):(e.set(a.z,0,-a.x).normalize(),t=kn(a.y),this.quaternion.setFromAxisAngle(e,t))}}(),Dn.prototype.setLength=function(e,t,a){void 0===t&&(t=.2*e),void 0===a&&(a=.2*t),this.line.scale.set(1,ei(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(a,t,a),this.cone.position.y=e,this.cone.updateMatrix()},Dn.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},Dn.prototype.copy=function(e){return A.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},Dn.prototype.clone=function(){return new this.constructor().copy(this)},Bn.prototype=Object.create(ka.prototype),Bn.prototype.constructor=Bn,Oo.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Oo.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(Oa.prototype,{createPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getPoints(e),this.createGeometry(e)},createSpacedPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getSpacedPoints(e),this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var a=new F,r=0,o=t.length,n;r<o;r++)n=t[r],a.vertices.push(new s(n.x,n.y,n.z||0));return a}}),Object.assign(Wo.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Un.prototype=Object.create(re.prototype),On.prototype=Object.create(re.prototype),zn.prototype=Object.create(re.prototype),Object.assign(zn.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),An.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},_n.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(rn.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Se.extractUrlBase(e)}}),Object.assign(se.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(yn.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(u.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Le.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(ni,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ni.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ni.ceilPowerOfTwo(e)}}),Object.assign(y.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(W.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new s),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,a,r,o,n,e){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,a,o,r,n,e)}}),x.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},i.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(de.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(ce.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(ce,{barycoordFromPoint:function(t,a,r,o,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ce.getBarycoord(t,a,r,o,n)},normal:function(e,t,a,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ce.getNormal(e,t,a,r)}}),Object.assign(Pa.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Yr(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ro(this,e)}}),Object.assign(o.prototype,{fromAttribute:function(e,t,a){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,a)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(s.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,a){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,a)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(_.prototype,{fromAttribute:function(e,t,a){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,a)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(F.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(A.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(A.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(ir.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(lr.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),sr.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Oo.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ha.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Xo.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(I.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(Z.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,a){void 0!==a&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Z.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Qr.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Ge.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(q.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new w}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}}}),Object.defineProperties(yo.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Q.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(ja.prototype,{clearTarget:function(e,t,a,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,a,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")}}),Object.defineProperties(ja.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Sa.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(n.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}}),Object.defineProperties(l.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(Xa.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),Be.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return new on().load(e,function(e){t.setBuffer(e)}),this},De.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},sn.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},O.crossOrigin=void 0,O.loadTexture=function(t,r,o,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new qe;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,o,void 0,n),r&&(t.mapping=r),t},O.loadTextureCube=function(t,r,o,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new Uo;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,o,void 0,n),r&&(t.mapping=r),t},O.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},O.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},e.WebGLMultisampleRenderTarget=a,e.WebGLRenderTargetCube=n,e.WebGLRenderTarget=l,e.WebGLRenderer=ja,e.ShaderLib=J,e.UniformsLib=di,e.UniformsUtils={clone:v,merge:d},e.ShaderChunk=li,e.FogExp2=je,e.Fog=qa,e.Scene=tr,e.Sprite=nr,e.LOD=ir,e.SkinnedMesh=sr,e.Skeleton=lr,e.Bone=dr,e.Mesh=ge,e.LineSegments=ka,e.LineLoop=V,e.Line=U,e.Points=Ia,e.Group=Aa,e.VideoTexture=cr,e.DataTexture=p,e.DataTexture2DArray=dt,e.DataTexture3D=pt,e.CompressedTexture=le,e.CubeTexture=lt,e.CanvasTexture=ur,e.DepthTexture=mr,e.Texture=r,e.AnimationLoader=Ka,e.CompressedTextureLoader=Do,e.DataTextureLoader=Bo,e.CubeTextureLoader=Uo,e.TextureLoader=qe,e.ObjectLoader=se,e.MaterialLoader=tn,e.BufferGeometryLoader=an,e.DefaultLoadingManager=Li,e.LoadingManager=No,e.ImageLoader=pe,e.ImageBitmapLoader=te,e.FontLoader=we,e.FileLoader=oe,e.Loader=rn,e.LoaderUtils=Se,e.Cache=ba,e.AudioLoader=on,e.SpotLightShadow=Yo,e.SpotLight=Qo,e.PointLight=qo,e.RectAreaLight=en,e.HemisphereLight=T,e.HemisphereLightProbe=Qa,e.DirectionalLightShadow=Jo,e.DirectionalLight=Ko,e.AmbientLight=$o,e.AmbientLightProbe=ye,e.LightShadow=jo,e.Light=Xo,e.LightProbe=nn,e.StereoCamera=ze,e.PerspectiveCamera=Ha,e.OrthographicCamera=Zo,e.CubeCamera=sn,e.ArrayCamera=ca,e.Camera=Ba,e.AudioListener=Ae,e.PositionalAudio=dn,e.AudioContext=Fi,e.AudioAnalyser=De,e.Audio=Be,e.VectorKeyframeTrack=Ro,e.StringKeyframeTrack=Co,e.QuaternionKeyframeTrack=Lo,e.NumberKeyframeTrack=Mo,e.ColorKeyframeTrack=Ao,e.BooleanKeyframeTrack=da,e.PropertyMixer=Ee,e.PropertyBinding=pn,e.KeyframeTrack=wo,e.AnimationUtils=Pi,e.AnimationObjectGroup=ia,e.AnimationMixer=un,e.AnimationClip=Fo,e.Uniform=Ge,e.InstancedBufferGeometry=mn,e.BufferGeometry=Z,e.Geometry=F,e.InterleavedBufferAttribute=rr,e.InstancedInterleavedBuffer=He,e.InterleavedBuffer=ar,e.InstancedBufferAttribute=Ie,e.Face3=L,e.Object3D=A,e.Raycaster=Je,e.Layers=f,e.EventDispatcher=t,e.Clock=ln,e.QuaternionLinearInterpolant=Po,e.LinearInterpolant=So,e.DiscreteInterpolant=Eo,e.CubicInterpolant=Da,e.Interpolant=To,e.Triangle=ce,e.Math=ni,e.Spherical=Ke,e.Cylindrical=hn,e.Plane=x,e.Frustum=C,e.Sphere=S,e.Ray=de,e.Matrix4=W,e.Matrix3=y,e.Box3=u,e.Box2=yn,e.Line3=Le,e.Euler=m,e.Vector4=_,e.Vector3=s,e.Vector2=o,e.Quaternion=i,e.Color=w,e.SphericalHarmonics3=xe,e.ImmediateRenderObject=Me,e.VertexNormalsHelper=xn,e.SpotLightHelper=vn,e.SkeletonHelper=_n,e.PointLightHelper=Tn,e.RectAreaLightHelper=Sn,e.HemisphereLightHelper=En,e.LightProbeHelper=wn,e.GridHelper=An,e.PolarGridHelper=Mn,e.PositionalAudioHelper=Pn,e.FaceNormalsHelper=Ln,e.DirectionalLightHelper=Cn,e.CameraHelper=Rn,e.BoxHelper=Fn,e.Box3Helper=In,e.PlaneHelper=Nn,e.ArrowHelper=Dn,e.AxesHelper=Bn,e.Shape=Pa,e.Path=Wo,e.ShapePath=ue,e.Font=ve,e.CurvePath=Oa,e.Curve=Oo,e.ImageUtils=O,e.ShapeUtils=wi,e.WebGLUtils=Ga,e.WireframeGeometry=fr,e.ParametricGeometry=gr,e.ParametricBufferGeometry=hr,e.TetrahedronGeometry=la,e.TetrahedronBufferGeometry=vr,e.OctahedronGeometry=br,e.OctahedronBufferGeometry=_r,e.IcosahedronGeometry=Tr,e.IcosahedronBufferGeometry=Sr,e.DodecahedronGeometry=Er,e.DodecahedronBufferGeometry=wr,e.PolyhedronGeometry=yr,e.PolyhedronBufferGeometry=xr,e.TubeGeometry=Ar,e.TubeBufferGeometry=Mr,e.TorusKnotGeometry=Pr,e.TorusKnotBufferGeometry=Lr,e.TorusGeometry=Cr,e.TorusBufferGeometry=Rr,e.TextGeometry=qr,e.TextBufferGeometry=Zr,e.SphereGeometry=Jr,e.SphereBufferGeometry=Kr,e.RingGeometry=$r,e.RingBufferGeometry=eo,e.PlaneGeometry=k,e.PlaneBufferGeometry=ee,e.LatheGeometry=to,e.LatheBufferGeometry=ao,e.ShapeGeometry=ro,e.ShapeBufferGeometry=oo,e.ExtrudeGeometry=Yr,e.ExtrudeBufferGeometry=Qr,e.EdgesGeometry=io,e.ConeGeometry=po,e.ConeBufferGeometry=co,e.CylinderGeometry=so,e.CylinderBufferGeometry=lo,e.CircleGeometry=uo,e.CircleBufferGeometry=mo,e.BoxGeometry=B,e.CubeGeometry=B,e.BoxBufferGeometry=K,e.ShadowMaterial=fo,e.SpriteMaterial=or,e.RawShaderMaterial=go,e.ShaderMaterial=Q,e.PointsMaterial=pr,e.MeshPhysicalMaterial=Za,e.MeshStandardMaterial=ho,e.MeshPhongMaterial=yo,e.MeshToonMaterial=Ja,e.MeshNormalMaterial=xo,e.MeshLambertMaterial=vo,e.MeshDepthMaterial=_a,e.MeshDistanceMaterial=Ta,e.MeshBasicMaterial=fe,e.MeshMatcapMaterial=bo,e.LineDashedMaterial=_o,e.LineBasicMaterial=ke,e.Material=q,e.Float64BufferAttribute=E,e.Float32BufferAttribute=j,e.Uint32BufferAttribute=H,e.Int32BufferAttribute=G,e.Uint16BufferAttribute=z,e.Int16BufferAttribute=D,e.Uint8ClampedBufferAttribute=N,e.Uint8BufferAttribute=h,e.Int8BufferAttribute=g,e.BufferAttribute=I,e.ArcCurve=Ea,e.CatmullRomCurve3=re,e.CubicBezierCurve=Ho,e.CubicBezierCurve3=La,e.EllipseCurve=M,e.LineCurve=$a,e.LineCurve3=wa,e.QuadraticBezierCurve=Ma,e.QuadraticBezierCurve3=Na,e.SplineCurve=Vo,e.REVISION="104",e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},e.CullFaceNone=0,e.CullFaceBack=1,e.CullFaceFront=2,e.CullFaceFrontBack=3,e.FrontFaceDirectionCW=0,e.FrontFaceDirectionCCW=1,e.BasicShadowMap=0,e.PCFShadowMap=1,e.PCFSoftShadowMap=2,e.FrontSide=0,e.BackSide=1,e.DoubleSide=2,e.FlatShading=1,e.SmoothShading=2,e.NoColors=0,e.FaceColors=1,e.VertexColors=2,e.NoBlending=0,e.NormalBlending=1,e.AdditiveBlending=2,e.SubtractiveBlending=3,e.MultiplyBlending=4,e.CustomBlending=5,e.AddEquation=100,e.SubtractEquation=101,e.ReverseSubtractEquation=102,e.MinEquation=103,e.MaxEquation=104,e.ZeroFactor=200,e.OneFactor=201,e.SrcColorFactor=202,e.OneMinusSrcColorFactor=203,e.SrcAlphaFactor=204,e.OneMinusSrcAlphaFactor=205,e.DstAlphaFactor=206,e.OneMinusDstAlphaFactor=207,e.DstColorFactor=208,e.OneMinusDstColorFactor=209,e.SrcAlphaSaturateFactor=210,e.NeverDepth=0,e.AlwaysDepth=1,e.LessDepth=2,e.LessEqualDepth=3,e.EqualDepth=4,e.GreaterEqualDepth=5,e.GreaterDepth=6,e.NotEqualDepth=7,e.MultiplyOperation=0,e.MixOperation=1,e.AddOperation=2,e.NoToneMapping=0,e.LinearToneMapping=1,e.ReinhardToneMapping=2,e.Uncharted2ToneMapping=3,e.CineonToneMapping=4,e.ACESFilmicToneMapping=5,e.UVMapping=300,e.CubeReflectionMapping=301,e.CubeRefractionMapping=302,e.EquirectangularReflectionMapping=303,e.EquirectangularRefractionMapping=304,e.SphericalReflectionMapping=305,e.CubeUVReflectionMapping=306,e.CubeUVRefractionMapping=307,e.RepeatWrapping=1E3,e.ClampToEdgeWrapping=1001,e.MirroredRepeatWrapping=1002,e.NearestFilter=1003,e.NearestMipMapNearestFilter=1004,e.NearestMipMapLinearFilter=1005,e.LinearFilter=1006,e.LinearMipMapNearestFilter=1007,e.LinearMipMapLinearFilter=1008,e.UnsignedByteType=1009,e.ByteType=1010,e.ShortType=1011,e.UnsignedShortType=1012,e.IntType=1013,e.UnsignedIntType=1014,e.FloatType=1015,e.HalfFloatType=1016,e.UnsignedShort4444Type=1017,e.UnsignedShort5551Type=1018,e.UnsignedShort565Type=1019,e.UnsignedInt248Type=1020,e.AlphaFormat=1021,e.RGBFormat=1022,e.RGBAFormat=1023,e.LuminanceFormat=1024,e.LuminanceAlphaFormat=1025,e.RGBEFormat=1023,e.DepthFormat=1026,e.DepthStencilFormat=1027,e.RedFormat=1028,e.RGB_S3TC_DXT1_Format=33776,e.RGBA_S3TC_DXT1_Format=33777,e.RGBA_S3TC_DXT3_Format=33778,e.RGBA_S3TC_DXT5_Format=33779,e.RGB_PVRTC_4BPPV1_Format=35840,e.RGB_PVRTC_2BPPV1_Format=35841,e.RGBA_PVRTC_4BPPV1_Format=35842,e.RGBA_PVRTC_2BPPV1_Format=35843,e.RGB_ETC1_Format=36196,e.RGBA_ASTC_4x4_Format=37808,e.RGBA_ASTC_5x4_Format=37809,e.RGBA_ASTC_5x5_Format=37810,e.RGBA_ASTC_6x5_Format=37811,e.RGBA_ASTC_6x6_Format=37812,e.RGBA_ASTC_8x5_Format=37813,e.RGBA_ASTC_8x6_Format=37814,e.RGBA_ASTC_8x8_Format=37815,e.RGBA_ASTC_10x5_Format=37816,e.RGBA_ASTC_10x6_Format=37817,e.RGBA_ASTC_10x8_Format=37818,e.RGBA_ASTC_10x10_Format=37819,e.RGBA_ASTC_12x10_Format=37820,e.RGBA_ASTC_12x12_Format=37821,e.LoopOnce=2200,e.LoopRepeat=2201,e.LoopPingPong=2202,e.InterpolateDiscrete=2300,e.InterpolateLinear=2301,e.InterpolateSmooth=2302,e.ZeroCurvatureEnding=2400,e.ZeroSlopeEnding=2401,e.WrapAroundEnding=2402,e.TrianglesDrawMode=0,e.TriangleStripDrawMode=1,e.TriangleFanDrawMode=2,e.LinearEncoding=3E3,e.sRGBEncoding=3001,e.GammaEncoding=3007,e.RGBEEncoding=3002,e.LogLuvEncoding=3003,e.RGBM7Encoding=3004,e.RGBM16Encoding=3005,e.RGBDEncoding=3006,e.BasicDepthPacking=3200,e.RGBADepthPacking=3201,e.TangentSpaceNormalMap=0,e.ObjectSpaceNormalMap=1,e.Face4=function(t,a,r,o,n,e,i){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new L(t,a,r,n,e,i)},e.LineStrip=0,e.LinePieces=1,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ia(e,t)},e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new nr(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ia(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new pr(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new pr(e)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new pr(e)},e.Vertex=function(e,t,a){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new s(e,t,a)},e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new I(e,t).setDynamic(!0)},e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new g(e,t)},e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new h(e,t)},e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new N(e,t)},e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new D(e,t)},e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new z(e,t)},e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new G(e,t)},e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new H(e,t)},e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new j(e,t)},e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new E(e,t)},e.ClosedSplineCurve3=Un,e.SplineCurve3=On,e.Spline=zn,e.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Bn(e)},e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Fn(e,t)},e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ka(new io(e.geometry),new ke({color:void 0===t?16777215:t}))},e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ka(new fr(e.geometry),new ke({color:void 0===t?16777215:t}))},e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new oe(e)},e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Bo(e)},e.GeometryUtils={merge:function(e,t,a){if(console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh){t.matrixAutoUpdate&&t.updateMatrix();var r=t.matrix;t=t.geometry}e.merge(t,r,a)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},e.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},e.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},e.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}},e.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")},Object.defineProperty(e,"__esModule",{value:!0})}),"use strict",THREE.HDRLoader=THREE.RGBELoader=function(e){this.manager=e===void 0?THREE.DefaultLoadingManager:e,this.type=THREE.UnsignedByteType},THREE.RGBELoader.prototype=Object.create(THREE.DataTextureLoader.prototype),THREE.RGBELoader.prototype._parser=function(e){var t=String.fromCharCode,a=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(t||""));}return-1},r=function(e,a,r){a=a?a:1024;for(var o=e.pos,n=-1,l=0,d="",c=128,u=t.apply(null,new Uint16Array(e.subarray(o,o+128)));0>(n=u.indexOf("\n"))&&l<a&&o<e.byteLength;)d+=u,l+=u.length,o+=c,u+=t.apply(null,new Uint16Array(e.subarray(o,o+c)));return!!(-1<n)&&(!1!==r&&(e.pos+=l+n+1),d+u.slice(0,n))},o=function(e,t,r){var o=t,n=r,s,d,p,c,u,m,f,g,h,y,x,v,b;if(8>o||32767<o||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(o!==(e[2]<<8|e[3]))return a(3,"wrong scanline width");if(s=new Uint8Array(4*t*r),!s||!s.length)return a(4,"unable to allocate buffer space");for(d=0,p=0,g=4*o,b=new Uint8Array(4),m=new Uint8Array(g);0<n&&p<e.byteLength;){if(p+4>e.byteLength)return a(1);if(b[0]=e[p++],b[1]=e[p++],b[2]=e[p++],b[3]=e[p++],2!=b[0]||2!=b[1]||(b[2]<<8|b[3])!=o)return a(3,"bad rgbe scanline format");for(f=0;f<g&&p<e.byteLength;){if(c=e[p++],v=128<c,v&&(c-=128),0===c||f+c>g)return a(3,"bad scanline data");if(v)for(u=e[p++],h=0;h<c;h++)m[f++]=u;else m.set(e.subarray(p,p+c),f),f+=c,p+=c}for(y=o,h=0;h<y;h++)x=0,s[d]=m[h+x],x+=o,s[d+1]=m[h+x],x+=o,s[d+2]=m[h+x],x+=o,s[d+3]=m[h+x],d+=4;n--}return s},n=new Uint8Array(e),i=n.byteLength;n.pos=0;var s=function(e){var t=/^#\?(\S+)$/,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,n=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*FORMAT=(\S+)\s*$/,s=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,l={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0},d,p;if(e.pos>=e.byteLength||!(d=r(e)))return a(1,"no header found");if(!(p=d.match(t)))return a(3,"bad initial token");for(l.valid|=1,l.programtype=p[1],l.string+=d+"\n";d=r(e),!1!==d;){if(l.string+=d+"\n","#"===d.charAt(0)){l.comments+=d+"\n";continue}if((p=d.match(o))&&(l.gamma=parseFloat(p[1],10)),(p=d.match(n))&&(l.exposure=parseFloat(p[1],10)),(p=d.match(i))&&(l.valid|=2,l.format=p[1]),(p=d.match(s))&&(l.valid|=4,l.height=parseInt(p[1],10),l.width=parseInt(p[2],10)),2&l.valid&&4&l.valid)break}return 2&l.valid?4&l.valid?l:a(3,"missing image size specifier"):a(3,"missing format specifier")}(n);if(-1!==s){var l=s.width,d=s.height,p=o(n.subarray(n.pos),l,d);if(-1!==p){if(this.type===THREE.UnsignedByteType)var c=p,u=THREE.RGBEFormat,m=THREE.UnsignedByteType;else if(this.type===THREE.FloatType){for(var f=function(t,a,r,o){var n=t[a+3],e=Math.pow(2,n-128)/255;r[o+0]=t[a+0]*e,r[o+1]=t[a+1]*e,r[o+2]=t[a+2]*e},g=3*(p.length/4),h=new Float32Array(g),y=0;y<g;y++)f(p,4*y,h,3*y);var c=h,u=THREE.RGBFormat,m=THREE.FloatType}else console.error("THREE.RGBELoader: unsupported type: ",this.type);return{width:l,height:d,data:c,header:s.string,gamma:s.gamma,exposure:s.exposure,format:u,type:m}}}return null},THREE.RGBELoader.prototype.setType=function(e){return this.type=e,this},"use strict",THREE.PMREMCubeUVPacker=function(){var e=Math.log,t=new THREE.OrthographicCamera,a=new THREE.Scene,r=function(){var e=new THREE.ShaderMaterial({uniforms:{faceIndex:{value:0},mapSize:{value:0},envMap:{value:null},testColor:{value:new THREE.Vector3(1,1,1)}},vertexShader:"precision highp float;        varying vec2 vUv;        void main() {          vUv = uv;          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );        }",fragmentShader:"precision highp float;        varying vec2 vUv;        uniform samplerCube envMap;        uniform float mapSize;        uniform vec3 testColor;        uniform int faceIndex;                void main() {          vec3 sampleDirection;          vec2 uv = vUv;          uv = uv * 2.0 - 1.0;          uv.y *= -1.0;          if(faceIndex == 0) {            sampleDirection = normalize(vec3(1.0, uv.y, -uv.x));          } else if(faceIndex == 1) {            sampleDirection = normalize(vec3(uv.x, 1.0, uv.y));          } else if(faceIndex == 2) {            sampleDirection = normalize(vec3(uv.x, uv.y, 1.0));          } else if(faceIndex == 3) {            sampleDirection = normalize(vec3(-1.0, uv.y, uv.x));          } else if(faceIndex == 4) {            sampleDirection = normalize(vec3(uv.x, -1.0, -uv.y));          } else {            sampleDirection = normalize(vec3(-uv.x, uv.y, -1.0));          }          vec4 color = envMapTexelToLinear( textureCube( envMap, sampleDirection ) );          gl_FragColor = linearToOutputTexel( color );        }",blending:THREE.NoBlending});return e.type="PMREMCubeUVPacker",e}(),o=function(t){this.cubeLods=t;var a=4*t[0].width,o=t[0].texture,n={format:o.format,magFilter:o.magFilter,minFilter:o.minFilter,type:o.type,generateMipmaps:o.generateMipmaps,anisotropy:o.anisotropy,encoding:o.encoding===THREE.RGBEEncoding?THREE.RGBM16Encoding:o.encoding};n.encoding===THREE.RGBM16Encoding&&(n.magFilter=THREE.LinearFilter,n.minFilter=THREE.LinearFilter),this.CubeUVRenderTarget=new THREE.WebGLRenderTarget(a,a,n),this.CubeUVRenderTarget.texture.name="PMREMCubeUVPacker.cubeUv",this.CubeUVRenderTarget.texture.mapping=THREE.CubeUVReflectionMapping,this.objects=[];var s=new THREE.PlaneBufferGeometry(1,1),l=[];l.push(new THREE.Vector2(0,0)),l.push(new THREE.Vector2(1,0)),l.push(new THREE.Vector2(2,0)),l.push(new THREE.Vector2(0,1)),l.push(new THREE.Vector2(1,1)),l.push(new THREE.Vector2(2,1));var d=a;a=t[0].width;var p=0,u=4;this.numLods=e(t[0].width)/e(2)-2;for(var m=0,f;m<this.numLods;m++){f=.5*(d-d/u),16<a&&(u*=2);for(var g=16<a?6:1,h=0,y=0,x=a,v=0;v<g;v++){for(var b=0,_;6>b;b++){_=r.clone(),_.uniforms.envMap.value=this.cubeLods[m].texture,_.envMap=this.cubeLods[m].texture,_.uniforms.faceIndex.value=b,_.uniforms.mapSize.value=x;var T=new THREE.Mesh(s,_);T.position.x=l[b].x*x-f+h,T.position.y=l[b].y*x-f+p+y,T.material.side=THREE.BackSide,T.scale.setScalar(x),this.objects.push(T)}y+=1.75*x,h+=1.25*x,x/=2}p+=2*a,16<a&&(a/=2)}};return o.prototype={constructor:o,update:function(e){var r=4*this.cubeLods[0].width;t.left=.5*-r,t.right=.5*r,t.top=.5*-r,t.bottom=.5*r,t.near=0,t.far=1,t.updateProjectionMatrix();for(var o=0;o<this.objects.length;o++)a.add(this.objects[o]);var n=e.gammaInput,s=e.gammaOutput,l=e.toneMapping,d=e.toneMappingExposure,p=e.getRenderTarget();e.gammaInput=!1,e.gammaOutput=!1,e.toneMapping=THREE.LinearToneMapping,e.toneMappingExposure=1,e.setRenderTarget(this.CubeUVRenderTarget),e.render(a,t),e.setRenderTarget(p),e.toneMapping=l,e.toneMappingExposure=d,e.gammaInput=n,e.gammaOutput=s;for(var o=0;o<this.objects.length;o++)a.remove(this.objects[o])},dispose:function(){for(var e=0,t=this.objects.length;e<t;e++)this.objects[e].material.dispose();this.objects[0].geometry.dispose()}},o}(),"use strict",THREE.PMREMGenerator=function(){var e=Math.log,t=Math.max,a=function(){var e=new THREE.ShaderMaterial({defines:{SAMPLES_PER_LEVEL:20},uniforms:{faceIndex:{value:0},roughness:{value:.5},mapSize:{value:.5},envMap:{value:null},tFlip:{value:-1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform int faceIndex;\n\t\t\t\tuniform float roughness;\n\t\t\t\tuniform samplerCube envMap;\n\t\t\t\tuniform float mapSize;\n\t\t\t\tuniform float tFlip;\n\t\t\t\t\n\t\t\t\tfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\t\t\t\t\tfloat a = ggxRoughness + 0.0001;\n\t\t\t\t\ta *= a;\n\t\t\t\t\treturn ( 2.0 / a - 2.0 );\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSamplePhong(vec2 uv, mat3 vecSpace, float specPow) {\n\t\t\t\t\tfloat phi = uv.y * 2.0 * PI;\n\t\t\t\t\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n\t\t\t\t\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\t\t\t\t\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n\t\t\t\t\treturn vecSpace * sampleDir;\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSampleGGX( vec2 uv, mat3 vecSpace, float Roughness )\n\t\t\t\t{\n\t\t\t\t\tfloat a = Roughness * Roughness;\n\t\t\t\t\tfloat Phi = 2.0 * PI * uv.x;\n\t\t\t\t\tfloat CosTheta = sqrt( (1.0 - uv.y) / ( 1.0 + (a*a - 1.0) * uv.y ) );\n\t\t\t\t\tfloat SinTheta = sqrt( 1.0 - CosTheta * CosTheta );\n\t\t\t\t\treturn vecSpace * vec3(SinTheta * cos( Phi ), SinTheta * sin( Phi ), CosTheta);\n\t\t\t\t}\n\t\t\t\tmat3 matrixFromVector(vec3 n) {\n\t\t\t\t\tfloat a = 1.0 / (1.0 + n.z);\n\t\t\t\t\tfloat b = -n.x * n.y * a;\n\t\t\t\t\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n\t\t\t\t\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n\t\t\t\t\treturn mat3(b1, b2, n);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec4 testColorMap(float Roughness) {\n\t\t\t\t\tvec4 color;\n\t\t\t\t\tif(faceIndex == 0)\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 1)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 2)\n\t\t\t\t\t\tcolor = vec4(0.0,0.0,1.0,1.0);\n\t\t\t\t\telse if(faceIndex == 3)\n\t\t\t\t\t\tcolor = vec4(1.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 4)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,1.0,1.0);\n\t\t\t\t\telse\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,1.0,1.0);\n\t\t\t\t\tcolor *= ( 1.0 - Roughness );\n\t\t\t\t\treturn color;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec3 sampleDirection;\n\t\t\t\t\tvec2 uv = vUv*2.0 - 1.0;\n\t\t\t\t\tfloat offset = -1.0/mapSize;\n\t\t\t\t\tconst float a = -1.0;\n\t\t\t\t\tconst float b = 1.0;\n\t\t\t\t\tfloat c = -1.0 + offset;\n\t\t\t\t\tfloat d = 1.0 - offset;\n\t\t\t\t\tfloat bminusa = b - a;\n\t\t\t\t\tuv.x = (uv.x - a)/bminusa * d - (uv.x - b)/bminusa * c;\n\t\t\t\t\tuv.y = (uv.y - a)/bminusa * d - (uv.y - b)/bminusa * c;\n\t\t\t\t\tif (faceIndex==0) {\n\t\t\t\t\t\tsampleDirection = vec3(1.0, -uv.y, -uv.x);\n\t\t\t\t\t} else if (faceIndex==1) {\n\t\t\t\t\t\tsampleDirection = vec3(-1.0, -uv.y, uv.x);\n\t\t\t\t\t} else if (faceIndex==2) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, 1.0, uv.y);\n\t\t\t\t\t} else if (faceIndex==3) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -1.0, -uv.y);\n\t\t\t\t\t} else if (faceIndex==4) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -uv.y, 1.0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsampleDirection = vec3(-uv.x, -uv.y, -1.0);\n\t\t\t\t\t}\n\t\t\t\t\tvec3 correctedDirection = vec3( tFlip * sampleDirection.x, sampleDirection.yz );\n\t\t\t\t\tmat3 vecSpace = matrixFromVector( normalize( correctedDirection ) );\n\t\t\t\t\tvec3 rgbColor = vec3(0.0);\n\t\t\t\t\tconst int NumSamples = SAMPLES_PER_LEVEL;\n\t\t\t\t\tvec3 vect;\n\t\t\t\t\tfloat weight = 0.0;\n\t\t\t\t\tfor( int i = 0; i < NumSamples; i ++ ) {\n\t\t\t\t\t\tfloat sini = sin(float(i));\n\t\t\t\t\t\tfloat cosi = cos(float(i));\n\t\t\t\t\t\tfloat r = rand(vec2(sini, cosi));\n\t\t\t\t\t\tvect = ImportanceSampleGGX(vec2(float(i) / float(NumSamples), r), vecSpace, roughness);\n\t\t\t\t\t\tfloat dotProd = dot(vect, normalize(sampleDirection));\n\t\t\t\t\t\tweight += dotProd;\n\t\t\t\t\t\tvec3 color = envMapTexelToLinear(textureCube(envMap, vect)).rgb;\n\t\t\t\t\t\trgbColor.rgb += color;\n\t\t\t\t\t}\n\t\t\t\t\trgbColor /= float(NumSamples);\n\t\t\t\t\t//rgbColor = testColorMap( roughness ).rgb;\n\t\t\t\t\tgl_FragColor = linearToOutputTexel( vec4( rgbColor, 1.0 ) );\n\t\t\t\t}",blending:THREE.NoBlending});return e.type="PMREMGenerator",e}(),r=new THREE.OrthographicCamera(-1,1,1,-1,0,1e3),o=new THREE.Scene,n=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2,0),a);n.material.side=THREE.DoubleSide,o.add(n),o.add(r);var i=function(a,r,o){this.sourceTexture=a,this.resolution=void 0===o?256:o,this.samplesPerLevel=void 0===r?32:r;var n=this.sourceTexture.encoding===THREE.LinearEncoding||this.sourceTexture.encoding===THREE.GammaEncoding||this.sourceTexture.encoding===THREE.sRGBEncoding;this.sourceTexture.minFilter=n?THREE.LinearFilter:THREE.NearestFilter,this.sourceTexture.magFilter=n?THREE.LinearFilter:THREE.NearestFilter,this.sourceTexture.generateMipmaps=this.sourceTexture.generateMipmaps&&n,this.cubeLods=[];var s=this.resolution,l={format:this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.numLods=e(s)/e(2)-2;for(var d=0,p;d<this.numLods;d++)p=new THREE.WebGLRenderTargetCube(s,s,l),p.texture.name="PMREMGenerator.cube"+d,this.cubeLods.push(p),s=t(16,s/2)};return i.prototype={constructor:i,update:function(e){var t=this.sourceTexture.isCubeTexture?-1:1;a.defines.SAMPLES_PER_LEVEL=this.samplesPerLevel,a.uniforms.faceIndex.value=0,a.uniforms.envMap.value=this.sourceTexture,a.envMap=this.sourceTexture,a.needsUpdate=!0;var o=e.gammaInput,n=e.gammaOutput,s=e.toneMapping,l=e.toneMappingExposure,d=e.getRenderTarget();e.toneMapping=THREE.LinearToneMapping,e.toneMappingExposure=1,e.gammaInput=!1,e.gammaOutput=!1;for(var p=0,c;p<this.numLods;p++){c=p/(this.numLods-1),a.uniforms.roughness.value=.9*c,a.uniforms.tFlip.value=0==p?t:1;var u=this.cubeLods[p].width;a.uniforms.mapSize.value=u,this.renderToCubeMapTarget(e,this.cubeLods[p]),5>p&&(a.uniforms.envMap.value=this.cubeLods[p].texture)}e.setRenderTarget(d),e.toneMapping=s,e.toneMappingExposure=l,e.gammaInput=o,e.gammaOutput=n},renderToCubeMapTarget:function(e,t){for(var a=0;6>a;a++)this.renderToCubeMapTargetFace(e,t,a)},renderToCubeMapTargetFace:function(e,t,n){a.uniforms.faceIndex.value=n,e.setRenderTarget(t,n),e.clear(),e.render(o,r)},dispose:function(){for(var e=0,t=this.cubeLods.length;e<t;e++)this.cubeLods[e].dispose()}},i}(),"use strict",THREE.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float opacity;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\ngl_FragColor = opacity * texel;\n}"},"use strict",THREE.FXAAShader={uniforms:{tDiffuse:{value:null},resolution:{value:new THREE.Vector2(1/1024,1/512)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"precision highp float;\n\nuniform sampler2D tDiffuse;\n\nuniform vec2 resolution;\n\nvarying vec2 vUv;\n\n// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)\n\n//----------------------------------------------------------------------------------\n// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag\n// SDK Version: v3.00\n// Email:       gameworks@nvidia.com\n// Site:        http://developer.nvidia.com/\n//\n// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions\n// are met:\n//  * Redistributions of source code must retain the above copyright\n//    notice, this list of conditions and the following disclaimer.\n//  * Redistributions in binary form must reproduce the above copyright\n//    notice, this list of conditions and the following disclaimer in the\n//    documentation and/or other materials provided with the distribution.\n//  * Neither the name of NVIDIA CORPORATION nor the names of its\n//    contributors may be used to endorse or promote products derived\n//    from this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY\n// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n//----------------------------------------------------------------------------------\n\n#define FXAA_PC 1\n#define FXAA_GLSL_100 1\n#define FXAA_QUALITY_PRESET 12\n\n#define FXAA_GREEN_AS_LUMA 1\n\n/*--------------------------------------------------------------------------*/\n#ifndef FXAA_PC_CONSOLE\n    //\n    // The console algorithm for PC is included\n    // for developers targeting really low spec machines.\n    // Likely better to just run FXAA_PC, and use a really low preset.\n    //\n    #define FXAA_PC_CONSOLE 0\n#endif\n/*--------------------------------------------------------------------------*/\n#ifndef FXAA_GLSL_120\n    #define FXAA_GLSL_120 0\n#endif\n/*--------------------------------------------------------------------------*/\n#ifndef FXAA_GLSL_130\n    #define FXAA_GLSL_130 0\n#endif\n/*--------------------------------------------------------------------------*/\n#ifndef FXAA_HLSL_3\n    #define FXAA_HLSL_3 0\n#endif\n/*--------------------------------------------------------------------------*/\n#ifndef FXAA_HLSL_4\n    #define FXAA_HLSL_4 0\n#endif\n/*--------------------------------------------------------------------------*/\n#ifndef FXAA_HLSL_5\n    #define FXAA_HLSL_5 0\n#endif\n/*==========================================================================*/\n#ifndef FXAA_GREEN_AS_LUMA\n    //\n    // For those using non-linear color,\n    // and either not able to get luma in alpha, or not wanting to,\n    // this enables FXAA to run using green as a proxy for luma.\n    // So with this enabled, no need to pack luma in alpha.\n    //\n    // This will turn off AA on anything which lacks some amount of green.\n    // Pure red and blue or combination of only R and B, will get no AA.\n    //\n    // Might want to lower the settings for both,\n    //    fxaaConsoleEdgeThresholdMin\n    //    fxaaQualityEdgeThresholdMin\n    // In order to insure AA does not get turned off on colors\n    // which contain a minor amount of green.\n    //\n    // 1 = On.\n    // 0 = Off.\n    //\n    #define FXAA_GREEN_AS_LUMA 0\n#endif\n/*--------------------------------------------------------------------------*/\n#ifndef FXAA_EARLY_EXIT\n    //\n    // Controls algorithm's early exit path.\n    // On PS3 turning this ON adds 2 cycles to the shader.\n    // On 360 turning this OFF adds 10ths of a millisecond to the shader.\n    // Turning this off on console will result in a more blurry image.\n    // So this defaults to on.\n    //\n    // 1 = On.\n    // 0 = Off.\n    //\n    #define FXAA_EARLY_EXIT 1\n#endif\n/*--------------------------------------------------------------------------*/\n#ifndef FXAA_DISCARD\n    //\n    // Only valid for PC OpenGL currently.\n    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.\n    //\n    // 1 = Use discard on pixels which don't need AA.\n    //     For APIs which enable concurrent TEX+ROP from same surface.\n    // 0 = Return unchanged color on pixels which don't need AA.\n    //\n    #define FXAA_DISCARD 0\n#endif\n/*--------------------------------------------------------------------------*/\n#ifndef FXAA_FAST_PIXEL_OFFSET\n    //\n    // Used for GLSL 120 only.\n    //\n    // 1 = GL API supports fast pixel offsets\n    // 0 = do not use fast pixel offsets\n    //\n    #ifdef GL_EXT_gpu_shader4\n        #define FXAA_FAST_PIXEL_OFFSET 1\n    #endif\n    #ifdef GL_NV_gpu_shader5\n        #define FXAA_FAST_PIXEL_OFFSET 1\n    #endif\n    #ifdef GL_ARB_gpu_shader5\n        #define FXAA_FAST_PIXEL_OFFSET 1\n    #endif\n    #ifndef FXAA_FAST_PIXEL_OFFSET\n        #define FXAA_FAST_PIXEL_OFFSET 0\n    #endif\n#endif\n/*--------------------------------------------------------------------------*/\n#ifndef FXAA_GATHER4_ALPHA\n    //\n    // 1 = API supports gather4 on alpha channel.\n    // 0 = API does not support gather4 on alpha channel.\n    //\n    #if (FXAA_HLSL_5 == 1)\n        #define FXAA_GATHER4_ALPHA 1\n    #endif\n    #ifdef GL_ARB_gpu_shader5\n        #define FXAA_GATHER4_ALPHA 1\n    #endif\n    #ifdef GL_NV_gpu_shader5\n        #define FXAA_GATHER4_ALPHA 1\n    #endif\n    #ifndef FXAA_GATHER4_ALPHA\n        #define FXAA_GATHER4_ALPHA 0\n    #endif\n#endif\n\n\n/*============================================================================\n                        FXAA QUALITY - TUNING KNOBS\n------------------------------------------------------------------------------\nNOTE the other tuning knobs are now in the shader function inputs!\n============================================================================*/\n#ifndef FXAA_QUALITY_PRESET\n    //\n    // Choose the quality preset.\n    // This needs to be compiled into the shader as it effects code.\n    // Best option to include multiple presets is to\n    // in each shader define the preset, then include this file.\n    //\n    // OPTIONS\n    // -----------------------------------------------------------------------\n    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)\n    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)\n    // 39       - no dither, very expensive\n    //\n    // NOTES\n    // -----------------------------------------------------------------------\n    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)\n    // 13 = about same speed as FXAA 3.9 and better than 12\n    // 23 = closest to FXAA 3.9 visually and performance wise\n    //  _ = the lowest digit is directly related to performance\n    // _  = the highest digit is directly related to style\n    //\n    #define FXAA_QUALITY_PRESET 12\n#endif\n\n\n/*============================================================================\n\n                           FXAA QUALITY - PRESETS\n\n============================================================================*/\n\n/*============================================================================\n                     FXAA QUALITY - MEDIUM DITHER PRESETS\n============================================================================*/\n#if (FXAA_QUALITY_PRESET == 10)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 3.0\n    #define FXAA_QUALITY_P2 12.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 11)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 3.0\n    #define FXAA_QUALITY_P3 12.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 12)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 4.0\n    #define FXAA_QUALITY_P4 12.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 13)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 4.0\n    #define FXAA_QUALITY_P5 12.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 14)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 4.0\n    #define FXAA_QUALITY_P6 12.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 15)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 12.0\n#endif\n\n/*============================================================================\n                     FXAA QUALITY - LOW DITHER PRESETS\n============================================================================*/\n#if (FXAA_QUALITY_PRESET == 20)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 2.0\n    #define FXAA_QUALITY_P2 8.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 21)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 8.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 22)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 8.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 23)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 8.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 24)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 3.0\n    #define FXAA_QUALITY_P6 8.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 25)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 8.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 26)\n    #define FXAA_QUALITY_PS 9\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 4.0\n    #define FXAA_QUALITY_P8 8.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 27)\n    #define FXAA_QUALITY_PS 10\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 4.0\n    #define FXAA_QUALITY_P9 8.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 28)\n    #define FXAA_QUALITY_PS 11\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 4.0\n    #define FXAA_QUALITY_P10 8.0\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_QUALITY_PRESET == 29)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n\n/*============================================================================\n                     FXAA QUALITY - EXTREME QUALITY\n============================================================================*/\n#if (FXAA_QUALITY_PRESET == 39)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.0\n    #define FXAA_QUALITY_P2 1.0\n    #define FXAA_QUALITY_P3 1.0\n    #define FXAA_QUALITY_P4 1.0\n    #define FXAA_QUALITY_P5 1.5\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n\n\n\n/*============================================================================\n\n                                API PORTING\n\n============================================================================*/\n#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)\n    #define FxaaBool bool\n    #define FxaaDiscard discard\n    #define FxaaFloat float\n    #define FxaaFloat2 vec2\n    #define FxaaFloat3 vec3\n    #define FxaaFloat4 vec4\n    #define FxaaHalf float\n    #define FxaaHalf2 vec2\n    #define FxaaHalf3 vec3\n    #define FxaaHalf4 vec4\n    #define FxaaInt2 ivec2\n    #define FxaaSat(x) clamp(x, 0.0, 1.0)\n    #define FxaaTex sampler2D\n#else\n    #define FxaaBool bool\n    #define FxaaDiscard clip(-1)\n    #define FxaaFloat float\n    #define FxaaFloat2 float2\n    #define FxaaFloat3 float3\n    #define FxaaFloat4 float4\n    #define FxaaHalf half\n    #define FxaaHalf2 half2\n    #define FxaaHalf3 half3\n    #define FxaaHalf4 half4\n    #define FxaaSat(x) saturate(x)\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_GLSL_100 == 1)\n  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)\n  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_GLSL_120 == 1)\n    // Requires,\n    //  #version 120\n    // And at least,\n    //  #extension GL_EXT_gpu_shader4 : enable\n    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)\n    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)\n    #if (FXAA_FAST_PIXEL_OFFSET == 1)\n        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)\n    #else\n        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)\n    #endif\n    #if (FXAA_GATHER4_ALPHA == 1)\n        // use #extension GL_ARB_gpu_shader5 : enable\n        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)\n        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)\n        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)\n        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)\n    #endif\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_GLSL_130 == 1)\n    // Requires \"#version 130\" or better\n    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)\n    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)\n    #if (FXAA_GATHER4_ALPHA == 1)\n        // use #extension GL_ARB_gpu_shader5 : enable\n        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)\n        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)\n        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)\n        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)\n    #endif\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_HLSL_3 == 1)\n    #define FxaaInt2 float2\n    #define FxaaTex sampler2D\n    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))\n    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_HLSL_4 == 1)\n    #define FxaaInt2 int2\n    struct FxaaTex { SamplerState smpl; Texture2D tex; };\n    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)\n    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)\n#endif\n/*--------------------------------------------------------------------------*/\n#if (FXAA_HLSL_5 == 1)\n    #define FxaaInt2 int2\n    struct FxaaTex { SamplerState smpl; Texture2D tex; };\n    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)\n    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)\n    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)\n    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)\n    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)\n    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)\n#endif\n\n\n/*============================================================================\n                   GREEN AS LUMA OPTION SUPPORT FUNCTION\n============================================================================*/\n#if (FXAA_GREEN_AS_LUMA == 0)\n    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }\n#else\n    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }\n#endif\n\n\n\n\n/*============================================================================\n\n                             FXAA3 QUALITY - PC\n\n============================================================================*/\n#if (FXAA_PC == 1)\n/*--------------------------------------------------------------------------*/\nFxaaFloat4 FxaaPixelShader(\n    //\n    // Use noperspective interpolation here (turn off perspective interpolation).\n    // {xy} = center of pixel\n    FxaaFloat2 pos,\n    //\n    // Used only for FXAA Console, and not used on the 360 version.\n    // Use noperspective interpolation here (turn off perspective interpolation).\n    // {xy_} = upper left of pixel\n    // {_zw} = lower right of pixel\n    FxaaFloat4 fxaaConsolePosPos,\n    //\n    // Input color texture.\n    // {rgb_} = color in linear or perceptual color space\n    // if (FXAA_GREEN_AS_LUMA == 0)\n    //     {__a} = luma in perceptual color space (not linear)\n    FxaaTex tex,\n    //\n    // Only used on the optimized 360 version of FXAA Console.\n    // For everything but 360, just use the same input here as for \"tex\".\n    // For 360, same texture, just alias with a 2nd sampler.\n    // This sampler needs to have an exponent bias of -1.\n    FxaaTex fxaaConsole360TexExpBiasNegOne,\n    //\n    // Only used on the optimized 360 version of FXAA Console.\n    // For everything but 360, just use the same input here as for \"tex\".\n    // For 360, same texture, just alias with a 3nd sampler.\n    // This sampler needs to have an exponent bias of -2.\n    FxaaTex fxaaConsole360TexExpBiasNegTwo,\n    //\n    // Only used on FXAA Quality.\n    // This must be from a constant/uniform.\n    // {x_} = 1.0/screenWidthInPixels\n    // {_y} = 1.0/screenHeightInPixels\n    FxaaFloat2 fxaaQualityRcpFrame,\n    //\n    // Only used on FXAA Console.\n    // This must be from a constant/uniform.\n    // This effects sub-pixel AA quality and inversely sharpness.\n    //   Where N ranges between,\n    //     N = 0.50 (default)\n    //     N = 0.33 (sharper)\n    // {x__} = -N/screenWidthInPixels\n    // {_y_} = -N/screenHeightInPixels\n    // {_z_} =  N/screenWidthInPixels\n    // {__w} =  N/screenHeightInPixels\n    FxaaFloat4 fxaaConsoleRcpFrameOpt,\n    //\n    // Only used on FXAA Console.\n    // Not used on 360, but used on PS3 and PC.\n    // This must be from a constant/uniform.\n    // {x__} = -2.0/screenWidthInPixels\n    // {_y_} = -2.0/screenHeightInPixels\n    // {_z_} =  2.0/screenWidthInPixels\n    // {__w} =  2.0/screenHeightInPixels\n    FxaaFloat4 fxaaConsoleRcpFrameOpt2,\n    //\n    // Only used on FXAA Console.\n    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.\n    // This must be from a constant/uniform.\n    // {x__} =  8.0/screenWidthInPixels\n    // {_y_} =  8.0/screenHeightInPixels\n    // {_z_} = -4.0/screenWidthInPixels\n    // {__w} = -4.0/screenHeightInPixels\n    FxaaFloat4 fxaaConsole360RcpFrameOpt2,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_SUBPIX define.\n    // It is here now to allow easier tuning.\n    // Choose the amount of sub-pixel aliasing removal.\n    // This can effect sharpness.\n    //   1.00 - upper limit (softer)\n    //   0.75 - default amount of filtering\n    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)\n    //   0.25 - almost off\n    //   0.00 - completely off\n    FxaaFloat fxaaQualitySubpix,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.\n    // It is here now to allow easier tuning.\n    // The minimum amount of local contrast required to apply algorithm.\n    //   0.333 - too little (faster)\n    //   0.250 - low quality\n    //   0.166 - default\n    //   0.125 - high quality\n    //   0.063 - overkill (slower)\n    FxaaFloat fxaaQualityEdgeThreshold,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.\n    // It is here now to allow easier tuning.\n    // Trims the algorithm from processing darks.\n    //   0.0833 - upper limit (default, the start of visible unfiltered edges)\n    //   0.0625 - high quality (faster)\n    //   0.0312 - visible limit (slower)\n    // Special notes when using FXAA_GREEN_AS_LUMA,\n    //   Likely want to set this to zero.\n    //   As colors that are mostly not-green\n    //   will appear very dark in the green channel!\n    //   Tune by looking at mostly non-green content,\n    //   then start at zero and increase until aliasing is a problem.\n    FxaaFloat fxaaQualityEdgeThresholdMin,\n    //\n    // Only used on FXAA Console.\n    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.\n    // It is here now to allow easier tuning.\n    // This does not effect PS3, as this needs to be compiled in.\n    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.\n    //   Due to the PS3 being ALU bound,\n    //   there are only three safe values here: 2 and 4 and 8.\n    //   These options use the shaders ability to a free *|/ by 2|4|8.\n    // For all other platforms can be a non-power of two.\n    //   8.0 is sharper (default!!!)\n    //   4.0 is softer\n    //   2.0 is really soft (good only for vector graphics inputs)\n    FxaaFloat fxaaConsoleEdgeSharpness,\n    //\n    // Only used on FXAA Console.\n    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.\n    // It is here now to allow easier tuning.\n    // This does not effect PS3, as this needs to be compiled in.\n    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.\n    //   Due to the PS3 being ALU bound,\n    //   there are only two safe values here: 1/4 and 1/8.\n    //   These options use the shaders ability to a free *|/ by 2|4|8.\n    // The console setting has a different mapping than the quality setting.\n    // Other platforms can use other values.\n    //   0.125 leaves less aliasing, but is softer (default!!!)\n    //   0.25 leaves more aliasing, and is sharper\n    FxaaFloat fxaaConsoleEdgeThreshold,\n    //\n    // Only used on FXAA Console.\n    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.\n    // It is here now to allow easier tuning.\n    // Trims the algorithm from processing darks.\n    // The console setting has a different mapping than the quality setting.\n    // This only applies when FXAA_EARLY_EXIT is 1.\n    // This does not apply to PS3,\n    // PS3 was simplified to avoid more shader instructions.\n    //   0.06 - faster but more aliasing in darks\n    //   0.05 - default\n    //   0.04 - slower and less aliasing in darks\n    // Special notes when using FXAA_GREEN_AS_LUMA,\n    //   Likely want to set this to zero.\n    //   As colors that are mostly not-green\n    //   will appear very dark in the green channel!\n    //   Tune by looking at mostly non-green content,\n    //   then start at zero and increase until aliasing is a problem.\n    FxaaFloat fxaaConsoleEdgeThresholdMin,\n    //\n    // Extra constants for 360 FXAA Console only.\n    // Use zeros or anything else for other platforms.\n    // These must be in physical constant registers and NOT immediates.\n    // Immediates will result in compiler un-optimizing.\n    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)\n    FxaaFloat4 fxaaConsole360ConstDir\n) {\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posM;\n    posM.x = pos.x;\n    posM.y = pos.y;\n    #if (FXAA_GATHER4_ALPHA == 1)\n        #if (FXAA_DISCARD == 0)\n            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n            #if (FXAA_GREEN_AS_LUMA == 0)\n                #define lumaM rgbyM.w\n            #else\n                #define lumaM rgbyM.y\n            #endif\n        #endif\n        #if (FXAA_GREEN_AS_LUMA == 0)\n            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);\n            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));\n        #else\n            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);\n            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));\n        #endif\n        #if (FXAA_DISCARD == 1)\n            #define lumaM luma4A.w\n        #endif\n        #define lumaE luma4A.z\n        #define lumaS luma4A.x\n        #define lumaSE luma4A.y\n        #define lumaNW luma4B.w\n        #define lumaN luma4B.z\n        #define lumaW luma4B.x\n    #else\n        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n        #if (FXAA_GREEN_AS_LUMA == 0)\n            #define lumaM rgbyM.w\n        #else\n            #define lumaM rgbyM.y\n        #endif\n        #if (FXAA_GLSL_100 == 1)\n          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));\n        #else\n          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\n        #endif\n    #endif\n/*--------------------------------------------------------------------------*/\n    FxaaFloat maxSM = max(lumaS, lumaM);\n    FxaaFloat minSM = min(lumaS, lumaM);\n    FxaaFloat maxESM = max(lumaE, maxSM);\n    FxaaFloat minESM = min(lumaE, minSM);\n    FxaaFloat maxWN = max(lumaN, lumaW);\n    FxaaFloat minWN = min(lumaN, lumaW);\n    FxaaFloat rangeMax = max(maxWN, maxESM);\n    FxaaFloat rangeMin = min(minWN, minESM);\n    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    FxaaFloat range = rangeMax - rangeMin;\n    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n    FxaaBool earlyExit = range < rangeMaxClamped;\n/*--------------------------------------------------------------------------*/\n    if(earlyExit)\n        #if (FXAA_DISCARD == 1)\n            FxaaDiscard;\n        #else\n            return rgbyM;\n        #endif\n/*--------------------------------------------------------------------------*/\n    #if (FXAA_GATHER4_ALPHA == 0)\n        #if (FXAA_GLSL_100 == 1)\n          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));\n        #else\n          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\n          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n        #endif\n    #else\n        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));\n        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n    #endif\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNS = lumaN + lumaS;\n    FxaaFloat lumaWE = lumaW + lumaE;\n    FxaaFloat subpixRcpRange = 1.0/range;\n    FxaaFloat subpixNSWE = lumaNS + lumaWE;\n    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNESE = lumaNE + lumaSE;\n    FxaaFloat lumaNWNE = lumaNW + lumaNE;\n    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNWSW = lumaNW + lumaSW;\n    FxaaFloat lumaSWSE = lumaSW + lumaSE;\n    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\n    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;\n    FxaaBool horzSpan = edgeHorz >= edgeVert;\n    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n/*--------------------------------------------------------------------------*/\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat gradientN = lumaN - lumaM;\n    FxaaFloat gradientS = lumaS - lumaM;\n    FxaaFloat lumaNN = lumaN + lumaM;\n    FxaaFloat lumaSS = lumaS + lumaM;\n    FxaaBool pairN = abs(gradientN) >= abs(gradientS);\n    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posB;\n    posB.x = posM.x;\n    posB.y = posM.y;\n    FxaaFloat2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posN;\n    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\n    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat2 posP;\n    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\n    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\n    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));\n    FxaaFloat subpixE = subpixC * subpixC;\n    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));\n/*--------------------------------------------------------------------------*/\n    if(!pairN) lumaNN = lumaSS;\n    FxaaFloat gradientScaled = gradient * 1.0/4.0;\n    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;\n    FxaaFloat subpixF = subpixD * subpixE;\n    FxaaBool lumaMLTZero = lumaMM < 0.0;\n/*--------------------------------------------------------------------------*/\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;\n    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\n    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\n    FxaaBool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\n    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\n/*--------------------------------------------------------------------------*/\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 3)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 4)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 5)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 6)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n/*--------------------------------------------------------------------------*/\n                        #if (FXAA_QUALITY_PS > 7)\n                        if(doneNP) {\n                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                            doneN = abs(lumaEndN) >= gradientScaled;\n                            doneP = abs(lumaEndP) >= gradientScaled;\n                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\n                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\n                            doneNP = (!doneN) || (!doneP);\n                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\n                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n/*--------------------------------------------------------------------------*/\n    #if (FXAA_QUALITY_PS > 8)\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 9)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 10)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 11)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 12)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n    #endif\n/*--------------------------------------------------------------------------*/\n                        }\n                        #endif\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n/*--------------------------------------------------------------------------*/\n    FxaaFloat dstN = posM.x - posN.x;\n    FxaaFloat dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n/*--------------------------------------------------------------------------*/\n    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    FxaaFloat spanLength = (dstP + dstN);\n    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    FxaaFloat spanLengthRcp = 1.0/spanLength;\n/*--------------------------------------------------------------------------*/\n    FxaaBool directionN = dstN < dstP;\n    FxaaFloat dst = min(dstN, dstP);\n    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\n    FxaaFloat subpixG = subpixF * subpixF;\n    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n    #if (FXAA_DISCARD == 1)\n        return FxaaTexTop(tex, posM);\n    #else\n        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);\n    #endif\n}\n/*==========================================================================*/\n#endif\n\nvoid main() {\n  gl_FragColor = FxaaPixelShader(\n    vUv,\n    vec4(0.0),\n    tDiffuse,\n    tDiffuse,\n    tDiffuse,\n    resolution,\n    vec4(0.0),\n    vec4(0.0),\n    vec4(0.0),\n    0.75,\n    0.166,\n    0.0833,\n    0.0,\n    0.0,\n    0.0,\n    vec4(0.0)\n  );\n\n  // TODO avoid querying texture twice for same texel\n  gl_FragColor.a = texture2D(tDiffuse, vUv).a;\n}"},"use strict",THREE.EffectComposer=function(e,t){if(this.renderer=e,void 0===t){var a={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1},r=e.getDrawingBufferSize(new THREE.Vector2);t=new THREE.WebGLRenderTarget(r.width,r.height,a),t.texture.name="EffectComposer.rt1"}this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),void 0===THREE.ShaderPass&&console.error("THREE.EffectComposer relies on THREE.ShaderPass"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader),this._previousFrameTime=Date.now()},Object.assign(THREE.EffectComposer.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e);var t=this.renderer.getDrawingBufferSize(new THREE.Vector2);e.setSize(t.width,t.height)},insertPass:function(e,t){this.passes.splice(t,0,e)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){e===void 0&&(e=.001*(Date.now()-this._previousFrameTime)),this._previousFrameTime=Date.now();var t=this.renderer.getRenderTarget(),a=!1,r=this.passes.length,o,n;for(n=0;n<r;n++)if(o=this.passes[n],!1!==o.enabled){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(n),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,a),o.needsSwap){if(a){var s=this.renderer.context;s.stencilFunc(s.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.stencilFunc(s.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==THREE.MaskPass&&(o instanceof THREE.MaskPass?a=!0:o instanceof THREE.ClearMaskPass&&(a=!1))}this.renderer.setRenderTarget(t)},reset:function(e){if(e===void 0){var t=this.renderer.getDrawingBufferSize(new THREE.Vector2);e=this.renderTarget1.clone(),e.setSize(t.width,t.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this.renderTarget1.setSize(e,t),this.renderTarget2.setSize(e,t);for(var a=0;a<this.passes.length;a++)this.passes[a].setSize(e,t)}}),THREE.Pass=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1},Object.assign(THREE.Pass.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),THREE.Pass.FullScreenQuad=function(){var e=new THREE.OrthographicCamera(-1,1,1,-1,0,1),t=new THREE.PlaneBufferGeometry(2,2),a=function(e){this._mesh=new THREE.Mesh(t,e)};return Object.defineProperty(a.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(a.prototype,{render:function(t){t.render(this._mesh,e)}}),a}(),"use strict",THREE.RenderPass=function(e,t,a,r,o){THREE.Pass.call(this),this.scene=e,this.camera=t,this.overrideMaterial=a,this.clearColor=r,this.clearAlpha=o===void 0?0:o,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1},THREE.RenderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.RenderPass,render:function(e,t,a){var r=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial;var o,n;this.clearColor&&(o=e.getClearColor().getHex(),n=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:a),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(o,n),this.scene.overrideMaterial=null,e.autoClear=r}}),"use strict",THREE.ShaderPass=function(e,t){THREE.Pass.call(this),this.textureID=t===void 0?"tDiffuse":t,e instanceof THREE.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=THREE.UniformsUtils.clone(e.uniforms),this.material=new THREE.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new THREE.Pass.FullScreenQuad(this.material)},THREE.ShaderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.ShaderPass,render:function(e,t,a){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=a.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}),"use strict",THREE.HDRResolveShader={uniforms:{tDiffuse:{value:null},exposure:{value:1}},defines:{GAMMA:2.2},vertexShader:"varying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform float gamma;\nuniform float exposure;\nvarying vec2 vUv;\nvoid main() {\n  vec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );\n  vec3 mapped = vec3(1.0) - exp(-tex.xyz * exposure);\n  mapped = pow(mapped, vec3(1.0 / GAMMA));\n  gl_FragColor = vec4(mapped, 1.0);\n}"},"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}THREE.EquirectangularToCubeGenerator=function(){var e=new THREE.PerspectiveCamera(90,1,.1,10),t=new THREE.Scene,a=new THREE.Mesh(new THREE.BoxBufferGeometry(1,1,1),function(){var e=new THREE.ShaderMaterial({uniforms:{equirectangularMap:{value:null}},vertexShader:"varying vec3 localPosition;\n\nvoid main() {\n  localPosition = position;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#include <common>\nvarying vec3 localPosition;\nuniform sampler2D equirectangularMap;\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\nvec2 EquirectangularSampleUV(vec3 v) {\n  vec2 uv = vec2(atan(v.z, v.x), asin(v.y));\n  uv *= vec2(-RECIPROCAL_PI2, RECIPROCAL_PI); // inverse atan and flipX to match Webots orientation\n  uv += 0.5;\n  return uv;\n}\n\nvoid main() {\n  vec2 uv = EquirectangularSampleUV(normalize(localPosition));\n  gl_FragColor = texture2D(equirectangularMap, uv);\n}",blending:THREE.NoBlending});return e.type="EquirectangularToCubeGenerator",e}());a.material.side=THREE.BackSide,t.add(a);var r=function(){function r(e,t){_classCallCheck(this,r),t=t||{},this.sourceTexture=e,this.resolution=t.resolution||512,this.views=[{t:[1,0,0],u:[0,-1,0]},{t:[-1,0,0],u:[0,-1,0]},{t:[0,1,0],u:[0,0,1]},{t:[0,-1,0],u:[0,0,-1]},{t:[0,0,1],u:[0,-1,0]},{t:[0,0,-1],u:[0,-1,0]}];var a={format:t.format||this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:t.type||this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.renderTarget=new THREE.WebGLRenderTargetCube(this.resolution,this.resolution,a)}return _createClass(r,[{key:"update",value:function(r){var o=r.getRenderTarget();a.material.uniforms.equirectangularMap.value=this.sourceTexture;for(var n=0,s;6>n;n++)s=this.views[n],e.position.set(0,0,0),e.up.set(s.u[0],s.u[1],s.u[2]),e.lookAt(s.t[0],s.t[1],s.t[2]),r.setRenderTarget(this.renderTarget,n),r.clear(),r.render(t,e);return r.setRenderTarget(o),this.renderTarget.texture}},{key:"dispose",value:function(){this.renderTarget.dispose()}}]),r}();return r}(),"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _possibleConstructorReturn(e,t){return t&&("object"===_typeof(t)||"function"==typeof t)?t:_assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}THREE.FaceIDShader={vertexShader:"attribute float id;\nuniform float size;\nuniform float scale;\nuniform float baseId;\nvarying vec4 worldId;\nvoid main() {\n  vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n  gl_PointSize = size * (scale / length(mvPosition.xyz));\n  float i = baseId + id;\n  vec3 a = fract(vec3(1.0 / 255.0, 1.0 / (255.0 * 255.0), 1.0 / (255.0 * 255.0 * 255.0)) * i);\n  a -= a.xxy * vec3(0.0, 1.0 / 255.0, 1.0 / 255.0);\n  worldId = vec4(a, 1);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 worldId;\nvoid main() {\n  gl_FragColor = worldId;\n}"},THREE.FaceIDMaterial=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,{uniforms:{baseId:{type:"f",value:0},size:{type:"f",value:.01},scale:{type:"f",value:400}},vertexShader:THREE.FaceIDShader.vertexShader,fragmentShader:THREE.FaceIDShader.fragmentShader}))}return _inherits(t,e),_createClass(t,[{key:"setBaseID",value:function(e){this.uniforms.baseId.value=e}},{key:"setPointSize",value:function(e){this.uniforms.size.value=e}},{key:"setPointScale",value:function(e){this.uniforms.scale.value=e}}]),t}(THREE.ShaderMaterial),THREE.GPUPicker=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.pickingScene=new THREE.Scene,this.pickingTexture=new THREE.WebGLRenderTarget,this.pickingTexture.texture.minFilter=THREE.LinearFilter,this.pickingTexture.texture.generateMipmaps=!1,this.lineShell="undefined"==typeof t.lineShell?4:t.lineShell,this.pointShell="undefined"==typeof t.pointShell?.1:t.pointShell,this.needUpdate=!0,t.renderer&&this.setRenderer(t.renderer),this.container=[],this.objectsMap={},this.setFilter()}return _createClass(e,[{key:"setRenderer",value:function(e){this.renderer=e;var t=new THREE.Vector2;e.getSize(t),this.resizeTexture(t.x,t.y),this.needUpdate=!0}},{key:"resizeTexture",value:function(e,t){this.pickingTexture.setSize(e,t),this.pixelBuffer=new Uint8Array(4*e*t),this.needUpdate=!0}},{key:"setCamera",value:function(e){this.camera=e,this.needUpdate=!0}},{key:"update",value:function(){if(this.needUpdate){var e=this.renderer.getRenderTarget();this.renderer.setRenderTarget(this.pickingTexture),this.renderer.render(this.pickingScene,this.camera),this.renderer.readRenderTargetPixels(this.pickingTexture,0,0,this.pickingTexture.width,this.pickingTexture.height,this.pixelBuffer),this.renderer.setRenderTarget(e),this.needUpdate=!1}}},{key:"setFilter",value:function(e){this.filterFunc=e instanceof Function?e:function(){return!0}}},{key:"setScene",value:function(e){this.pickingScene=e.clone(),this._processObject(this.pickingScene,0),this.needUpdate=!0}},{key:"pick",value:function(e,t){this.update();var a=e.x+(this.pickingTexture.height-e.y)*this.pickingTexture.width,r=255*(255*this.pixelBuffer[4*a+2])+255*this.pixelBuffer[4*a+1]+this.pixelBuffer[4*a+0],o=this._getObject(this.pickingScene,0,r),n=o[1],i=r-o[0];if(n&&n.raycastWithID){var s=n.raycastWithID(i,t);return s&&(s.object=n.originalObject),s}}},{key:"_getObject",value:function(e,t,a){if("undefined"!=typeof e.elementsCount&&a>=t&&a<t+e.elementsCount)return[t,e];"undefined"!=typeof e.elementsCount&&(t+=e.elementsCount);for(var r=[t,void 0],o=0;o<e.children.length&&(r=this._getObject(e.children[o],r[0],a),void 0===r[1]);o++);return r}},{key:"_processObject",value:function(e,t){t+=this._addElementID(e,t);for(var a=0;a<e.children.length;a++)t=this._processObject(e.children[a],t);return t}},{key:"_addElementID",value:function(e,t){if(!this.filterFunc(e)&&"undefined"!=typeof e.geometry)return e.visible=!1,0;if(e.geometry){var a;if(e.geometry.__pickingGeometry)a=e.geometry.__pickingGeometry;else{a=e.geometry,e.geometry instanceof THREE.Geometry&&(a=new THREE.BufferGeometry().setFromObject(e));var r=1;e instanceof THREE.Points?r=1:e instanceof THREE.Line?r=2:e instanceof THREE.Mesh&&(r=3);var o,n,s,l,d,p,c,u,m;if(null!==a.index){for(a=a.clone(),d=a.index.array,u=a.attributes.position.array,delete a.attributes.position,a.index=null,delete a.attributes.normal,s=d.length/r,p=new Float32Array(3*s*r),a.addAttribute("position",new THREE.BufferAttribute(p,3)),o=0;o<s;++o)for(n=r*o,l=0;l<r;++l)m=3*d[n+l],c=3*(n+l),p[c]=u[m],p[c+1]=u[m+1],p[c+2]=u[m+2];a.computeVertexNormals()}if(e instanceof THREE.Line&&!(e instanceof THREE.LineSegments)){for(u=a.attributes.position.array,delete a.attributes.position,s=u.length/3-1,p=new Float32Array(3*(s*r)),a.addAttribute("position",new THREE.BufferAttribute(p,3)),o=0;o<s;++o)n=3*o,m=n,c=2*n,p[c]=u[m],p[c+1]=u[m+1],p[c+2]=u[m+2],p[c+3]=u[m+3],p[c+4]=u[m+4],p[c+5]=u[m+5];a.computeVertexNormals(),e.__proto__=THREE.LineSegments.prototype}for(var f=a.attributes,g=f.position.array,h=g.length/3,y=new THREE.Float32BufferAttribute(h,1),x=0,v=h/r;x<v;x++)for(var b=0;b<r;++b)y.array[x*r+b]=x;a.addAttribute("id",y),a.elementsCount=h/r,e.geometry.__pickingGeometry=a}e.geometry=a,e.elementsCount=a.elementsCount;var _=e.material.size||.01,T=e.material.linewidth||1;e.material=new THREE.FaceIDMaterial,e.material.linewidth=T+this.lineShell,e.material.setBaseID(t),e.material.setPointSize(_+this.pointShell);var S=new THREE.Vector2;return this.renderer.getSize(S),e.material.setPointScale(S.y*this.renderer.getPixelRatio()/2),e.elementsCount}return 0}}]),e}(),function(e){(function(t){e.Object3D.prototype.clone=function(e){var a=t.call(this,e);return a.originalObject=this,a.priority=this.priority,a}})(e.Object3D.prototype.clone),function(t){e.Points.prototype.clone=function(e){var a=t.call(this,e);return a.originalObject=this,a.priority=this.priority,a}}(e.Points.prototype.clone),function(t){e.Mesh.prototype.clone=function(){var e=t.call(this);return e.originalObject=this,e.priority=this.priority,e}}(e.Mesh.prototype.clone),function(t){e.Line.prototype.clone=function(){var e=t.call(this);return e.originalObject=this,e.priority=this.priority,e}}(e.Line.prototype.clone),e.Mesh.prototype.raycastWithID=function(){function t(t,a,r,o,n,i,s){var d=r.intersectTriangle(i,n,o,!1,s);var p=new e.Plane;if(p.setFromCoplanarPoints(o,n,i),d=r.intersectPlane(p,new e.Vector3),null===d)return null;l.copy(s),l.applyMatrix4(t.matrixWorld);var c=a.ray.origin.distanceTo(l);return c<a.near||c>a.far?null:{distance:c,point:l.clone(),object:t}}var r=new e.Vector3,o=new e.Vector3,n=new e.Vector3,i=new e.Matrix4,s=new e.Ray,l=new e.Vector3,d=new e.Vector3;return function(l,p){var u=this.geometry,m=u.attributes;i.getInverse(this.matrixWorld),s.copy(p.ray).applyMatrix4(i);var f,g,h;if(null!==u.index)console.log("WARNING: raycastWithID does not support indexed vertices");else{var y=m.position,x=3*l;f=x,g=x+1,h=x+2,r.fromBufferAttribute(y,f),o.fromBufferAttribute(y,g),n.fromBufferAttribute(y,h)}var v=t(this,p,s,r,o,n,d);if(null===v)return void console.log("WARNING: intersectionPoint missing");var _=new e.Face3(f,g,h);return e.Triangle.getNormal(r,o,n,_.normal),v.face=_,v.faceIndex=f,v}}(),e.Line.prototype.raycastWithID=function(){var t=new e.Matrix4,a=new e.Ray,r=new e.Vector3,o=new e.Vector3,n=new e.Vector3,s=new e.Vector3;return function(l,d){t.getInverse(this.matrixWorld),a.copy(d.ray).applyMatrix4(t);var p=this.geometry;if(p instanceof e.BufferGeometry){var c=p.attributes;if(null!==p.index)console.log("WARNING: raycastWithID does not support indexed vertices");else{var u=c.position.array,m=6*l;r.fromArray(u,m),o.fromArray(u,m+3);var i=a.origin.distanceTo(s);if(i<d.near||i>d.far)return;var f={distance:i,point:n.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this};return f}}}}(),e.Points.prototype.raycastWithID=function(){var t=new e.Matrix4,a=new e.Ray;return function(r,o){var n=this,i=n.geometry;t.getInverse(this.matrixWorld),a.copy(o.ray).applyMatrix4(t);var s=new e.Vector3,l=i.attributes,d=l.position.array;return s.fromArray(d,3*r),function(e,t){var r=a.distanceToPoint(e),i=a.closestPointToPoint(e);i.applyMatrix4(n.matrixWorld);var s=o.ray.origin.distanceTo(i);if(!(s<o.near||s>o.far)){var l={distance:s,distanceToRay:r,point:i.clone(),index:t,face:null,object:n};return l}}(s,r)}}()}(THREE),"use strict";var _this=void 0,webots=window.webots||{};webots.quaternionToAxisAngle=function(e){var t=Math.acos,a=Math.PI,r=Math.sqrt,o=e.clone(),n,i;if(1<o.w&&o.normalize(),n=1<=o.w?0:-1>=o.w?2*a:2*t(o.w),.001>n)i=new THREE.Vector3(0,1,0),n=0;else{var s=1/r(o.x*o.x+o.y*o.y+o.z*o.z);i=new THREE.Vector3(o.x*s,o.y*s,o.z*s)}return{axis:i,angle:n}},webots.parseMillisecondsIntoReadableTime=function(e){var t=Math.floor,a=(e+.9)/3600000,r=t(a),o=9<r?r:"0"+r,n=60*(a-r),i=t(n),l=9<i?i:"0"+i,d=60*(n-i),p=t(d),c=9<p?p:"0"+p,s=t(1e3*(d-p));return 10>s?s="00"+s:100>s&&(s="0"+s),o+":"+l+":"+c+":"+s},"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return _this.slice(0,e.length)===e}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return-1!==_this.indexOf(e,_this.length-e.length)}),"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var SystemInfo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"isMacOS",value:function(){return 0<=navigator.platform.toUpperCase().indexOf("MAC")}},{key:"isIOS",value:function(){return!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)}},{key:"isMobileDevice",value:function(){return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var DialogWindow=function(){function e(t,a){var r=this;_classCallCheck(this,e),this.mobile=a,this.parent=t,this.panel=document.createElement("div"),t.appendChild(this.panel),this.params={appendTo:t,open:function(){e.openDialog(r.panel)},autoOpen:!1,resizeStart:e.disablePointerEvents,resizeStop:e.enablePointerEvents,dragStart:e.disablePointerEvents,dragStop:e.enablePointerEvents},this.mobile&&e.addMobileDialogAttributes(this.params,this.panel)}return _createClass(e,null,[{key:"clampDialogSize",value:function(e){if("undefined"==typeof $("#playerDiv").height||"undefined"==typeof $("#playerDiv").width)return e;var t=$("#playerDiv").height()-e.top-$("#toolBar").height()-20,a=$("#playerDiv").width()-e.left-20,r=e.height,o=e.width;return t<r&&(r=t),a<o&&(o=a),{width:o,height:r}}},{key:"openDialog",value:function(t){e.resizeDialogOnOpen(t),$(t).parent().css("opacity",.9),$(t).parent().hover(function(){$(t).css("opacity",.99)},function(){$(t).css("opacity",.9)})}},{key:"resizeDialogOnOpen",value:function(t){var a=$(t).parent().width(),r=$(t).parent().height(),o=e.clampDialogSize({left:0,top:0,width:a,height:r});o.width<a&&$(t).dialog("option","width",o.width),o.height<r&&$(t).dialog("option","height",o.height)}},{key:"createMobileDialog",value:function(){var e=$("button:contains(\"WbClose\")");e.html(""),e.removeClass("ui-button-text-only"),e.addClass("mobile-dialog-close-button"),e.addClass("ui-button-icon-primary"),e.prepend("<span class=\"ui-icon ui-icon-closethick\"></span>")}},{key:"addMobileDialogAttributes",value:function(t,a){t.dialogClass="mobile-no-default-buttons",t.create=e.createMobileDialog,t.buttons={WbClose:function(){$(a).dialog("close")}}}},{key:"disablePointerEvents",value:function(){document.body.style["pointer-events"]="none"}},{key:"enablePointerEvents",value:function(){document.body.style["pointer-events"]="auto"}}]),e}();webots.alert=function(e,t,a){webots.currentView.ondialogwindow(!0);var r=webots.currentView.view3D,o=document.getElementById("webotsAlert");o||(o=document.createElement("div"),o.id="webotsAlert",r.appendChild(o)),o.innerHTML=t,$("#webotsAlert").dialog({title:e,resizeStart:DialogWindow.disablePointerEvents,resizeStop:DialogWindow.enablePointerEvents,dragStart:DialogWindow.disablePointerEvents,dragStop:DialogWindow.enablePointerEvents,appendTo:r,open:function(){DialogWindow.openDialog(o)},modal:!0,width:400,buttons:{Ok:function(){$("#webotsAlert").dialog("close")}},close:function(){"function"==typeof a&&a(),webots.currentView.ondialogwindow(!1),$("#webotsAlert").remove()}})},webots.confirm=function(e,t,a){webots.currentView.ondialogwindow(!0);var r=webots.currentView.view3D,o=document.createElement("div");o.id="webotsConfirm",o.innerHTML=t,r.appendChild(o),$("#webotsConfirm").dialog({title:e,resizeStart:DialogWindow.disablePointerEvents,resizeStop:DialogWindow.enablePointerEvents,dragStart:DialogWindow.disablePointerEvents,dragStop:DialogWindow.enablePointerEvents,appendTo:r,open:function(){DialogWindow.openDialog(o)},modal:!0,width:400,buttons:{Ok:function(){$("#webotsConfirm").dialog("close"),a()},Cancel:function(){$("#webotsConfirm").dialog("close")}},close:function(){$("#webotsConfirm").dialog("destroy").remove(),webots.currentView.ondialogwindow(!1)}})},"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _possibleConstructorReturn(e,t){return t&&("object"===_typeof(t)||"function"==typeof t)?t:_assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}var Console=function(e){function t(e,a){var r;_classCallCheck(this,t),r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,a)),r.panel.id="webotsConsole",r.panel.className="webotsConsole";var o=DialogWindow.clampDialogSize({left:0,top:0,width:600,height:400});return r.params.width=o.width,r.params.height=o.height,r.params.close=function(){$("#consoleButton").removeClass("toolBarButtonActive")},r.params.title="Console",$(r.panel).dialog(r.params).dialogExtend({maximizable:!a}),r}return _inherits(t,e),_createClass(t,[{key:"scrollDown",value:function(){this.panel&&(this.panel.scrollTop=this.panel.scrollHeight)}},{key:"clear",value:function(){if(this.panel)for(;this.panel.firstChild;)this.panel.removeChild(this.panel.firstChild);else console.clear()}},{key:"stdout",value:function(e){this._log(e,0)}},{key:"stderr",value:function(e){this._log(e,1)}},{key:"info",value:function(e){this._log(e,2)}},{key:"error",value:function(e){this._log(e,3)}},{key:"_log",value:function(e,a){var r=document.createElement("p"),o="margin:0;",n="";if(0===a?(o+="color:Blue;",n="Webots stdout"):1===a?(o+="color:Red;",n="Webots stderr"):2===a?(o+="color:Gray;",n="info"):3===a?(o+="color:Salmon;",n="error"):void 0,this.panel){r.style.cssText=o,r.title=n+" ("+this._hourString()+")";var i=document.createTextNode(e);r.appendChild(i),this.panel.appendChild(r),this.scrollDown()}else console.log("%c"+e,o)}},{key:"_hourString",value:function(){var e=new Date;return e.getHours()+":"+(10>e.getMinutes()?"0":"")+e.getMinutes()+":"+(10>e.getSeconds()?"0":"")+e.getSeconds()}}]),t}(DialogWindow);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){return t&&("object"===_typeof(t)||"function"==typeof t)?t:_assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}var HelpWindow=function(e){function t(e,a,r){var o;if(_classCallCheck(this,t),o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,a)),o.panel.id="webotsHelp",o.panel.style.overflow="hidden",o.panel.className+="webotsTabContainer",o.tabs=document.createElement("div"),o.tabs.id="webotsHelpTabs",o.tabs.className+="webotsTabs",o.tabsHeader=document.createElement("ul"),o.tabs.appendChild(o.tabsHeader),o.panel.appendChild(o.tabs),r){var n=document.createElement("li");n.innerHTML="<a href=\"#webotsHelpReference\">Webots Reference Manual</a>",o.tabsHeader.appendChild(n);var i=document.createElement("div");i.id="webotsHelpReference",i.innerHTML="<iframe src=\""+r+"\"></iframe>",o.tabs.appendChild(i),$("#webotsHelpTabs").tabs()}var s=DialogWindow.clampDialogSize({left:5,top:5,width:600,height:600});o.params.width=s.width,o.params.height=s.height,o.params.close=function(){$("#helpButton").removeClass("toolBarButtonActive")},o.params.position={at:"right-5 top+5",my:"right top",of:o.parent},o.params.title="Help",$(o.panel).dialog(o.params).dialogExtend({maximizable:!a});var l=function(){$("#webotsHelpTabs").tabs("refresh"),$("#webotsHelpTabs").tabs("option","active",0),$(o.panel).dialog("open")},d=DefaultUrl.currentScriptUrl(),p="";return webots.showFast&&(p="?fast=true"),$.ajax({url:d+"help.php"+p,success:function(e){var t=e.replace(/ src="images/g," src=\""+d+"/images"),a=document.createElement("li");a.innerHTML="<a href=\"#webotsHelpGuide\">User Guide</a>",$(o.tabsHeader).prepend(a);var r=document.createElement("div");r.id="webotsHelpGuide",r.innerHTML=t,document.getElementById("webotsHelpReference")?$("#webotsHelpReference").before(r):(o.tabs.appendChild(r),$("#webotsHelpTabs").tabs()),l()},error:l}),o}return _inherits(t,e),t}(DialogWindow);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _possibleConstructorReturn(e,t){return t&&("object"===_typeof(t)||"function"==typeof t)?t:_assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}var RobotWindow=function(e){function t(e,a,r){var o;_classCallCheck(this,t),o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,a)),o.name=r,o.panel.id=r,o.panel.className="webotsTabContainer";var n=DialogWindow.clampDialogSize({left:5,top:5,width:400,height:400});return o.params.width=n.width,o.params.height=n.height,o.params.close=null,o.params.position={at:"left+5 top+5",my:"left top",of:o.parent},o.params.title="Robot Window",$(o.panel).dialog(o.params).dialogExtend({maximizable:!a}),o}return _inherits(t,e),_createClass(t,[{key:"setProperties",value:function(e){$(this.panel).dialog(e)}},{key:"geometry",value:function(){var e=this.panel.getElementsByClassName("webotsTabs"),t=-1;return 0<e.length&&(t=$(e[0]).tabs("option","active")),{width:$(this.panel).dialog("option","width"),height:$(this.panel).dialog("option","height"),position:$(this.panel).dialog("option","position"),activeTabIndex:t,open:this.isOpen()}}},{key:"restoreGeometry",value:function(e){$(this.panel).dialog({width:e.width,height:e.height,position:e.position});var t=this.panel.getElementsByClassName("webotsTabs");0<=e.activeTabIndex&&0<t.length&&$(t[0]).tabs("option","active",e.activeTabIndex)}},{key:"destroy",value:function(){this.close(),this.panel.parentNode.removeChild(this.panel),this.panel=null}},{key:"setContent",value:function(e){$(this.panel).html(e)}},{key:"open",value:function(){$(this.panel).dialog("open")}},{key:"isOpen",value:function(){return $(this.panel).dialog("isOpen")}},{key:"close",value:function(){$(this.panel).dialog("close")}},{key:"send",value:function(e,t){webots.currentView.sendRobotMessage(e,t)}},{key:"receive",value:function(e,t){console.log("Robot window '"+this.name+"' received message from Robot '"+t+"': "+e)}}]),t}(DialogWindow);function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var Toolbar=function(){function e(t,a){var r=this;_classCallCheck(this,e),this.view=a,this.domElement=document.createElement("div"),this.domElement.id="toolBar",this.domElement.left=document.createElement("div"),this.domElement.left.className="toolBarLeft",("undefined"==typeof webots.showQuit||webots.showQuit)&&(this.domElement.left.appendChild(this.createToolBarButton("quit","Quit the simulation")),this.quitButton.onclick=function(){r.requestQuit()}),this.domElement.left.appendChild(this.createToolBarButton("info","Open the information window")),this.infoButton.onclick=function(){r.toggleInfo()},this.worldSelectionDiv=document.createElement("div"),this.domElement.left.appendChild(this.worldSelectionDiv),webots.showRevert&&(this.domElement.left.appendChild(this.createToolBarButton("revert","Save controllers and revert the simulation")),this.revertButton.addEventListener("click",function(){r.reset(!0)})),this.domElement.left.appendChild(this.createToolBarButton("reset","Save controllers and reset the simulation")),this.resetButton.addEventListener("click",function(){r.reset(!1)}),this.domElement.left.appendChild(this.createToolBarButton("step","Perform one simulation step")),this.stepButton.onclick=function(){r.step()},this.domElement.left.appendChild(this.createToolBarButton("real_time","Run the simulation in real time")),this.real_timeButton.onclick=function(){r.realTime()},this.domElement.left.appendChild(this.createToolBarButton("pause","Pause the simulation")),this.pauseButton.onclick=function(){r.pause()},this.pauseButton.style.display="none",webots.showFast&&(this.domElement.left.appendChild(this.createToolBarButton("fast","Run the simulation as fast as possible")),this.fastButton.onclick=function(){r.fast()});var o=document.createElement("div");o.className="webotsTime";var n=document.createElement("span");n.id="webotsClock",n.title="Current simulation time",n.innerHTML=webots.parseMillisecondsIntoReadableTime(0),o.appendChild(n);var i=document.createElement("span");i.id="webotsTimeout",i.title="Simulation time out",i.innerHTML=webots.parseMillisecondsIntoReadableTime(0<=this.view.timeout?this.view.timeout:0),o.appendChild(document.createElement("br")),o.appendChild(i),this.domElement.left.appendChild(o),this.domElement.left.appendChild(this.createToolBarButton("console","Open the console window")),this.consoleButton.onclick=function(){r.toggleConsole()},this.domElement.right=document.createElement("div"),this.domElement.right.className="toolBarRight",this.domElement.right.appendChild(this.createToolBarButton("help","Get help on the simulator")),this.helpButton.onclick=function(){r.toggleHelp()},this.view.fullscreenEnabled&&(this.domElement.right.appendChild(this.createToolBarButton("exit_fullscreen","Exit fullscreen")),this.exit_fullscreenButton.onclick=function(){r.exitFullscreen()},this.exit_fullscreenButton.style.display="none",this.domElement.right.appendChild(this.createToolBarButton("fullscreen","Enter fullscreen")),this.fullscreenButton.onclick=function(){r.requestFullscreen()}),this.domElement.appendChild(this.domElement.left),this.domElement.appendChild(this.domElement.right),t.appendChild(this.domElement),this.enableToolBarButtons(!1),this.view.broadcast&&this.quitButton&&(this.quitButton.disabled=!0,this.quitButton.classList.add("toolBarButtonDisabled"),this.view.contextMenu.disableEdit()),document.addEventListener("fullscreenchange",function(){r.onFullscreenChange()}),document.addEventListener("webkitfullscreenchange",function(){r.onFullscreenChange()}),document.addEventListener("mozfullscreenchange",function(){r.onFullscreenChange()}),document.addEventListener("MSFullscreenChange",function(){r.onFullscreenChange()})}return _createClass(e,[{key:"toggleInfo",value:function(){this.view.contextMenu.hide(),this.view.infoWindow&&(this.view.infoWindow.isOpen()?(this.view.infoWindow.close(),this.infoButton.classList.remove("toolBarButtonActive")):(this.view.infoWindow.open(),this.infoButton.classList.add("toolBarButtonActive")))}},{key:"toggleConsole",value:function(){this.view.contextMenu.hide(),$("#webotsConsole").is(":visible")?($("#webotsConsole").dialog("close"),this.consoleButton.classList.remove("toolBarButtonActive")):($("#webotsConsole").dialog("open"),this.consoleButton.classList.add("toolBarButtonActive"))}},{key:"toggleHelp",value:function(){if(this.view.contextMenu.hide(),!this.view.helpWindow){if(!this.view.broadcast&&webots.webotsDocUrl)var e=webots.webotsDocUrl;this.view.helpWindow=new HelpWindow(this.view.view3D,this.view.mobileDevice,e),this.helpButton.classList.add("toolBarButtonActive")}else $("#webotsHelp").is(":visible")?($("#webotsHelp").dialog("close"),this.helpButton.classList.remove("toolBarButtonActive")):($("#webotsHelp").dialog("open"),this.helpButton.classList.add("toolBarButtonActive"))}},{key:"exitFullscreen",value:function(){this.view.contextMenu.hide(),document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}},{key:"requestFullscreen",value:function(){this.view.contextMenu.hide();var e=this.view.view3D;e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}},{key:"onFullscreenChange",value:function(){var e=document.fullScreenElement||document.mozFullScreenElement||document.webkitFullScreenElement||document.msFullScreenElement||document.webkitCurrentFullScreenElement;null==e?(this.fullscreenButton.style.display="inline",this.exit_fullscreenButton.style.display="none"):(this.fullscreenButton.style.display="none",this.exit_fullscreenButton.style.display="inline")}},{key:"requestQuit",value:function(){var e=this;if(this.view.editor.hasUnsavedChanges()){var t=this.view.editor.unloggedFileModified||"undefined"==typeof webots.User1Id||""===webots.User1Id?"Your changes to the robot controller will be lost because you are not logged in.":"Your unsaved changes to the robot controller will be lost.";var a=document.getElementById("quitDialog");return void(a?$(a).dialog("open"):(a=document.createElement("div"),a.id="quitDialog",$(a).html(t),this.view.view3D.appendChild(a),$(a).dialog({title:"Quit the simulation?",modal:!0,resizable:!1,appendTo:this.view.view3D,open:function(){DialogWindow.openDialog(a)},buttons:{Cancel:function(){$(a).dialog("close")},Quit:function(){$(a).dialog("close"),e.view.quitSimulation()}}})))}this.view.quitSimulation()}},{key:"reset",value:function(){var e=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];if(!this.view.broadcast){for(var t in this.time=0,e?$("#webotsProgressMessage").html("Reverting simulation..."):$("#webotsProgressMessage").html("Restarting simulation..."),$("#webotsProgress").show(),this.runOnLoad="inline"===this.pauseButton.style.display,this.pause(),this.view.editor.filenames)this.view.editor.save(t),this.view.editor.needToUploadFiles[t]&&this.view.editor.upload(t);this.view.onrobotwindowsdestroy(),0<=this.view.timeout?(this.view.deadline=this.view.timeout,$("#webotsTimeout").html(webots.parseMillisecondsIntoReadableTime(this.view.timeout))):$("#webotsTimeout").html(webots.parseMillisecondsIntoReadableTime(0)),this.enableToolBarButtons(!1),e?this.view.stream.socket.send("revert"):this.view.stream.socket.send("reset")}}},{key:"isPaused",value:function(){return"inline"===this.real_timeButton.style.display}},{key:"pause",value:function(){this.view.broadcast||(this.view.contextMenu.hide(),this.view.stream.socket.send("pause"))}},{key:"realTime",value:function(){this.view.broadcast||(this.view.contextMenu.hide(),this.view.stream.socket.send("real-time:"+this.view.timeout),this.pauseButton.style.display="inline",this.real_timeButton.style.display="none","undefined"!=typeof this.fastButton&&(this.fastButton.style.display="inline"))}},{key:"fast",value:function(){this.view.broadcast||(this.view.contextMenu.hide(),this.view.stream.socket.send("fast:"+this.view.timeout),this.pauseButton.style.display="inline",this.real_timeButton.style.display="inline",this.fastButton.style.display="none")}},{key:"step",value:function(){this.view.broadcast||(this.view.contextMenu.hide(),this.pauseButton.style.display="none",this.real_timeButton.style.display="inline","undefined"!=typeof this.fastButton&&(this.fastButton.style.display="inline"),this.view.stream.socket.send("step"))}},{key:"enableToolBarButtons",value:function(e){var t=[this.infoButton,this.revertButton,this.resetButton,this.stepButton,this.real_timeButton,this.fastButton,this.pauseButton,this.consoleButton,this.worldSelect];for(var a in t)t[a]&&(e&&(!this.view.broadcast||t[a]===this.consoleButton)?(t[a].disabled=!1,t[a].classList.remove("toolBarButtonDisabled")):(t[a].disabled=!0,t[a].classList.add("toolBarButtonDisabled")))}},{key:"createToolBarButton",value:function(e,t){var a=e+"Button";return this[a]=document.createElement("button"),this[a].id=a,this[a].className="toolBarButton",this[a].title=t,this[a].style.backgroundImage="url("+DefaultUrl.wwiImagesUrl()+e+".png)",this[a]}},{key:"setMode",value:function(e){var t="undefined"!=typeof this.fastButton;return"pause"===e?(this.pauseButton.style.display="none",this.real_timeButton.style.display="inline",void(t&&(this.fastButton.style.display="inline"))):void(this.pauseButton.style.display="inline",t&&"fast"===e?(this.fastButton.style.display="none",this.real_timeButton.style.display="inline"):(t&&(this.fastButton.style.display="inline"),this.real_timeButton.style.display="none"))}}]),e}();function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _possibleConstructorReturn(e,t){return t&&("object"===_typeof(t)||"function"==typeof t)?t:_assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}var Editor=function(e){function t(e,a,r){var o;_classCallCheck(this,t),o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,a)),o.panel.id="webotsEditor",o.panel.className="webotsTabContainer",o.view=r,o.filenames=[],o.needToUploadFiles=[],o.sessions=[];var n=document.createElement("div");n.id="webotsEditorTab",n.className="webotsTab",o.editor=ace.edit(n),o.sessions[0]=o.editor.getSession(),o.currentSession=0,o.tabs=document.createElement("div"),o.tabs.id="webotsEditorTabs",o.tabs.className="webotsTabs",o.tabsHeader=document.createElement("ul"),o.tabs.appendChild(o.tabsHeader),o.tabs.appendChild(n),$(o.tabs).tabs({activate:function(e,t){o.currentSession=parseInt(t.newTab.attr("id").substr(5)),o.editor.setSession(o.sessions[o.currentSession])}}),o.panel.appendChild(o.tabs),o.menu=document.createElement("div"),o.menu.id="webotsEditorMenu";var i;i=SystemInfo.isMacOS()?"Cmd-S":"Ctrl-S",o.menu.innerHTML="<input type=\"image\" id=\"webotsEditorMenuImage\" width=\"17px\" src=\""+DefaultUrl.wwiImagesUrl()+"menu.png\"><div id=\"webotsEditorMenuContent\"><div id=\"webotsEditorSaveAction\" class=\"webotsEditorMenuContentItem\" title=\"Save current file\">Save<span style=\"float:right\"><i><small>"+i+"</small></i></span></div><div id=\"webotsEditorSaveAllAction\" class=\"webotsEditorMenuContentItem\" title=\"Save all the files\">Save All</div><div id=\"webotsEditorResetAction\" class=\"webotsEditorMenuContentItem\" title=\"Reset current file to the original version\">Reset</div><div id=\"webotsEditorResetAllAction\" class=\"webotsEditorMenuContentItem\" title=\"Reset all the files to the original version\">Reset All</div></div>",o.panel.appendChild(o.menu);var s=DialogWindow.clampDialogSize({left:0,top:0,width:800,height:600});return o.params.width=s.width,o.params.height=s.height,o.params.close=null,o.params.resize=function(){o._resize()},o.params.open=function(){DialogWindow.resizeDialogOnOpen(o.panel)},o.params.title="Editor",$(o.panel).dialog(o.params).dialogExtend({maximizable:!a}),o.editor.commands.addCommand({name:"save",bindKey:{win:"Ctrl-S",mac:"Cmd-S"},exec:function(){o.save(o.currentSession)}}),$("#webotsEditorSaveAction").click(function(){o.save(o.currentSession),o._hideMenu()}),$("#webotsEditorSaveAllAction").click(function(){for(var e in o.filenames)o.save(e);o._hideMenu()}),$("#webotsEditorResetAction").click(function(){o._openResetConfirmDialog(!1)}),$("#webotsEditorResetAllAction").click(function(){o._openResetConfirmDialog(!0)}),$("#webotsEditorMenuImage").click(function(){$("#webotsEditorMenu").hasClass("pressed")?$("#webotsEditorMenu").removeClass("pressed"):$("#webotsEditorMenu").addClass("pressed")}),$("#webotsEditorMenu").focusout(function(){window.setTimeout(function(){0<$(".webotsEditorMenuContentItem:hover").length||$("#webotsEditorMenu").hasClass("pressed")&&$("#webotsEditorMenu").removeClass("pressed")},100)}),o}return _inherits(t,e),_createClass(t,[{key:"hasUnsavedChanges",value:function(){if(this.unloggedFileModified)return!0;for(var e in this.filenames)if($("#filename-"+e).html().endsWith("*"))return!0;return!1}},{key:"upload",value:function(e){this.view.stream.socket.send("set controller:"+this.dirname+"/"+this.filenames[e]+":"+this.sessions[e].getLength()+"\n"+this.sessions[e].getValue()),this.needToUploadFiles[e]=!1}},{key:"save",value:function(e){$("#filename-"+e).html().endsWith("*")&&($("#filename-"+e).html(this.filenames[e]),this.needToUploadFiles[e]=!0,("undefined"!=typeof webots.User1Id||""!==webots.User1Id)&&webots.User1Authentication?this._storeUserFile(e):this.unloggedFileModified=!0,0===this.view.time?this.upload(e):("undefined"==typeof this.statusMessage&&(this.statusMessage=document.createElement("div"),this.statusMessage.id="webotsEditorStatusMessage",this.statusMessage.className="webotsEditorStatusMessage",this.statusMessage.innerHTML="<font size=\"2\">Reset the simulation to apply the changes.</font>"),this.panel.appendChild(this.statusMessage),setTimeout(function(){$("#webotsEditorStatusMessage").remove()},1500)))}},{key:"addFile",value:function(e,t){var a=this,r=this.filenames.indexOf(e);return 0<=r?(this.needToUploadFiles[r]=!1,this.sessions[r].setValue(t),$("#filename-"+r).html().endsWith("*")&&$("#filename-"+r).html(e),void(webots.User1Authentication&&("undefined"!=typeof webots.User1Id||""!==webots.User1Id)&&this.storeUserFile(r))):void(r=this.filenames.length,this.filenames.push(e),this.needToUploadFiles[r]=!1,0===r?(this.sessions[r].setMode(this._aceMode(e)),this.sessions[r].setValue(t),$("#webotsEditorMenu").show(),$("#webotsEditorTabs").show()):this.sessions.push(ace.createEditSession(t,this._aceMode(e))),this.sessions[r].on("change",function(){a._textChange(r)}),$("div#webotsEditorTabs ul").append("<li id=\"file-"+r+"\"><a href=\"#webotsEditorTab\" id=\"filename-"+r+"\">"+e+"</a></li>"),$("div#webotsEditorTabs").tabs("refresh"),0===r&&$("div#webotsEditorTabs").tabs("option","active",r))}},{key:"closeAllTabs",value:function(){this.editor.setSession(ace.createEditSession("","")),this.filenames=[],this.needToUploadFiles=[],this.sessions=[],this.sessions[0]=this.editor.getSession(),this.currentSession=0,$("div#webotsEditorTabs ul").empty(),$("#webotsEditorMenu").hide(),$("#webotsEditorTabs").hide()}},{key:"_resize",value:function(){var e=$("#webotsEditorTab").outerHeight()-$("#webotsEditorTab").height();$("#webotsEditorTab").height(this.tabs.clientHeight-this.tabsHeader.scrollHeight-e),this.editor.resize()}},{key:"_hideMenu",value:function(){$("#webotsEditorMenu").hasClass("pressed")&&$("#webotsEditorMenu").removeClass("pressed")}},{key:"_openResetConfirmDialog",value:function(e){var t=this;this.resetAllFiles=e;var a,r;r="Permanently reset ",e?(r+="all the files",a="Reset files?"):(r+="this file",a="Reset file?"),r+=" to the original version?",r+="<br/><br/>Your modifications will be lost.";var o=document.createElement("div");this.panel.appendChild(o),$(o).html(r),$(o).dialog({title:a,modal:!0,autoOpen:!0,resizable:!1,dialogClass:"alert",open:function(){DialogWindow.openDialog(o)},appendTo:this.parent,buttons:{Cancel:function(){$(o).dialog("close"),$("#webotsEditorConfirmDialog").remove()},Reset:function(){$(o).dialog("close"),$("#webotsEditorConfirmDialog").remove(),t.resetAllFiles?t.filenames.forEach(function(e){t.view.server.resetController(t.dirname+"/"+e)}):t.view.server.resetController(t.dirname+"/"+t.filenames[t.currentSession])}}}),this._hideMenu()}},{key:"_textChange",value:function(e){!$("#filename-"+e).html().endsWith("*")&&this.editor.curOp&&this.editor.curOp.command.name&&$("#filename-"+e).html(this.filenames[e]+"*")}},{key:"_aceMode",value:function(e){if("makefile"===e.toLowerCase())return"ace/mode/makefile";var t=e.split(".").pop().toLowerCase();return"py"===t?"ace/mode/python":"c"===t||"cpp"===t||"c++"===t||"cxx"===t||"cc"===t||"h"===t||"hpp"===t||"h++"===t||"hxx"===t||"hh"===t?"ace/mode/c_cpp":"java"===t?"ace/mode/java":"m"===t?"ace/mode/matlab":"json"===t?"ace/mode/json":"xml"===t?"ace/mode/xml":"yaml"===t?"ace/mode/yaml":"ini"===t?"ace/mode/ini":"html"===t?"ace/mode/html":"js"===t?"ace/mode/javascript":"css"===t?"ace/mode/css":"ace/mode/text"}},{key:"_storeUserFile",value:function(e){var t=this,a=new FormData;a.append("dirname",this.view.server.project+"/controllers/"+this.dirname),a.append("filename",this.filenames[e]),a.append("content",this.sessions[e].getValue()),$.ajax({url:"/ajax/upload-file.php",type:"POST",data:a,processData:!1,contentType:!1,success:function(e){"OK"!==e&&t.alert("File saving error",e)}})}}]),t}(DialogWindow);function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var ContextMenu=function(){function e(t,a){var r=this;_classCallCheck(this,e),this.object=null,this.visible=!1,this.authenticatedUser=t,this.onFollowObject=null,this.onEditController=null,this.onOpenRobotWindow=null,this.isFollowedObject=null,this.isRobotWindowValid=null;var o=document.createElement("ul");o.id="contextMenu",o.innerHTML="<li class='ui-widget-header'><div id='contextMenuTitle'>Object</div></li><li id='contextMenuFollow'><div>Follow</div></li><li id='contextMenuUnfollow'><div>Unfollow</div></li><li><div class='ui-state-disabled'>Zoom</div></li><li id='contextMenuRobotWindow'><div id='contextMenuRobotWindowDiv'>Robot window</div></li><li id='contextMenuEditController'><div id='contextMenuEditControllerDiv'>Edit controller</div></li><li><div class='ui-state-disabled'>Delete</div></li><li><div class='ui-state-disabled'>Properties</div></li>",$(a).append(o),$("#contextMenu").menu({items:"> :not(.ui-widget-header)"}),$("#contextMenu").css("position","absolute"),$("#contextMenu").css("z-index",1),$("#contextMenu").css("display","none"),$("#contextMenu").on("menuselect",function(e,t){if(!t.item.children().hasClass("ui-state-disabled")){var a=t.item.attr("id");if("contextMenuFollow"===a)"function"==typeof r.onFollowObject&&r.onFollowObject(r.object.name);else if("contextMenuUnfollow"===a)"function"==typeof r.onFollowObject&&r.onFollowObject("none");else if("contextMenuEditController"===a){var o=r.object.userData.controller;$("#webotsEditor").dialog("open"),$("#webotsEditor").dialog("option","title","Controller: "+o),"function"==typeof r.onEditController&&r.onEditController(o)}else if("contextMenuRobotWindow"===a){var n=r.object.userData.name;"function"==typeof r.onOpenRobotWindow&&r.onOpenRobotWindow(n)}else console.log("Unknown menu item: "+a);$("#contextMenu").css("display","none")}})}return _createClass(e,[{key:"disableEdit",value:function(){$("#contextMenuRobotWindowDiv").addClass("ui-state-disabled"),$("#contextMenuEditControllerDiv").addClass("ui-state-disabled")}},{key:"toggle",value:function(){var e=this.visible;return e&&this.hide(),e}},{key:"hide",value:function(){$("#contextMenu").css("display","none"),this.visible=!1}},{key:"show",value:function(e,t){this.object=e;var a=e.userData.name;(null==a||""===a)&&(a=e.userData.name.defName,(null==a||""===a)&&(a="Object")),$("#contextMenuTitle").html(a);var r=e.userData.controller;if(r&&""!==r){$("#contextMenuEditController").css("display","inline"),"void"!==r&&0!==r.length&&this.authenticatedUser||$("#contextMenuEditController").children().addClass("ui-state-disabled");var o=e.userData.name,n=!1;"function"==typeof this.isRobotWindowValid&&this.isRobotWindowValid(o,function(e){n=e}),n?$("#contextMenuRobotWindow").css("display","inline"):$("#contextMenuRobotWindow").css("display","none")}else $("#contextMenuEditController").css("display","none"),$("#contextMenuRobotWindow").css("display","none");var i=!1;"function"==typeof this.isFollowedObject&&this.isFollowedObject(e,function(e){i=e}),i?($("#contextMenuFollow").css("display","none"),$("#contextMenuUnfollow").css("display","inline")):($("#contextMenuFollow").css("display","inline"),$("#contextMenuUnfollow").css("display","none"));var s=$("#contextMenu").width(),l=$("#contextMenu").height(),d=$("#playerDiv").width(),p=$("#playerDiv").height(),c,u;c=null!=d&&s+t.x>d?d-s:t.x,u=null!=p&&l+t.y>p?p-l-$("#toolBar").height():t.y,$("#contextMenu").css("left",c+"px"),$("#contextMenu").css("top",u+"px"),$("#contextMenu").css("display","block"),this.visible=!0}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var Viewpoint=function(){var t=Math.abs;function e(){_classCallCheck(this,e),this.onCameraParametersChanged=null,this.followedObjectId=null,this.followedObjectDeltaPosition=null,this.viewpointMass=1,this.viewpointFriction=.05,this.viewpointForce=null,this.viewpointVelocity=null,this.viewpointLastUpdate=void 0,this.camera=new THREE.PerspectiveCamera(45,1,.001,400),this.camera.position.x=10,this.camera.position.y=10,this.camera.position.z=10}return _createClass(e,[{key:"reset",value:function(e){this.camera.position.copy(this.initialViewpointPosition),this.camera.quaternion.copy(this.initialViewpointOrientation),this.updateViewpointPosition(!0,e),this.notifyCameraParametersChanged()}},{key:"isFollowedObject",value:function(e){return this.followedObjectId&&(e.name===this.followedObjectId||e.userData.name===this.followedObjectId)}},{key:"resetFollow",value:function(){this.followedObjectId=null}},{key:"initFollowParameters",value:function(){this.initialViewpointPosition=this.camera.position.clone(),this.initialViewpointOrientation=this.camera.quaternion.clone(),null!=this.camera.userData.followSmoothness&&this.setViewpointMass(this.camera.userData.followSmoothness),null==this.camera.userData.followedId?this.follow.followedObjectId="none":this.follow(this.camera.userData.followedId)}},{key:"follow",value:function(e){this.followedObjectId=e,this.viewpointForce=new THREE.Vector3(0,0,0),this.viewpointVelocity=new THREE.Vector3(0,0,0)}},{key:"setViewpointMass",value:function(e){this.viewpointMass=e,.05>=this.viewpointMass?this.viewpointMass=0:(1<this.viewpointMass&&(this.viewpointMass=1),this.friction=.05/this.viewpointMass)}},{key:"setFollowedObjectDeltaPosition",value:function(e,t){this.followedObjectDeltaPosition=new THREE.Vector3,this.followedObjectDeltaPosition.subVectors(e,t)}},{key:"updateViewpointPosition",value:function(e,a){if(null==this.followedObjectId||"none"===this.followedObjectId||"undefined"==typeof a)return!1;"undefined"==typeof this.viewpointLastUpdate&&(this.viewpointLastUpdate=a);var r=t(a-this.viewpointLastUpdate)/1e3;if(0<r&&this.camera){this.viewpointLastUpdate=a;var o=null;if(null!=this.followedObjectDeltaPosition&&this.viewpointForce.add(this.followedObjectDeltaPosition),e||0===this.viewpointMass||.1<r&&null==this.animation)o=this.viewpointForce.clone(),this.viewpointVelocity=new THREE.Vector3(0,0,0);else{var n=this.viewpointForce.clone();n.multiplyScalar(r/this.viewpointMass),this.viewpointVelocity.add(n);var i=this.viewpointVelocity.length(),s;if(null!=this.followedObjectDeltaPosition){var l=this.followedObjectDeltaPosition.clone();l.divideScalar(r),s=l.dot(this.viewpointVelocity)/i}else s=0;if(0<this.viewpointFriction&&i>s){var d=(i-(i-s)*this.viewpointFriction)/i;this.viewpointVelocity.multiplyScalar(d)}o=this.viewpointVelocity.clone(),o.multiplyScalar(r)}return this.viewpointForce.sub(o),this.camera.position.add(o),this.followedObjectDeltaPosition=null,!0}return!1}},{key:"rotate",value:function(e){var t=-.005*e.dx,a=-.005*e.dy;null==e.pickPosition&&(t/=-8,a/=-8);var r=new THREE.Matrix4,o=new THREE.Vector3,n=new THREE.Vector3;r.makeRotationFromQuaternion(this.camera.quaternion).extractBasis(o,n,new THREE.Vector3);var i=new THREE.Quaternion;i.setFromAxisAngle(o,2*a);var s=new THREE.Quaternion;s.setFromAxisAngle(new THREE.Vector3(0,1,0),2*t);var l=s.multiply(i);e.pickPosition&&this.camera.position.sub(e.pickPosition).applyQuaternion(l).add(e.pickPosition),this.camera.quaternion.premultiply(l),this.notifyCameraParametersChanged()}},{key:"translate",value:function(e){var t=new THREE.Matrix4,a=new THREE.Vector3,r=new THREE.Vector3;t.makeRotationFromQuaternion(this.camera.quaternion).extractBasis(a,r,new THREE.Vector3);var o=-e.scaleFactor*e.dx,n=e.scaleFactor*e.dy;this.camera.position.addVectors(e.initialCameraPosition,a.multiplyScalar(o).add(r.multiplyScalar(n))),this.notifyCameraParametersChanged()}},{key:"zoomAndTilt",value:function(e){var t=new THREE.Matrix4,a=new THREE.Vector3;t.makeRotationFromQuaternion(this.camera.quaternion).extractBasis(new THREE.Vector3,new THREE.Vector3,a),this.camera.position.add(a.clone().multiplyScalar(e.zoomScale));var r=new THREE.Quaternion;r.setFromAxisAngle(a,e.tiltAngle),this.camera.quaternion.premultiply(r),this.notifyCameraParametersChanged()}},{key:"zoom",value:function(e,t){var a=.02*e*(0>t?-1:1),r=new THREE.Matrix4,o=new THREE.Vector3;r.makeRotationFromQuaternion(this.camera.quaternion).extractBasis(new THREE.Vector3,new THREE.Vector3,o),this.camera.position.add(o.multiplyScalar(a)),this.notifyCameraParametersChanged()}},{key:"notifyCameraParametersChanged",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];"function"==typeof this.onCameraParametersChanged&&this.onCameraParametersChanged(e)}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var Selector=function(){function e(){_classCallCheck(this,e),this.selectedObject=null,this.selectedRepresentations=[],this.onSelectionChange=null}return _createClass(e,[{key:"select",value:function(e){if(this.selectedObject!==e){if(this.clearSelection(),!e)return void("function"==typeof this.onSelectionChange&&this.onSelectionChange());for(var t=[e],a;0<t.length;)a=t.pop(),a.userData&&"Switch"===a.userData.x3dType&&(a.visible=!0,this.selectedRepresentations.push(a)),a.children&&(t=t.concat(a.children));0<this.selectedRepresentations.length&&(this.selectedObject=e),"function"==typeof this.onSelectionChange&&this.onSelectionChange()}}},{key:"clearSelection",value:function(){this.selectedRepresentations.forEach(function(e){e.visible=!1}),this.selectedRepresentations=[],this.selectedObject=null}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var MouseEvents=function(){var t=Math.tan,a=Math.round,r=Math.atan2,o=Math.max,n=Math.abs;function e(t,a,r,o){var n=this;_classCallCheck(this,e),this.scene=t,this.contextMenu=a,this.domElement=r,this.mobileDevice=o,this.state={initialized:!1,mouseDown:0,moved:!1,wheelFocus:!1,wheelTimeout:null,hiddenContextMenu:!1},this.moveParams={},this.enableNavigation=!0,this.onmousemove=function(e){n._onMouseMove(e)},this.onmouseup=function(e){n._onMouseUp(e)},this.ontouchmove=function(e){n._onTouchMove(e)},this.ontouchend=function(e){n._onTouchEnd(e)},r.addEventListener("mousedown",function(e){n._onMouseDown(e)},!1),r.addEventListener("mouseover",function(e){n._onMouseOver(e)},!1),r.addEventListener("mouseleave",function(e){n._onMouseLeave(e)},!1),r.addEventListener("wheel",function(e){n._onMouseWheel(e)},!1),r.addEventListener("touchstart",function(e){n._onTouchStart(e)},!0),r.addEventListener("contextmenu",function(e){e.preventDefault()},!1),r.parentNode.addEventListener("contextmenu",function(e){e.preventDefault()},!1)}return _createClass(e,[{key:"_onMouseDown",value:function(e){switch(this.state.wheelFocus=!0,this._initMouseMove(e),e.button){case THREE.MOUSE.LEFT:this.state.mouseDown|=1;break;case THREE.MOUSE.MIDDLE:this.state.mouseDown|=4;break;case THREE.MOUSE.RIGHT:this.state.mouseDown|=2;}SystemInfo.isMacOS()&&"ctrlKey"in e&&e.ctrlKey&&1===this.state.mouseDown&&(this.state.mouseDown=2),0!==this.state.mouseDown&&(this._setupMoveParameters(e),this.state.initialX=e.clientX,this.state.initialY=e.clientY,document.addEventListener("mousemove",this.onmousemove,!1),document.addEventListener("mouseup",this.onmouseup,!1)),"function"==typeof webots.currentView.onmousedown&&webots.currentView.onmousedown(e)}},{key:"_onMouseMove",value:function(e){if(!this.enableNavigation&&0===e.button)return void("function"==typeof webots.currentView.onmousemove&&webots.currentView.onmousemove(e));if("undefined"!=typeof this.state.x){if("buttons"in e)this.state.mouseDown=e.buttons;else if("which"in e)switch(e.which){case 0:this.state.mouseDown=0;break;case 1:this.state.mouseDown=1;break;case 2:this.state.pressedButton=4;break;case 3:this.state.pressedButton=2;break;default:this.state.pressedButton=0;}SystemInfo.isMacOS()&&"ctrlKey"in e&&e.ctrlKey&&1===this.state.mouseDown&&(this.state.mouseDown=2),0===this.state.mouseDown||null===this.state.initialTimeStamp||(this.moveParams.dx=e.clientX-this.state.x,this.moveParams.dy=e.clientY-this.state.y,1===this.state.mouseDown?this.scene.viewpoint.rotate(this.moveParams):2===this.state.mouseDown?(this.moveParams.dx=e.clientX-this.state.initialX,this.moveParams.dy=e.clientY-this.state.initialY,this.scene.viewpoint.translate(this.moveParams)):(3===this.state.mouseDown||4===this.state.mouseDown)&&(this.moveParams.tiltAngle=.01*this.moveParams.dx,this.moveParams.zoomScale=5*this.moveParams.scaleFactor*this.moveParams.dy,this.scene.viewpoint.zoomAndTilt(this.moveParams,!0)),this.state.moved=e.clientX!==this.state.x||e.clientY!==this.state.y,this.state.x=e.clientX,this.state.y=e.clientY,"function"==typeof webots.currentView.onmousemove&&webots.currentView.onmousemove(e),"function"==typeof webots.currentView.onmousedrag&&webots.currentView.onmousedrag(e))}}},{key:"_onMouseUp",value:function(e){this._clearMouseMove(),this._selectAndHandleClick(),document.removeEventListener("mousemove",this.onmousemove,!1),document.removeEventListener("mouseup",this.onmouseup,!1),"function"==typeof webots.currentView.onmouseup&&webots.currentView.onmouseup(e)}},{key:"_onMouseWheel",value:function(e){var t=this;if(e.preventDefault(),"initialCameraPosition"in this.moveParams||this._setupMoveParameters(e),!this.enableNavigation||!1===this.state.wheelFocus){var a=e.deltaY;return 1===e.deltaMode&&(a*=40),window.scroll(0,window.pageYOffset+a),void(this.state.wheelTimeout&&(clearTimeout(this.state.wheelTimeout),this.state.wheelTimeout=setTimeout(function(e){t._wheelTimeoutCallback(e)},1500)))}this.scene.viewpoint.zoom(this.moveParams.distanceToPickPosition,e.deltaY),"function"==typeof webots.currentView.onmousewheel&&webots.currentView.onmousewheel(e)}},{key:"_wheelTimeoutCallback",value:function(){this.state.wheelTimeout=null,this.state.wheelFocus=!0}},{key:"_onMouseOver",value:function(){var e=this;this.state.wheelTimeout=setTimeout(function(t){e._wheelTimeoutCallback(t)},1500)}},{key:"_onMouseLeave",value:function(e){null!=this.state.wheelTimeout&&(clearTimeout(this.state.wheelTimeout),this.state.wheelTimeout=null),this.state.wheelFocus=!1,"function"==typeof webots.currentView.onmouseleave&&webots.currentView.onmouseleave(e)}},{key:"_onTouchMove",value:function(e){if(this.enableNavigation&&0!==e.targetTouches.length&&!(2<e.targetTouches.length)&&null!==this.state.initialTimeStamp&&2!==this.state.mouseDown==1<e.targetTouches.length){var t=e.targetTouches[0],r=a(t.clientX),o=a(t.clientY);if(2===this.state.mouseDown)this.moveParams.dx=r-this.state.x,this.moveParams.dy=o-this.state.y,null==this.state.initialX&&null==this.state.initialY&&(this.state.initialX=a(this.state.x),this.state.initialY=a(this.state.y)),this.state.moved=!(2>n(this.moveParams.dx)&&2>n(this.moveParams.dy)&&5>n(this.state.initialX-r)&&5>n(this.state.initialY-o)),this.moveParams.dx=r-this.state.initialX,this.moveParams.dy=o-this.state.initialY,this.scene.viewpoint.translate(this.moveParams);else{var i=e.targetTouches[1],s=a(i.clientX),l=a(i.clientY),p=r-s,c=o-l,u=p*p+c*c,m=this.state.touchDistance-u,f=r-this.state.x,g=s-this.state.x1,h=o-this.state.y,y=l-this.state.y1,x=window.devicePixelRatio||1;if(n(m)>500*x){var v;v=n(g)<n(f)?f:g,this.moveParams.tiltAngle=4e-4*v,this.moveParams.zoomScale=.015*this.moveParams.scaleFactor*m,this.scene.viewpoint.zoomAndTilt(this.moveParams)}else n(y-h)<3*x&&n(g-f)<3*x&&(this.moveParams.dx=.8*f,this.moveParams.dy=.5*h,this.scene.viewpoint.rotate(this.moveParams));this.state.touchDistance=u,this.state.moved=!0}this.state.x=r,this.state.y=o,this.state.x1=s,this.state.y1=l,"function"==typeof webots.currentView.ontouchmove&&webots.currentView.ontouchmove(e)}}},{key:"_onTouchStart",value:function(e){if(this._initMouseMove(e.targetTouches[0]),2===e.targetTouches.length){var t=e.targetTouches[1];this.state.x1=t.clientX,this.state.y1=t.clientY;var a=this.state.x-this.state.x1,o=this.state.y-this.state.y1;this.state.touchDistance=a*a+o*o,this.state.touchOrientation=r(this.state.y1-this.state.y,this.state.x1-this.state.x),this.state.mouseDown=3}else this.state.mouseDown=2;this._setupMoveParameters(e.targetTouches[0]),this.domElement.addEventListener("touchend",this.ontouchend,!0),this.domElement.addEventListener("touchmove",this.ontouchmove,!0),"function"==typeof webots.currentView.ontouchstart&&webots.currentView.ontouchstart(e)}},{key:"_onTouchEnd",value:function(e){this._clearMouseMove(),this._selectAndHandleClick(),this.domElement.removeEventListener("touchend",this.ontouchend,!0),this.domElement.removeEventListener("touchmove",this.ontouchmove,!0),"function"==typeof webots.currentView.ontouchend&&webots.currentView.ontouchend(e)}},{key:"_initMouseMove",value:function(e){this.state.x=e.clientX,this.state.y=e.clientY,this.state.initialX=null,this.state.initialY=null,this.state.moved=!1,this.state.initialTimeStamp=Date.now(),this.state.longClick=!1,this.contextMenu&&(this.hiddenContextMenu=this.contextMenu.toggle())}},{key:"_setupMoveParameters",value:function(a){this.moveParams={};var r=e.convertMouseEventPositionToRelativePosition(this.scene.renderer.domElement,a.clientX,a.clientY),n=e.convertMouseEventPositionToScreenPosition(this.scene.renderer.domElement,a.clientX,a.clientY);if(this.intersection=this.scene.pick(r,n),this.moveParams.pickPosition=this.intersection&&this.intersection.object?this.intersection.point:null,null==this.intersection){var i=new THREE.Vector3;this.scene.viewpoint.camera.getWorldPosition(i),this.moveParams.distanceToPickPosition=i.length()}else this.moveParams.distanceToPickPosition=this.intersection.distance;.001>this.moveParams.distanceToPickPosition&&(this.moveParams.distanceToPickPosition=.001),this.moveParams.scaleFactor=2*this.moveParams.distanceToPickPosition*t(.5*this.scene.viewpoint.camera.fovX);var s=parseFloat($(this.scene.domElement).css("height").slice(0,-2)),l=parseFloat($(this.scene.domElement).css("width").slice(0,-2));this.moveParams.scaleFactor/=o(s,l),this.moveParams.initialCameraPosition=this.scene.viewpoint.camera.position.clone()}},{key:"_clearMouseMove",value:function(){var e=this.mobileDevice?100:1e3;this.state.longClick=Date.now()-this.state.initialTimeStamp>=e,this.previousSelection=!1===this.state.moved?this.selection:null,this.state.previousMouseDown=this.state.mouseDown,this.state.mouseDown=0,this.state.initialTimeStamp=null,this.state.initialX=null,this.state.initialY=null,this.moveParams={}}},{key:"_selectAndHandleClick",value:function(){if(!1===this.state.moved&&(!this.state.longClick||this.mobileDevice)){var e;this.intersection&&(e=this.intersection.object,e&&(e=this.scene.getTopX3dNode(e))),this.scene.selector.select(e),(this.mobileDevice&&this.state.longClick||!this.mobileDevice&&2===this.state.previousMouseDown)&&!1===this.hiddenContextMenu&&this.contextMenu&&this.contextMenu.show(e,{x:this.state.x,y:this.state.y})}}}]),e}();MouseEvents.convertMouseEventPositionToScreenPosition=function(e,t,a){var r=e.getBoundingClientRect(),o=new THREE.Vector2;return o.x=2*((t-r.left)/(r.right-r.left))-1,o.y=2*-((a-r.top)/(r.bottom-r.top))+1,o},MouseEvents.convertMouseEventPositionToRelativePosition=function(e,t,a){var r=Math.round,o=e.getBoundingClientRect(),n=new THREE.Vector2;return n.x=r(t-o.left),n.y=r(a-o.top),n},"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var TextureLoader={createEmptyTexture:function(e){if(hasHDRExtension(e)){var t=new THREE.DataTexture;return t.encoding=THREE.RGBEEncoding,t.minFilter=THREE.NearestFilter,t.magFilter=THREE.NearestFilter,t.flipY=!0,t}return new THREE.Texture},createColoredCubeTexture:function(e){var t=Math.floor,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=document.createElement("canvas"),s=n.getContext("2d");n.width=a,n.height=o;for(var l=t(255*e.r),r=t(255*e.g),d=t(255*e.b),p=s.createImageData(a,o),c=0,u;c<a*o;c++)u=4*c,p.data[u+0]=l,p.data[u+1]=r,p.data[u+2]=d,p.data[u+3]=255;s.putImageData(p,0,0);var m=n.toDataURL(),f=new THREE.CubeTextureLoader;return f.load([m,m,m,m,m,m])},createOrRetrieveTexture:function(e,t){return console.assert("string"==typeof e,"TextureLoader.createOrRetrieveTexture: name is not a string."),this._getInstance().createOrRetrieveTexture(e,t)},loadOrRetrieveImage:function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:void 0;return console.assert("string"==typeof e,"TextureLoader.loadOrRetrieveImage: name is not a string."),"undefined"==typeof e||""===e?void 0:this._getInstance().loadOrRetrieveImage(e,t,a,r)},setOnTextureLoad:function(e){this._getInstance().onTextureLoad=e},setTexturePathPrefix:function(e){this._getInstance().texturePathPrefix=e},hasPendingData:function(){return this._getInstance().hasPendingData},_getInstance:function(){return"undefined"==typeof this.instance&&(this.instance=new _TextureLoaderObject),this.instance}},TextureData=function(){function e(t,a,r){_classCallCheck(this,e),this.transparent=t,this.wrap=a,this.transform=r}return _createClass(e,[{key:"equals",value:function(e){return this.transparent===e.transparent&&JSON.stringify(this.wrap)===JSON.stringify(e.wrap)&&JSON.stringify(this.transform)===JSON.stringify(e.transform)}}]),e}();var _TextureLoaderObject=function(){var t=Math.sin,a=Math.cos;function e(){_classCallCheck(this,e),this.images=[],this.textures={},this.loadingTextures={},this.loadingCubeTextureObjects={},this.onTextureLoad=void 0,this.texturePathPrefix="",this.hasPendingData=!1}return _createClass(e,[{key:"createOrRetrieveTexture",value:function(e,r){var o=this.textures[e];if(o){for(var n in o)if(o[n][0].equals(r))return o[n][1];}else this.textures[e]=[];var i=TextureLoader.createEmptyTexture(e);this.textures[e].push([r,i]);var s=this.loadOrRetrieveImage(e,i);return"undefined"!=typeof s&&(i.image=s,i.needsUpdate=!0),i.userData={isTransparent:r.transparent,url:e},i.wrapS="true"===r.wrap.s?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,i.wrapT="true"===r.wrap.t?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,"undefined"!=typeof r.transform&&(i.matrixAutoUpdate=!1,i.onUpdate=function(){var e=a(-r.transform.rotation),o=t(-r.transform.rotation),n=r.transform.scale.x,s=r.transform.scale.y,l=r.transform.center.x,d=r.transform.center.y,p=r.transform.translation.x,c=r.transform.translation.y;i.matrix.set(n*e,n*o,n*(p*e+c*o+l*e+d*o)-l,-s*o,s*e,s*(-p*o+c*e-l*o+d*e)-d,0,0,1)},i.needsUpdate=!0),i.encoding=THREE.sRGBEncoding,i}},{key:"loadOrRetrieveImage",value:function(e,t){var a=this,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:void 0;if(this.texturePathPrefix&&(e=this.texturePathPrefix+e),this.images[e])return"undefined"!=typeof o&&o(this.images[e]),this.images[e];if(t instanceof THREE.CubeTexture){var n;this.loadingCubeTextureObjects[t]?(n=this.loadingCubeTextureObjects[t],n[e]?n[e].push(r):n[e]=[r]):(n={},n[e]=[r],this.loadingCubeTextureObjects[t]=n)}if(this.loadingTextures[e])return"undefined"!=typeof t&&this.loadingTextures[e].objects.push(t),void("undefined"!=typeof o&&this.loadingTextures[e].onLoad.push(o));this.loadingTextures[e]={objects:[],onLoad:[]},"undefined"!=typeof t&&this.loadingTextures[e].objects.push(t),"undefined"!=typeof o&&this.loadingTextures[e].onLoad.push(o),this.hasPendingData=!0,this._setTimeout();var i=hasHDRExtension(e),s;return s=i?new THREE.RGBELoader:new THREE.ImageLoader,void s.load(e,function(t){a.loadingTextures[e]&&(a.loadingTextures[e].data=i?t.image:t,a._onImageLoaded(e))},void 0,function(t){console.error("An error happened when loading the texure \""+e+"\": "+t)})}},{key:"_onImageLoaded",value:function(e){var t=this;if(this.loadingTextures[e]){var a=this.loadingTextures[e].data;this.images[e]=a;var r=this.loadingTextures[e].objects,o=hasJPEGExtension(e),n=!o&&hasHDRExtension(e);r.forEach(function(r){if(r instanceof THREE.CubeTexture){var i=t.loadingCubeTextureObjects[r],s=i[e];s.forEach(function(e){(2===e||3===e)&&(a.src=flipImage(a)),r.images[e]=a}),delete i[e],0===Object.keys(i).length&&(r.needsUpdate=!0,delete t.loadingCubeTextureObjects[r])}else n||(r.format=o?THREE.RGBFormat:THREE.RGBAFormat),r.image=a,r.needsUpdate=!0});var i=this.loadingTextures[e].onLoad;i.forEach(function(e){"function"==typeof e&&e(a)}),delete this.loadingTextures[e],"function"==typeof this.onTextureLoad&&this.onTextureLoad(),this._evaluatePendingData()}}},{key:"_setTimeout",value:function(){var e=this;this.timeoutHandle&&window.clearTimeout(this.timeoutHandle),this.timeoutHandle=window.setTimeout(function(){var t="ERROR: Texture loader timeout elapsed. The following textures could not be loaded: \n";for(var a in e.loadingTextures)t+=a+"\n";console.error(t),e.hasPendingData=!1,"function"==typeof e.onTextureLoad&&e.onTextureLoad()},1e4)}},{key:"_evaluatePendingData",value:function(){for(var e in this.hasPendingData=!1,this.loadingTextures)if(this.loadingTextures.hasOwnProperty(e)){this.hasPendingData=!0;break}this.hasPendingData?this._setTimeout():this.timeoutHandle&&window.clearTimeout(this.timeoutHandle)}}]),e}();function flipImage(e){var t=document.createElement("canvas"),a=t.getContext("2d");return t.width=e.width,t.height=e.height,a.scale(-1,-1),a.translate(-t.height,-t.width),a.drawImage(e,0,0),t.toDataURL("image/jpeg",95)}function hasJPEGExtension(e){return 0<e.search(/\.jpe?g($|\?)/i)||0===e.search(/^data:image\/jpeg/)}function hasHDRExtension(e){return 0<e.search(/\.hdr($|\?)/i)||0===e.search(/^data:image\/hdr/)}var DefaultUrl={wwiUrl:function(){if("undefined"==typeof this._wwiUrl){this._wwiUrl="";for(var e=document.getElementsByTagName("script"),t=e.length-1,a;0<=t;t--)if(a=e[t].src,0<a.indexOf("?")&&(a=a.substring(0,a.indexOf("?"))),a.endsWith("webots.js")||a.endsWith("webots.min.js")){this._wwiUrl=a.substr(0,a.lastIndexOf("/")+1);break}}return this._wwiUrl},wwiImagesUrl:function(){return this.wwiUrl()+"images/"},currentScriptUrl:function(){var e=document.querySelectorAll("script[src]");for(var t in e){var a=e[t].src,r=a.indexOf("?");if(0<r&&(a=a.substring(0,r)),a.endsWith("webots.js")||a.endsWith("webots.min.js"))return r=a.lastIndexOf("/"),a.substring(0,r+1)}return""}};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var Server=function(){function e(t,a,r){_classCallCheck(this,e),this.view=a,this.onready=r;var o=t.indexOf("/",6),n=t.lastIndexOf("/");this.url="http"+t.substring(2,o),this.project=t.substring(o+1,n-7),this.worldFile=t.substring(n+1),this.controllers=[]}return _createClass(e,[{key:"connect",value:function(){var e=this,t=new XMLHttpRequest;t.open("GET",this.url+"/session",!0),$("#webotsProgressMessage").html("Connecting to session server..."),t.onreadystatechange=function(){if(4===t.readyState&&200===t.status){var a=t.responseText;if(a.startsWith("Error:")){$("#webotsProgress").hide();var r=a.substring(6).trim();return r=r.charAt(0).toUpperCase()+r.substring(1),void webots.alert("Session server error",r)}e.socket=new WebSocket(a+"/client"),e.socket.onopen=function(t){e.onOpen(t)},e.socket.onmessage=function(t){e.onMessage(t)},e.socket.onclose=function(){e.view.console.info("Disconnected to the Webots server.")},e.socket.onerror=function(){e.view.console.error("Cannot connect to the simulation server")}}},t.send()}},{key:"onOpen",value:function(){var e=location.protocol+"//"+location.host.replace(/^www./,"");"undefined"==typeof webots.User1Id&&(webots.User1Id=""),"undefined"==typeof webots.User1Name&&(webots.User1Name=""),"undefined"==typeof webots.User1Authentication&&(webots.User1Authentication=""),"undefined"==typeof webots.User2Id&&(webots.User2Id=""),"undefined"==typeof webots.User2Name&&(webots.User2Name=""),"undefined"==typeof webots.CustomData&&(webots.CustomData=""),this.socket.send("{ \"init\" : [ \""+e+"\", \""+this.project+"\", \""+this.worldFile+"\", \""+webots.User1Id+"\", \""+webots.User1Name+"\", \""+webots.User1Authentication+"\", \""+webots.User2Id+"\", \""+webots.User2Name+"\", \""+webots.CustomData+"\" ] }"),$("#webotsProgressMessage").html("Starting simulation...")}},{key:"onMessage",value:function(e){var t=e.data;if(0===t.indexOf("webots:ws://")||0===t.indexOf("webots:wss://")){var a=t.substring(7),r=a.replace(/ws/,"http");TextureLoader.setTexturePathPrefix(r+"/"),this.view.stream=new Stream(a,this.view,this.onready),this.view.stream.connect()}else if(0===t.indexOf("controller:")){var o=t.indexOf(":",11),n={};n.name=t.substring(11,o),n.port=t.substring(o+1),this.view.console.info("Using controller "+n.name+" on port "+n.port),this.controllers.push(n)}else if(0===t.indexOf("queue:"))this.view.console.error("The server is saturated. Queue to wait: "+t.substring(6)+" client(s).");else if("."===t);else 0===t.indexOf("reset controller:")?this.view.stream.socket.send("sync controller:"+t.substring(18).trim()):console.log("Received an unknown message from the Webots server socket: \""+t+"\"")}},{key:"resetController",value:function(e){this.socket.send("{ \"reset controller\" : \""+e+"\" }")}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var Stream=function(){function e(t,a,r){_classCallCheck(this,e),this.wsServer=t,this.view=a,this.onready=r,this.socket=null,this.videoStream=null}return _createClass(e,[{key:"connect",value:function(){var e=this;this.socket=new WebSocket(this.wsServer),$("#webotsProgressMessage").html("Connecting to Webots instance..."),this.socket.onopen=function(t){e.onSocketOpen(t)},this.socket.onmessage=function(t){e.onSocketMessage(t)},this.socket.onclose=function(t){e.onSocketClose(t)},this.socket.onerror=function(t){e.view.destroyWorld(),e.view.onerror("WebSocket error: "+t.data)}}},{key:"close",value:function(){this.socket&&this.socket.close(),this.videoStream&&this.videoStream.close()}},{key:"onSocketOpen",value:function(){var e=this.view.mode;"video"===e?e+=": "+this.view.video.width+"x"+this.view.video.height:this.view.broadcast&&(e+=";broadcast"),this.socket.send(e)}},{key:"onSocketClose",value:function(e){this.view.onerror("Disconnected from "+this.wsServer+" ("+e.code+")"),(1001<e.code&&1016>e.code||1001===e.code&&!1===this.view.quitting)&&webots.alert("Streaming server error","Connection closed abnormally.<br>(Error code: "+e.code+")<br><br>Please reset the simulation by clicking <a href=\""+window.location.href+"\">here</a>."),this.view.destroyWorld(),"function"==typeof this.view.onclose&&this.view.onclose()}},{key:"onSocketMessage",value:function(e){var t=e.data,a,r;if(t.startsWith("robot:")||t.startsWith("stdout:")||t.startsWith("stderr:"))for(a=t.split("\n"),r=0;r<a.length;r++){var o=a[r];if(""!==o)if(o.startsWith("stdout:"))this.view.console.stdout(o.substring(7));else if(o.startsWith("stderr:"))this.view.console.stderr(o.substring(7));else if(o.startsWith("robot:")){var n=o.indexOf(":",6),s=o.substring(6,n),l=o.substring(n+1);this.view.onrobotmessage(s,l)}}else if(t.startsWith("application/json:")){if("undefined"!=typeof this.view.time){t=t.substring(t.indexOf(":")+1);var d=JSON.parse(t);if(this.view.time=d.time,$("#webotsClock").html(webots.parseMillisecondsIntoReadableTime(d.time)),d.hasOwnProperty("poses"))for(r=0;r<d.poses.length;r++)this.view.x3dScene.applyPose(d.poses[r]);this.view.x3dScene.viewpoint.updateViewpointPosition(null,this.view.time)&&this.view.x3dScene.viewpoint.notifyCameraParametersChanged(!1),this.view.x3dScene.onSceneUpdate()}}else if(t.startsWith("node:")){t=t.substring(t.indexOf(":")+1);var p=t.split(":")[0];t=t.substring(t.indexOf(":")+1),this.view.x3dScene.loadObject(t,p)}else if(t.startsWith("delete:"))t=t.substring(t.indexOf(":")+1).trim(),this.view.x3dScene.deleteObject(t);else if(t.startsWith("model:")){if($("#webotsProgressMessage").html("Loading 3D scene..."),$("#webotsProgressPercent").html(""),this.view.destroyWorld(),t=t.substring(t.indexOf(":")+1).trim(),!t)return;this.view.x3dScene.loadObject(t)}else if(t.startsWith("world:")){t=t.substring(t.indexOf(":")+1).trim();var c=t.substring(0,t.indexOf(":")).trim();t=t.substring(t.indexOf(":")+1).trim(),this.view.updateWorldList(c,t.split(";"))}else if(t.startsWith("video: ")){console.log("Received data = "+t);var u=t.split(" "),m=u[1],f=u[2];console.log("Received video message on "+m+" stream = "+f),this.videoStream=new webots.VideoStream(m,this.view.video,document.getElementById("BitrateViewer"),f),"function"==typeof this.onready&&this.onready()}else if(t.startsWith("set controller:")){var g=t.indexOf("/",15),h=t.substring(15,g),y=t.substring(g+1,t.indexOf(":",g+1));this.view.editor.dirname===h?this.view.editor.addFile(y,t.substring(t.indexOf("\n")+1)):console.log("Warning: "+y+" not in controller directory: "+h+" != "+this.view.editor.dirname)}else if("pause"===t)this.view.toolBar.setMode(t),0<this.view.timeout&&!this.view.isAutomaticallyPaused&&(this.view.deadline=this.view.timeout,"undefined"!=typeof this.view.time&&(this.view.deadline+=this.view.time),$("#webotsTimeout").html(webots.parseMillisecondsIntoReadableTime(this.view.deadline)));else if("real-time"===t||"run"===t||"fast"===t)this.view.toolBar.setMode(t),0<=this.view.timeout&&this.view.stream.socket.send("timeout:"+this.view.timeout);else if(t.startsWith("loading:")){t=t.substring(t.indexOf(":")+1).trim();var x=t.substring(0,t.indexOf(":")).trim();t=t.substring(t.indexOf(":")+1).trim(),$("#webotsProgressMessage").html("Loading: "+x),$("#webotsProgressPercent").html("<progress value=\""+t+"\" max=\"100\"></progress>")}else if("scene load completed"===t)this.view.time=0,$("#webotsClock").html(webots.parseMillisecondsIntoReadableTime(0)),"function"==typeof this.onready&&this.onready();else if("reset finished"===t)this.view.resetSimulation(),"function"==typeof this.onready&&this.onready();else if(t.startsWith("label")){var v=t.indexOf(";"),b=t.substring(t.indexOf(":"),v),_=[],T;for(r=0;5>r;r++)T=v+1,v=t.indexOf(";",T),_.push(t.substring(T,v));this.view.setLabel({id:b,text:t.substring(v+1,t.length),font:_[0],color:_[1],size:_[2],x:_[3],y:_[4]})}else console.log("WebSocket error: Unknown message received: \""+t+"\"")}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var Video=function(){var t=Math.sign;function e(t,a,r){var o=this;_classCallCheck(this,e),this.domElement=document.createElement("video"),this.domElement.style.background="grey",this.domElement.id="remoteVideo",this.domElement["class"]="rounded centered",this.domElement.autoplay="true",this.domElement.width=800,this.domElement.height=600,t.appendChild(this.domElement),this.mouseEvents=a,this.stream=r,this.onmousemove=function(t){o._onMouseMove(t)}}return _createClass(e,[{key:"finalize",value:function(e){var t=this;this.domElement.addEventListener("mousedown",function(a){t._onMouseDown(a)},!1),this.domElement.addEventListener("mouseup",function(a){t._onMouseUp(a)},!1),this.domElement.addEventListener("wheel",function(a){t._onWheel(a)},!1),this.domElement.addEventListener("contextmenu",function(a){t._onContextMenu(a)},!1),"function"==typeof e&&e()}},{key:"sendMouseEvent",value:function(e,t,a){var r=this.stream.socket;if(r&&1===r.readyState){var o=(t.shiftKey?1:0)+(t.ctrlKey?2:0)+(t.altKey?4:0);r.send("mouse "+e+" "+t.button+" "+this.mouseEvents.mouseState.mouseDown+" "+t.offsetX+" "+t.offsetY+" "+o+" "+a)}}},{key:"resize",value:function(e,t){this.domElement.width=e,this.domElement.height=t,this.stream.socket.send("resize: "+e+"x"+t)}},{key:"_onMouseDown",value:function(e){return e.target.addEventListener("mousemove",this.onmousemove,!1),this.sendMouseEvent(-1,e,0),e.preventDefault(),!1}},{key:"_onMouseMove",value:function(e){return 0===this.mouseEvents.mouseState.mouseDown?(e.target.removeEventListener("mousemove",this.onmousemove,!1),!1):(this.sendMouseEvent(0,e,0),!1)}},{key:"_onMouseUp",value:function(e){return e.target.removeEventListener("mousemove",this.onmousemove,!1),this.sendMouseEvent(1,e,0),e.preventDefault(),!1}},{key:"_onWheel",value:function(e){return this.sendMouseEvent(2,e,t(e.deltaY)),!1}},{key:"_onContextMenu",value:function(e){return e.preventDefault(),!1}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}THREE.X3DLoader=function(){var t=Math.PI,a=Math.min;function e(t){_classCallCheck(this,e),this.scene=t,this.parsedObjects=[],this.directionalLights=[]}return _createClass(e,[{key:"load",value:function(e,t){console.log("X3D: Loading "+e);var a=this,r=new THREE.FileLoader(a.manager);r.load(e,function(e){"undefined"!=typeof t&&t(a.parse(e))})}},{key:"parse",value:function(e){this.directionalLights=[];var t;console.log("X3D: Parsing");var a=null;if(window.DOMParser){var r=new DOMParser;a=r.parseFromString(e,"text/xml")}else a=new ActiveXObject("Microsoft.XMLDOM"),a.async=!1,a.loadXML(e);var o=a.getElementsByTagName("Scene")[0];if("undefined"!=typeof o)return t=new THREE.Group,t.userData.x3dType="Group",t.name="n0",this.parsedObjects.push(t),this.parseNode(t,o),this.parsedObjects;var i=[];for(a.childNodes.forEach(function(e){i.push(e)});0<i.length;){var s=i.pop();t=new THREE.Group,this.parsedObjects.push(t),this.parseNode(t,s)}return this.parsedObjects}},{key:"parseNode",value:function(e,t){var a=this._getDefNode(t);if("undefined"!=typeof a){var r=a.clone();return this._setCustomId(t,r,a),void e.add(r)}var o=!1,n=[];if("Transform"===t.tagName)a=this.parseTransform(t),o=!0;else if("Shape"===t.tagName)a=this.parseShape(t);else if("DirectionalLight"===t.tagName)a=this.parseDirectionalLight(t);else if("PointLight"===t.tagName)a=this.parsePointLight(t);else if("SpotLight"===t.tagName)a=this.parseSpotLight(t,n);else if("Group"===t.tagName)a=new THREE.Group,a.userData.x3dType="Group",o=!0;else if("Switch"===t.tagName)a=new THREE.Group,a.visible="-1"!==getNodeAttribute(t,"whichChoice","-1"),a.userData.x3dType="Switch",o=!0;else if("Fog"===t.tagName)this.parseFog(t);else if("Viewpoint"===t.tagName)a=this.parseViewpoint(t);else if("Background"===t.tagName)a=this.parseBackground(t);else return"WorldInfo"===t.tagName?void this.parseWorldInfo(t):void this.parseChildren(t,e);if("undefined"!=typeof a){var i="false"===getNodeAttribute(t,"render","true").toLowerCase();i&&a.visible&&(a.visible=!1),this._setCustomId(t,a),e.add(a)}0<n.length&&n.forEach(function(t){e.add(t)}),o&&this.parseChildren(t,a)}},{key:"parseChildren",value:function(e,t){for(var a=0,r;a<e.childNodes.length;a++)r=e.childNodes[a],"undefined"!=typeof r.tagName&&this.parseNode(t,r)}},{key:"parseTransform",value:function(e){var t=new THREE.Object3D;t.userData.x3dType="Transform",t.userData.solid="true"===getNodeAttribute(e,"solid","false").toLowerCase(),t.userData.window=getNodeAttribute(e,"window","");var a=getNodeAttribute(e,"controller",void 0);"undefined"!=typeof a&&(t.userData.controller=a),t.userData.name=getNodeAttribute(e,"name","");var r=convertStringToVec3(getNodeAttribute(e,"translation","0 0 0"));t.position.copy(r);var o=convertStringToVec3(getNodeAttribute(e,"scale","1 1 1"));t.scale.copy(o);var n=convertStringToQuaternion(getNodeAttribute(e,"rotation","0 1 0 0"));return t.quaternion.copy(n),t}},{key:"parseShape",value:function(e){for(var t=0,a,r,o;t<e.childNodes.length;t++)if(o=e.childNodes[t],"undefined"!=typeof o.tagName){var n=this._getDefNode(o);if("undefined"!=typeof n){n.isGeometry||n.isBufferGeometry?a=n:n.isMaterial&&(r=n);continue}if("undefined"==typeof r){if("Appearance"===o.tagName){for(var s=!1,l=0,d;l<e.childNodes.length;l++)if(d=e.childNodes[l],"PBRAppearance"===d.tagName){s=!0;break}if(s)continue;else r=this.parseAppearance(o)}else"PBRAppearance"===o.tagName&&(r=this.parsePBRAppearance(o));if("undefined"!=typeof r){this._setCustomId(o,r);continue}}if("undefined"==typeof a&&("Box"===o.tagName?a=this.parseBox(o):"Cone"===o.tagName?a=this.parseCone(o):"Cylinder"===o.tagName?a=this.parseCylinder(o):"IndexedFaceSet"===o.tagName?a=this.parseIndexedFaceSet(o):"Sphere"===o.tagName?a=this.parseSphere(o):"Plane"===o.tagName?a=this.parsePlane(o):"ElevationGrid"===o.tagName?a=this.parseElevationGrid(o):"IndexedLineSet"===o.tagName?a=this.parseIndexedLineSet(o):"PointSet"===o.tagName&&(a=this.parsePointSet(o)),"undefined"!=typeof a)){this._setCustomId(o,a);continue}console.log("X3dLoader: Unknown node: "+o.tagName)}"undefined"==typeof a&&(a=createDefaultGeometry()),"undefined"==typeof r&&(r=createDefaultMaterial(a));var p;return p="IndexedLineSet"===a.userData.x3dType?new THREE.LineSegments(a,r):"PointSet"===a.userData.x3dType?new THREE.Points(a,r):new THREE.Mesh(a,r),p.userData.x3dType="Shape",r.transparent||r.userData.hasTransparentTexture||(p.castShadow="true"===getNodeAttribute(e,"castShadows","false").toLowerCase()),p.receiveShadow=!0,p.userData.isPickable="true"===getNodeAttribute(e,"isPickable","true").toLowerCase(),p}},{key:"parseAppearance",value:function(e){var t=new THREE.MeshBasicMaterial({color:16777215});t.userData.x3dType="Appearance";var a=e.getElementsByTagName("Material")[0],r={};if("undefined"!=typeof a){var o=this._getDefNode(a);r="undefined"==typeof o?{color:convertStringToColor(getNodeAttribute(a,"diffuseColor","0.8 0.8 0.8"),!1),specular:convertStringToColor(getNodeAttribute(a,"specularColor","0 0 0"),!1),emissive:convertStringToColor(getNodeAttribute(a,"emissiveColor","0 0 0"),!1),shininess:parseFloat(getNodeAttribute(a,"shininess","0.2")),transparent:"transparent"===getNodeAttribute(e,"sortType","auto")}:{color:o.color,specular:o.specular,emissive:o.emissive,shininess:o.shininess}}var n=e.getElementsByTagName("ImageTexture"),i;return 0<n.length&&(i=this.parseImageTexture(n[0],e.getElementsByTagName("TextureTransform")),"undefined"!=typeof i&&(r.map=i,i.userData.isTransparent&&(r.transparent=!0,r.alphaTest=.5))),t=new THREE.MeshPhongMaterial(r),t.userData.x3dType="Appearance",t.userData.hasTransparentTexture=i&&i.userData.isTransparent,"undefined"!=typeof a&&this._setCustomId(a,t),t}},{key:"parsePBRAppearance",value:function(e){var a=!1,r=convertStringToColor(getNodeAttribute(e,"baseColor","1 1 1")),o=2*parseFloat(getNodeAttribute(e,"roughness","0")),n=parseFloat(getNodeAttribute(e,"metalness","1")),i=convertStringToColor(getNodeAttribute(e,"emissiveColor","0 0 0")),s=parseFloat(getNodeAttribute(e,"transparency","0")),l={color:r,roughness:o,metalness:n,emissive:i};s&&(l.opacity=1-s,a=!0);for(var d=e.getElementsByTagName("TextureTransform"),p=e.getElementsByTagName("ImageTexture"),c=0;c<p.length;c++){var u=p[c],m=getNodeAttribute(u,"type",void 0);"baseColor"===m?(l.map=this.parseImageTexture(u,d),"undefined"!=typeof l.map&&l.map.userData.isTransparent&&(a=!0,l.alphaTest=.5)):"roughness"===m?(l.roughnessMap=this.parseImageTexture(u,d),0>=o&&(l.roughness=2)):"metalness"===m?l.metalnessMap=this.parseImageTexture(u,d):"normal"===m?l.normalMap=this.parseImageTexture(u,d):"emissiveColor"===m&&(l.emissiveMap=this.parseImageTexture(u,d),l.emissive=new THREE.Color(16777215))}var f=new THREE.MeshStandardMaterial(l);return f.userData.x3dType="PBRAppearance",a&&(f.transparent=!0),f.userData.hasTransparentTexture=l.map&&l.map.userData.isTransparent,f}},{key:"parseImageTexture",value:function(e,t){var a=this._getDefNode(e);if("undefined"!=typeof a)return a;var r=getNodeAttribute(e,"url","");if(r=r.split(/['"\s]/).filter(function(e){return e}),null!=r[0]){var o;if(t&&t[0]){var n=this._getDefNode(t[0]);o="undefined"==typeof n?{center:convertStringToVec2(getNodeAttribute(t[0],"center","0 0")),rotation:parseFloat(getNodeAttribute(t[0],"rotation","0")),scale:convertStringToVec2(getNodeAttribute(t[0],"scale","1 1")),translation:convertStringToVec2(getNodeAttribute(t[0],"translation","0 0"))}:n.userData.transform}return a=TextureLoader.createOrRetrieveTexture(r[0],new TextureData("true"===getNodeAttribute(e,"isTransparent","false").toLowerCase(),{s:getNodeAttribute(e,"repeatS","true").toLowerCase(),t:getNodeAttribute(e,"repeatT","true").toLowerCase()},o)),"undefined"!=typeof t&&this._setCustomId(t[0],a),this._setCustomId(e,a),a}}},{key:"parseIndexedFaceSet",value:function(e){var t=e.getElementsByTagName("Coordinate")[0],a=e.getElementsByTagName("TextureCoordinate")[0],r=e.getElementsByTagName("Normal")[0];"undefined"!=typeof t&&"USE"in t.attributes&&(console.error("X3DLoader:parseIndexedFaceSet: USE 'Coordinate' node not supported."),t=void 0),"undefined"!=typeof a&&"USE"in a.attributes&&(console.error("X3DLoader:parseIndexedFaceSet: USE 'TextureCoordinate' node not supported."),a=void 0),"undefined"!=typeof r&&"USE"in r.attributes&&(console.error("X3DLoader:parseIndexedFaceSet: USE 'Normal' node not supported."),r=void 0);var o=new THREE.Geometry,n=getNodeAttribute(e,"x3dType",void 0);if(o.userData={x3dType:"undefined"==typeof n?"IndexedFaceSet":n},"undefined"==typeof t)return o;for(var s=getNodeAttribute(e,"coordIndex","").split(/\s/),l=getNodeAttribute(t,"point","").split(/\s/),d=("texCoordIndex"in e.attributes),p=d?getNodeAttribute(e,"texCoordIndex",""):"",c=d?getNodeAttribute(a,"point",""):"",u=0,m;u<l.length;u+=3)m=new THREE.Vector3,m.x=parseFloat(l[u+0]),m.y=parseFloat(l[u+1]),m.z=parseFloat(l[u+2]),o.vertices.push(m);var f,g;if("undefined"!=typeof r){var h=getNodeAttribute(r,"vector","").split(/[\s,]+/);g=getNodeAttribute(e,"normalIndex","").split(/\s/),f=[];for(var y=0;y<h.length;y+=3)f.push(new THREE.Vector3(parseFloat(h[y+0]),parseFloat(h[y+1]),parseFloat(h[y+2])))}if(d)for(var x="true"===getNodeAttribute(e,"defaultMapping","false").toLowerCase(),b=c.split(/\s/),_=[],T=0;T<b.length;T+=2)m=new THREE.Vector2,m.x=parseFloat(b[T+0]),m.y=parseFloat(b[T+1]),x&&(m.x+=.01*Math.random(),m.y+=.01*Math.random()),_.push(m);if(d)var S=p.split(/\s/);for(var E=0;E<s.length;E++){for(var w=[],A=[],M=[];0<=parseFloat(s[E]);)w.push(parseFloat(s[E])),d&&A.push(parseFloat(S[E])),"undefined"!=typeof g&&M.push(parseFloat(g[E])),E++;for(var P;3<w.length;){if(d){o.faceVertexUvs[0].push([_[parseFloat(A[A.length-3])].clone(),_[parseFloat(A[A.length-2])].clone(),_[parseFloat(A[A.length-1])].clone()]);var L=A[A.length-1];A.pop(),A[A.length-1]=L}P=void 0,"undefined"!=typeof r&&(P=[f[M[w.length-3]],f[M[w.length-2]],f[M[w.length-1]]]),o.faces.push(new THREE.Face3(w[w.length-3],w[w.length-2],w[w.length-1],P)),L=w[w.length-1],w.pop(),w[w.length-1]=L}3===w.length&&(d&&o.faceVertexUvs[0].push([_[parseFloat(A[A.length-3])].clone(),_[parseFloat(A[A.length-2])].clone(),_[parseFloat(A[A.length-1])].clone()]),"undefined"!=typeof r&&(P=[f[M[w.length-3]],f[M[w.length-2]],f[M[w.length-1]]]),o.faces.push(new THREE.Face3(w[0],w[1],w[2],P)))}return o.computeBoundingSphere(),"undefined"==typeof r&&o.computeVertexNormals(),this._setCustomId(t,o),d&&this._setCustomId(a,o),o}},{key:"parseIndexedLineSet",value:function(e){var t=e.getElementsByTagName("Coordinate")[0];"undefined"!=typeof t&&"USE"in t.attributes&&(console.error("X3DLoader:parseIndexedLineSet: USE 'Coordinate' node not supported."),t=void 0);var a=new THREE.BufferGeometry;if(a.userData={x3dType:"IndexedLineSet"},"undefined"==typeof t)return a;for(var r=getNodeAttribute(e,"coordIndex","").trim().split(/\s/),o=getNodeAttribute(t,"point","").trim().split(/\s/),n=new Float32Array(3*o.length),s=0;s<o.length;s+=3)n[s]=parseFloat(o[s+0]),n[s+1]=parseFloat(o[s+1]),n[s+2]=parseFloat(o[s+2]);for(var l=[],d=0;d<r.length;d++)for(;0<=parseFloat(r[d]);)l.push(parseFloat(r[d])),d++;return a.setIndex(new THREE.BufferAttribute(new Uint16Array(l),1)),a.addAttribute("position",new THREE.BufferAttribute(n,3)),a.computeBoundingSphere(),this._setCustomId(t,a),a}},{key:"parseElevationGrid",value:function(e){var a=getNodeAttribute(e,"height",void 0),r=parseInt(getNodeAttribute(e,"xDimension","0")),o=parseFloat(getNodeAttribute(e,"xSpacing","1")),n=parseInt(getNodeAttribute(e,"zDimension","0")),s=parseFloat(getNodeAttribute(e,"zSpacing","1")),l=(r-1)*o,d=(n-1)*s,p=new THREE.PlaneBufferGeometry(l,d,r-1,n-1);if(p.userData={x3dType:"ElevationGrid"},p.rotateX(-t/2),p.translate(l/2,0,d/2),"undefined"==typeof a)return p;for(var c=a.trim().split(/\s/),u=p.getAttribute("position").array,m=p.getAttribute("uv").array,f=c.length,g=0,h=1,y=0;y<r;y++)for(var x=0,b;x<n;x++)b=r*y+x,b<f&&(u[g+1]=parseFloat(c[b])),m[h]=-m[h],g+=3,h+=2;return p.computeVertexNormals(),p}},{key:"parseBox",value:function(e){var t=convertStringToVec3(getNodeAttribute(e,"size","2 2 2")),a=new THREE.BoxBufferGeometry(t.x,t.y,t.z);return a.userData={x3dType:"Box"},a}},{key:"parseCone",value:function(e){var a=getNodeAttribute(e,"bottomRadius","1"),r=getNodeAttribute(e,"height","2"),o=getNodeAttribute(e,"subdivision","32"),n="true"===getNodeAttribute(e,"side","true").toLowerCase(),i="true"===getNodeAttribute(e,"bottom","true").toLowerCase(),s;if(n&&i)s=new THREE.ConeBufferGeometry(a,r,o,1,!1,t/2);else{if(s=new THREE.Geometry,n){var l=new THREE.ConeGeometry(a,r,o,1,!0,t/2);s.merge(l)}if(i){var d=new THREE.CircleGeometry(a,o),p=new THREE.Matrix4;p.makeRotationFromEuler(new THREE.Euler(t/2,0,t/2)),p.setPosition(new THREE.Vector3(0,-r/2,0)),s.merge(d,p)}}return s.userData={x3dType:"Cone"},s.rotateY(t/2),s}},{key:"parseCylinder",value:function(e){var a=getNodeAttribute(e,"radius","1"),r=getNodeAttribute(e,"height","2"),o=getNodeAttribute(e,"subdivision","32"),n="true"===getNodeAttribute(e,"bottom","true").toLowerCase(),i="true"===getNodeAttribute(e,"side","true").toLowerCase(),s="true"===getNodeAttribute(e,"top","true").toLowerCase(),l;if(n&&i&&s)l=new THREE.CylinderBufferGeometry(a,a,r,o,1,!1,t/2);else{if(l=new THREE.Geometry,i){var d=new THREE.CylinderGeometry(a,a,r,o,1,!0,t/2);l.merge(d)}if(s){var p=new THREE.CircleGeometry(a,o),c=new THREE.Matrix4;c.makeRotationFromEuler(new THREE.Euler(-t/2,0,-t/2)),c.setPosition(new THREE.Vector3(0,r/2,0)),l.merge(p,c)}if(n){var u=new THREE.CircleGeometry(a,o),m=new THREE.Matrix4;m.makeRotationFromEuler(new THREE.Euler(t/2,0,t/2)),m.setPosition(new THREE.Vector3(0,-r/2,0)),l.merge(u,m)}}return l.userData={x3dType:"Cylinder"},l.rotateY(t/2),l}},{key:"parseSphere",value:function(e){var a=getNodeAttribute(e,"radius","1"),r=getNodeAttribute(e,"subdivision","8,8").split(","),o="true"===getNodeAttribute(e,"ico","false").toLowerCase(),n;return o?(n=new THREE.IcosahedronBufferGeometry(a,r[0]),n.rotateY(t/2)):n=new THREE.SphereBufferGeometry(a,r[0],r[1],-t/2),n.userData={x3dType:"Sphere"},n}},{key:"parsePlane",value:function(e){var a=convertStringToVec2(getNodeAttribute(e,"size","1,1")),r=new THREE.PlaneBufferGeometry(a.x,a.y);return r.userData={x3dType:"Plane"},r.rotateX(-t/2),r}},{key:"parsePointSet",value:function(e){var t=e.getElementsByTagName("Coordinate")[0],r=new THREE.BufferGeometry;if(r.userData={x3dType:"PointSet"},"undefined"==typeof t)return r;var o=getNodeAttribute(t,"point","").trim().split(/\s/),n=e.getElementsByTagName("Color")[0],s=o.length,l;r.userData.isColorPerVertex=!1,"undefined"!=typeof n&&(l=getNodeAttribute(n,"color","").trim().split(/\s/),"undefined"!=typeof l&&(s!==l.length&&(s=a(s,l.length),console.error("X3DLoader:parsePointSet: 'coord' and 'color' fields size doesn't match.")),r.userData.isColorPerVertex=!0));for(var d=new Float32Array(s),p=0;p<s;p++)d[p]=parseFloat(o[p]);if(r.addAttribute("position",new THREE.BufferAttribute(d,3)),r.userData.isColorPerVertex){for(var c=new Float32Array(s),u=0;u<s;u++)c[u]=parseFloat(l[u]);r.addAttribute("color",new THREE.BufferAttribute(c,3))}return r.computeBoundingBox(),r}},{key:"parseDirectionalLight",value:function(e){var t="true"===getNodeAttribute(e,"on","true").toLowerCase();if(t){var a=convertStringToColor(getNodeAttribute(e,"color","1 1 1"),!1),r=convertStringToVec3(getNodeAttribute(e,"direction","0 0 -1")),o=parseFloat(getNodeAttribute(e,"intensity","1")),n="true"===getNodeAttribute(e,"castShadows","false").toLowerCase(),i=new THREE.DirectionalLight(a.getHex(),o);if(n){i.castShadow=!0;var s=parseFloat(getNodeAttribute(e,"shadowMapSize","1024"));i.shadow.mapSize.width=s,i.shadow.mapSize.height=s,i.shadow.radius=parseFloat(getNodeAttribute(e,"shadowsRadius","1.5")),i.shadow.bias=parseFloat(getNodeAttribute(e,"shadowBias","0.000001")),i.shadow.camera.near=parseFloat(getNodeAttribute(e,"zNear","0.001;")),i.shadow.camera.far=parseFloat(getNodeAttribute(e,"zFar","2000"))}return i.position.set(-r.x,-r.y,-r.z),i.userData={x3dType:"DirectionalLight"},this.directionalLights.push(i),i}}},{key:"parsePointLight",value:function(e){var t="true"===getNodeAttribute(e,"on","true").toLowerCase();if(t){var a=convertStringToVec3(getNodeAttribute(e,"attenuation","1 0 0")),r=convertStringToColor(getNodeAttribute(e,"color","1 1 1"),!1),o=parseFloat(getNodeAttribute(e,"intensity","1")),n=convertStringToVec3(getNodeAttribute(e,"location","0 0 0")),i=parseFloat(getNodeAttribute(e,"radius","100")),s="true"===getNodeAttribute(e,"castShadows","false").toLowerCase(),l=new THREE.PointLight(r.getHex());if(l.intensity=o/a.manhattanLength(),0<a.x&&(l.decay=0),0<a.y&&(l.decay=1),0<a.z&&(l.decay=2),l.distance=i,s){l.castShadow=!0;var d=parseFloat(getNodeAttribute(e,"shadowMapSize","512"));l.shadow.mapSize.width=d,l.shadow.mapSize.height=d,l.shadow.radius=parseFloat(getNodeAttribute(e,"shadowsRadius","1")),l.shadow.bias=parseFloat(getNodeAttribute(e,"shadowBias","0")),l.shadow.camera.near=parseFloat(getNodeAttribute(e,"zNear","0.001;")),l.shadow.camera.far=i}return l.position.copy(n),l.userData={x3dType:"PointLight"},l}}},{key:"parseSpotLight",value:function(e,t){var a="true"===getNodeAttribute(e,"on","true").toLowerCase();if(a){var r=convertStringToVec3(getNodeAttribute(e,"attenuation","1 0 0")),o=parseFloat(getNodeAttribute(e,"beamWidth","0.785")),n=convertStringToColor(getNodeAttribute(e,"color","1 1 1"),!1),i=parseFloat(getNodeAttribute(e,"cutOffAngle","0.785")),s=convertStringToVec3(getNodeAttribute(e,"direction","0 0 -1")),l=parseFloat(getNodeAttribute(e,"intensity","1")),d=convertStringToVec3(getNodeAttribute(e,"location","0 0 0")),p=parseFloat(getNodeAttribute(e,"radius","100")),c="true"===getNodeAttribute(e,"castShadows","false").toLowerCase(),u=new THREE.SpotLight(n.getHex());if(u.intensity=l/r.manhattanLength(),0<r.x&&(u.decay=0),0<r.y&&(u.decay=1),0<r.z&&(u.decay=2),u.distance=p,u.angle=i,u.penumbra=o>i?0:1-o/i,c){u.castShadow=!0;var m=parseFloat(getNodeAttribute(e,"shadowMapSize","512"));u.shadow.mapSize.width=m,u.shadow.mapSize.height=m,u.shadow.radius=parseFloat(getNodeAttribute(e,"shadowsRadius","1")),u.shadow.bias=parseFloat(getNodeAttribute(e,"shadowBias","0")),u.shadow.camera.near=parseFloat(getNodeAttribute(e,"zNear","0.001;")),u.shadow.camera.far=p}return u.position.copy(d),u.target=new THREE.Object3D,u.target.position.addVectors(u.position,s),u.target.userData.x3dType="LightTarget",t.push(u.target),u.userData={x3dType:"SpotLight"},u}}},{key:"parseBackground",value:function(e){var t=this,a=convertStringToColor(getNodeAttribute(e,"skyColor","0 0 0"));this.scene.scene.background=a;var r=getNodeAttribute(e,"hdrUrl",void 0),o=!1,n="undefined"!=typeof r;if(n)TextureLoader.loadOrRetrieveImage(r,void 0,void 0,function(e){t.scene.applyEquirectangularBackground(e)}),o=!0;else{for(var s=["leftUrl","rightUrl","topUrl","bottomUrl","backUrl","frontUrl"],l=[],d=0,p;6>d;d++)p=getNodeAttribute(e,s[d],void 0),"undefined"!=typeof p&&(o=!0,p=p.split(/['"\s]/).filter(function(e){return e})[0]),l.push(p);if(o){for(var c=new THREE.CubeTexture,u=0,m=0;6>m;m++)if("undefined"!=typeof l[m]){u++;var f=TextureLoader.loadOrRetrieveImage(l[m],c,m);"undefined"!=typeof f&&(c.images[m]=f,u--)}this.scene.scene.background=c,0===u&&(c.needsUpdate=!0)}}if(o){var g=new THREE.AmbientLight(n?3355443:16777215);this.scene.scene.add(g)}}},{key:"parseViewpoint",value:function(e){var t=parseFloat(getNodeAttribute(e,"fieldOfView","0.785")),a=parseFloat(getNodeAttribute(e,"zNear","0.1")),r=parseFloat(getNodeAttribute(e,"zFar","2000"));if("undefined"==typeof this.scene.viewpoint?(console.log("Parse Viewpoint: error camera"),this.scene.viewpoint.camera=new THREE.PerspectiveCamera(.785,1,a,r)):(this.scene.viewpoint.camera.near=a,this.scene.viewpoint.camera.far=r),this.scene.viewpoint.camera.fovX=t,this.scene.viewpoint.camera.fov=THREE.Math.radToDeg(horizontalToVerticalFieldOfView(t,this.scene.viewpoint.camera.aspect)),"position"in e.attributes){var o=getNodeAttribute(e,"position","0 0 10");this.scene.viewpoint.camera.position.copy(convertStringToVec3(o))}if("orientation"in e.attributes){var n=convertStringToQuaternion(getNodeAttribute(e,"orientation","0 1 0 0"));this.scene.viewpoint.camera.quaternion.copy(n)}return this.scene.viewpoint.camera.updateProjectionMatrix(),this.scene.viewpoint.camera.userData.x3dType="Viewpoint",this.scene.viewpoint.camera.userData.followedId=getNodeAttribute(e,"followedId",null),this.scene.viewpoint.camera.userData.followSmoothness=getNodeAttribute(e,"followSmoothness",null),void(this.scene.viewpoint.camera.userData.exposure=parseFloat(getNodeAttribute(e,"exposure","1.0")))}},{key:"parseWorldInfo",value:function(e){this.scene.worldInfo.title=getNodeAttribute(e,"title",""),this.scene.worldInfo.window=getNodeAttribute(e,"window","")}},{key:"parseFog",value:function(e){var t=convertStringToColor(getNodeAttribute(e,"color","1 1 1"),!1).getHex(),a=parseFloat(getNodeAttribute(e,"visibilityRange","0")),r=null,o=getNodeAttribute(e,"fogType","LINEAR");return r="LINEAR"===o?new THREE.Fog(t,.001,a):new THREE.FogExp2(t,1/a),void(this.scene.scene.fog=r)}},{key:"_setCustomId",value:function(e,t,a){if(e&&t){var r=getNodeAttribute(e,"id",void 0);"undefined"!=typeof r&&(t.name=""===t.name?r+"":t.name+";"+(r+""),a&&("undefined"==typeof a.userData.USE?a.userData.USE=r+"":a.userData.USE=a.userData.USE+";"+(r+"")))}}},{key:"_getDefNode",value:function(e){var t=getNodeAttribute(e,"USE",void 0);if("undefined"!=typeof t){var a=this.scene.getObjectById(t,!1,this.parsedObjects);return"undefined"==typeof a?(a=this.scene.getObjectById(t,!1,this.scene.root),"undefined"==typeof a&&console.error("X3dLoader: no matching DEF node \""+t+"\" node."),a):a}}}]),e}();function getNodeAttribute(e,t,a){return console.assert(e&&e.attributes),t in e.attributes?e.attributes.getNamedItem(t).value:a}function createDefaultGeometry(){var e=new THREE.Geometry;return e.userData={x3dType:"unknown"},e}function createDefaultMaterial(e){var t;return t="undefined"!=typeof e&&"PointSet"===e.userData.x3dType&&e.userData.isColorPerVertex?new THREE.PointsMaterial({size:4,sizeAttenuation:!1,vertexColors:THREE.VertexColors}):new THREE.MeshBasicMaterial({color:16777215}),t}function convertStringToVec2(e){e=e.split(/\s/);var t=new THREE.Vector2(parseFloat(e[0]),parseFloat(e[1]));return t}function convertStringToVec3(e){e=e.split(/\s/);var t=new THREE.Vector3(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));return t}function convertStringToQuaternion(e){var t=e.split(/\s/),a=new THREE.Quaternion;return a.setFromAxisAngle(new THREE.Vector3(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2])),parseFloat(t[3])),a}function convertStringToColor(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],a=convertStringToVec3(e),r=new THREE.Color(a.x,a.y,a.z);return t&&r.convertSRGBToLinear(),r}function horizontalToVerticalFieldOfView(e,t){return 1>t?e:2*Math.atan(Math.tan(.5*e)/t)}THREE.X3DLoader.textures={},"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var X3dScene=function(){var t=Math.max;function e(t){_classCallCheck(this,e),this.domElement=t,this.root=void 0,this.worldInfo={},this.viewpoint=void 0,this.sceneModified=!1,this.useNodeCache={},this.objectsIdCache={}}return _createClass(e,[{key:"init",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.renderer=new THREE.WebGLRenderer({antialias:!1}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(16777215,1),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,this.renderer.gammaInput=!1,this.renderer.gammaOutput=!1,this.renderer.physicallyCorrectLights=!0,this.domElement.appendChild(this.renderer.domElement),this.scene=new THREE.Scene,this.renderAllAtLoad=!1,this.viewpoint=new Viewpoint,this.viewpoint.onCameraParametersChanged=function(t){e.gpuPicker&&(e.gpuPicker.needUpdate=!0),t&&e.render()},this.selector=new Selector,this.selector.onSelectionChange=function(){e.render()},this.gpuPicker=new THREE.GPUPicker({renderer:this.renderer,debug:!1}),this.gpuPicker.setFilter(function(e){return e.isMesh&&"x3dType"in e.userData&&!1!==e.userData.isPickable}),this.gpuPicker.setScene(this.scene),this.gpuPicker.setCamera(this.viewpoint.camera),this.composer=new THREE.EffectComposer(this.renderer);var a=new THREE.RenderPass(this.scene,this.viewpoint.camera);this.composer.addPass(a),this.hdrResolvePass=new THREE.ShaderPass(THREE.HDRResolveShader),this.composer.addPass(this.hdrResolvePass);var r=new THREE.ShaderPass(THREE.FXAAShader);this.composer.addPass(r),this.resize(),this.destroyWorld(),TextureLoader.setTexturePathPrefix(t),TextureLoader.setOnTextureLoad(function(){e.renderAllAtLoad&&!TextureLoader.hasPendingData()&&(e.renderAllAtLoad=!1,e.scene.traverse(function(e){e.frustumCulled=!0})),e.render()})}},{key:"render",value:function(){this.hdrResolvePass.material.uniforms.exposure.value=2*this.viewpoint.camera.userData.exposure,"function"==typeof this.preRender&&this.preRender(this.scene,this.viewpoint.camera),this.composer.render(),"function"==typeof this.postRender&&this.postRender(this.scene,this.viewpoint.camera)}},{key:"resize",value:function(){var e=this.domElement.clientWidth,t=this.domElement.clientHeight;this.viewpoint.camera.aspect=e/t,this.viewpoint.camera.fovX&&(this.viewpoint.camera.fov=THREE.Math.radToDeg(horizontalToVerticalFieldOfView(this.viewpoint.camera.fovX,this.viewpoint.camera.aspect))),this.viewpoint.camera.updateProjectionMatrix(),this.gpuPicker.resizeTexture(e,t),this.renderer.setSize(e,t),this.composer.setSize(e,t),this.render()}},{key:"onSceneUpdate",value:function(){this.sceneModified=!0,this.render()}},{key:"destroyWorld",value:function(){if(this.selector.clearSelection(),!!this.scene){for(var e=this.scene.children.length-1;0<=e;e--)this.scene.remove(this.scene.children[e]);this.objectsIdCache={},this.useNodeCache={},this.root=void 0,this.scene.background=new THREE.Color(0,0,0),this.onSceneUpdate(),this.render()}}},{key:"deleteObject",value:function(e){var t={},a=this.getObjectById("n"+e,!1,"scene",t);if("undefined"!=typeof a){var r;"undefined"==typeof t.field?(r=a.parent,a.parent.remove(a)):(r=t.parent,r[t.field]=a.isMaterial?createDefaultMaterial(r.geometry):a.isGeometry||a.isBufferGeometry?createDefaultGeometry():void 0),delete this.objectsIdCache[e],"undefined"!=typeof r&&this._updateUseNodesIfNeeded(r,r.name.split(";"))}a===this.root&&(this.root=void 0),this.onSceneUpdate(),this.render()}},{key:"loadWorldFile",value:function(e,t){var a=this;this.objectsIdCache={};var r=new THREE.X3DLoader(this);r.load(e,function(e){0<e.length&&(a.scene.add(e[0]),a.root=e[0]),a._setupLights(r.directionalLights),a._setupEnvironmentMap(),a.gpuPicker&&(a.gpuPicker.setScene(a.scene),a.sceneModified=!1),a.scene.traverse(function(e){e.frustumCulled=!1}),a.renderAllAtLoad=!0,a.onSceneUpdate(),"function"==typeof t&&t()})}},{key:"loadObject",value:function(e,t){var a=this,r;t&&0!==t&&(r=this.getObjectById("n"+t));var o=new THREE.X3DLoader(this),n=o.parse(e);"undefined"==typeof r?(console.assert(1>=n.length&&"undefined"==typeof this.root),n.forEach(function(e){a.scene.add(e)}),this.root=n[0]):(n.forEach(function(e){r.add(e)}),this._updateUseNodesIfNeeded(r,r.name.split(";"))),this._setupLights(o.directionalLights),this._setupEnvironmentMap(),"undefined"==typeof r&&(this.scene.traverse(function(e){e.frustumCulled=!1}),this.renderAllAtLoad=!0),this.onSceneUpdate()}},{key:"applyPose",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],a=e.id,r=t;for(var o in e)if("id"!=o&&-1===r.indexOf(o)){var n=e[o],i=this.getObjectById("n"+a,!0);if("undefined"!=typeof i){var s=!0;if("translation"===o){if(i.isTexture){var l=convertStringToVec2(n);i.userData&&i.userData.transform&&(i.userData.transform.translation=l,i.needsUpdate=!0,this.sceneModified=!0)}else if(i.isObject3D){var d=convertStringToVec3(n);this.viewpoint.followedObjectId&&(a===this.viewpoint.followedObjectId||"n"+a===this.viewpoint.followedObjectId||i.userData.name===this.viewpoint.followedObjectId)&&this.viewpoint.setFollowedObjectDeltaPosition(d,i.position),i.position.copy(d),this.sceneModified=!0}}else if("rotation"===o&&i.isObject3D){var p=convertStringToQuaternion(n);i.quaternion.copy(p),this.sceneModified=!0}else i.isMaterial?"baseColor"===o?i.color=convertStringToColor(n):"diffuseColor"===o?i.color=convertStringToColor(n,!1):"emissiveColor"===o&&(i.emissive=convertStringToColor(n,"PBRAppearance"===i.userData.x3dType)):"render"===o&&i.isObject3D?i.visible="true"===n.toLowerCase():s=!1;s&&r.push(o),this._updateUseNodesIfNeeded(i,a)}}return r}},{key:"pick",value:function(e,t){this.sceneModified&&(this.gpuPicker.setScene(this.scene),this.sceneModified=!1);var a=new THREE.Raycaster;return a.setFromCamera(t,this.viewpoint.camera),this.gpuPicker.pick(e,a)}},{key:"getCamera",value:function(){return this.viewpoint.camera}},{key:"getTopX3dNode",value:function(e){for(var t;e&&(e.userData&&e.userData.solid&&(t=e),e.parent!==this.scene);)e=e.parent;return"undefined"==typeof t?e:t}},{key:"getObjectById",value:function(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"scene",r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};if("scene"===a&&(a=this.scene),!a||t&&"undefined"!=typeof a.userData&&"Switch"===a.userData.x3dType)return void(r.parent=void 0);if(Array.isArray(a))for(var n=0,s=a.length,l;n<s;n++)if(l=this.getObjectById(e,t,a[n],r),"undefined"!=typeof l)return l;if("undefined"!=typeof this.objectsIdCache[e])return r.field=this.objectsIdCache[e].context.field,r.parent=this.objectsIdCache[e].context.parent,this.objectsIdCache[e].object;if(a.name&&a.name.includes(e))return this.objectsIdCache[e]={object:a,context:r},a;var d;if(a.children)for(var p in a.children)if(r.parent=a,d=this.getObjectById(e,t,a.children[p],r),"undefined"!=typeof d)return d;if(a.isMesh||a.isLineSegments||a.isPoint){if(a.material&&(d=this.getObjectById(e,t,a.material,r),"undefined"!=typeof d))return r.field="material",r.parent=a,d;if(a.geometry&&(d=this.getObjectById(e,t,a.geometry,r),"undefined"!=typeof d))return r.field="geometry",r.parent=a,d}else if(a.isMaterial){if(a.map&&(d=this.getObjectById(e,t,a.map,r),"undefined"!=typeof d))return r.field="map",r.parent=a,d;if(a.aoMap&&(d=this.getObjectById(e,t,a.aoMap,r),"undefined"!=typeof d))return r.field="aoMap",r.parent=a,d;if(a.roughnessMap&&(d=this.getObjectById(e,t,a.roughnessMap,r),"undefined"!=typeof d))return r.field="roughnessMap",r.parent=a,d;if(a.metalnessMap&&(d=this.getObjectById(e,t,a.metalnessMap,r),"undefined"!=typeof d))return r.field="metalnessMap",r.parent=a,d;if(a.normalMap&&(d=this.getObjectById(e,t,a.normalMap,r),"undefined"!=typeof d))return r.field="normalMap",r.parent=a,d;if(a.emissiveMap&&(d=this.getObjectById(e,t,a.emissiveMap,r),"undefined"!=typeof d))return r.field="emissiveMap",r.parent=a,d}}},{key:"applyEquirectangularBackground",value:function(e){var t;e.data?(t=new THREE.DataTexture(e.data,e.width,e.height),t.encoding=THREE.RGBEEncoding,t.minFilter=THREE.NearestFilter,t.magFilter=THREE.NearestFilter,t.flipY=!0):(t=new THREE.Texture(e),t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter),t.needsUpdate=!0;var a=new THREE.EquirectangularToCubeGenerator(t,{resolution:e.width});this.scene.background=a.renderTarget;var r=a.update(this.renderer),o=new THREE.PMREMGenerator(r);o.update(this.renderer);var n=new THREE.PMREMCubeUVPacker(o.cubeLods);n.update(this.renderer),this.scene.background.userData={},this.scene.background.userData.isHDR=!0,this.scene.background.userData.texture=n.CubeUVRenderTarget.texture,this._setupEnvironmentMap(),t.dispose(),o.dispose(),n.dispose()}},{key:"_setupLights",value:function(e){if(this.root){var a=new THREE.Box3;a.setFromObject(this.root);var r=new THREE.Vector3;a.getSize(r);var o=new THREE.Vector3;a.getCenter(o);var n=r.x/2+o.x,i=r.z/2+o.z,s=2*t(n,r.y/2+o.y,i);e.forEach(function(e){e.position.multiplyScalar(s),e.shadow.camera.far=t(s,e.shadow.camera.far),e.shadow.camera.left=-s,e.shadow.camera.right=s,e.shadow.camera.top=s,e.shadow.camera.bottom=-s})}}},{key:"_setupEnvironmentMap",value:function(){var e=!1,t;if(this.scene.background)if("undefined"!=typeof this.scene.background.userData&&this.scene.background.userData.isHDR)e=!0,t=this.scene.background.userData.texture;else if(this.scene.background.isCubeTexture)t=this.scene.background;else if(this.scene.background.isColor){var a=this.scene.background.clone();a.convertLinearToSRGB(),t=TextureLoader.createColoredCubeTexture(a)}this.scene.traverse(function(a){if(a.isMesh&&a.material&&a.material.isMeshStandardMaterial){var r=a.material;r.envMap=t,e&&(r.envMapIntensity=.2),r.needsUpdate=!0}})}},{key:"_updateUseNodesIfNeeded",value:function(e,t){var a=this;if(e){if(Array.isArray(t)&&(1<t.length?t.forEach(function(t){return a._updateUseNodesIfNeeded(e,t)}):t=t[0]),"undefined"==typeof this.useNodeCache[t]){for(var r=e,o;r&&r!==this.root;)"undefined"!=typeof r.userData.USE&&(o=r),r=r.parent;this.useNodeCache[t]={source:o},"undefined"!=typeof o&&(this.useNodeCache[t].target=[],o.userData.USE.split(";").forEach(function(e){var r=a.getObjectById(e);"undefined"!=typeof r&&a.useNodeCache[t].target.push(r)}))}if("undefined"!=typeof this.useNodeCache[t].source){for(var n=this.useNodeCache[t].source,s=this.useNodeCache[t].target,d=[],p=0,c=s.length;p<c;p++){var l=s[p],u=n.clone();u.name=l.name;var m=l.parent,f=m.children.indexOf(l);m.remove(l),m.children.splice(f,0,u),u.parent=m,e.dispatchEvent({type:"added"}),d.push(u)}this.useNodeCache[t].target=d}}}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var Animation=function(){var t=Math.min,a=Math.floor;function e(t,a,r,o,n){_classCallCheck(this,e),this.url=t,this.scene=a,this.view=r,this.gui="undefined"==typeof o||"play"===o?"real_time":"pause",this.loop="undefined"==typeof n||n,this.sliding=!1,this.onReady=null}return _createClass(e,[{key:"init",value:function(e){var t=this;this.onReady=e;var a=new XMLHttpRequest;a.open("GET",this.url,!0),a.overrideMimeType("application/json"),a.onreadystatechange=function(){4===a.readyState&&200===a.status&&t._setup(JSON.parse(a.responseText))},a.send()}},{key:"getStatus",value:function(){return"real_time"===this.gui?"play":"pause"}},{key:"_setup",value:function(e){var t=this;this.data=e,this.allIds=this.data.ids.split(";").filter(Boolean).map(function(e){return parseInt(e)}),"real_time"===this.gui&&TextureLoader.hasPendingData()&&(this.gui="play_on_load");var a=document.createElement("div");a.id="playBar",this.view.view3D.appendChild(a),this.button=document.createElement("button"),this.button.id="playPauseButton";var r="real_time"===this.gui?"pause":"real_time";this.button.style.backgroundImage="url("+DefaultUrl.wwiImagesUrl()+r+".png)",this.button.style.padding="0",this.button.addEventListener("click",function(){t._triggerPlayPauseButton()}),a.appendChild(this.button);var o=document.createElement("div");o.id="playSlider",a.appendChild(o),this.playSlider=$("#playSlider").slider(),this._connectSliderEvents(),this.start=new Date().getTime(),this.step=0,this.previousStep=0,this._updateAnimation(),"function"==typeof this.onReady&&this.onReady()}},{key:"_elapsedTime",value:function(){var e=new Date().getTime();return e-this.start}},{key:"_triggerPlayPauseButton",value:function(){var e=this;this.button.style.backgroundImage="url("+DefaultUrl.wwiImagesUrl()+this._getIconBaseName(this.gui)+".png)","real_time"===this.gui?(this.gui="pause",0>this.step||this.step>=this.data.frames.length?(this.start=new Date().getTime(),this._updateAnimationState()):this.start=new Date().getTime()-this.data.basicTimeStep*this.step):(this.gui="real_time",this.start=new Date().getTime()-this.data.basicTimeStep*this.step,window.requestAnimationFrame(function(){e._updateAnimation()}))}},{key:"_connectSliderEvents",value:function(){var t=this;this.playSlider=this.playSlider.slider({change:function(a,e){t._updateSlider(e.value),t._updateAnimation()},slide:function(a,e){t._updateSlider(e.value)},start:function(){t.sliding=!0},stop:function(){t.sliding=!1}})}},{key:"_disconnectSliderEvents",value:function(){this.playSlider.slider({change:null,slide:null})}},{key:"_updateSlider",value:function(e){var r=t(e,99),o=a(this.data.frames.length*r/100);this.start=new Date().getTime()-a(this.data.basicTimeStep*this.step),this._updateAnimationState(o)}},{key:"_updateAnimationState",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,t="undefined"==typeof e;if(t&&(e=a(this._elapsedTime()/this.data.basicTimeStep),0>e||e>=this.data.frames.length)){if(!this.loop)return"real_time"===this.gui?void this._triggerPlayPauseButton():void 0;if(e>this.data.frames.length)e=0,this.previousStep=0,this.start=new Date().getTime();else return}if(e!==this.step){this.step=e;var r=[],o;if(this.data.frames[this.step].hasOwnProperty("poses")){var n=this.data.frames[this.step].poses;for(o=0;o<n.length;o++)r[n[o].id]=this.scene.applyPose(n[o])}var s=this.view.x3dScene;if(this.step!==this.previousStep+1){var l;for(var d in l=this.step>this.previousStep?this.previousStep:0,this.allIds)for(var i=this.allIds[d],c=r[i],u=this.step-1;u>=l;u--)if(this.data.frames[u].poses)for(o=0;o<this.data.frames[u].poses.length;o++)this.data.frames[u].poses[o].id===i&&(c=s.applyPose(this.data.frames[u].poses[o],c))}t&&(this._disconnectSliderEvents(),this.playSlider.slider("option","value",100*this.step/this.data.frames.length),this._connectSliderEvents()),this.previousStep=this.step,this.view.time=this.data.frames[this.step].time,s.viewpoint.updateViewpointPosition(!t|0===this.step,this.view.time),s.viewpoint.notifyCameraParametersChanged()}}},{key:"_updateAnimation",value:function(){var e=this;"real_time"!==this.gui||this.sliding?"play_on_load"===this.gui&&(!TextureLoader.hasPendingData()&&this._triggerPlayPauseButton(),window.requestAnimationFrame(function(){e._updateAnimation()})):(this._updateAnimationState(),window.requestAnimationFrame(function(){e._updateAnimation()}))}},{key:"_getIconBaseName",value:function(){return"real_time"===this.gui?"real_time":"pause"}}]),e}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0,r;a<t.length;a++)r=t[a],r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}webots.View=function(){function View(e,t){var a=this;_classCallCheck(this,View),webots.currentView=this,this.onerror=function(e){console.log("%c"+e,"color:black"),a.onrobotwindowsdestroy()},this.onstdout=function(e){console.log("%c"+e,"color:blue")},this.onstderr=function(e){console.log("%c"+e,"color:red")},this.onrobotmessage=function(e,t){return"undefined"==typeof a.robotWindowNames[e]?void console.log("Robot '"+e+"' has no associated robot window"):void a.robotWindows[a.robotWindowNames[e]].receive(t,e)},this.onrobotwindowsdestroy=function(){for(var e in a.robotWindowsGeometries={},a.robotWindows)a.robotWindowsGeometries[e]=a.robotWindows[e].geometry(),a.robotWindows[e].destroy();a.infoWindow=void 0,a.robotWindows={},a.robotWindowNames={}},this.onquit=function(){var e=window.location.href,t=e.substring(0,e.lastIndexOf("/",e.length-2)+1);window.location=t},this.onresize=function(){return a.x3dScene?null===a.x3dScene.root?void setTimeout(a.onresize,0):void a.x3dScene.resize():void 0},this.ondialogwindow=function(e){e&&"undefined"==typeof a.isAutomaticallyPaused?(a.isAutomaticallyPaused=a.toolBar&&a.toolBar.pauseButton&&"inline"===a.toolBar.pauseButton.style.display,a.toolBar.pauseButton.click()):!e&&a.isAutomaticallyPaused&&(a.toolBar.real_timeButton.click(),a.isAutomaticallyPaused=void 0)},window.onresize=this.onresize,this.robotWindowNames={},this.robotWindows={},this.view3D=e,this.view3D.className=e.className+" webotsView",this.mobileDevice="undefined"==typeof t?SystemInfo.isMobileDevice():t,this.fullscreenEnabled=!SystemInfo.isIOS(),this.fullscreenEnabled||$("head").append("<meta name=\"apple-mobile-web-app-capable\" content=\"yes\">");var r=/INPUT|SELECT|TEXTAREA/i;$(document).bind("keydown keypress",function(t){8===t.which&&(!r.test(t.target.tagName)||t.target.disabled||t.target.readOnly)&&t.preventDefault()}),this.debug=!1,this.timeout=60000,this.time=void 0,this.deadline=this.timeout,this.runOnLoad=!1,this.quitting=!1}return _createClass(View,[{key:"setTimeout",value:function(e){return 0>e?(this.timeout=e,void(this.deadline=0)):void(this.timeout=1e3*e,this.deadline=this.timeout,"undefined"!=typeof this.time&&(this.deadline+=this.time))}},{key:"setWebotsDocUrl",value:function(e){webots.webotsDocUrl=e}},{key:"setAnimation",value:function(e,t,a){"undefined"==typeof t&&(t="play"),"undefined"==typeof a&&(a=!0),this.animation=new Animation(e,this.x3dScene,this,t,a)}},{key:"open",value:function(url,mode){var _this2=this,texturePathPrefix=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";this.url=url,"undefined"==typeof mode&&(mode="x3d"),this.mode=mode;var initWorld=function(){if(!_this2.isWebSocketProtocol)_this2.x3dScene.loadWorldFile(_this2.url,finalizeWorld);else if(_this2.progress=document.createElement("div"),_this2.progress.id="webotsProgress",_this2.progress.innerHTML="<div><img src='"+DefaultUrl.wwiImagesUrl()+"load_animation.gif'></div><div id='webotsProgressMessage'>Initializing...</div></div><div id='webotsProgressPercent'></div>",_this2.view3D.appendChild(_this2.progress),"undefined"==typeof _this2.toolBar&&(_this2.toolBar=new Toolbar(_this2.view3D,_this2)),_this2.url.endsWith(".wbt")){var e;e="video"===_this2.mode?_this2.video.finalize:finalizeWorld,_this2.server=new Server(_this2.url,_this2,e),_this2.server.connect()}else{var t=_this2.url.replace(/ws/,"http");_this2.stream=new Stream(_this2.url,_this2,finalizeWorld),TextureLoader.setTexturePathPrefix(t+"/"),_this2.stream.connect()}},finalizeWorld=function(){if($("#webotsProgressMessage").html("Loading HTML and Javascript files..."),null==_this2.x3dScene.viewpoint.followedObjectId||_this2.broadcast?_this2.x3dScene.viewpoint.initFollowParameters():_this2.x3dScene.viewpoint.follow(_this2.x3dScene.viewpoint.followedObjectId),!_this2.isWebSocketProtocol)return null==_this2.animation?loadFinalize():_this2.animation.init(loadFinalize),void _this2.onresize();var loadRobotWindow=function(windowName,nodeName){function closeInfoWindow(){$("#infoButton").removeClass("toolBarButtonActive")}_this2.robotWindowNames[nodeName]=windowName;var win=new RobotWindow(_this2.view3D,_this2.mobileDevice,windowName);if(_this2.robotWindows[windowName]=win,windowName===infoWindowName){var user;"undefined"!=typeof webots.User1Id&&""!==webots.User1Id?(user=" ["+webots.User1Name,"undefined"!=typeof webots.User2Id&&""!==webots.User2Id&&(user+="/"+webots.User2Name),user+="]"):user="",win.setProperties({title:_this2.x3dScene.worldInfo.title+user,close:closeInfoWindow}),_this2.infoWindow=win}else win.setProperties({title:"Robot: "+nodeName});pendingRequestsCount++,$.get("window/"+windowName+"/"+windowName+".html",function(data){var d=data.replace(/ src='/g," src='window/"+windowName+"/").replace(/ src="/g," src=\"window/"+windowName+"/");win.setContent(d),MathJax.Hub.Queue(["Typeset",MathJax.Hub,win[0]]),$.get("window/"+windowName+"/"+windowName+".js",function(data){eval(data),pendingRequestsCount--,0===pendingRequestsCount&&loadFinalize()}).fail(function(){pendingRequestsCount--,0===pendingRequestsCount&&loadFinalize()})}).fail(function(){windowName===infoWindowName&&(_this2.infoWindow=void 0),pendingRequestsCount--,0===pendingRequestsCount&&loadFinalize()})},infoWindowName=_this2.x3dScene.worldInfo.window,pendingRequestsCount=1,nodes=_this2.x3dScene.root?_this2.x3dScene.root.children:[];nodes.forEach(function(e){e.isObject3D&&e.userData&&e.userData.window&&e.userData.name&&loadRobotWindow(e.userData.window,e.userData.name)}),pendingRequestsCount--,0===pendingRequestsCount&&loadFinalize()},loadFinalize=function(){if($("#webotsProgress").hide(),_this2.toolBar&&_this2.toolBar.enableToolBarButtons(!0),"function"==typeof _this2.onready&&_this2.onready(),_this2.robotWindowsGeometries)for(var e in _this2.robotWindows)e in _this2.robotWindowsGeometries&&(_this2.robotWindows[e].restoreGeometry(_this2.robotWindowsGeometries[e]),_this2.robotWindowsGeometries[e].open&&(_this2.robotWindows[e]===_this2.infoWindow?_this2.toolBar.toggleInfo():_this2.robotWindows[e].open()));else _this2.infoWindow&&!_this2.broadcast&&_this2.toolBar.toggleInfo();_this2.runOnLoad&&_this2.toolBar&&_this2.toolBar.realTime()};if("video"===mode)return this.url=url,this.video=new Video(this.view3D,this.mouseEvents),void initWorld();if("x3d"!==mode)return void console.log("Error: webots.View.open: wrong mode argument: "+mode);if(this.broadcast&&this.setTimeout(-1),this.isWebSocketProtocol=this.url.startsWith("ws://")||this.url.startsWith("wss://"),"undefined"==typeof this.x3dScene){this.x3dDiv=document.createElement("div"),this.x3dDiv.className="webots3DView",this.view3D.appendChild(this.x3dDiv),this.x3dScene=new X3dScene(this.x3dDiv),this.x3dScene.init(texturePathPrefix);var param=document.createElement("param");param.name="showProgress",param.value=!1,this.x3dScene.domElement.appendChild(param)}if("undefined"==typeof this.contextMenu&&this.isWebSocketProtocol){var authenticatedUser=!this.broadcast;authenticatedUser&&"undefined"!=typeof webots.User1Id&&""!==webots.User1Id&&(authenticatedUser=!!webots.User1Authentication),this.contextMenu=new ContextMenu(authenticatedUser,this.view3D),this.contextMenu.onEditController=function(e){_this2.editController(e)},this.contextMenu.onFollowObject=function(e){_this2.x3dScene.viewpoint.follow(e)},this.contextMenu.isFollowedObject=function(e,t){t(_this2.x3dScene.viewpoint.isFollowedObject(e))},this.contextMenu.onOpenRobotWindow=function(e){_this2.openRobotWindow(e)},this.contextMenu.isRobotWindowValid=function(e,t){t(_this2.robotWindows[_this2.robotWindowNames[e]])}}"undefined"==typeof this.mouseEvents&&(this.mouseEvents=new MouseEvents(this.x3dScene,this.contextMenu,this.x3dDiv,this.mobileDevice)),"undefined"==typeof this.console&&(this.console=new Console(this.view3D,this.mobileDevice)),"undefined"==typeof this.editor&&(this.editor=new Editor(this.view3D,this.mobileDevice,this)),initWorld()}},{key:"close",value:function(){this.server&&this.server.socket.close(),this.stream&&this.stream.close()}},{key:"sendRobotMessage",value:function(e,t){this.stream.socket.send("robot:"+t+":"+e),this.toolBar.isPaused()&&webots.currentView.stream.socket.send("step")}},{key:"resize",value:function(e,t){this.video&&this.video.resize(e,t)}},{key:"getControllerUrl",value:function(e){if(this.server){var t=0;for(var a in this.server.controllers)if(this.server.controllers[a].name===e){t=this.server.controllers[a].port;break}return 0===t?void 0:this.url.substring(0,this.url.indexOf(":",6)+1)+t}}},{key:"updateWorldList",value:function(e,t){var a=this;if(this.toolBar&&!this.broadcast&&("undefined"!=typeof this.worldSelect&&this.toolBar.worldSelectionDiv.removeChild(this.worldSelect),!(1>=t.length))){for(var r in this.worldSelect=document.createElement("select"),this.worldSelect.id="worldSelection",this.toolBar.worldSelectionDiv.appendChild(this.worldSelect),t){var o=document.createElement("option");o.value=t[r],o.text=t[r],this.worldSelect.appendChild(o),e===t[r]&&(this.worldSelect.selectedIndex=r)}this.worldSelect.onchange=function(){a.broadcast||"undefined"==typeof a.worldSelect||(a.toolBar&&a.toolBar.enableToolBarButtons(!1),a.x3dScene.viewpoint.resetFollow(),a.onrobotwindowsdestroy(),$("#webotsProgressMessage").html("Loading "+a.worldSelect.value+"..."),$("#webotsProgress").show(),a.stream.socket.send("load:"+a.worldSelect.value))}}}},{key:"setLabel",value:function(e){var t=document.getElementById("label"+e.id);null==t&&(t=document.createElement("div"),t.id="label"+e.id,t.className="webotsLabel",this.x3dDiv.appendChild(t)),t.style.fontFamily=e.font,t.style.color=e.color,t.style.fontSize=$(this.x3dDiv).height()*e.size/2.25+"px",t.style.left=$(this.x3dDiv).width()*e.x+"px",t.style.top=$(this.x3dDiv).height()*e.y+"px",t.innerHTML=e.text}},{key:"removeLabels",value:function(){for(var e=document.getElementsByClassName("webotsLabel"),t=e.length-1,a;0<=t;t--)a=e.item(t),a.parentNode.removeChild(a)}},{key:"resetSimulation",value:function(){this.removeLabels(),$("#webotsClock").html(webots.parseMillisecondsIntoReadableTime(0)),this.deadline=this.timeout,0<=this.deadline?$("#webotsTimeout").html(webots.parseMillisecondsIntoReadableTime(this.deadline)):$("#webotsTimeout").html(webots.parseMillisecondsIntoReadableTime(0)),this.x3dScene.viewpoint.reset(this.time)}},{key:"quitSimulation",value:function(){this.broadcast||($("#webotsProgressMessage").html("Bye bye..."),$("#webotsProgress").show(),this.quitting=!0,this.onquit())}},{key:"destroyWorld",value:function(){this.x3dScene&&this.x3dScene.destroyWorld(),this.removeLabels()}},{key:"editController",value:function(e){this.editor.dirname!==e&&(this.editor.closeAllTabs(),this.editor.dirname=e,this.stream.socket.send("get controller:"+e))}},{key:"openRobotWindow",value:function(e){var t=this.robotWindows[this.robotWindowNames[e]];t?t===this.infoWindow?!this.infoWindow.isOpen()&&this.toolBar.toggleInfo():t.open():console.log("No valid robot window for robot: "+e)}}]),View}(),webots.window=function(e){var t=webots.currentView.robotWindows[e];return t||console.log("Robot window '"+e+"' not found."),t},"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}(function(){function s(l,e,r){function t(d,n){if(!e[d]){if(!l[d]){var i="function"==typeof require&&require;if(!n&&i)return i(d,!0);if(o)return o(d,!0);var c=new Error("Cannot find module '"+d+"'");throw c.code="MODULE_NOT_FOUND",c}var a=e[d]={exports:{}};l[d][0].call(a.exports,function(e){var a=l[d][1][e];return t(a||e)},a,a.exports,s,l,e,r)}return e[d].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)t(r[a]);return t}return s})()({1:[function(e){"use strict";e(2);var t=function(e){return e&&e.__esModule?e:{default:e}}(e(15));t["default"]._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),t["default"]._babelPolyfill=!0},{15:15,2:2}],2:[function(e){"use strict";e(3),e(5),e(4),e(11),e(10),e(13),e(12),e(14),e(7),e(8),e(6),e(9),e(306),e(307)},{10:10,11:11,12:12,13:13,14:14,3:3,306:306,307:307,4:4,5:5,6:6,7:7,8:8,9:9}],3:[function(e,t){e(278),e(214),e(216),e(215),e(218),e(220),e(225),e(219),e(217),e(227),e(226),e(222),e(223),e(221),e(213),e(224),e(228),e(229),e(180),e(182),e(181),e(231),e(230),e(201),e(211),e(212),e(202),e(203),e(204),e(205),e(206),e(207),e(208),e(209),e(210),e(184),e(185),e(186),e(187),e(188),e(189),e(190),e(191),e(192),e(193),e(194),e(195),e(196),e(197),e(198),e(199),e(200),e(265),e(270),e(277),e(268),e(260),e(261),e(266),e(271),e(273),e(256),e(257),e(258),e(259),e(262),e(263),e(264),e(267),e(269),e(272),e(274),e(275),e(276),e(175),e(177),e(176),e(179),e(178),e(163),e(161),e(168),e(165),e(171),e(173),e(160),e(167),e(157),e(172),e(155),e(170),e(169),e(162),e(166),e(154),e(156),e(159),e(158),e(174),e(164),e(247),e(248),e(254),e(249),e(250),e(251),e(252),e(253),e(232),e(183),e(255),e(290),e(291),e(279),e(280),e(285),e(288),e(289),e(283),e(286),e(284),e(287),e(281),e(282),e(233),e(234),e(235),e(236),e(237),e(240),e(238),e(239),e(241),e(242),e(243),e(244),e(246),e(245),t.exports=e(52)},{154:154,155:155,156:156,157:157,158:158,159:159,160:160,161:161,162:162,163:163,164:164,165:165,166:166,167:167,168:168,169:169,170:170,171:171,172:172,173:173,174:174,175:175,176:176,177:177,178:178,179:179,180:180,181:181,182:182,183:183,184:184,185:185,186:186,187:187,188:188,189:189,190:190,191:191,192:192,193:193,194:194,195:195,196:196,197:197,198:198,199:199,200:200,201:201,202:202,203:203,204:204,205:205,206:206,207:207,208:208,209:209,210:210,211:211,212:212,213:213,214:214,215:215,216:216,217:217,218:218,219:219,220:220,221:221,222:222,223:223,224:224,225:225,226:226,227:227,228:228,229:229,230:230,231:231,232:232,233:233,234:234,235:235,236:236,237:237,238:238,239:239,240:240,241:241,242:242,243:243,244:244,245:245,246:246,247:247,248:248,249:249,250:250,251:251,252:252,253:253,254:254,255:255,256:256,257:257,258:258,259:259,260:260,261:261,262:262,263:263,264:264,265:265,266:266,267:267,268:268,269:269,270:270,271:271,272:272,273:273,274:274,275:275,276:276,277:277,278:278,279:279,280:280,281:281,282:282,283:283,284:284,285:285,286:286,287:287,288:288,289:289,290:290,291:291,52:52}],4:[function(e,t){e(292),t.exports=e(52).Array.flatMap},{292:292,52:52}],5:[function(e,t){e(293),t.exports=e(52).Array.includes},{293:293,52:52}],6:[function(e,t){e(294),t.exports=e(52).Object.entries},{294:294,52:52}],7:[function(e,t){e(295),t.exports=e(52).Object.getOwnPropertyDescriptors},{295:295,52:52}],8:[function(e,t){e(296),t.exports=e(52).Object.values},{296:296,52:52}],9:[function(e,t){'use strict';e(232),e(297),t.exports=e(52).Promise["finally"]},{232:232,297:297,52:52}],10:[function(e,t){e(298),t.exports=e(52).String.padEnd},{298:298,52:52}],11:[function(e,t){e(299),t.exports=e(52).String.padStart},{299:299,52:52}],12:[function(e,t){e(301),t.exports=e(52).String.trimRight},{301:301,52:52}],13:[function(e,t){e(300),t.exports=e(52).String.trimLeft},{300:300,52:52}],14:[function(e,t){e(302),t.exports=e(151).f("asyncIterator")},{151:151,302:302}],15:[function(e,t){e(32),t.exports=e(18).global},{18:18,32:32}],16:[function(e,t){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],17:[function(e,t){var a=e(28);t.exports=function(e){if(!a(e))throw TypeError(e+" is not an object!");return e}},{28:28}],18:[function(e,t){var a=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=a)},{}],19:[function(e,t){var a=e(16);t.exports=function(e,t,r){return(a(e),void 0===t)?e:1===r?function(r){return e.call(t,r)}:2===r?function(r,a){return e.call(t,r,a)}:3===r?function(r,a,o){return e.call(t,r,a,o)}:function(){return e.apply(t,arguments)}}},{16:16}],20:[function(e,t){t.exports=!e(23)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{23:23}],21:[function(e,t){var a=e(28),r=e(24).document,o=a(r)&&a(r.createElement);t.exports=function(e){return o?r.createElement(e):{}}},{24:24,28:28}],22:[function(e,t){var a=e(24),r=e(18),o=e(19),n=e(26),i=e(25),s="prototype",l=function e(t,l,d){var p=t&e.F,c=t&e.G,u=t&e.S,m=t&e.P,f=t&e.B,g=t&e.W,h=c?r:r[l]||(r[l]={}),y=h[s],x=c?a:u?a[l]:(a[l]||{})[s],v,b,_;for(v in c&&(d=l),d)b=!p&&x&&void 0!==x[v],b&&i(h,v)||(_=b?x[v]:d[v],h[v]=c&&"function"!=typeof x[v]?d[v]:f&&b?o(_,a):g&&x[v]==_?function(e){var t=function(t,a,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,a);}return new e(t,a,r)}return e.apply(this,arguments)};return t[s]=e[s],t}(_):m&&"function"==typeof _?o(Function.call,_):_,m&&((h.virtual||(h.virtual={}))[v]=_,t&e.R&&y&&!y[v]&&n(y,v,_)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},{18:18,19:19,24:24,25:25,26:26}],23:[function(e,t){t.exports=function(e){try{return!!e()}catch(t){return!0}}},{}],24:[function(e,t){var a=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=a)},{}],25:[function(e,t){var a={}.hasOwnProperty;t.exports=function(e,t){return a.call(e,t)}},{}],26:[function(e,t){var a=e(29),r=e(30);t.exports=e(20)?function(e,t,o){return a.f(e,t,r(1,o))}:function(e,t,a){return e[t]=a,e}},{20:20,29:29,30:30}],27:[function(e,t){t.exports=!e(20)&&!e(23)(function(){return 7!=Object.defineProperty(e(21)("div"),"a",{get:function(){return 7}}).a})},{20:20,21:21,23:23}],28:[function(e,t){t.exports=function(e){return"object"===_typeof(e)?null!==e:"function"==typeof e}},{}],29:[function(e,t,a){var r=e(17),o=e(27),n=e(31),i=Object.defineProperty;a.f=e(20)?Object.defineProperty:function(e,t,a){if(r(e),t=n(t,!0),r(a),o)try{return i(e,t,a)}catch(t){}if("get"in a||"set"in a)throw TypeError("Accessors not supported!");return"value"in a&&(e[t]=a.value),e}},{17:17,20:20,27:27,31:31}],30:[function(e,t){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],31:[function(e,t){var a=e(28);t.exports=function(e,t){if(!a(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!a(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!a(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!a(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},{28:28}],32:[function(e){var t=e(22);t(t.G,{global:e(24)})},{22:22,24:24}],33:[function(e,t,a){arguments[4][16][0].apply(a,arguments)},{16:16}],34:[function(e,t){var a=e(48);t.exports=function(e,t){if("number"!=typeof e&&"Number"!=a(e))throw TypeError(t);return+e}},{48:48}],35:[function(e,t){var a=e(152)("unscopables"),r=Array.prototype;r[a]==null&&e(72)(r,a,{}),t.exports=function(e){r[a][e]=!0}},{152:152,72:72}],36:[function(e,t){'use strict';var a=e(129)(!0);t.exports=function(e,t,r){return t+(r?a(e,t).length:1)}},{129:129}],37:[function(e,t){t.exports=function(e,t,a,r){if(!(e instanceof t)||r!==void 0&&r in e)throw TypeError(a+": incorrect invocation!");return e}},{}],38:[function(e,t,a){arguments[4][17][0].apply(a,arguments)},{17:17,81:81}],39:[function(e,t){'use strict';var a=e(142),r=e(137),o=e(141);t.exports=[].copyWithin||function(e,t){var n=a(this),i=o(n.length),s=r(e,i),l=r(t,i),d=2<arguments.length?arguments[2]:void 0,p=Math.min((d===void 0?i:r(d,i))-l,i-s),c=1;for(l<s&&s<l+p&&(c=-1,l+=p-1,s+=p-1);0<p--;)l in n?n[s]=n[l]:delete n[s],s+=c,l+=c;return n}},{137:137,141:141,142:142}],40:[function(e,t){'use strict';var a=e(142),r=e(137),o=e(141);t.exports=function(e){for(var t=a(this),n=o(t.length),i=arguments.length,s=r(1<i?arguments[1]:void 0,n),l=2<i?arguments[2]:void 0,d=void 0===l?n:r(l,n);d>s;)t[s++]=e;return t}},{137:137,141:141,142:142}],41:[function(e,t){var a=e(140),r=e(141),o=e(137);t.exports=function(e){return function(t,n,i){var s=a(t),l=r(s.length),d=o(i,l),p;if(e&&n!=n){for(;l>d;)if(p=s[d++],p!=p)return!0;}else for(;l>d;d++)if((e||d in s)&&s[d]===n)return e||d||0;return!e&&-1}}},{137:137,140:140,141:141}],42:[function(e,t){var a=e(54),r=e(77),o=e(142),n=e(141),i=e(45);t.exports=function(e,t){var s=1==e,l=4==e,d=6==e,p=t||i;return function(t,i,c){for(var u=o(t),m=r(u),g=a(i,c,3),f=n(m.length),h=0,y=s?p(t,f):2==e?p(t,0):void 0,x,v;f>h;h++)if((5==e||d||h in m)&&(x=m[h],v=g(x,h,u),e))if(s)y[h]=v;else if(v)switch(e){case 3:return!0;case 5:return x;case 6:return h;case 2:y.push(x);}else if(l)return!1;return d?-1:3==e||l?l:y}}},{141:141,142:142,45:45,54:54,77:77}],43:[function(e,t){var a=e(33),r=e(142),o=e(77),n=e(141);t.exports=function(e,t,s,l,d){a(t);var p=r(e),c=o(p),u=n(p.length),m=d?u-1:0,f=d?-1:1;if(2>s)for(;;){if(m in c){l=c[m],m+=f;break}if(m+=f,d?0>m:u<=m)throw TypeError("Reduce of empty array with no initial value")}for(;d?0<=m:u>m;m+=f)m in c&&(l=t(l,c[m],m,p));return l}},{141:141,142:142,33:33,77:77}],44:[function(e,t){var a=e(81),r=e(79),o=e(152)("species");t.exports=function(e){var t;return r(e)&&(t=e.constructor,"function"==typeof t&&(t===Array||r(t.prototype))&&(t=void 0),a(t)&&(t=t[o],null===t&&(t=void 0))),void 0===t?Array:t}},{152:152,79:79,81:81}],45:[function(e,t){var a=e(44);t.exports=function(e,t){return new(a(e))(t)}},{44:44}],46:[function(e,t){'use strict';var a=e(33),r=e(81),o=e(76),n=[].slice,s={},l=function(e,t,a){if(!(t in s)){for(var r=[],o=0;o<t;o++)r[o]="a["+o+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,a)};t.exports=Function.bind||function(e){var t=a(this),i=n.call(arguments,1),s=function a(){var r=i.concat(n.call(arguments));return this instanceof a?l(t,r.length,r):o(t,r,e)};return r(t.prototype)&&(s.prototype=t.prototype),s}},{33:33,76:76,81:81}],47:[function(e,t){var a=e(48),r=e(152)("toStringTag"),o="Arguments"==a(function(){return arguments}()),n=function(e,t){try{return e[t]}catch(t){}};t.exports=function(e){var t,i,s;return e===void 0?"Undefined":null===e?"Null":"string"==typeof(i=n(t=Object(e),r))?i:o?a(t):"Object"==(s=a(t))&&"function"==typeof t.callee?"Arguments":s}},{152:152,48:48}],48:[function(e,t){var a={}.toString;t.exports=function(e){return a.call(e).slice(8,-1)}},{}],49:[function(e,t){'use strict';var a=e(99).f,r=e(98),o=e(117),n=e(54),i=e(37),s=e(68),l=e(85),d=e(87),p=e(123),c=e(58),u=e(94).fastKey,m=e(149),f=c?"_s":"size",g=function(e,t){var a=u(t),r;if("F"!==a)return e._i[a];for(r=e._f;r;r=r.n)if(r.k==t)return r};t.exports={getConstructor:function(e,t,l,d){var p=e(function(e,a){i(e,p,t,"_i"),e._t=t,e._i=r(null),e._f=void 0,e._l=void 0,e[f]=0,null!=a&&s(a,l,e[d],e)});return o(p.prototype,{clear:function(){for(var e=m(this,t),a=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete a[r.i];e._f=e._l=void 0,e[f]=0},delete:function(e){var a=m(this,t),r=g(a,e);if(r){var o=r.n,n=r.p;delete a._i[r.i],r.r=!0,n&&(n.n=o),o&&(o.p=n),a._f==r&&(a._f=o),a._l==r&&(a._l=n),a[f]--}return!!r},forEach:function(e){m(this,t);for(var a=n(e,1<arguments.length?arguments[1]:void 0,3),r;r=r?r.n:this._f;)for(a(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!g(m(this,t),e)}}),c&&a(p.prototype,"size",{get:function(){return m(this,t)[f]}}),p},def:function(e,t,a){var r=g(e,t),o,n;return r?r.v=a:(e._l=r={i:n=u(t,!0),k:t,v:a,p:o=e._l,n:void 0,r:!1},!e._f&&(e._f=r),o&&(o.n=r),e[f]++,"F"!==n&&(e._i[n]=r)),e},getEntry:g,setStrong:function(e,t,a){l(e,t,function(e,a){this._t=m(e,t),this._k=a,this._l=void 0},function(){for(var e=this,t=e._k,a=e._l;a&&a.r;)a=a.p;return e._t&&(e._l=a=a?a.n:e._t._f)?"keys"==t?d(0,a.k):"values"==t?d(0,a.v):d(0,[a.k,a.v]):(e._t=void 0,d(1))},a?"entries":"values",!a,!0),p(t)}}},{117:117,123:123,149:149,37:37,54:54,58:58,68:68,85:85,87:87,94:94,98:98,99:99}],50:[function(e,t){'use strict';var a=e(117),r=e(94).getWeak,o=e(38),n=e(81),i=e(37),s=e(68),l=e(42),d=e(71),p=e(149),c=l(5),u=l(6),m=0,f=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},h=function(e,t){return c(e.a,function(e){return e[0]===t})};g.prototype={get:function(e){var t=h(this,e);if(t)return t[1]},has:function(e){return!!h(this,e)},set:function(e,t){var a=h(this,e);a?a[1]=t:this.a.push([e,t])},delete:function(e){var t=u(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},t.exports={getConstructor:function(e,t,o,l){var c=e(function(e,a){i(e,c,t,"_i"),e._t=t,e._i=m++,e._l=void 0,null!=a&&s(a,o,e[l],e)});return a(c.prototype,{delete:function(e){if(!n(e))return!1;var a=r(e);return!0===a?f(p(this,t))["delete"](e):a&&d(a,this._i)&&delete a[this._i]},has:function(e){if(!n(e))return!1;var a=r(e);return!0===a?f(p(this,t)).has(e):a&&d(a,this._i)}}),c},def:function(e,t,a){var n=r(o(t),!0);return!0===n?f(e).set(t,a):n[e._i]=a,e},ufstore:f}},{117:117,149:149,37:37,38:38,42:42,68:68,71:71,81:81,94:94}],51:[function(e,t){'use strict';var a=e(70),r=e(62),o=e(118),n=e(117),i=e(94),s=e(68),l=e(37),d=e(81),p=e(64),c=e(86),u=e(124),m=e(75);t.exports=function(e,t,f,g,h,y){var x=a[e],v=x,b=h?"set":"add",_=v&&v.prototype,T={},S=function(e){var t=_[e];o(_,e,"delete"==e?function(e){return(!y||d(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return(!y||d(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return y&&!d(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,a){return t.call(this,0===e?0:e,a),this})};if("function"!=typeof v||!(y||_.forEach&&!p(function(){new v().entries().next()})))v=g.getConstructor(t,e,h,b),n(v.prototype,f),i.NEED=!0;else{var E=new v,w=E[b](y?{}:-0,1)!=E,A=p(function(){E.has(1)}),M=c(function(e){new v(e)}),P=!y&&p(function(){for(var e=new v,t=5;t--;)e[b](t,t);return!e.has(-0)});M||(v=t(function(t,a){l(t,v,e);var r=m(new x,t,v);return null!=a&&s(a,h,r[b],r),r}),v.prototype=_,_.constructor=v),(A||P)&&(S("delete"),S("has"),h&&S("get")),(P||w)&&S(b),y&&_.clear&&delete _.clear}return u(v,e),T[e]=v,r(r.G+r.W+r.F*(v!=x),T),y||g.setStrong(v,e,h),v}},{117:117,118:118,124:124,37:37,62:62,64:64,68:68,70:70,75:75,81:81,86:86,94:94}],52:[function(e,t,a){arguments[4][18][0].apply(a,arguments)},{18:18}],53:[function(e,t){'use strict';var a=e(99),r=e(116);t.exports=function(e,t,o){t in e?a.f(e,t,r(0,o)):e[t]=o}},{116:116,99:99}],54:[function(e,t,a){arguments[4][19][0].apply(a,arguments)},{19:19,33:33}],55:[function(e,t){'use strict';var a=e(64),r=Date.prototype.getTime,o=Date.prototype.toISOString,n=function(e){return 9<e?e:"0"+e};t.exports=a(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-50000000000001))})||!a(function(){o.call(new Date(NaN))})?function(){if(!isFinite(r.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),a=e.getUTCMilliseconds(),o=0>t?"-":9999<t?"+":"";return o+("00000"+Math.abs(t)).slice(o?-6:-4)+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+(99<a?a:"0"+n(a))+"Z"}:o},{64:64}],56:[function(e,t){'use strict';var a=e(38),r=e(143),o="number";t.exports=function(e){if("string"!==e&&e!==o&&"default"!==e)throw TypeError("Incorrect hint");return r(a(this),e!=o)}},{143:143,38:38}],57:[function(e,t){t.exports=function(e){if(e==null)throw TypeError("Can't call method on  "+e);return e}},{}],58:[function(e,t,a){arguments[4][20][0].apply(a,arguments)},{20:20,64:64}],59:[function(e,t,a){arguments[4][21][0].apply(a,arguments)},{21:21,70:70,81:81}],60:[function(e,t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],61:[function(e,t){var a=e(107),r=e(104),o=e(108);t.exports=function(e){var t=a(e),n=r.f;if(n)for(var s=n(e),l=o.f,d=0,p;s.length>d;)l.call(e,p=s[d++])&&t.push(p);return t}},{104:104,107:107,108:108}],62:[function(e,t){var a=e(70),r=e(52),o=e(72),n=e(118),i=e(54),s="prototype",l=function e(t,l,d){var p=t&e.F,c=t&e.G,u=t&e.S,m=t&e.P,f=t&e.B,g=c?a:u?a[l]||(a[l]={}):(a[l]||{})[s],h=c?r:r[l]||(r[l]={}),y=h[s]||(h[s]={}),x,v,b,_;for(x in c&&(d=l),d)v=!p&&g&&void 0!==g[x],b=(v?g:d)[x],_=f&&v?i(b,a):m&&"function"==typeof b?i(Function.call,b):b,g&&n(g,x,b,t&e.U),h[x]!=b&&o(h,x,_),m&&y[x]!=b&&(y[x]=b)};a.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},{118:118,52:52,54:54,70:70,72:72}],63:[function(e,t){var a=e(152)("match");t.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[a]=!1,!"/./"[e](t)}catch(e){}}return!0}},{152:152}],64:[function(e,t,a){arguments[4][23][0].apply(a,arguments)},{23:23}],65:[function(e,t){'use strict';e(248);var a=e(118),r=e(72),o=e(64),n=e(57),i=e(152),s=e(120),l=i("species"),d=!o(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),p=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var a="ab".split(e);return 2===a.length&&"a"===a[0]&&"b"===a[1]}();t.exports=function(e,t,c){var u=i(e),m=!o(function(){var t={};return t[u]=function(){return 7},7!=""[e](t)}),f=m?!o(function(){var t=!1,a=/a/;return a.exec=function(){return t=!0,null},"split"===e&&(a.constructor={},a.constructor[l]=function(){return a}),a[u](""),!t}):void 0;if(!m||!f||"replace"===e&&!d||"split"===e&&!p){var g=/./[u],h=c(n,u,""[e],function(e,t,a,r,o){return t.exec===s?m&&!o?{done:!0,value:g.call(t,a,r)}:{done:!0,value:e.call(a,t,r)}:{done:!1}}),y=h[0],x=h[1];a(String.prototype,e,y),r(RegExp.prototype,u,2==t?function(e,t){return x.call(e,this,t)}:function(e){return x.call(e,this)})}}},{118:118,120:120,152:152,248:248,57:57,64:64,72:72}],66:[function(e,t){'use strict';var a=e(38);t.exports=function(){var e=a(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},{38:38}],67:[function(e,t){'use strict';function a(e,t,l,d,p,c,u,m){for(var f=p,g=0,h=!!u&&i(u,m,3),y,x;g<d;){if(g in l){if(y=h?h(l[g],g,t):l[g],x=!1,o(y)&&(x=y[s],x=void 0===x?r(y):!!x),x&&0<c)f=a(e,t,y,n(y.length),f,c-1)-1;else{if(9007199254740991<=f)throw TypeError();e[f]=y}f++}g++}return f}var r=e(79),o=e(81),n=e(141),i=e(54),s=e(152)("isConcatSpreadable");t.exports=a},{141:141,152:152,54:54,79:79,81:81}],68:[function(e,t,a){var r=e(54),o=e(83),n=e(78),i=e(38),s=e(141),l=e(153),d={},p={},a=t.exports=function(e,t,a,c,u){var m=u?function(){return e}:l(e),g=r(a,c,t?2:1),f=0,h,y,x,v;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(n(m)){for(h=s(e.length);h>f;f++)if(v=t?g(i(y=e[f])[0],y[1]):g(e[f]),v===d||v===p)return v;}else for(x=m.call(e);!(y=x.next()).done;)if(v=o(x,g,y.value,t),v===d||v===p)return v};a.BREAK=d,a.RETURN=p},{141:141,153:153,38:38,54:54,78:78,83:83}],69:[function(e,t){t.exports=e(126)("native-function-to-string",Function.toString)},{126:126}],70:[function(e,t,a){arguments[4][24][0].apply(a,arguments)},{24:24}],71:[function(e,t,a){arguments[4][25][0].apply(a,arguments)},{25:25}],72:[function(e,t,a){arguments[4][26][0].apply(a,arguments)},{116:116,26:26,58:58,99:99}],73:[function(e,t){var a=e(70).document;t.exports=a&&a.documentElement},{70:70}],74:[function(e,t,a){arguments[4][27][0].apply(a,arguments)},{27:27,58:58,59:59,64:64}],75:[function(e,t){var a=e(81),r=e(122).set;t.exports=function(e,t,o){var n=t.constructor,i;return n!==o&&"function"==typeof n&&(i=n.prototype)!==o.prototype&&a(i)&&r&&r(e,i),e}},{122:122,81:81}],76:[function(e,t){t.exports=function(e,t,a){var r=a===void 0;switch(t.length){case 0:return r?e():e.call(a);case 1:return r?e(t[0]):e.call(a,t[0]);case 2:return r?e(t[0],t[1]):e.call(a,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(a,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(a,t[0],t[1],t[2],t[3]);}return e.apply(a,t)}},{}],77:[function(e,t){var a=e(48);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==a(e)?e.split(""):Object(e)}},{48:48}],78:[function(e,t){var a=e(88),r=e(152)("iterator"),o=Array.prototype;t.exports=function(e){return e!==void 0&&(a.Array===e||o[r]===e)}},{152:152,88:88}],79:[function(e,t){var a=e(48);t.exports=Array.isArray||function(e){return"Array"==a(e)}},{48:48}],80:[function(e,t){var a=e(81),r=Math.floor;t.exports=function(e){return!a(e)&&isFinite(e)&&r(e)===e}},{81:81}],81:[function(e,t,a){arguments[4][28][0].apply(a,arguments)},{28:28}],82:[function(e,t){var a=e(81),r=e(48),o=e(152)("match");t.exports=function(e){var t;return a(e)&&((t=e[o])===void 0?"RegExp"==r(e):!!t)}},{152:152,48:48,81:81}],83:[function(e,t){var a=e(38);t.exports=function(t,r,e,o){try{return o?r(a(e)[0],e[1]):r(e)}catch(r){var n=t["return"];throw void 0!==n&&a(n.call(t)),r}}},{38:38}],84:[function(e,t){'use strict';var a=e(98),r=e(116),o=e(124),n={};e(72)(n,e(152)("iterator"),function(){return this}),t.exports=function(e,t,i){e.prototype=a(n,{next:r(1,i)}),o(e,t+" Iterator")}},{116:116,124:124,152:152,72:72,98:98}],85:[function(e,t){'use strict';var a=e(89),r=e(62),o=e(118),n=e(72),i=e(88),s=e(84),l=e(124),d=e(105),p=e(152)("iterator"),c=!([].keys&&"next"in[].keys()),u="keys",m="values",f=function(){return this};t.exports=function(e,t,g,h,y,x,v){s(g,t,h);var b=function(e){return!c&&e in E?E[e]:e===u?function(){return new g(this,e)}:e===m?function(){return new g(this,e)}:function(){return new g(this,e)}},_=t+" Iterator",T=y==m,S=!1,E=e.prototype,w=E[p]||E["@@iterator"]||y&&E[y],A=w||b(y),M=y?T?b("entries"):A:void 0,P="Array"==t?E.entries||w:w,L,C,R;if(P&&(R=d(P.call(new e)),R!==Object.prototype&&R.next&&(l(R,_,!0),!a&&"function"!=typeof R[p]&&n(R,p,f))),T&&w&&w.name!==m&&(S=!0,A=function(){return w.call(this)}),(!a||v)&&(c||S||!E[p])&&n(E,p,A),i[t]=A,i[_]=f,y)if(L={values:T?A:b(m),keys:x?A:b(u),entries:M},v)for(C in L)C in E||o(E,C,L[C]);else r(r.P+r.F*(c||S),t,L);return L}},{105:105,118:118,124:124,152:152,62:62,72:72,84:84,88:88,89:89}],86:[function(e,t){var a=e(152)("iterator"),r=!1;try{var o=[7][a]();o["return"]=function(){r=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(e,t){if(!t&&!r)return!1;var o=!1;try{var n=[7],i=n[a]();i.next=function(){return{done:o=!0}},n[a]=function(){return i},e(n)}catch(t){}return o}},{152:152}],87:[function(e,t){t.exports=function(e,t){return{value:t,done:!!e}}},{}],88:[function(e,t){t.exports={}},{}],89:[function(e,t){t.exports=!1},{}],90:[function(e,t){var a=Math.expm1;t.exports=!a||22025.465794806718<a(10)||22025.465794806718>a(10)||-2e-17!=a(-2e-17)?function(e){return 0==(e=+e)?e:-1e-6<e&&1e-6>e?e+e*e/2:Math.exp(e)-1}:a},{}],91:[function(e,t){var r=Math.abs,o=e(93),n=Math.pow,i=n(2,-52),s=n(2,-23),l=n(2,127)*(2-s),d=n(2,-126),p=function(e){return e+1/i-1/i};t.exports=Math.fround||function(e){var t=r(e),n=o(e),c,u;return t<d?n*p(t/d/s)*d*s:(c=(1+s/i)*t,u=c-(c-t),u>l||u!=u?n*(1/0):n*u)}},{93:93}],92:[function(e,t){t.exports=Math.log1p||function(e){return-1e-8<(e=+e)&&1e-8>e?e-e*e/2:Math.log(1+e)}},{}],93:[function(e,t){t.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:0>e?-1:1}},{}],94:[function(e,t){var a=e(147)("meta"),r=e(81),o=e(71),n=e(99).f,i=0,s=Object.isExtensible||function(){return!0},l=!e(64)(function(){return s(Object.preventExtensions({}))}),d=function(e){n(e,a,{value:{i:"O"+ ++i,w:{}}})},p=function(e,t){if(!r(e))return"symbol"==_typeof(e)?e:("string"==typeof e?"S":"P")+e;if(!o(e,a)){if(!s(e))return"F";if(!t)return"E";d(e)}return e[a].i},c=t.exports={KEY:a,NEED:!1,fastKey:p,getWeak:function(e,t){if(!o(e,a)){if(!s(e))return!0;if(!t)return!1;d(e)}return e[a].w},onFreeze:function(e){return l&&c.NEED&&s(e)&&!o(e,a)&&d(e),e}}},{147:147,64:64,71:71,81:81,99:99}],95:[function(e,t){var a=e(70),r=e(136).set,o=a.MutationObserver||a.WebKitMutationObserver,n=a.process,i=a.Promise,s="process"==e(48)(n);t.exports=function(){var e=function(){var e,a;for(s&&(e=n.domain)&&e.exit();t;){a=t.fn,t=t.next;try{a()}catch(a){throw t?d():l=void 0,a}}l=void 0,e&&e.enter()},t,l,d;if(s)d=function(){n.nextTick(e)};else if(o&&!(a.navigator&&a.navigator.standalone)){var p=!0,c=document.createTextNode("");new o(e).observe(c,{characterData:!0}),d=function(){c.data=p=!p}}else if(i&&i.resolve){var u=i.resolve(void 0);d=function(){u.then(e)}}else d=function(){r.call(a,e)};return function(e){var a={fn:e,next:void 0};l&&(l.next=a),t||(t=a,d()),l=a}}},{136:136,48:48,70:70}],96:[function(e,t){'use strict';function a(e){var t,a;this.promise=new e(function(e,r){if(t!==void 0||a!==void 0)throw TypeError("Bad Promise constructor");t=e,a=r}),this.resolve=r(t),this.reject=r(a)}var r=e(33);t.exports.f=function(e){return new a(e)}},{33:33}],97:[function(e,t){'use strict';var a=e(58),r=e(107),o=e(104),n=e(108),i=e(142),s=e(77),l=Object.assign;t.exports=!l||e(64)(function(){var e={},t={},a=Symbol(),r="abcdefghijklmnopqrst";return e[a]=7,r.split("").forEach(function(e){t[e]=e}),7!=l({},e)[a]||Object.keys(l({},t)).join("")!=r})?function(e){for(var t=i(e),l=arguments.length,d=1,p=o.f,c=n.f;l>d;)for(var u=s(arguments[d++]),m=p?r(u).concat(p(u)):r(u),f=m.length,g=0,h;f>g;)h=m[g++],(!a||c.call(u,h))&&(t[h]=u[h]);return t}:l},{104:104,107:107,108:108,142:142,58:58,64:64,77:77}],98:[function(e,t){var a=e(38),r=e(100),o=e(60),n=e(125)("IE_PROTO"),i=function(){},s="prototype",l=function(){var t=e(59)("iframe"),a=o.length,r="<",n=">",d;for(t.style.display="none",e(73).appendChild(t),t.src="javascript:",d=t.contentWindow.document,d.open(),d.write(r+"script"+n+"document.F=Object"+r+"/script"+n),d.close(),l=d.F;a--;)delete l[s][o[a]];return l()};t.exports=Object.create||function(e,t){var o;return null===e?o=l():(i[s]=a(e),o=new i,i[s]=null,o[n]=e),void 0===t?o:r(o,t)}},{100:100,125:125,38:38,59:59,60:60,73:73}],99:[function(e,t,a){arguments[4][29][0].apply(a,arguments)},{143:143,29:29,38:38,58:58,74:74}],100:[function(e,t){var a=e(99),r=e(38),o=e(107);t.exports=e(58)?Object.defineProperties:function(e,t){r(e);for(var n=o(t),s=n.length,l=0,d;s>l;)a.f(e,d=n[l++],t[d]);return e}},{107:107,38:38,58:58,99:99}],101:[function(e,t,a){var r=e(108),o=e(116),n=e(140),i=e(143),s=e(71),l=e(74),d=Object.getOwnPropertyDescriptor;a.f=e(58)?d:function(e,t){if(e=n(e),t=i(t,!0),l)try{return d(e,t)}catch(t){}return s(e,t)?o(!r.f.call(e,t),e[t]):void 0}},{108:108,116:116,140:140,143:143,58:58,71:71,74:74}],102:[function(e,t){var a=e(140),r=e(103).f,o={}.toString,n="object"==("undefined"==typeof window?"undefined":_typeof(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],i=function(e){try{return r(e)}catch(t){return n.slice()}};t.exports.f=function(e){return n&&"[object Window]"==o.call(e)?i(e):r(a(e))}},{103:103,140:140}],103:[function(e,t,a){var r=e(106),o=e(60).concat("length","prototype");a.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},{106:106,60:60}],104:[function(e,t,a){a.f=Object.getOwnPropertySymbols},{}],105:[function(e,t){var a=e(71),r=e(142),o=e(125)("IE_PROTO"),n=Object.prototype;t.exports=Object.getPrototypeOf||function(e){return e=r(e),a(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?n:null}},{125:125,142:142,71:71}],106:[function(e,t){var a=e(71),r=e(140),o=e(41)(!1),n=e(125)("IE_PROTO");t.exports=function(e,t){var s=r(e),l=0,d=[],p;for(p in s)p!=n&&a(s,p)&&d.push(p);for(;t.length>l;)a(s,p=t[l++])&&(~o(d,p)||d.push(p));return d}},{125:125,140:140,41:41,71:71}],107:[function(e,t){var a=e(106),r=e(60);t.exports=Object.keys||function(e){return a(e,r)}},{106:106,60:60}],108:[function(e,t,a){a.f={}.propertyIsEnumerable},{}],109:[function(e,t){var a=e(62),r=e(52),o=e(64);t.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],i={};i[e]=t(n),a(a.S+a.F*o(function(){n(1)}),"Object",i)}},{52:52,62:62,64:64}],110:[function(e,t){var a=e(58),r=e(107),o=e(140),n=e(108).f;t.exports=function(e){return function(t){for(var s=o(t),l=r(s),d=l.length,p=0,c=[],u;d>p;)u=l[p++],(!a||n.call(s,u))&&c.push(e?[u,s[u]]:s[u]);return c}}},{107:107,108:108,140:140,58:58}],111:[function(e,t){var a=e(103),r=e(104),o=e(38),n=e(70).Reflect;t.exports=n&&n.ownKeys||function(e){var t=a.f(o(e)),n=r.f;return n?t.concat(n(e)):t}},{103:103,104:104,38:38,70:70}],112:[function(e,t){var a=e(70).parseFloat,r=e(134).trim;t.exports=1/a(e(135)+"-0")==-Infinity?a:function(e){var t=r(e+"",3),o=a(t);return 0===o&&"-"==t.charAt(0)?-0:o}},{134:134,135:135,70:70}],113:[function(e,t){var a=e(70).parseInt,r=e(134).trim,o=e(135),n=/^[-+]?0[xX]/;t.exports=8!==a(o+"08")||22!==a(o+"0x16")?function(e,t){var o=r(e+"",3);return a(o,t>>>0||(n.test(o)?16:10))}:a},{134:134,135:135,70:70}],114:[function(e,t){t.exports=function(e){try{return{e:!1,v:e()}}catch(t){return{e:!0,v:t}}}},{}],115:[function(e,t){var a=e(38),r=e(81),o=e(96);t.exports=function(e,t){if(a(e),r(t)&&t.constructor===e)return t;var n=o.f(e),i=n.resolve;return i(t),n.promise}},{38:38,81:81,96:96}],116:[function(e,t,a){arguments[4][30][0].apply(a,arguments)},{30:30}],117:[function(e,t){var a=e(118);t.exports=function(e,t,r){for(var o in t)a(e,o,t[o],r);return e}},{118:118}],118:[function(e,t){var a=e(70),r=e(72),o=e(71),n=e(147)("src"),i=e(69),s="toString",l=(""+i).split(s);e(52).inspectSource=function(e){return i.call(e)},(t.exports=function(e,t,i,s){var d="function"==typeof i;d&&(o(i,"name")||r(i,"name",t));e[t]===i||(d&&(o(i,n)||r(i,n,e[t]?""+e[t]:l.join(t+""))),e===a?e[t]=i:s?e[t]?e[t]=i:r(e,t,i):(delete e[t],r(e,t,i)))})(Function.prototype,s,function(){return"function"==typeof this&&this[n]||i.call(this)})},{147:147,52:52,69:69,70:70,71:71,72:72}],119:[function(e,t){'use strict';var a=e(47),r=RegExp.prototype.exec;t.exports=function(e,t){var o=e.exec;if("function"==typeof o){var n=o.call(e,t);if("object"!==_typeof(n))throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==a(e))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(e,t)}},{47:47}],120:[function(e,t){'use strict';var a=e(66),r=RegExp.prototype.exec,o=String.prototype.replace,n=r,s="lastIndex",l=function(){var e=/a/,t=/b*/g;return r.call(e,"a"),r.call(t,"a"),0!==e[s]||0!==t[s]}(),d=/()??/.exec("")[1]!==void 0;(l||d)&&(n=function(e){var t=this,n,p,c,u;return d&&(p=new RegExp("^"+t.source+"$(?!\\s)",a.call(t))),l&&(n=t[s]),c=r.call(t,e),l&&c&&(t[s]=t.global?c.index+c[0].length:n),d&&c&&1<c.length&&o.call(c[0],p,function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(c[u]=void 0)}),c}),t.exports=n},{66:66}],121:[function(e,t){t.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},{}],122:[function(e,t){var a=e(81),r=e(38),o=function(e,t){if(r(e),!a(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,a,r){try{r=e(54)(Function.call,e(101).f(Object.prototype,"__proto__").set,2),r(t,[]),a=!(t instanceof Array)}catch(t){a=!0}return function(e,t){return o(e,t),a?e.__proto__=t:r(e,t),e}}({},!1):void 0),check:o}},{101:101,38:38,54:54,81:81}],123:[function(e,t){'use strict';var a=e(70),r=e(99),o=e(58),n=e(152)("species");t.exports=function(e){var t=a[e];o&&t&&!t[n]&&r.f(t,n,{configurable:!0,get:function(){return this}})}},{152:152,58:58,70:70,99:99}],124:[function(e,t){var a=e(99).f,r=e(71),o=e(152)("toStringTag");t.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,o)&&a(e,o,{configurable:!0,value:t})}},{152:152,71:71,99:99}],125:[function(e,t){var a=e(126)("keys"),r=e(147);t.exports=function(e){return a[e]||(a[e]=r(e))}},{126:126,147:147}],126:[function(e,t){var a=e(52),r=e(70),o="__core-js_shared__",n=r[o]||(r[o]={});(t.exports=function(e,t){return n[e]||(n[e]=t===void 0?{}:t)})("versions",[]).push({version:a.version,mode:e(89)?"pure":"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})},{52:52,70:70,89:89}],127:[function(e,t){var a=e(38),r=e(33),o=e(152)("species");t.exports=function(e,t){var n=a(e).constructor,i;return n===void 0||(i=a(n)[o])==null?t:r(i)}},{152:152,33:33,38:38}],128:[function(e,t){'use strict';var a=e(64);t.exports=function(e,t){return!!e&&a(function(){t?e.call(null,function(){},1):e.call(null)})}},{64:64}],129:[function(e,t){var r=e(139),o=e(57);t.exports=function(e){return function(t,n){var d=o(t)+"",s=r(n),i=d.length,l,p;return 0>s||s>=i?e?"":void 0:(l=d.charCodeAt(s),55296>l||56319<l||s+1===i||56320>(p=d.charCodeAt(s+1))||57343<p?e?d.charAt(s):l:e?d.slice(s,s+2):(l-55296<<10)+(p-56320)+65536)}}},{139:139,57:57}],130:[function(e,t){var a=e(82),r=e(57);t.exports=function(e,t,o){if(a(t))throw TypeError("String#"+o+" doesn't accept regex!");return r(e)+""}},{57:57,82:82}],131:[function(e,t){var a=e(62),r=e(64),o=e(57),n=/"/g,i=function(e,t,a,r){var i=o(e)+"",s="<"+t;return""!==a&&(s+=" "+a+"=\""+(r+"").replace(n,"&quot;")+"\""),s+">"+i+"</"+t+">"};t.exports=function(e,t){var o={};o[e]=t(i),a(a.P+a.F*r(function(){var t=""[e]("\"");return t!==t.toLowerCase()||3<t.split("\"").length}),"String",o)}},{57:57,62:62,64:64}],132:[function(e,t){var a=Math.ceil,r=e(141),o=e(133),n=e(57);t.exports=function(e,t,i,s){var l=n(e)+"",d=l.length,p=void 0===i?" ":i+"",c=r(t);if(c<=d||""==p)return l;var u=c-d,m=o.call(p,a(u/p.length));return m.length>u&&(m=m.slice(0,u)),s?m+l:l+m}},{133:133,141:141,57:57}],133:[function(e,t){'use strict';var a=e(139),r=e(57);t.exports=function(e){var t=r(this)+"",o="",i=a(e);if(0>i||i==1/0)throw RangeError("Count can't be negative");for(;0<i;(i>>>=1)&&(t+=t))1&i&&(o+=t);return o}},{139:139,57:57}],134:[function(e,t){var a=e(62),r=e(57),o=e(64),n=e(135),i="["+n+"]",s="\u200B\x85",l=RegExp("^"+i+i+"*"),d=RegExp(i+i+"*$"),p=function(e,t,r){var i={},l=o(function(){return!!n[e]()||s[e]()!=s}),d=i[e]=l?t(c):n[e];r&&(i[r]=d),a(a.P+a.F*l,"String",i)},c=p.trim=function(e,t){return e=r(e)+"",1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(d,"")),e};t.exports=p},{135:135,57:57,62:62,64:64}],135:[function(e,t){t.exports="\t\n\x0B\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF"},{}],136:[function(e,t){var a=e(54),r=e(76),o=e(73),n=e(59),i=e(70),s=i.process,l=i.setImmediate,d=i.clearImmediate,p=i.MessageChannel,c=i.Dispatch,u=0,m={},f="onreadystatechange",g=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},h=function(e){g.call(e.data)},y,x,v;l&&d||(l=function(e){for(var t=[],a=1;arguments.length>a;)t.push(arguments[a++]);return m[++u]=function(){r("function"==typeof e?e:Function(e),t)},y(u),u},d=function(e){delete m[e]},"process"==e(48)(s)?y=function(e){s.nextTick(a(g,e,1))}:c&&c.now?y=function(e){c.now(a(g,e,1))}:p?(x=new p,v=x.port2,x.port1.onmessage=h,y=a(v.postMessage,v,1)):i.addEventListener&&"function"==typeof postMessage&&!i.importScripts?(y=function(e){i.postMessage(e+"","*")},i.addEventListener("message",h,!1)):f in n("script")?y=function(e){o.appendChild(n("script"))[f]=function(){o.removeChild(this),g.call(e)}}:y=function(e){setTimeout(a(g,e,1),0)}),t.exports={set:l,clear:d}},{48:48,54:54,59:59,70:70,73:73,76:76}],137:[function(e,t){var a=e(139),r=Math.max,o=Math.min;t.exports=function(e,t){return e=a(e),0>e?r(e+t,0):o(e,t)}},{139:139}],138:[function(e,t){var a=e(139),r=e(141);t.exports=function(e){if(e===void 0)return 0;var t=a(e),o=r(t);if(t!==o)throw RangeError("Wrong length!");return o}},{139:139,141:141}],139:[function(e,t){var a=Math.ceil,r=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(0<e?r:a)(e)}},{}],140:[function(e,t){var a=e(77),r=e(57);t.exports=function(e){return a(r(e))}},{57:57,77:77}],141:[function(e,t){var a=e(139),r=Math.min;t.exports=function(e){return 0<e?r(a(e),9007199254740991):0}},{139:139}],142:[function(e,t){var a=e(57);t.exports=function(e){return Object(a(e))}},{57:57}],143:[function(e,t,a){arguments[4][31][0].apply(a,arguments)},{31:31,81:81}],144:[function(e,t){'use strict';var a=Math.floor;if(e(58)){var r=e(89),o=e(70),n=e(64),i=e(62),s=e(146),l=e(145),d=e(54),p=e(37),c=e(116),u=e(72),m=e(117),f=e(139),g=e(141),h=e(138),y=e(137),x=e(143),v=e(71),b=e(47),_=e(81),T=e(142),S=e(78),E=e(98),w=e(105),A=e(103).f,M=e(153),P=e(147),L=e(152),C=e(42),R=e(41),F=e(127),I=e(164),N=e(88),D=e(86),B=e(123),U=e(40),O=e(39),z=e(99),G=e(101),k=z.f,H=G.f,V=o.RangeError,W=o.TypeError,X=o.Uint8Array,j="ArrayBuffer",Y="Shared"+j,Q="BYTES_PER_ELEMENT",q="prototype",Z=Array[q],J=l.ArrayBuffer,K=l.DataView,ee=C(0),te=C(2),ae=C(3),re=C(4),oe=C(5),ne=C(6),ie=R(!0),se=R(!1),le=I.values,de=I.keys,pe=I.entries,ce=Z.lastIndexOf,ue=Z.reduce,me=Z.reduceRight,fe=Z.join,ge=Z.sort,he=Z.slice,ye=Z.toString,xe=Z.toLocaleString,ve=L("iterator"),be=L("toStringTag"),_e=P("typed_constructor"),Te=P("def_constructor"),Se=s.CONSTR,Ee=s.TYPED,we=s.VIEW,Ae="Wrong length!",Me=C(1,function(e,t){return Fe(F(e,e[Te]),t)}),Pe=n(function(){return 1===new X(new Uint16Array([1]).buffer)[0]}),Le=!!X&&!!X[q].set&&n(function(){new X(1).set({})}),Ce=function(e,t){var a=f(e);if(0>a||a%t)throw V("Wrong offset!");return a},Re=function(e){if(_(e)&&Ee in e)return e;throw W(e+" is not a typed array!")},Fe=function(e,t){if(!(_(e)&&_e in e))throw W("It is not a typed array constructor!");return new e(t)},Ie=function(e,t){return Ne(F(e,e[Te]),t)},Ne=function(e,t){for(var a=0,r=t.length,o=Fe(e,r);r>a;)o[a]=t[a++];return o},De=function(e,t,a){k(e,t,{get:function(){return this._d[a]}})},Be=function(e){var t=T(e),a=arguments.length,r=1<a?arguments[1]:void 0,o=r!==void 0,n=M(t),s,l,p,c,u,m;if(n!=null&&!S(n)){for(m=n.call(t),p=[],s=0;!(u=m.next()).done;s++)p.push(u.value);t=p}for(o&&2<a&&(r=d(r,arguments[2],2)),s=0,l=g(t.length),c=Fe(this,l);l>s;s++)c[s]=o?r(t[s],s):t[s];return c},Ue=function(){for(var e=0,t=arguments.length,a=Fe(this,t);t>e;)a[e]=arguments[e++];return a},Oe=!!X&&n(function(){xe.call(new X(1))}),ze=function(){return xe.apply(Oe?he.call(Re(this)):Re(this),arguments)},Ge={copyWithin:function(e,t){return O.call(Re(this),e,t,2<arguments.length?arguments[2]:void 0)},every:function(e){return re(Re(this),e,1<arguments.length?arguments[1]:void 0)},fill:function(){return U.apply(Re(this),arguments)},filter:function(e){return Ie(this,te(Re(this),e,1<arguments.length?arguments[1]:void 0))},find:function(e){return oe(Re(this),e,1<arguments.length?arguments[1]:void 0)},findIndex:function(e){return ne(Re(this),e,1<arguments.length?arguments[1]:void 0)},forEach:function(e){ee(Re(this),e,1<arguments.length?arguments[1]:void 0)},indexOf:function(e){return se(Re(this),e,1<arguments.length?arguments[1]:void 0)},includes:function(e){return ie(Re(this),e,1<arguments.length?arguments[1]:void 0)},join:function(){return fe.apply(Re(this),arguments)},lastIndexOf:function(){return ce.apply(Re(this),arguments)},map:function(e){return Me(Re(this),e,1<arguments.length?arguments[1]:void 0)},reduce:function(){return ue.apply(Re(this),arguments)},reduceRight:function(){return me.apply(Re(this),arguments)},reverse:function(){for(var e=this,t=Re(e).length,r=a(t/2),o=0,n;o<r;)n=e[o],e[o++]=e[--t],e[t]=n;return e},some:function(e){return ae(Re(this),e,1<arguments.length?arguments[1]:void 0)},sort:function(e){return ge.call(Re(this),e)},subarray:function(e,t){var a=Re(this),r=a.length,o=y(e,r);return new(F(a,a[Te]))(a.buffer,a.byteOffset+o*a.BYTES_PER_ELEMENT,g((t===void 0?r:y(t,r))-o))}},ke=function(e,t){return Ie(this,he.call(Re(this),e,t))},He=function(e){Re(this);var t=Ce(arguments[1],1),a=this.length,r=T(e),o=g(r.length),n=0;if(o+t>a)throw V(Ae);for(;n<o;)this[t+n]=r[n++]},Ve={entries:function(){return pe.call(Re(this))},keys:function(){return de.call(Re(this))},values:function(){return le.call(Re(this))}},We=function(e,t){return _(e)&&e[Ee]&&"symbol"!=_typeof(t)&&t in e&&+t+""==t+""},Xe=function(e,t){return We(e,t=x(t,!0))?c(2,e[t]):H(e,t)},je=function(e,t,a){return We(e,t=x(t,!0))&&_(a)&&v(a,"value")&&!v(a,"get")&&!v(a,"set")&&!a.configurable&&(!v(a,"writable")||a.writable)&&(!v(a,"enumerable")||a.enumerable)?(e[t]=a.value,e):k(e,t,a)};Se||(G.f=Xe,z.f=je),i(i.S+i.F*!Se,"Object",{getOwnPropertyDescriptor:Xe,defineProperty:je}),n(function(){ye.call({})})&&(ye=xe=function(){return fe.call(this)});var Ye=m({},Ge);m(Ye,Ve),u(Ye,ve,Ve.values),m(Ye,{slice:ke,set:He,constructor:function(){},toString:ye,toLocaleString:ze}),De(Ye,"buffer","b"),De(Ye,"byteOffset","o"),De(Ye,"byteLength","l"),De(Ye,"length","e"),k(Ye,be,{get:function(){return this[Ee]}}),t.exports=function(e,t,a,l){l=!!l;var d=e+(l?"Clamped":"")+"Array",c=o[d],m=c||{},f=c&&w(c),y=!c||!s.ABV,x={},v=c&&c[q],T=function(a,r){var o=a._d;return o.v["get"+e](r*t+o.o,Pe)},S=function(a,r,o){var n=a._d;l&&(o=0>(o=Math.round(o))?0:255<o?255:255&o),n.v["set"+e](r*t+n.o,o,Pe)},M=function(e,t){k(e,t,{get:function(){return T(this,t)},set:function(e){return S(this,t,e)},enumerable:!0})};y?(c=a(function(e,a,r,o){p(e,c,d,"_d");var n=0,i=0,s,l,m,f;if(!_(a))m=h(a),l=m*t,s=new J(l);else if(a instanceof J||(f=b(a))==j||f==Y){s=a,i=Ce(r,t);var y=a.byteLength;if(void 0===o){if(y%t)throw V(Ae);if(l=y-i,0>l)throw V(Ae)}else if(l=g(o)*t,l+i>y)throw V(Ae);m=l/t}else return Ee in a?Ne(c,a):Be.call(c,a);for(u(e,"_d",{b:s,o:i,l:l,e:m,v:new K(s)});n<m;)M(e,n++)}),v=c[q]=E(Ye),u(v,"constructor",c)):(!n(function(){c(1)})||!n(function(){new c(-1)})||!D(function(e){new c,new c(null),new c(1.5),new c(e)},!0))&&(c=a(function(e,a,r,o){p(e,c,d);var n;return _(a)?a instanceof J||(n=b(a))==j||n==Y?void 0===o?void 0===r?new m(a):new m(a,Ce(r,t)):new m(a,Ce(r,t),o):Ee in a?Ne(c,a):Be.call(c,a):new m(h(a))}),ee(f===Function.prototype?A(m):A(m).concat(A(f)),function(e){e in c||u(c,e,m[e])}),c[q]=v,!r&&(v.constructor=c));var P=v[ve],L=!!P&&("values"==P.name||P.name==null),C=Ve.values;u(c,_e,!0),u(v,Ee,d),u(v,we,!0),u(v,Te,c),(l?new c(1)[be]!=d:!(be in v))&&k(v,be,{get:function(){return d}}),x[d]=c,i(i.G+i.W+i.F*(c!=m),x),i(i.S,d,{BYTES_PER_ELEMENT:t}),i(i.S+i.F*n(function(){m.of.call(c,1)}),d,{from:Be,of:Ue}),Q in v||u(v,Q,t),i(i.P,d,Ge),B(d),i(i.P+i.F*Le,d,{set:He}),i(i.P+i.F*!L,d,Ve),r||v.toString==ye||(v.toString=ye),i(i.P+i.F*n(function(){new c(1).slice()}),d,{slice:ke}),i(i.P+i.F*(n(function(){return[1,2].toLocaleString()!=new c([1,2]).toLocaleString()})||!n(function(){v.toLocaleString.call([1,2])})),d,{toLocaleString:ze}),N[d]=L?P:C,r||L||u(v,ve,C)}}else t.exports=function(){}},{101:101,103:103,105:105,116:116,117:117,123:123,127:127,137:137,138:138,139:139,141:141,142:142,143:143,145:145,146:146,147:147,152:152,153:153,164:164,37:37,39:39,40:40,41:41,42:42,47:47,54:54,58:58,62:62,64:64,70:70,71:71,72:72,78:78,81:81,86:86,88:88,89:89,98:98,99:99}],145:[function(e,t,a){'use strict';function r(t,a,r){var o=Array(r),n=8*r-a-1,l=(1<<n)-1,d=l>>1,p=23===a?z(2,-24)-z(2,-77):0,u=0,f=0>t||0===t&&0>1/t?1:0,s,g,h;for(t=O(t),t!=t||t===B?(g=t==t?0:1,s=l):(s=G(k(t)/H),1>t*(h=z(2,-s))&&(s--,h*=2),t+=1<=s+d?p/h:p*z(2,1-d),2<=t*h&&(s++,h/=2),s+d>=l?(g=0,s=l):1<=s+d?(g=(t*h-1)*z(2,a),s+=d):(g=t*z(2,d-1)*z(2,a),s=0));8<=a;o[u++]=255&g,g/=256,a-=8);for(s=s<<a|g,n+=a;0<n;o[u++]=255&s,s/=256,n-=8);return o[--u]|=128*f,o}function o(t,a,r){var o=8*r-a-1,n=(1<<o)-1,l=n>>1,d=o-7,p=r-1,c=t[p--],u=127&c,f;for(c>>=7;0<d;u=256*u+t[p],p--,d-=8);for(f=u&(1<<-d)-1,u>>=-d,d+=a;0<d;f=256*f+t[p],p--,d-=8);if(0===u)u=1-l;else{if(u===n)return f?NaN:c?-B:B;f+=z(2,a),u-=l}return(c?-1:1)*f*z(2,u-a)}function n(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function i(e){return[255&e]}function s(e){return[255&e,255&e>>8]}function l(e){return[255&e,255&e>>8,255&e>>16,255&e>>24]}function d(e){return r(e,52,8)}function p(e){return r(e,23,4)}function c(e,t,a){A(e.prototype,t,{get:function(){return this[a]}})}function u(e,t,a,r){var o=E(+a);if(o+t>e[Q])throw D("Wrong index!");var n=e[Y]._b,i=o+e[q],s=n.slice(i,i+t);return r?s:s.reverse()}function m(e,t,a,r,o,n){var s=E(+a);if(s+t>e[Q])throw D("Wrong index!");for(var l=e[Y]._b,d=s+e[q],p=r(+o),c=0;c<t;c++)l[d+c]=p[n?c:t-c-1]}var f=e(70),g=e(58),h=e(89),y=e(146),x=e(72),v=e(117),b=e(64),_=e(37),T=e(139),S=e(141),E=e(138),w=e(103).f,A=e(99).f,M=e(40),P=e(124),L="ArrayBuffer",C="DataView",R="prototype",F=f[L],I=f[C],N=f.Math,D=f.RangeError,B=f.Infinity,U=F,O=N.abs,z=N.pow,G=N.floor,k=N.log,H=N.LN2,V="buffer",W="byteLength",X="byteOffset",Y=g?"_b":V,Q=g?"_l":W,q=g?"_o":X;if(!y.ABV)F=function(e){_(this,F,L);var t=E(e);this._b=M.call(Array(t),0),this[Q]=t},I=function(e,t,a){_(this,I,C),_(e,F,C);var r=e[Q],o=T(t);if(0>o||o>r)throw D("Wrong offset!");if(a=void 0===a?r-o:S(a),o+a>r)throw D("Wrong length!");this[Y]=e,this[q]=o,this[Q]=a},g&&(c(F,W,"_l"),c(I,V,"_b"),c(I,W,"_l"),c(I,X,"_o")),v(I[R],{getInt8:function(e){return u(this,1,e)[0]<<24>>24},getUint8:function(e){return u(this,1,e)[0]},getInt16:function(e){var t=u(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=u(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return n(u(this,4,e,arguments[1]))},getUint32:function(e){return n(u(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return o(u(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return o(u(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){m(this,1,e,i,t)},setUint8:function(e,t){m(this,1,e,i,t)},setInt16:function(e,t){m(this,2,e,s,t,arguments[2])},setUint16:function(e,t){m(this,2,e,s,t,arguments[2])},setInt32:function(e,t){m(this,4,e,l,t,arguments[2])},setUint32:function(e,t){m(this,4,e,l,t,arguments[2])},setFloat32:function(e,t){m(this,4,e,p,t,arguments[2])},setFloat64:function(e,t){m(this,8,e,d,t,arguments[2])}});else{if(!b(function(){F(1)})||!b(function(){new F(-1)})||b(function(){return new F,new F(1.5),new F(NaN),F.name!=L})){F=function(e){return _(this,F),new U(E(e))};for(var Z=F[R]=U[R],J=w(U),K=0,ee;J.length>K;)(ee=J[K++])in F||x(F,ee,U[ee]);h||(Z.constructor=F)}var te=new I(new F(2)),ae=I[R].setInt8;te.setInt8(0,2147483648),te.setInt8(1,2147483649),(te.getInt8(0)||!te.getInt8(1))&&v(I[R],{setInt8:function(e,t){ae.call(this,e,t<<24>>24)},setUint8:function(e,t){ae.call(this,e,t<<24>>24)}},!0)}P(F,L),P(I,C),x(I[R],y.VIEW,!0),a[L]=F,a[C]=I},{103:103,117:117,124:124,138:138,139:139,141:141,146:146,37:37,40:40,58:58,64:64,70:70,72:72,89:89,99:99}],146:[function(e,t){for(var a=e(70),r=e(72),o=e(147),n=o("typed_array"),s=o("view"),l=!!(a.ArrayBuffer&&a.DataView),d=l,p=0,c=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"],u;p<9;)(u=a[c[p++]])?(r(u.prototype,n,!0),r(u.prototype,s,!0)):d=!1;t.exports={ABV:l,CONSTR:d,TYPED:n,VIEW:s}},{147:147,70:70,72:72}],147:[function(e,t){var a=0,r=Math.random();t.exports=function(e){return"Symbol(".concat(e===void 0?"":e,")_",(++a+r).toString(36))}},{}],148:[function(e,t){var a=e(70),r=a.navigator;t.exports=r&&r.userAgent||""},{70:70}],149:[function(e,t){var a=e(81);t.exports=function(e,t){if(!a(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},{81:81}],150:[function(e,t){var a=e(70),r=e(52),o=e(89),n=e(151),i=e(99).f;t.exports=function(e){var t=r.Symbol||(r.Symbol=o?{}:a.Symbol||{});"_"==e.charAt(0)||e in t||i(t,e,{value:n.f(e)})}},{151:151,52:52,70:70,89:89,99:99}],151:[function(e,t,a){a.f=e(152)},{152:152}],152:[function(e,t){var a=e(126)("wks"),r=e(147),o=e(70).Symbol,n="function"==typeof o,i=t.exports=function(e){return a[e]||(a[e]=n&&o[e]||(n?o:r)("Symbol."+e))};i.store=a},{126:126,147:147,70:70}],153:[function(e,t){var a=e(47),r=e(152)("iterator"),o=e(88);t.exports=e(52).getIteratorMethod=function(e){if(e!=null)return e[r]||e["@@iterator"]||o[a(e)]}},{152:152,47:47,52:52,88:88}],154:[function(e){var t=e(62);t(t.P,"Array",{copyWithin:e(39)}),e(35)("copyWithin")},{35:35,39:39,62:62}],155:[function(e){'use strict';var t=e(62),a=e(42)(4);t(t.P+t.F*!e(128)([].every,!0),"Array",{every:function(e){return a(this,e,arguments[1])}})},{128:128,42:42,62:62}],156:[function(e){var t=e(62);t(t.P,"Array",{fill:e(40)}),e(35)("fill")},{35:35,40:40,62:62}],157:[function(e){'use strict';var t=e(62),a=e(42)(2);t(t.P+t.F*!e(128)([].filter,!0),"Array",{filter:function(e){return a(this,e,arguments[1])}})},{128:128,42:42,62:62}],158:[function(e){'use strict';var t=e(62),a=e(42)(6),r="findIndex",o=!0;r in[]&&[,][r](function(){o=!1}),t(t.P+t.F*o,"Array",{findIndex:function(e){return a(this,e,1<arguments.length?arguments[1]:void 0)}}),e(35)(r)},{35:35,42:42,62:62}],159:[function(e){'use strict';var t=e(62),a=e(42)(5),r="find",o=!0;r in[]&&[,][r](function(){o=!1}),t(t.P+t.F*o,"Array",{find:function(e){return a(this,e,1<arguments.length?arguments[1]:void 0)}}),e(35)(r)},{35:35,42:42,62:62}],160:[function(e){'use strict';var t=e(62),a=e(42)(0),r=e(128)([].forEach,!0);t(t.P+t.F*!r,"Array",{forEach:function(e){return a(this,e,arguments[1])}})},{128:128,42:42,62:62}],161:[function(e){'use strict';var t=e(54),a=e(62),r=e(142),o=e(83),n=e(78),i=e(141),s=e(53),l=e(153);a(a.S+a.F*!e(86)(function(e){Array.from(e)}),"Array",{from:function(e){var a=r(e),d="function"==typeof this?this:Array,p=arguments.length,c=1<p?arguments[1]:void 0,u=void 0!==c,m=0,f=l(a),g,h,y,x;if(u&&(c=t(c,2<p?arguments[2]:void 0,2)),null!=f&&!(d==Array&&n(f)))for(x=f.call(a),h=new d;!(y=x.next()).done;m++)s(h,m,u?o(x,c,[y.value,m],!0):y.value);else for(g=i(a.length),h=new d(g);g>m;m++)s(h,m,u?c(a[m],m):a[m]);return h.length=m,h}})},{141:141,142:142,153:153,53:53,54:54,62:62,78:78,83:83,86:86}],162:[function(e){'use strict';var t=e(62),a=e(41)(!1),r=[].indexOf,o=!!r&&0>1/[1].indexOf(1,-0);t(t.P+t.F*(o||!e(128)(r)),"Array",{indexOf:function(e){return o?r.apply(this,arguments)||0:a(this,e,arguments[1])}})},{128:128,41:41,62:62}],163:[function(e){var t=e(62);t(t.S,"Array",{isArray:e(79)})},{62:62,79:79}],164:[function(e,t){'use strict';var a=e(35),r=e(87),o=e(88),n=e(140);t.exports=e(85)(Array,"Array",function(e,t){this._t=n(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,a=this._i++;return!e||a>=e.length?(this._t=void 0,r(1)):"keys"==t?r(0,a):"values"==t?r(0,e[a]):r(0,[a,e[a]])},"values"),o.Arguments=o.Array,a("keys"),a("values"),a("entries")},{140:140,35:35,85:85,87:87,88:88}],165:[function(e){'use strict';var t=e(62),a=e(140),r=[].join;t(t.P+t.F*(e(77)!=Object||!e(128)(r)),"Array",{join:function(e){return r.call(a(this),e===void 0?",":e)}})},{128:128,140:140,62:62,77:77}],166:[function(e){'use strict';var t=Math.min,a=e(62),r=e(140),o=e(139),n=e(141),i=[].lastIndexOf,s=!!i&&0>1/[1].lastIndexOf(1,-0);a(a.P+a.F*(s||!e(128)(i)),"Array",{lastIndexOf:function(e){if(s)return i.apply(this,arguments)||0;var a=r(this),l=n(a.length),d=l-1;for(1<arguments.length&&(d=t(d,o(arguments[1]))),0>d&&(d=l+d);0<=d;d--)if(d in a&&a[d]===e)return d||0;return-1}})},{128:128,139:139,140:140,141:141,62:62}],167:[function(e){'use strict';var t=e(62),a=e(42)(1);t(t.P+t.F*!e(128)([].map,!0),"Array",{map:function(e){return a(this,e,arguments[1])}})},{128:128,42:42,62:62}],168:[function(e){'use strict';var t=e(62),a=e(53);t(t.S+t.F*e(64)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)a(r,e,arguments[e++]);return r.length=t,r}})},{53:53,62:62,64:64}],169:[function(e){'use strict';var t=e(62),a=e(43);t(t.P+t.F*!e(128)([].reduceRight,!0),"Array",{reduceRight:function(e){return a(this,e,arguments.length,arguments[1],!0)}})},{128:128,43:43,62:62}],170:[function(e){'use strict';var t=e(62),a=e(43);t(t.P+t.F*!e(128)([].reduce,!0),"Array",{reduce:function(e){return a(this,e,arguments.length,arguments[1],!1)}})},{128:128,43:43,62:62}],171:[function(e){'use strict';var t=e(62),a=e(73),r=e(48),o=e(137),n=e(141),s=[].slice;t(t.P+t.F*e(64)(function(){a&&s.call(a)}),"Array",{slice:function(e,t){var a=n(this.length),l=r(this);if(t=void 0===t?a:t,"Array"==l)return s.call(this,e,t);for(var d=o(e,a),p=o(t,a),c=n(p-d),u=Array(c),m=0;m<c;m++)u[m]="String"==l?this.charAt(d+m):this[d+m];return u}})},{137:137,141:141,48:48,62:62,64:64,73:73}],172:[function(e){'use strict';var t=e(62),a=e(42)(3);t(t.P+t.F*!e(128)([].some,!0),"Array",{some:function(e){return a(this,e,arguments[1])}})},{128:128,42:42,62:62}],173:[function(e){'use strict';var t=e(62),a=e(33),r=e(142),o=e(64),n=[].sort,i=[1,2,3];t(t.P+t.F*(o(function(){i.sort(void 0)})||!o(function(){i.sort(null)})||!e(128)(n)),"Array",{sort:function(e){return e===void 0?n.call(r(this)):n.call(r(this),a(e))}})},{128:128,142:142,33:33,62:62,64:64}],174:[function(e){e(123)("Array")},{123:123}],175:[function(e){var t=e(62);t(t.S,"Date",{now:function(){return new Date().getTime()}})},{62:62}],176:[function(e){var t=e(62),a=e(55);t(t.P+t.F*(Date.prototype.toISOString!==a),"Date",{toISOString:a})},{55:55,62:62}],177:[function(e){'use strict';var t=e(62),a=e(142),r=e(143);t(t.P+t.F*e(64)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(){var e=a(this),t=r(e);return"number"!=typeof t||isFinite(t)?e.toISOString():null}})},{142:142,143:143,62:62,64:64}],178:[function(e){var t=e(152)("toPrimitive"),a=Date.prototype;t in a||e(72)(a,t,e(56))},{152:152,56:56,72:72}],179:[function(e){var t=Date.prototype,a="Invalid Date",r="toString",o=t[r],n=t.getTime;new Date(NaN)+""!=a&&e(118)(t,r,function(){var e=n.call(this);return e===e?o.call(this):a})},{118:118}],180:[function(e){var t=e(62);t(t.P,"Function",{bind:e(46)})},{46:46,62:62}],181:[function(e){'use strict';var t=e(81),a=e(105),r=e(152)("hasInstance"),o=Function.prototype;r in o||e(99).f(o,r,{value:function(e){if("function"!=typeof this||!t(e))return!1;if(!t(this.prototype))return e instanceof this;for(;e=a(e);)if(this.prototype===e)return!0;return!1}})},{105:105,152:152,81:81,99:99}],182:[function(e){var t=e(99).f,a=Function.prototype,r=/^\s*function ([^ (]*)/,o="name";o in a||e(58)&&t(a,o,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},{58:58,99:99}],183:[function(e,t){'use strict';var a=e(49),r=e(149),o="Map";t.exports=e(51)(o,function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{get:function(e){var t=a.getEntry(r(this,o),e);return t&&t.v},set:function(e,t){return a.def(r(this,o),0===e?0:e,t)}},a,!0)},{149:149,49:49,51:51}],184:[function(e){var t=e(62),a=e(92),r=Math.sqrt,o=Math.acosh;t(t.S+t.F*!(o&&710==Math.floor(o(Number.MAX_VALUE))&&o(1/0)==1/0),"Math",{acosh:function(e){return 1>(e=+e)?NaN:94906265.62425156<e?Math.log(e)+Math.LN2:a(e-1+r(e-1)*r(e+1))}})},{62:62,92:92}],185:[function(e){function t(e){return isFinite(e=+e)&&0!=e?0>e?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}var a=e(62),r=Math.asinh;a(a.S+a.F*!(r&&0<1/r(0)),"Math",{asinh:t})},{62:62}],186:[function(e){var t=e(62),a=Math.atanh;t(t.S+t.F*!(a&&0>1/a(-0)),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},{62:62}],187:[function(e){var t=e(62),a=e(93);t(t.S,"Math",{cbrt:function(e){return a(e=+e)*Math.pow(Math.abs(e),1/3)}})},{62:62,93:93}],188:[function(e){var t=e(62);t(t.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},{62:62}],189:[function(e){var t=e(62),a=Math.exp;t(t.S,"Math",{cosh:function(e){return(a(e=+e)+a(-e))/2}})},{62:62}],190:[function(e){var t=e(62),a=e(90);t(t.S+t.F*(a!=Math.expm1),"Math",{expm1:a})},{62:62,90:90}],191:[function(e){var t=e(62);t(t.S,"Math",{fround:e(91)})},{62:62,91:91}],192:[function(e){var t=e(62),a=Math.abs;t(t.S,"Math",{hypot:function(){for(var e=0,t=0,r=arguments.length,o=0,n,s;t<r;)n=a(arguments[t++]),o<n?(s=o/n,e=e*s*s+1,o=n):0<n?(s=n/o,e+=s*s):e+=n;return o===1/0?1/0:o*Math.sqrt(e)}})},{62:62}],193:[function(e){var t=e(62),a=Math.imul;t(t.S+t.F*e(64)(function(){return-5!=a(4294967295,5)||2!=a.length}),"Math",{imul:function(e,t){var a=+e,r=+t,o=65535&a,n=65535&r;return 0|o*n+((65535&a>>>16)*n+o*(65535&r>>>16)<<16>>>0)}})},{62:62,64:64}],194:[function(e){var t=e(62);t(t.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},{62:62}],195:[function(e){var t=e(62);t(t.S,"Math",{log1p:e(92)})},{62:62,92:92}],196:[function(e){var t=e(62);t(t.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},{62:62}],197:[function(e){var t=e(62);t(t.S,"Math",{sign:e(93)})},{62:62,93:93}],198:[function(e){var t=e(62),a=e(90),r=Math.exp;t(t.S+t.F*e(64)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return 1>Math.abs(e=+e)?(a(e)-a(-e))/2:(r(e-1)-r(-e-1))*(Math.E/2)}})},{62:62,64:64,90:90}],199:[function(e){var t=e(62),r=e(90),o=Math.exp;t(t.S,"Math",{tanh:function(e){var t=r(e=+e),a=r(-e);return t==1/0?1:a==1/0?-1:(t-a)/(o(e)+o(-e))}})},{62:62,90:90}],200:[function(e){var t=e(62);t(t.S,"Math",{trunc:function(e){return(0<e?Math.floor:Math.ceil)(e)}})},{62:62}],201:[function(e){'use strict';var t=e(70),a=e(71),r=e(48),o=e(75),n=e(143),i=e(64),s=e(103).f,l=e(101).f,d=e(99).f,p=e(134).trim,c="Number",u=t[c],m=u,f=u.prototype,g=r(e(98)(f))==c,h="trim"in String.prototype,y=function(e){var t=n(e,!1);if("string"==typeof t&&2<t.length){t=h?t.trim():p(t,3);var a=t.charCodeAt(0),r,o,s;if(43===a||45===a){if(r=t.charCodeAt(2),88===r||120===r)return NaN;}else if(48===a){switch(t.charCodeAt(1)){case 66:case 98:o=2,s=49;break;case 79:case 111:o=8,s=55;break;default:return+t;}for(var d=t.slice(2),c=0,u=d.length,l;c<u;c++)if(l=d.charCodeAt(c),48>l||l>s)return NaN;return parseInt(d,o)}}return+t};if(!u(" 0o1")||!u("0b1")||u("+0x1")){u=function(e){var t=1>arguments.length?0:e,a=this;return a instanceof u&&(g?i(function(){f.valueOf.call(a)}):r(a)!=c)?o(new m(y(t)),a,u):y(t)};for(var x=e(58)?s(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),v=0,b;x.length>v;v++)a(m,b=x[v])&&!a(u,b)&&d(u,b,l(m,b));u.prototype=f,f.constructor=u,e(118)(t,c,u)}},{101:101,103:103,118:118,134:134,143:143,48:48,58:58,64:64,70:70,71:71,75:75,98:98,99:99}],202:[function(e){var t=e(62);t(t.S,"Number",{EPSILON:Math.pow(2,-52)})},{62:62}],203:[function(e){var t=e(62),a=e(70).isFinite;t(t.S,"Number",{isFinite:function(e){return"number"==typeof e&&a(e)}})},{62:62,70:70}],204:[function(e){var t=e(62);t(t.S,"Number",{isInteger:e(80)})},{62:62,80:80}],205:[function(e){var t=e(62);t(t.S,"Number",{isNaN:function(e){return e!=e}})},{62:62}],206:[function(e){var t=e(62),a=e(80),r=Math.abs;t(t.S,"Number",{isSafeInteger:function(e){return a(e)&&9007199254740991>=r(e)}})},{62:62,80:80}],207:[function(e){var t=e(62);t(t.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{62:62}],208:[function(e){var t=e(62);t(t.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{62:62}],209:[function(e){var t=e(62),a=e(112);t(t.S+t.F*(Number.parseFloat!=a),"Number",{parseFloat:a})},{112:112,62:62}],210:[function(e){var t=e(62),a=e(113);t(t.S+t.F*(Number.parseInt!=a),"Number",{parseInt:a})},{113:113,62:62}],211:[function(e){'use strict';var t=e(62),a=e(139),r=e(34),o=e(133),n=1 .toFixed,s=Math.floor,l=[0,0,0,0,0,0],d="Number.toFixed: incorrect invocation!",p="0",c=function(e,t){for(var a=-1,r=t;6>++a;)r+=e*l[a],l[a]=r%1e7,r=s(r/1e7)},u=function(e){for(var t=6,a=0;0<=--t;)a+=l[t],l[t]=s(a/e),a=1e7*(a%e)},g=function(){for(var e=6,a="";0<=--e;)if(""!==a||0===e||0!==l[e]){var r=l[e]+"";a=""===a?r:a+o.call(p,7-r.length)+r}return a},h=function e(t,a,r){return 0===a?r:1==a%2?e(t,a-1,r*t):e(t*t,a/2,r)},y=function(e){for(var t=0,a=e;4096<=a;)t+=12,a/=4096;for(;2<=a;)t+=1,a/=2;return t};t(t.P+t.F*(!!n&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==1000000000000000100 .toFixed(0))||!e(64)(function(){n.call({})})),"Number",{toFixed:function(t){var n=r(this,d),i=a(t),l="",f=p,v,b,_,T;if(0>i||20<i)throw RangeError(d);if(n!=n)return"NaN";if(-1e21>=n||1e21<=n)return n+"";if(0>n&&(l="-",n=-n),1e-21<n)if(v=y(n*h(2,69,1))-69,b=0>v?n*h(2,-v,1):n/h(2,v,1),b*=4503599627370496,v=52-v,0<v){for(c(0,b),_=i;7<=_;)c(1e7,0),_-=7;for(c(h(10,_,1),0),_=v-1;23<=_;)u(8388608),_-=23;u(1<<_),c(1,1),u(2),f=g()}else c(0,b),c(1<<-v,0),f=g()+o.call(p,i);return 0<i?(T=f.length,f=l+(T<=i?"0."+o.call(p,i-T)+f:f.slice(0,T-i)+"."+f.slice(T-i))):f=l+f,f}})},{133:133,139:139,34:34,62:62,64:64}],212:[function(e){'use strict';var t=e(62),a=e(64),r=e(34),o=1 .toPrecision;t(t.P+t.F*(a(function(){return"1"!==o.call(1,void 0)})||!a(function(){o.call({})})),"Number",{toPrecision:function(e){var t=r(this,"Number#toPrecision: incorrect invocation!");return e===void 0?o.call(t):o.call(t,e)}})},{34:34,62:62,64:64}],213:[function(e){var t=e(62);t(t.S+t.F,"Object",{assign:e(97)})},{62:62,97:97}],214:[function(e){var t=e(62);t(t.S,"Object",{create:e(98)})},{62:62,98:98}],215:[function(e){var t=e(62);t(t.S+t.F*!e(58),"Object",{defineProperties:e(100)})},{100:100,58:58,62:62}],216:[function(e){var t=e(62);t(t.S+t.F*!e(58),"Object",{defineProperty:e(99).f})},{58:58,62:62,99:99}],217:[function(e){var t=e(81),a=e(94).onFreeze;e(109)("freeze",function(e){return function(r){return e&&t(r)?e(a(r)):r}})},{109:109,81:81,94:94}],218:[function(e){var t=e(140),a=e(101).f;e(109)("getOwnPropertyDescriptor",function(){return function(e,r){return a(t(e),r)}})},{101:101,109:109,140:140}],219:[function(e){e(109)("getOwnPropertyNames",function(){return e(102).f})},{102:102,109:109}],220:[function(e){var t=e(142),a=e(105);e(109)("getPrototypeOf",function(){return function(e){return a(t(e))}})},{105:105,109:109,142:142}],221:[function(e){var t=e(81);e(109)("isExtensible",function(e){return function(a){return!!t(a)&&(!e||e(a))}})},{109:109,81:81}],222:[function(e){var t=e(81);e(109)("isFrozen",function(e){return function(a){return!t(a)||!!e&&e(a)}})},{109:109,81:81}],223:[function(e){var t=e(81);e(109)("isSealed",function(e){return function(a){return!t(a)||!!e&&e(a)}})},{109:109,81:81}],224:[function(e){var t=e(62);t(t.S,"Object",{is:e(121)})},{121:121,62:62}],225:[function(e){var t=e(142),a=e(107);e(109)("keys",function(){return function(e){return a(t(e))}})},{107:107,109:109,142:142}],226:[function(e){var t=e(81),a=e(94).onFreeze;e(109)("preventExtensions",function(e){return function(r){return e&&t(r)?e(a(r)):r}})},{109:109,81:81,94:94}],227:[function(e){var t=e(81),a=e(94).onFreeze;e(109)("seal",function(e){return function(r){return e&&t(r)?e(a(r)):r}})},{109:109,81:81,94:94}],228:[function(e){var t=e(62);t(t.S,"Object",{setPrototypeOf:e(122).set})},{122:122,62:62}],229:[function(e){'use strict';var t=e(47),a={};a[e(152)("toStringTag")]="z","[object z]"!=a+""&&e(118)(Object.prototype,"toString",function(){return"[object "+t(this)+"]"},!0)},{118:118,152:152,47:47}],230:[function(e){var t=e(62),a=e(112);t(t.G+t.F*(parseFloat!=a),{parseFloat:a})},{112:112,62:62}],231:[function(e){var t=e(62),a=e(113);t(t.G+t.F*(parseInt!=a),{parseInt:a})},{113:113,62:62}],232:[function(e){'use strict';var t=e(89),a=e(70),r=e(54),o=e(47),n=e(62),i=e(81),s=e(33),l=e(37),d=e(68),p=e(127),c=e(136).set,u=e(95)(),m=e(96),f=e(114),g=e(148),h=e(115),y="Promise",x=a.TypeError,v=a.process,b=v&&v.versions,_=b&&b.v8||"",T=a[y],S="process"==o(v),E=function(){},w=D=m.f,A=!!function(){try{var t=T.resolve(1),a=(t.constructor={})[e(152)("species")]=function(e){e(E,E)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(E)instanceof a&&0!==_.indexOf("6.6")&&-1===g.indexOf("Chrome/66")}catch(t){}}(),M=function(e){var t;return!!(i(e)&&"function"==typeof(t=e.then))&&t},P=function(e,t){if(!e._n){e._n=!0;var a=e._c;u(function(){for(var r=e._v,o=1==e._s,n=0,s=function(t){var a=o?t.ok:t.fail,n=t.resolve,i=t.reject,s=t.domain,l,d,p;try{a?(!o&&(2==e._h&&R(e),e._h=1),!0===a?l=r:(s&&s.enter(),l=a(r),s&&(s.exit(),p=!0)),l===t.promise?i(x("Promise-chain cycle")):(d=M(l))?d.call(l,n,i):n(l)):i(r)}catch(t){s&&!p&&s.exit(),i(t)}};a.length>n;)s(a[n++]);e._c=[],e._n=!1,t&&!e._h&&L(e)})}},L=function(e){c.call(a,function(){var t=e._v,r=C(e),o,n,i;if(r&&(o=f(function(){S?v.emit("unhandledRejection",t,e):(n=a.onunhandledrejection)?n({promise:e,reason:t}):(i=a.console)&&i.error&&i.error("Unhandled promise rejection",t)}),e._h=S||C(e)?2:1),e._a=void 0,r&&o.e)throw o.v})},C=function(e){return 1!==e._h&&0===(e._a||e._c).length},R=function(e){c.call(a,function(){var t;S?v.emit("rejectionHandled",e):(t=a.onrejectionhandled)&&t({promise:e,reason:e._v})})},F=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,!t._a&&(t._a=t._c.slice()),P(t,!0))},I=function e(t){var a=this,o;if(!a._d){a._d=!0,a=a._w||a;try{if(a===t)throw x("Promise can't be resolved itself");(o=M(t))?u(function(){var n={_w:a,_d:!1};try{o.call(t,r(e,n,1),r(F,n,1))}catch(t){F.call(n,t)}}):(a._v=t,a._s=1,P(a,!1))}catch(t){F.call({_w:a,_d:!1},t)}}},N,D,B,U;A||(T=function(e){l(this,T,y,"_h"),s(e),N.call(this);try{e(r(I,this,1),r(F,this,1))}catch(e){F.call(this,e)}},N=function(){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},N.prototype=e(117)(T.prototype,{then:function(e,t){var a=w(p(this,T));return a.ok="function"!=typeof e||e,a.fail="function"==typeof t&&t,a.domain=S?v.domain:void 0,this._c.push(a),this._a&&this._a.push(a),this._s&&P(this,!1),a.promise},catch:function(e){return this.then(void 0,e)}}),B=function(){var e=new N;this.promise=e,this.resolve=r(I,e,1),this.reject=r(F,e,1)},m.f=w=function(e){return e===T||e===U?new B(e):D(e)}),n(n.G+n.W+n.F*!A,{Promise:T}),e(124)(T,y),e(123)(y),U=e(52)[y],n(n.S+n.F*!A,y,{reject:function(e){var t=w(this),a=t.reject;return a(e),t.promise}}),n(n.S+n.F*(t||!A),y,{resolve:function(e){return h(t&&this===U?T:this,e)}}),n(n.S+n.F*!(A&&e(86)(function(e){T.all(e)["catch"](E)})),y,{all:function(e){var t=this,a=w(t),r=a.resolve,o=a.reject,n=f(function(){var a=[],n=0,i=1;d(e,!1,function(e){var s=n++,l=!1;a.push(void 0),i++,t.resolve(e).then(function(e){l||(l=!0,a[s]=e,--i||r(a))},o)}),--i||r(a)});return n.e&&o(n.v),a.promise},race:function(e){var t=this,a=w(t),r=a.reject,o=f(function(){d(e,!1,function(e){t.resolve(e).then(a.resolve,r)})});return o.e&&r(o.v),a.promise}})},{114:114,115:115,117:117,123:123,124:124,127:127,136:136,148:148,152:152,33:33,37:37,47:47,52:52,54:54,62:62,68:68,70:70,81:81,86:86,89:89,95:95,96:96}],233:[function(e){var t=e(62),a=e(33),r=e(38),o=(e(70).Reflect||{}).apply,n=Function.apply;t(t.S+t.F*!e(64)(function(){o(function(){})}),"Reflect",{apply:function(e,t,i){var s=a(e),l=r(i);return o?o(s,t,l):n.call(s,t,l)}})},{33:33,38:38,62:62,64:64,70:70}],234:[function(e){var t=e(62),a=e(98),r=e(33),o=e(38),n=e(81),i=e(64),s=e(46),l=(e(70).Reflect||{}).construct,d=i(function(){function e(){}return!(l(function(){},[],e)instanceof e)}),p=!i(function(){l(function(){})});t(t.S+t.F*(d||p),"Reflect",{construct:function(e,t){r(e),o(t);var i=3>arguments.length?e:r(arguments[2]);if(p&&!d)return l(e,t,i);if(e==i){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);}var c=[null];return c.push.apply(c,t),new(s.apply(e,c))}var u=i.prototype,m=a(n(u)?u:Object.prototype),f=Function.apply.call(e,m,t);return n(f)?f:m}})},{33:33,38:38,46:46,62:62,64:64,70:70,81:81,98:98}],235:[function(e){var t=e(99),a=e(62),r=e(38),o=e(143);a(a.S+a.F*e(64)(function(){Reflect.defineProperty(t.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,a,n){r(e),a=o(a,!0),r(n);try{return t.f(e,a,n),!0}catch(t){return!1}}})},{143:143,38:38,62:62,64:64,99:99}],236:[function(e){var t=e(62),a=e(101).f,r=e(38);t(t.S,"Reflect",{deleteProperty:function(e,t){var o=a(r(e),t);return(!o||o.configurable)&&delete e[t]}})},{101:101,38:38,62:62}],237:[function(e){'use strict';var t=e(62),a=e(38),r=function(e){this._t=a(e),this._i=0;var t=this._k=[],r;for(r in e)t.push(r)};e(84)(r,"Object",function(){var e=this,t=e._k,a;do if(e._i>=t.length)return{value:void 0,done:!0};while(!((a=t[e._i++])in e._t));return{value:a,done:!1}}),t(t.S,"Reflect",{enumerate:function(e){return new r(e)}})},{38:38,62:62,84:84}],238:[function(e){var t=e(101),a=e(62),r=e(38);a(a.S,"Reflect",{getOwnPropertyDescriptor:function(e,a){return t.f(r(e),a)}})},{101:101,38:38,62:62}],239:[function(e){var t=e(62),a=e(105),r=e(38);t(t.S,"Reflect",{getPrototypeOf:function(e){return a(r(e))}})},{105:105,38:38,62:62}],240:[function(e){function t(e,n){var l=3>arguments.length?e:arguments[2],d,p;return s(e)===l?e[n]:(d=a.f(e,n))?o(d,"value")?d.value:void 0===d.get?void 0:d.get.call(l):i(p=r(e))?t(p,n,l):void 0}var a=e(101),r=e(105),o=e(71),n=e(62),i=e(81),s=e(38);n(n.S,"Reflect",{get:t})},{101:101,105:105,38:38,62:62,71:71,81:81}],241:[function(e){var t=e(62);t(t.S,"Reflect",{has:function(e,t){return t in e}})},{62:62}],242:[function(e){var t=e(62),a=e(38),r=Object.isExtensible;t(t.S,"Reflect",{isExtensible:function(e){return a(e),!r||r(e)}})},{38:38,62:62}],243:[function(e){var t=e(62);t(t.S,"Reflect",{ownKeys:e(111)})},{111:111,62:62}],244:[function(e){var t=e(62),a=e(38),r=Object.preventExtensions;t(t.S,"Reflect",{preventExtensions:function(e){a(e);try{return r&&r(e),!0}catch(t){return!1}}})},{38:38,62:62}],245:[function(e){var t=e(62),a=e(122);a&&t(t.S,"Reflect",{setPrototypeOf:function(e,t){a.check(e,t);try{return a.set(e,t),!0}catch(t){return!1}}})},{122:122,62:62}],246:[function(e){function t(e,i,p){var c=4>arguments.length?e:arguments[3],u=r.f(l(e),i),m,f;if(!u){if(d(f=o(e)))return t(f,i,p,c);u=s(0)}if(n(u,"value")){if(!1===u.writable||!d(c))return!1;if(m=r.f(c,i)){if(m.get||m.set||!1===m.writable)return!1;m.value=p,a.f(c,i,m)}else a.f(c,i,s(0,p));return!0}return u.set!==void 0&&(u.set.call(c,p),!0)}var a=e(99),r=e(101),o=e(105),n=e(71),i=e(62),s=e(116),l=e(38),d=e(81);i(i.S,"Reflect",{set:t})},{101:101,105:105,116:116,38:38,62:62,71:71,81:81,99:99}],247:[function(e){var t=e(70),a=e(75),r=e(99).f,o=e(103).f,n=e(82),s=e(66),l=t.RegExp,d=l,c=l.prototype,u=/a/g,m=/a/g,g=new l(u)!==u;if(e(58)&&(!g||e(64)(function(){return m[e(152)("match")]=!1,l(u)!=u||l(m)==m||"/a/i"!=l(u,"i")}))){l=function(e,t){var r=this instanceof l,o=n(e),i=t===void 0;return!r&&o&&e.constructor===l&&i?e:a(g?new d(o&&!i?e.source:e,t):d((o=e instanceof l)?e.source:e,o&&i?s.call(e):t),r?this:c,l)};for(var h=function(e){(e in l)||r(l,e,{configurable:!0,get:function(){return d[e]},set:function(t){d[e]=t}})},y=o(d),x=0;y.length>x;)h(y[x++]);c.constructor=l,l.prototype=c,e(118)(t,"RegExp",l)}e(123)("RegExp")},{103:103,118:118,123:123,152:152,58:58,64:64,66:66,70:70,75:75,82:82,99:99}],248:[function(e){'use strict';var t=e(120);e(62)({target:"RegExp",proto:!0,forced:t!==/./.exec},{exec:t})},{120:120,62:62}],249:[function(e){e(58)&&"g"!=/./g.flags&&e(99).f(RegExp.prototype,"flags",{configurable:!0,get:e(66)})},{58:58,66:66,99:99}],250:[function(e){'use strict';var t=e(38),a=e(141),r=e(36),o=e(119);e(65)("match",1,function(e,n,i,s){return[function(t){var a=e(this),r=t==null?void 0:t[n];return r===void 0?new RegExp(t)[n](a+""):r.call(t,a)},function(e){var l=s(i,e,this);if(l.done)return l.value;var d=t(e),p=this+"";if(!d.global)return o(d,p);var c=d.unicode;d.lastIndex=0;for(var u=[],m=0,f;null!==(f=o(d,p));){var g=f[0]+"";u[m]=g,""==g&&(d.lastIndex=r(p,a(d.lastIndex),c)),m++}return 0===m?null:u}]})},{119:119,141:141,36:36,38:38,65:65}],251:[function(e){'use strict';var t=e(38),a=e(142),r=e(141),o=e(139),n=e(36),i=e(119),s=Math.max,l=Math.min,d=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,c=/\$([$&`']|\d\d?)/g,u=function(e){return e===void 0?e:e+""};e(65)("replace",2,function(e,m,f,g){function h(e,t,r,o,i,s){var l=r+e.length,u=o.length,n=c;return void 0!==i&&(i=a(i),n=p),f.call(s,n,function(a,s){var p;switch(s.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(l);case"<":p=i[s.slice(1,-1)];break;default:var c=+s;if(0==c)return a;if(c>u){var n=d(c/10);return 0===n?a:n<=u?void 0===o[n-1]?s.charAt(1):o[n-1]+s.charAt(1):a}p=o[c-1];}return void 0===p?"":p})}return[function(t,a){var r=e(this),o=t==null?void 0:t[m];return o===void 0?f.call(r+"",t,a):o.call(t,r,a)},function(e,a){var d=g(f,e,this,a);if(d.done)return d.value;var p=t(e),c=this+"",m="function"==typeof a;m||(a=a+"");var y=p.global;if(y){var x=p.unicode;p.lastIndex=0}for(var v=[],b;(b=i(p,c),null!==b)&&!(v.push(b),!y);){var _=b[0]+"";""==_&&(p.lastIndex=n(c,r(p.lastIndex),x))}for(var T="",S=0,E=0;E<v.length;E++){b=v[E];for(var w=b[0]+"",A=s(l(o(b.index),c.length),0),M=[],P=1;P<b.length;P++)M.push(u(b[P]));var L=b.groups;if(m){var C=[w].concat(M,A,c);L!==void 0&&C.push(L);var R=a.apply(void 0,C)+""}else R=h(w,c,A,M,L,a);A>=S&&(T+=c.slice(S,A)+R,S=A+w.length)}return T+c.slice(S)}]})},{119:119,139:139,141:141,142:142,36:36,38:38,65:65}],252:[function(e){'use strict';var t=e(38),a=e(121),r=e(119);e(65)("search",1,function(e,o,n,i){return[function(t){var a=e(this),r=t==null?void 0:t[o];return r===void 0?new RegExp(t)[o](a+""):r.call(t,a)},function(e){var o=i(n,e,this);if(o.done)return o.value;var s=t(e),l=this+"",d=s.lastIndex;a(d,0)||(s.lastIndex=0);var p=r(s,l);return a(s.lastIndex,d)||(s.lastIndex=d),null===p?-1:p.index}]})},{119:119,121:121,38:38,65:65}],253:[function(e){'use strict';var t=e(82),a=e(38),r=e(127),o=e(36),n=e(141),s=e(119),l=e(120),d=e(64),c=Math.min,u=[].push,m="split",f="length",g="lastIndex",h=4294967295,y=!d(function(){RegExp(h,"y")});e(65)("split",2,function(e,i,d,x){var v;return v="c"=="abbc"[m](/(b)*/)[1]||4!="test"[m](/(?:)/,-1)[f]||2!="ab"[m](/(?:ab)*/)[f]||4!="."[m](/(.?)(.?)/)[f]||1<"."[m](/()()/)[f]||""[m](/.?/)[f]?function(e,a){var r=this+"";if(void 0===e&&0===a)return[];if(!t(e))return d.call(r,e,a);for(var o=[],n=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),i=0,s=void 0===a?h:a>>>0,p=new RegExp(e.source,n+"g"),c,m,y;(c=l.call(p,r))&&(m=p[g],!(m>i&&(o.push(r.slice(i,c.index)),1<c[f]&&c.index<r[f]&&u.apply(o,c.slice(1)),y=c[0][f],i=m,o[f]>=s)));)p[g]===c.index&&p[g]++;return i===r[f]?(y||!p.test(""))&&o.push(""):o.push(r.slice(i)),o[f]>s?o.slice(0,s):o}:"0"[m](void 0,0)[f]?function(e,t){return void 0===e&&0===t?[]:d.call(this,e,t)}:d,[function(t,a){var r=e(this),o=null==t?void 0:t[i];return void 0===o?v.call(r+"",t,a):o.call(t,r,a)},function(t,l){var u=x(v,t,this,l,v!==d);if(u.done)return u.value;var m=a(t),f=this+"",g=r(m,RegExp),b=m.unicode,_=(m.ignoreCase?"i":"")+(m.multiline?"m":"")+(m.unicode?"u":"")+(y?"y":"g"),T=new g(y?m:"^(?:"+m.source+")",_),S=void 0===l?h:l>>>0;if(0===S)return[];if(0===f.length)return null===s(T,f)?[f]:[];for(var E=0,w=0,M=[];w<f.length;){T.lastIndex=y?w:0;var A=s(T,y?f:f.slice(w)),P;if(null===A||(P=c(n(T.lastIndex+(y?0:w)),f.length))===E)w=o(f,w,b);else{if(M.push(f.slice(E,w)),M.length===S)return M;for(var L=1;L<=A.length-1;L++)if(M.push(A[L]),M.length===S)return M;w=E=P}}return M.push(f.slice(E)),M}]})},{119:119,120:120,127:127,141:141,36:36,38:38,64:64,65:65,82:82}],254:[function(e){'use strict';e(249);var t=e(38),a=e(66),r=e(58),o="toString",n=/./[o],i=function(t){e(118)(RegExp.prototype,o,t,!0)};e(64)(function(){return"/a/b"!=n.call({source:"a",flags:"b"})})?i(function(){var e=t(this);return"/".concat(e.source,"/","flags"in e?e.flags:!r&&e instanceof RegExp?a.call(e):void 0)}):n.name!=o&&i(function(){return n.call(this)})},{118:118,249:249,38:38,58:58,64:64,66:66}],255:[function(e,t){'use strict';var a=e(49),r=e(149),o="Set";t.exports=e(51)(o,function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return a.def(r(this,o),e=0===e?0:e,e)}},a)},{149:149,49:49,51:51}],256:[function(e){'use strict';e(131)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},{131:131}],257:[function(e){'use strict';e(131)("big",function(e){return function(){return e(this,"big","","")}})},{131:131}],258:[function(e){'use strict';e(131)("blink",function(e){return function(){return e(this,"blink","","")}})},{131:131}],259:[function(e){'use strict';e(131)("bold",function(e){return function(){return e(this,"b","","")}})},{131:131}],260:[function(e){'use strict';var t=e(62),a=e(129)(!1);t(t.P,"String",{codePointAt:function(e){return a(this,e)}})},{129:129,62:62}],261:[function(e){'use strict';var t=e(62),a=e(141),r=e(130),o="endsWith",n=""[o];t(t.P+t.F*e(63)(o),"String",{endsWith:function(e){var t=r(this,e,o),n=1<arguments.length?arguments[1]:void 0,i=a(t.length),s=n===void 0?i:Math.min(a(n),i),l=e+"";return t.slice(s-l.length,s)===l}})},{130:130,141:141,62:62,63:63}],262:[function(e){'use strict';e(131)("fixed",function(e){return function(){return e(this,"tt","","")}})},{131:131}],263:[function(e){'use strict';e(131)("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},{131:131}],264:[function(e){'use strict';e(131)("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},{131:131}],265:[function(e){var t=e(62),a=e(137),r=String.fromCharCode,o=String.fromCodePoint;t(t.S+t.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(){for(var e=[],t=arguments.length,o=0,n;t>o;){if(n=+arguments[o++],a(n,1114111)!==n)throw RangeError(n+" is not a valid code point");e.push(65536>n?r(n):r(((n-=65536)>>10)+55296,n%1024+56320))}return e.join("")}})},{137:137,62:62}],266:[function(e){'use strict';var t=e(62),a=e(130),r="includes";t(t.P+t.F*e(63)(r),"String",{includes:function(e){return!!~a(this,e,r).indexOf(e,1<arguments.length?arguments[1]:void 0)}})},{130:130,62:62,63:63}],267:[function(e){'use strict';e(131)("italics",function(e){return function(){return e(this,"i","","")}})},{131:131}],268:[function(e){'use strict';var t=e(129)(!0);e(85)(String,"String",function(e){this._t=e+"",this._i=0},function(){var e=this._t,a=this._i,r;return a>=e.length?{value:void 0,done:!0}:(r=t(e,a),this._i+=r.length,{value:r,done:!1})})},{129:129,85:85}],269:[function(e){'use strict';e(131)("link",function(e){return function(t){return e(this,"a","href",t)}})},{131:131}],270:[function(e){var t=e(62),a=e(140),r=e(141);t(t.S,"String",{raw:function(e){for(var t=a(e.raw),o=r(t.length),n=arguments.length,s=[],l=0;o>l;)s.push(t[l++]+""),l<n&&s.push(arguments[l]+"");return s.join("")}})},{140:140,141:141,62:62}],271:[function(e){var t=e(62);t(t.P,"String",{repeat:e(133)})},{133:133,62:62}],272:[function(e){'use strict';e(131)("small",function(e){return function(){return e(this,"small","","")}})},{131:131}],273:[function(e){'use strict';var t=e(62),a=e(141),r=e(130),o="startsWith",n=""[o];t(t.P+t.F*e(63)(o),"String",{startsWith:function(e){var t=r(this,e,o),n=a(Math.min(1<arguments.length?arguments[1]:void 0,t.length)),i=e+"";return t.slice(n,n+i.length)===i}})},{130:130,141:141,62:62,63:63}],274:[function(e){'use strict';e(131)("strike",function(e){return function(){return e(this,"strike","","")}})},{131:131}],275:[function(e){'use strict';e(131)("sub",function(e){return function(){return e(this,"sub","","")}})},{131:131}],276:[function(e){'use strict';e(131)("sup",function(e){return function(){return e(this,"sup","","")}})},{131:131}],277:[function(e){'use strict';e(134)("trim",function(e){return function(){return e(this,3)}})},{134:134}],278:[function(e){'use strict';var t=e(70),a=e(71),r=e(58),o=e(62),n=e(118),s=e(94).KEY,l=e(64),d=e(126),p=e(124),c=e(147),u=e(152),m=e(151),f=e(150),g=e(61),h=e(79),y=e(38),x=e(81),v=e(142),b=e(140),_=e(143),T=e(116),S=e(98),E=e(102),w=e(101),A=e(104),M=e(99),P=e(107),L=w.f,C=M.f,R=E.f,F=t.Symbol,I=t.JSON,N=I&&I.stringify,D="prototype",B=u("_hidden"),U=u("toPrimitive"),O={}.propertyIsEnumerable,z=d("symbol-registry"),G=d("symbols"),H=d("op-symbols"),V=Object[D],W="function"==typeof F&&!!A.f,X=t.QObject,Y=!X||!X[D]||!X[D].findChild,Q=r&&l(function(){return 7!=S(C({},"a",{get:function(){return C(this,"a",{value:7}).a}})).a})?function(e,t,a){var r=L(V,t);r&&delete V[t],C(e,t,a),r&&e!==V&&C(V,t,r)}:C,q=function(e){var t=G[e]=S(F[D]);return t._k=e,t},Z=W&&"symbol"==_typeof(F.iterator)?function(e){return"symbol"==_typeof(e)}:function(e){return e instanceof F},J=function(e,t,r){return e===V&&J(H,t,r),y(e),t=_(t,!0),y(r),a(G,t)?(r.enumerable?(a(e,B)&&e[B][t]&&(e[B][t]=!1),r=S(r,{enumerable:T(0,!1)})):(!a(e,B)&&C(e,B,T(1,{})),e[B][t]=!0),Q(e,t,r)):C(e,t,r)},K=function(e,t){y(e);for(var a=g(t=b(t)),r=0,o=a.length,n;o>r;)J(e,n=a[r++],t[n]);return e},ee=function(e){var t=O.call(this,e=_(e,!0));return(this!==V||!a(G,e)||a(H,e))&&(!(t||!a(this,e)||!a(G,e)||a(this,B)&&this[B][e])||t)},te=function(e,t){if(e=b(e),t=_(t,!0),e!==V||!a(G,t)||a(H,t)){var r=L(e,t);return r&&a(G,t)&&!(a(e,B)&&e[B][t])&&(r.enumerable=!0),r}},ae=function(e){for(var t=R(b(e)),r=[],o=0,n;t.length>o;)a(G,n=t[o++])||n==B||n==s||r.push(n);return r},re=function(e){for(var t=e===V,r=R(t?H:b(e)),o=[],n=0,s;r.length>n;)a(G,s=r[n++])&&(!t||a(V,s))&&o.push(G[s]);return o};W||(F=function(){if(this instanceof F)throw TypeError("Symbol is not a constructor!");var e=c(0<arguments.length?arguments[0]:void 0);return r&&Y&&Q(V,e,{configurable:!0,set:function t(r){this===V&&t.call(H,r),a(this,B)&&a(this[B],e)&&(this[B][e]=!1),Q(this,e,T(1,r))}}),q(e)},n(F[D],"toString",function(){return this._k}),w.f=te,M.f=J,e(103).f=E.f=ae,e(108).f=ee,A.f=re,r&&!e(89)&&n(V,"propertyIsEnumerable",ee,!0),m.f=function(e){return q(u(e))}),o(o.G+o.W+o.F*!W,{Symbol:F});for(var oe=["hasInstance","isConcatSpreadable","iterator","match","replace","search","species","split","toPrimitive","toStringTag","unscopables"],ne=0;oe.length>ne;)u(oe[ne++]);for(var i=P(u.store),ie=0;i.length>ie;)f(i[ie++]);o(o.S+o.F*!W,"Symbol",{for:function(e){return a(z,e+="")?z[e]:z[e]=F(e)},keyFor:function(e){if(!Z(e))throw TypeError(e+" is not a symbol!");for(var t in z)if(z[t]===e)return t},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),o(o.S+o.F*!W,"Object",{create:function(e,t){return t===void 0?S(e):K(S(e),t)},defineProperty:J,defineProperties:K,getOwnPropertyDescriptor:te,getOwnPropertyNames:ae,getOwnPropertySymbols:re});var se=l(function(){A.f(1)});o(o.S+o.F*se,"Object",{getOwnPropertySymbols:function(e){return A.f(v(e))}}),I&&o(o.S+o.F*(!W||l(function(){var e=F();return"[null]"!=N([e])||"{}"!=N({a:e})||"{}"!=N(Object(e))})),"JSON",{stringify:function(e){for(var t=[e],a=1,r,o;arguments.length>a;)t.push(arguments[a++]);if(o=r=t[1],(x(r)||void 0!==e)&&!Z(e))return h(r)||(r=function(e,t){if("function"==typeof o&&(t=o.call(this,e,t)),!Z(t))return t}),t[1]=r,N.apply(I,t)}}),F[D][U]||e(72)(F[D],U,F[D].valueOf),p(F,"Symbol"),p(Math,"Math",!0),p(t.JSON,"JSON",!0)},{101:101,102:102,103:103,104:104,107:107,108:108,116:116,118:118,124:124,126:126,140:140,142:142,143:143,147:147,150:150,151:151,152:152,38:38,58:58,61:61,62:62,64:64,70:70,71:71,72:72,79:79,81:81,89:89,94:94,98:98,99:99}],279:[function(e){'use strict';var t=e(62),a=e(146),r=e(145),o=e(38),n=e(137),i=e(141),s=e(81),l=e(70).ArrayBuffer,d=e(127),p=r.ArrayBuffer,c=r.DataView,u=a.ABV&&l.isView,m=p.prototype.slice,f=a.VIEW,g="ArrayBuffer";t(t.G+t.W+t.F*(l!==p),{ArrayBuffer:p}),t(t.S+t.F*!a.CONSTR,g,{isView:function(e){return u&&u(e)||s(e)&&f in e}}),t(t.P+t.U+t.F*e(64)(function(){return!new p(2).slice(1,void 0).byteLength}),g,{slice:function(e,t){if(m!==void 0&&t===void 0)return m.call(o(this),e);for(var a=o(this).byteLength,r=n(e,a),s=n(void 0===t?a:t,a),l=new(d(this,p))(i(s-r)),u=new c(this),f=new c(l),g=0;r<s;)f.setUint8(g++,u.getUint8(r++));return l}}),e(123)(g)},{123:123,127:127,137:137,141:141,145:145,146:146,38:38,62:62,64:64,70:70,81:81}],280:[function(e){var t=e(62);t(t.G+t.W+t.F*!e(146).ABV,{DataView:e(145).DataView})},{145:145,146:146,62:62}],281:[function(e){e(144)("Float32",4,function(e){return function(t,a,r){return e(this,t,a,r)}})},{144:144}],282:[function(e){e(144)("Float64",8,function(e){return function(t,a,r){return e(this,t,a,r)}})},{144:144}],283:[function(e){e(144)("Int16",2,function(e){return function(t,a,r){return e(this,t,a,r)}})},{144:144}],284:[function(e){e(144)("Int32",4,function(e){return function(t,a,r){return e(this,t,a,r)}})},{144:144}],285:[function(e){e(144)("Int8",1,function(e){return function(t,a,r){return e(this,t,a,r)}})},{144:144}],286:[function(e){e(144)("Uint16",2,function(e){return function(t,a,r){return e(this,t,a,r)}})},{144:144}],287:[function(e){e(144)("Uint32",4,function(e){return function(t,a,r){return e(this,t,a,r)}})},{144:144}],288:[function(e){e(144)("Uint8",1,function(e){return function(t,a,r){return e(this,t,a,r)}})},{144:144}],289:[function(e){e(144)("Uint8",1,function(e){return function(t,a,r){return e(this,t,a,r)}},!0)},{144:144}],290:[function(e,t){'use strict';var a=e(70),r=e(42)(0),o=e(118),n=e(94),i=e(97),s=e(50),l=e(81),d=e(149),p=e(149),c=!a.ActiveXObject&&"ActiveXObject"in a,u="WeakMap",m=n.getWeak,f=Object.isExtensible,g=s.ufstore,h=function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},y={get:function(e){if(l(e)){var t=m(e);return!0===t?g(d(this,u)).get(e):t?t[this._i]:void 0}},set:function(e,t){return s.def(d(this,u),e,t)}},x=t.exports=e(51)(u,h,y,s,!0,!0),v;p&&c&&(v=s.getConstructor(h,u),i(v.prototype,y),n.NEED=!0,r(["delete","has","get","set"],function(e){var t=x.prototype,r=t[e];o(t,e,function(t,a){if(l(t)&&!f(t)){this._f||(this._f=new v);var o=this._f[e](t,a);return"set"==e?this:o}return r.call(this,t,a)})}))},{118:118,149:149,42:42,50:50,51:51,70:70,81:81,94:94,97:97}],291:[function(e){'use strict';var t=e(50),a=e(149),r="WeakSet";e(51)(r,function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return t.def(a(this,r),e,!0)}},t,!1,!0)},{149:149,50:50,51:51}],292:[function(e){'use strict';var t=e(62),a=e(67),r=e(142),o=e(141),n=e(33),i=e(45);t(t.P,"Array",{flatMap:function(e){var t=r(this),s,l;return n(e),s=o(t.length),l=i(t,0),a(l,t,t,s,0,1,e,arguments[1]),l}}),e(35)("flatMap")},{141:141,142:142,33:33,35:35,45:45,62:62,67:67}],293:[function(e){'use strict';var t=e(62),a=e(41)(!0);t(t.P,"Array",{includes:function(e){return a(this,e,1<arguments.length?arguments[1]:void 0)}}),e(35)("includes")},{35:35,41:41,62:62}],294:[function(e){var t=e(62),a=e(110)(!0);t(t.S,"Object",{entries:function(e){return a(e)}})},{110:110,62:62}],295:[function(e){var t=e(62),a=e(111),r=e(140),o=e(101),n=e(53);t(t.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t=r(e),s=o.f,l=a(t),d={},p=0,c,u;l.length>p;)u=s(t,c=l[p++]),void 0!==u&&n(d,c,u);return d}})},{101:101,111:111,140:140,53:53,62:62}],296:[function(e){var t=e(62),a=e(110)(!1);t(t.S,"Object",{values:function(e){return a(e)}})},{110:110,62:62}],297:[function(e){'use strict';var t=e(62),a=e(52),r=e(70),o=e(127),n=e(115);t(t.P+t.R,"Promise",{finally:function(t){var i=o(this,a.Promise||r.Promise),e="function"==typeof t;return this.then(e?function(e){return n(i,t()).then(function(){return e})}:t,e?function(a){return n(i,t()).then(function(){throw a})}:t)}})},{115:115,127:127,52:52,62:62,70:70}],298:[function(e){'use strict';var t=e(62),a=e(132),r=e(148),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);t(t.P+t.F*o,"String",{padEnd:function(e){return a(this,e,1<arguments.length?arguments[1]:void 0,!1)}})},{132:132,148:148,62:62}],299:[function(e){'use strict';var t=e(62),a=e(132),r=e(148),o=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);t(t.P+t.F*o,"String",{padStart:function(e){return a(this,e,1<arguments.length?arguments[1]:void 0,!0)}})},{132:132,148:148,62:62}],300:[function(e){'use strict';e(134)("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},{134:134}],301:[function(e){'use strict';e(134)("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},{134:134}],302:[function(e){e(150)("asyncIterator")},{150:150}],303:[function(e){for(var t=e(164),a=e(107),r=e(118),o=e(70),n=e(72),s=e(88),l=e(152),d=l("iterator"),p=l("toStringTag"),c=s.Array,u={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},m=a(u),f=0;f<m.length;f++){var g=m[f],h=u[g],y=o[g],x=y&&y.prototype,v;if(x&&(x[d]||n(x,d,c),x[p]||n(x,p,g),s[g]=c,h))for(v in t)x[v]||r(x,v,t[v],!0)}},{107:107,118:118,152:152,164:164,70:70,72:72,88:88}],304:[function(e){var t=e(62),a=e(136);t(t.G+t.B,{setImmediate:a.set,clearImmediate:a.clear})},{136:136,62:62}],305:[function(e){var t=e(70),a=e(62),r=e(148),o=[].slice,n=/MSIE .\./.test(r),i=function(e){return function(t,a){var r=2<arguments.length,n=!!r&&o.call(arguments,2);return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,n)}:t,a)}};a(a.G+a.B+a.F*n,{setTimeout:i(t.setTimeout),setInterval:i(t.setInterval)})},{148:148,62:62,70:70}],306:[function(e,t){e(305),e(304),e(303),t.exports=e(52)},{303:303,304:304,305:305,52:52}],307:[function(e,t){var a=function(e){"use strict";function t(e,t,a,o){var n=t&&t.prototype instanceof r?t:r,i=Object.create(n.prototype),s=new u(o||[]);return i._invoke=l(e,a,s),i}function a(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(e){return{type:"throw",arg:e}}}function r(){}function o(){}function n(){}function i(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function s(e){function t(r,o,n,i){var s=a(e[r],e,o);if("throw"===s.type)i(s.arg);else{var l=s.arg,d=l.value;return d&&"object"===_typeof(d)&&h.call(d,"__await")?Promise.resolve(d.__await).then(function(e){t("next",e,n,i)},function(e){t("throw",e,n,i)}):Promise.resolve(d).then(function(e){l.value=e,n(l)},function(e){return t("throw",e,n,i)})}}function r(e,a){function r(){return new Promise(function(r,o){t(e,a,r,o)})}return o=o?o.then(r,r):r()}var o;this._invoke=r}function l(e,t,r){var o="suspendedStart";return function(n,i){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===n)throw i;return f()}for(r.method=n,r.arg=i;;){var s=r.delegate;if(s){var l=d(s,r);if(l){if(l===_)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===o)throw o="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o="executing";var p=a(e,t,r);if("normal"===p.type){if(o=r.done?"completed":"suspendedYield",p.arg===_)continue;return{value:p.arg,done:r.done}}"throw"===p.type&&(o="completed",r.method="throw",r.arg=p.arg)}}}function d(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator["return"]&&(t.method="return",t.arg=void 0,d(e,t),"throw"===t.method))return _;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var o=a(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,_;var n=o.arg;if(!n)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,_;if(n.done)t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0);else return n;return t.delegate=null,_}function p(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function c(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function u(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(p,this),this.reset(!0)}function m(e){if(e){var t=e[x];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,r=function t(){for(;++a<e.length;)if(h.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:f}}function f(){return{value:void 0,done:!0}}var g=Object.prototype,h=g.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},x=y.iterator||"@@iterator",v=y.asyncIterator||"@@asyncIterator",b=y.toStringTag||"@@toStringTag";e.wrap=t;var _={},T={};T[x]=function(){return this};var S=Object.getPrototypeOf,E=S&&S(S(m([])));E&&E!==g&&h.call(E,x)&&(T=E);var w=n.prototype=r.prototype=Object.create(T);return o.prototype=w.constructor=n,n.constructor=o,n[b]=o.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===o||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,n):(e.__proto__=n,!(b in e)&&(e[b]="GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},i(s.prototype),s.prototype[v]=function(){return this},e.AsyncIterator=s,e.async=function(a,r,o,n){var i=new s(t(a,r,o,n));return e.isGeneratorFunction(r)?i:i.next().then(function(e){return e.done?e.value:i.next()})},i(w),w[b]="Generator",w[x]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var a in e)t.push(a);return t.reverse(),function a(){for(;t.length;){var r=t.pop();if(r in e)return a.value=r,a.done=!1,a}return a.done=!0,a}},e.values=m,u.prototype={constructor:u,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(c),!e)for(var t in this)"t"===t.charAt(0)&&h.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return n.type="throw",n.arg=e,a.next=t,r&&(a.method="next",a.arg=void 0),!!r}if(this.done)throw e;for(var a=this,r=this.tryEntries.length-1;0<=r;--r){var o=this.tryEntries[r],n=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var s=h.call(o,"catchLoc"),l=h.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);}else if(!l)throw new Error("try statement without catch or finally");else if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1,r;0<=a;--a)if(r=this.tryEntries[a],r.tryLoc<=this.prev&&h.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var n=o?o.completion:{};return n.type=e,n.arg=t,o?(this.method="next",this.next=o.finallyLoc,_):this.complete(n)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1,a;0<=t;--t)if(a=this.tryEntries[t],a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),c(a),_},catch:function(e){for(var t=this.tryEntries.length-1,a;0<=t;--t)if(a=this.tryEntries[t],a.tryLoc===e){var r=a.completion;if("throw"===r.type){var o=r.arg;c(a)}return o}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:m(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),_}},e}("object"===_typeof(t)?t.exports:{});try{regeneratorRuntime=a}catch(e){Function("r","regeneratorRuntime = r")(a)}},{}]},{},[1]);